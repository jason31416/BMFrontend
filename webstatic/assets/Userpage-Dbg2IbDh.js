var Fe=Object.defineProperty;var $e=(d,m,g)=>m in d?Fe(d,m,{enumerable:!0,configurable:!0,writable:!0,value:g}):d[m]=g;var he=(d,m,g)=>$e(d,typeof m!="symbol"?m+"":m,g);import{c as createElementBlock,b as openBlock,f as createBaseVNode,C as getDefaultExportFromCjs$1,r as ref,q as useRoute,h as computed,i as createBlock,g as createCommentVNode,j as createVNode,s as createTextVNode,n as normalizeStyle,t as toDisplayString,e as normalizeClass,F as Fragment,d as renderList,D as resolveDynamicComponent}from"./index-TIiU0LZt.js";import{N as Navbar}from"./NavBar-C0FAO5nD.js";import{a as axios,_ as _sfc_main$1}from"./const-ClyfiBNT.js";import _sfc_main$2 from"./404-BQxvWML5.js";function render$2(d,m){return openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5"})])}function render$1(d,m){return openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}function render(d,m){return openBlock(),createElementBlock("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[createBaseVNode("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}var dayjs_min$1={exports:{}},dayjs_min=dayjs_min$1.exports,hasRequiredDayjs_min;function requireDayjs_min(){return hasRequiredDayjs_min||(hasRequiredDayjs_min=1,function(d,m){(function(g,w){d.exports=w()})(dayjs_min,function(){var g=1e3,w=6e4,I=36e5,P="millisecond",F="second",$="minute",D="hour",U="day",Z="week",j="month",G="quarter",H="year",W="date",Q="Invalid Date",q=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,rt=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,it={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(pt){var st=["th","st","nd","rd"],ct=pt%100;return"["+pt+(st[(ct-20)%10]||st[ct]||st[0])+"]"}},X=function(pt,st,ct){var At=String(pt);return!At||At.length>=st?pt:""+Array(st+1-At.length).join(ct)+pt},J={s:X,z:function(pt){var st=-pt.utcOffset(),ct=Math.abs(st),At=Math.floor(ct/60),kt=ct%60;return(st<=0?"+":"-")+X(At,2,"0")+":"+X(kt,2,"0")},m:function pt(st,ct){if(st.date()<ct.date())return-pt(ct,st);var At=12*(ct.year()-st.year())+(ct.month()-st.month()),kt=st.clone().add(At,j),yt=ct-kt<0,Ct=st.clone().add(At+(yt?-1:1),j);return+(-(At+(ct-kt)/(yt?kt-Ct:Ct-kt))||0)},a:function(pt){return pt<0?Math.ceil(pt)||0:Math.floor(pt)},p:function(pt){return{M:j,y:H,w:Z,d:U,D:W,h:D,m:$,s:F,ms:P,Q:G}[pt]||String(pt||"").toLowerCase().replace(/s$/,"")},u:function(pt){return pt===void 0}},tt="en",ot={};ot[tt]=it;var nt="$isDayjsObject",lt=function(pt){return pt instanceof ht||!(!pt||!pt[nt])},at=function pt(st,ct,At){var kt;if(!st)return tt;if(typeof st=="string"){var yt=st.toLowerCase();ot[yt]&&(kt=yt),ct&&(ot[yt]=ct,kt=yt);var Ct=st.split("-");if(!kt&&Ct.length>1)return pt(Ct[0])}else{var xt=st.name;ot[xt]=st,kt=xt}return!At&&kt&&(tt=kt),kt||!At&&tt},ut=function(pt,st){if(lt(pt))return pt.clone();var ct=typeof st=="object"?st:{};return ct.date=pt,ct.args=arguments,new ht(ct)},V=J;V.l=at,V.i=lt,V.w=function(pt,st){return ut(pt,{locale:st.$L,utc:st.$u,x:st.$x,$offset:st.$offset})};var ht=function(){function pt(ct){this.$L=at(ct.locale,null,!0),this.parse(ct),this.$x=this.$x||ct.x||{},this[nt]=!0}var st=pt.prototype;return st.parse=function(ct){this.$d=function(At){var kt=At.date,yt=At.utc;if(kt===null)return new Date(NaN);if(V.u(kt))return new Date;if(kt instanceof Date)return new Date(kt);if(typeof kt=="string"&&!/Z$/i.test(kt)){var Ct=kt.match(q);if(Ct){var xt=Ct[2]-1||0,Pt=(Ct[7]||"0").substring(0,3);return yt?new Date(Date.UTC(Ct[1],xt,Ct[3]||1,Ct[4]||0,Ct[5]||0,Ct[6]||0,Pt)):new Date(Ct[1],xt,Ct[3]||1,Ct[4]||0,Ct[5]||0,Ct[6]||0,Pt)}}return new Date(kt)}(ct),this.init()},st.init=function(){var ct=this.$d;this.$y=ct.getFullYear(),this.$M=ct.getMonth(),this.$D=ct.getDate(),this.$W=ct.getDay(),this.$H=ct.getHours(),this.$m=ct.getMinutes(),this.$s=ct.getSeconds(),this.$ms=ct.getMilliseconds()},st.$utils=function(){return V},st.isValid=function(){return this.$d.toString()!==Q},st.isSame=function(ct,At){var kt=ut(ct);return this.startOf(At)<=kt&&kt<=this.endOf(At)},st.isAfter=function(ct,At){return ut(ct)<this.startOf(At)},st.isBefore=function(ct,At){return this.endOf(At)<ut(ct)},st.$g=function(ct,At,kt){return V.u(ct)?this[At]:this.set(kt,ct)},st.unix=function(){return Math.floor(this.valueOf()/1e3)},st.valueOf=function(){return this.$d.getTime()},st.startOf=function(ct,At){var kt=this,yt=!!V.u(At)||At,Ct=V.p(ct),xt=function(Zt,Tt){var et=V.w(kt.$u?Date.UTC(kt.$y,Tt,Zt):new Date(kt.$y,Tt,Zt),kt);return yt?et:et.endOf(U)},Pt=function(Zt,Tt){return V.w(kt.toDate()[Zt].apply(kt.toDate("s"),(yt?[0,0,0,0]:[23,59,59,999]).slice(Tt)),kt)},Ft=this.$W,Rt=this.$M,Mt=this.$D,Bt="set"+(this.$u?"UTC":"");switch(Ct){case H:return yt?xt(1,0):xt(31,11);case j:return yt?xt(1,Rt):xt(0,Rt+1);case Z:var $t=this.$locale().weekStart||0,Ot=(Ft<$t?Ft+7:Ft)-$t;return xt(yt?Mt-Ot:Mt+(6-Ot),Rt);case U:case W:return Pt(Bt+"Hours",0);case D:return Pt(Bt+"Minutes",1);case $:return Pt(Bt+"Seconds",2);case F:return Pt(Bt+"Milliseconds",3);default:return this.clone()}},st.endOf=function(ct){return this.startOf(ct,!1)},st.$set=function(ct,At){var kt,yt=V.p(ct),Ct="set"+(this.$u?"UTC":""),xt=(kt={},kt[U]=Ct+"Date",kt[W]=Ct+"Date",kt[j]=Ct+"Month",kt[H]=Ct+"FullYear",kt[D]=Ct+"Hours",kt[$]=Ct+"Minutes",kt[F]=Ct+"Seconds",kt[P]=Ct+"Milliseconds",kt)[yt],Pt=yt===U?this.$D+(At-this.$W):At;if(yt===j||yt===H){var Ft=this.clone().set(W,1);Ft.$d[xt](Pt),Ft.init(),this.$d=Ft.set(W,Math.min(this.$D,Ft.daysInMonth())).$d}else xt&&this.$d[xt](Pt);return this.init(),this},st.set=function(ct,At){return this.clone().$set(ct,At)},st.get=function(ct){return this[V.p(ct)]()},st.add=function(ct,At){var kt,yt=this;ct=Number(ct);var Ct=V.p(At),xt=function(Rt){var Mt=ut(yt);return V.w(Mt.date(Mt.date()+Math.round(Rt*ct)),yt)};if(Ct===j)return this.set(j,this.$M+ct);if(Ct===H)return this.set(H,this.$y+ct);if(Ct===U)return xt(1);if(Ct===Z)return xt(7);var Pt=(kt={},kt[$]=w,kt[D]=I,kt[F]=g,kt)[Ct]||1,Ft=this.$d.getTime()+ct*Pt;return V.w(Ft,this)},st.subtract=function(ct,At){return this.add(-1*ct,At)},st.format=function(ct){var At=this,kt=this.$locale();if(!this.isValid())return kt.invalidDate||Q;var yt=ct||"YYYY-MM-DDTHH:mm:ssZ",Ct=V.z(this),xt=this.$H,Pt=this.$m,Ft=this.$M,Rt=kt.weekdays,Mt=kt.months,Bt=kt.meridiem,$t=function(Tt,et,It,mt){return Tt&&(Tt[et]||Tt(At,yt))||It[et].slice(0,mt)},Ot=function(Tt){return V.s(xt%12||12,Tt,"0")},Zt=Bt||function(Tt,et,It){var mt=Tt<12?"AM":"PM";return It?mt.toLowerCase():mt};return yt.replace(rt,function(Tt,et){return et||function(It){switch(It){case"YY":return String(At.$y).slice(-2);case"YYYY":return V.s(At.$y,4,"0");case"M":return Ft+1;case"MM":return V.s(Ft+1,2,"0");case"MMM":return $t(kt.monthsShort,Ft,Mt,3);case"MMMM":return $t(Mt,Ft);case"D":return At.$D;case"DD":return V.s(At.$D,2,"0");case"d":return String(At.$W);case"dd":return $t(kt.weekdaysMin,At.$W,Rt,2);case"ddd":return $t(kt.weekdaysShort,At.$W,Rt,3);case"dddd":return Rt[At.$W];case"H":return String(xt);case"HH":return V.s(xt,2,"0");case"h":return Ot(1);case"hh":return Ot(2);case"a":return Zt(xt,Pt,!0);case"A":return Zt(xt,Pt,!1);case"m":return String(Pt);case"mm":return V.s(Pt,2,"0");case"s":return String(At.$s);case"ss":return V.s(At.$s,2,"0");case"SSS":return V.s(At.$ms,3,"0");case"Z":return Ct}return null}(Tt)||Ct.replace(":","")})},st.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},st.diff=function(ct,At,kt){var yt,Ct=this,xt=V.p(At),Pt=ut(ct),Ft=(Pt.utcOffset()-this.utcOffset())*w,Rt=this-Pt,Mt=function(){return V.m(Ct,Pt)};switch(xt){case H:yt=Mt()/12;break;case j:yt=Mt();break;case G:yt=Mt()/3;break;case Z:yt=(Rt-Ft)/6048e5;break;case U:yt=(Rt-Ft)/864e5;break;case D:yt=Rt/I;break;case $:yt=Rt/w;break;case F:yt=Rt/g;break;default:yt=Rt}return kt?yt:V.a(yt)},st.daysInMonth=function(){return this.endOf(j).$D},st.$locale=function(){return ot[this.$L]},st.locale=function(ct,At){if(!ct)return this.$L;var kt=this.clone(),yt=at(ct,At,!0);return yt&&(kt.$L=yt),kt},st.clone=function(){return V.w(this.$d,this)},st.toDate=function(){return new Date(this.valueOf())},st.toJSON=function(){return this.isValid()?this.toISOString():null},st.toISOString=function(){return this.$d.toISOString()},st.toString=function(){return this.$d.toUTCString()},pt}(),vt=ht.prototype;return ut.prototype=vt,[["$ms",P],["$s",F],["$m",$],["$H",D],["$W",U],["$M",j],["$y",H],["$D",W]].forEach(function(pt){vt[pt[1]]=function(st){return this.$g(st,pt[0],pt[1])}}),ut.extend=function(pt,st){return pt.$i||(pt(st,ht,ut),pt.$i=!0),ut},ut.locale=at,ut.isDayjs=lt,ut.unix=function(pt){return ut(1e3*pt)},ut.en=ot[tt],ut.Ls=ot,ut.p={},ut})}(dayjs_min$1)),dayjs_min$1.exports}var dayjs_minExports=requireDayjs_min();const dayjs=getDefaultExportFromCjs$1(dayjs_minExports);var relativeTime$2={exports:{}},relativeTime$1=relativeTime$2.exports,hasRequiredRelativeTime;function requireRelativeTime(){return hasRequiredRelativeTime||(hasRequiredRelativeTime=1,function(d,m){(function(g,w){d.exports=w()})(relativeTime$1,function(){return function(g,w,I){g=g||{};var P=w.prototype,F={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function $(U,Z,j,G){return P.fromToBase(U,Z,j,G)}I.en.relativeTime=F,P.fromToBase=function(U,Z,j,G,H){for(var W,Q,q,rt=j.$locale().relativeTime||F,it=g.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],X=it.length,J=0;J<X;J+=1){var tt=it[J];tt.d&&(W=G?I(U).diff(j,tt.d,!0):j.diff(U,tt.d,!0));var ot=(g.rounding||Math.round)(Math.abs(W));if(q=W>0,ot<=tt.r||!tt.r){ot<=1&&J>0&&(tt=it[J-1]);var nt=rt[tt.l];H&&(ot=H(""+ot)),Q=typeof nt=="string"?nt.replace("%d",ot):nt(ot,Z,tt.l,q);break}}if(Z)return Q;var lt=q?rt.future:rt.past;return typeof lt=="function"?lt(Q):lt.replace("%s",Q)},P.to=function(U,Z){return $(U,Z,this,!0)},P.from=function(U,Z){return $(U,Z,this)};var D=function(U){return U.$u?I.utc():I()};P.toNow=function(U){return this.to(D(this),U)},P.fromNow=function(U){return this.from(D(this),U)}}})}(relativeTime$2)),relativeTime$2.exports}var relativeTimeExports=requireRelativeTime();const relativeTime=getDefaultExportFromCjs$1(relativeTimeExports);var zhCn$1={exports:{}},zhCn=zhCn$1.exports,hasRequiredZhCn;function requireZhCn(){return hasRequiredZhCn||(hasRequiredZhCn=1,function(d,m){(function(g,w){d.exports=w(requireDayjs_min())})(zhCn,function(g){function w(F){return F&&typeof F=="object"&&"default"in F?F:{default:F}}var I=w(g),P={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(F,$){return $==="W"?F+"周":F+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(F,$){var D=100*F+$;return D<600?"凌晨":D<900?"早上":D<1100?"上午":D<1300?"中午":D<1800?"下午":"晚上"}};return I.default.locale(P,null,!0),P})}(zhCn$1)),zhCn$1.exports}requireZhCn();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}function getAugmentedNamespace(d){if(d.__esModule)return d;var m=d.default;if(typeof m=="function"){var g=function w(){return this instanceof w?Reflect.construct(m,arguments,this.constructor):m.apply(this,arguments)};g.prototype=m.prototype}else g={};return Object.defineProperty(g,"__esModule",{value:!0}),Object.keys(d).forEach(function(w){var I=Object.getOwnPropertyDescriptor(d,w);Object.defineProperty(g,w,I.get?I:{enumerable:!0,get:function(){return d[w]}})}),g}typeof self>"u"&&typeof commonjsGlobal=="object"&&(commonjsGlobal.self=commonjsGlobal);var global$1=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},lookup=[],revLookup=[],Arr=typeof Uint8Array<"u"?Uint8Array:Array,inited=!1;function init(){inited=!0;for(var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m=0;m<64;++m)lookup[m]=d[m],revLookup[d.charCodeAt(m)]=m;revLookup[45]=62,revLookup[95]=63}function toByteArray(d){var m,g,w,I,P,F;inited||init();var $=d.length;if($%4>0)throw new Error("Invalid string. Length must be a multiple of 4");P=d[$-2]==="="?2:d[$-1]==="="?1:0,F=new Arr(3*$/4-P),w=P>0?$-4:$;var D=0;for(m=0,g=0;m<w;m+=4,g+=3)I=revLookup[d.charCodeAt(m)]<<18|revLookup[d.charCodeAt(m+1)]<<12|revLookup[d.charCodeAt(m+2)]<<6|revLookup[d.charCodeAt(m+3)],F[D++]=I>>16&255,F[D++]=I>>8&255,F[D++]=255&I;return P===2?(I=revLookup[d.charCodeAt(m)]<<2|revLookup[d.charCodeAt(m+1)]>>4,F[D++]=255&I):P===1&&(I=revLookup[d.charCodeAt(m)]<<10|revLookup[d.charCodeAt(m+1)]<<4|revLookup[d.charCodeAt(m+2)]>>2,F[D++]=I>>8&255,F[D++]=255&I),F}function tripletToBase64(d){return lookup[d>>18&63]+lookup[d>>12&63]+lookup[d>>6&63]+lookup[63&d]}function encodeChunk(d,m,g){for(var w,I=[],P=m;P<g;P+=3)w=(d[P]<<16)+(d[P+1]<<8)+d[P+2],I.push(tripletToBase64(w));return I.join("")}function fromByteArray(d){var m;inited||init();for(var g=d.length,w=g%3,I="",P=[],F=16383,$=0,D=g-w;$<D;$+=F)P.push(encodeChunk(d,$,$+F>D?D:$+F));return w===1?(m=d[g-1],I+=lookup[m>>2],I+=lookup[m<<4&63],I+="=="):w===2&&(m=(d[g-2]<<8)+d[g-1],I+=lookup[m>>10],I+=lookup[m>>4&63],I+=lookup[m<<2&63],I+="="),P.push(I),P.join("")}function read(d,m,g,w,I){var P,F,$=8*I-w-1,D=(1<<$)-1,U=D>>1,Z=-7,j=g?I-1:0,G=g?-1:1,H=d[m+j];for(j+=G,P=H&(1<<-Z)-1,H>>=-Z,Z+=$;Z>0;P=256*P+d[m+j],j+=G,Z-=8);for(F=P&(1<<-Z)-1,P>>=-Z,Z+=w;Z>0;F=256*F+d[m+j],j+=G,Z-=8);if(P===0)P=1-U;else{if(P===D)return F?NaN:1/0*(H?-1:1);F+=Math.pow(2,w),P-=U}return(H?-1:1)*F*Math.pow(2,P-w)}function write(d,m,g,w,I,P){var F,$,D,U=8*P-I-1,Z=(1<<U)-1,j=Z>>1,G=I===23?Math.pow(2,-24)-Math.pow(2,-77):0,H=w?0:P-1,W=w?1:-1,Q=m<0||m===0&&1/m<0?1:0;for(m=Math.abs(m),isNaN(m)||m===1/0?($=isNaN(m)?1:0,F=Z):(F=Math.floor(Math.log(m)/Math.LN2),m*(D=Math.pow(2,-F))<1&&(F--,D*=2),(m+=F+j>=1?G/D:G*Math.pow(2,1-j))*D>=2&&(F++,D/=2),F+j>=Z?($=0,F=Z):F+j>=1?($=(m*D-1)*Math.pow(2,I),F+=j):($=m*Math.pow(2,j-1)*Math.pow(2,I),F=0));I>=8;d[g+H]=255&$,H+=W,$/=256,I-=8);for(F=F<<I|$,U+=I;U>0;d[g+H]=255&F,H+=W,F/=256,U-=8);d[g+H-W]|=128*Q}var toString={}.toString,isArray=Array.isArray||function(d){return toString.call(d)=="[object Array]"},INSPECT_MAX_BYTES=50;function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(d,m){if(kMaxLength()<m)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(d=new Uint8Array(m)).__proto__=Buffer.prototype:(d===null&&(d=new Buffer(m)),d.length=m),d}function Buffer(d,m,g){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(d,m,g);if(typeof d=="number"){if(typeof m=="string")throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,d)}return from(this,d,m,g)}function from(d,m,g,w){if(typeof m=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&m instanceof ArrayBuffer?fromArrayBuffer(d,m,g,w):typeof m=="string"?fromString(d,m,g):fromObject(d,m)}function assertSize(d){if(typeof d!="number")throw new TypeError('"size" argument must be a number');if(d<0)throw new RangeError('"size" argument must not be negative')}function alloc(d,m,g,w){return assertSize(m),m<=0?createBuffer(d,m):g!==void 0?typeof w=="string"?createBuffer(d,m).fill(g,w):createBuffer(d,m).fill(g):createBuffer(d,m)}function allocUnsafe(d,m){if(assertSize(m),d=createBuffer(d,m<0?0:0|checked(m)),!Buffer.TYPED_ARRAY_SUPPORT)for(var g=0;g<m;++g)d[g]=0;return d}function fromString(d,m,g){if(typeof g=="string"&&g!==""||(g="utf8"),!Buffer.isEncoding(g))throw new TypeError('"encoding" must be a valid string encoding');var w=0|byteLength(m,g),I=(d=createBuffer(d,w)).write(m,g);return I!==w&&(d=d.slice(0,I)),d}function fromArrayLike(d,m){var g=m.length<0?0:0|checked(m.length);d=createBuffer(d,g);for(var w=0;w<g;w+=1)d[w]=255&m[w];return d}function fromArrayBuffer(d,m,g,w){if(m.byteLength,g<0||m.byteLength<g)throw new RangeError("'offset' is out of bounds");if(m.byteLength<g+(w||0))throw new RangeError("'length' is out of bounds");return m=g===void 0&&w===void 0?new Uint8Array(m):w===void 0?new Uint8Array(m,g):new Uint8Array(m,g,w),Buffer.TYPED_ARRAY_SUPPORT?(d=m).__proto__=Buffer.prototype:d=fromArrayLike(d,m),d}function fromObject(d,m){if(internalIsBuffer(m)){var g=0|checked(m.length);return(d=createBuffer(d,g)).length===0||m.copy(d,0,0,g),d}if(m){if(typeof ArrayBuffer<"u"&&m.buffer instanceof ArrayBuffer||"length"in m)return typeof m.length!="number"||isnan(m.length)?createBuffer(d,0):fromArrayLike(d,m);if(m.type==="Buffer"&&isArray(m.data))return fromArrayLike(d,m.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function checked(d){if(d>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|d}function internalIsBuffer(d){return!(d==null||!d._isBuffer)}function byteLength(d,m){if(internalIsBuffer(d))return d.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(d)||d instanceof ArrayBuffer))return d.byteLength;typeof d!="string"&&(d=""+d);var g=d.length;if(g===0)return 0;for(var w=!1;;)switch(m){case"ascii":case"latin1":case"binary":return g;case"utf8":case"utf-8":case void 0:return utf8ToBytes(d).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*g;case"hex":return g>>>1;case"base64":return base64ToBytes(d).length;default:if(w)return utf8ToBytes(d).length;m=(""+m).toLowerCase(),w=!0}}function slowToString(d,m,g){var w=!1;if((m===void 0||m<0)&&(m=0),m>this.length||((g===void 0||g>this.length)&&(g=this.length),g<=0)||(g>>>=0)<=(m>>>=0))return"";for(d||(d="utf8");;)switch(d){case"hex":return hexSlice(this,m,g);case"utf8":case"utf-8":return utf8Slice(this,m,g);case"ascii":return asciiSlice(this,m,g);case"latin1":case"binary":return latin1Slice(this,m,g);case"base64":return base64Slice(this,m,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,m,g);default:if(w)throw new TypeError("Unknown encoding: "+d);d=(d+"").toLowerCase(),w=!0}}function swap(d,m,g){var w=d[m];d[m]=d[g],d[g]=w}function bidirectionalIndexOf(d,m,g,w,I){if(d.length===0)return-1;if(typeof g=="string"?(w=g,g=0):g>2147483647?g=2147483647:g<-2147483648&&(g=-2147483648),g=+g,isNaN(g)&&(g=I?0:d.length-1),g<0&&(g=d.length+g),g>=d.length){if(I)return-1;g=d.length-1}else if(g<0){if(!I)return-1;g=0}if(typeof m=="string"&&(m=Buffer.from(m,w)),internalIsBuffer(m))return m.length===0?-1:arrayIndexOf(d,m,g,w,I);if(typeof m=="number")return m&=255,Buffer.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?I?Uint8Array.prototype.indexOf.call(d,m,g):Uint8Array.prototype.lastIndexOf.call(d,m,g):arrayIndexOf(d,[m],g,w,I);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(d,m,g,w,I){var P,F=1,$=d.length,D=m.length;if(w!==void 0&&((w=String(w).toLowerCase())==="ucs2"||w==="ucs-2"||w==="utf16le"||w==="utf-16le")){if(d.length<2||m.length<2)return-1;F=2,$/=2,D/=2,g/=2}function U(H,W){return F===1?H[W]:H.readUInt16BE(W*F)}if(I){var Z=-1;for(P=g;P<$;P++)if(U(d,P)===U(m,Z===-1?0:P-Z)){if(Z===-1&&(Z=P),P-Z+1===D)return Z*F}else Z!==-1&&(P-=P-Z),Z=-1}else for(g+D>$&&(g=$-D),P=g;P>=0;P--){for(var j=!0,G=0;G<D;G++)if(U(d,P+G)!==U(m,G)){j=!1;break}if(j)return P}return-1}function hexWrite(d,m,g,w){g=Number(g)||0;var I=d.length-g;w?(w=Number(w))>I&&(w=I):w=I;var P=m.length;if(P%2!=0)throw new TypeError("Invalid hex string");w>P/2&&(w=P/2);for(var F=0;F<w;++F){var $=parseInt(m.substr(2*F,2),16);if(isNaN($))return F;d[g+F]=$}return F}function utf8Write(d,m,g,w){return blitBuffer(utf8ToBytes(m,d.length-g),d,g,w)}function asciiWrite(d,m,g,w){return blitBuffer(asciiToBytes(m),d,g,w)}function latin1Write(d,m,g,w){return asciiWrite(d,m,g,w)}function base64Write(d,m,g,w){return blitBuffer(base64ToBytes(m),d,g,w)}function ucs2Write(d,m,g,w){return blitBuffer(utf16leToBytes(m,d.length-g),d,g,w)}function base64Slice(d,m,g){return m===0&&g===d.length?fromByteArray(d):fromByteArray(d.slice(m,g))}function utf8Slice(d,m,g){g=Math.min(d.length,g);for(var w=[],I=m;I<g;){var P,F,$,D,U=d[I],Z=null,j=U>239?4:U>223?3:U>191?2:1;if(I+j<=g)switch(j){case 1:U<128&&(Z=U);break;case 2:(192&(P=d[I+1]))==128&&(D=(31&U)<<6|63&P)>127&&(Z=D);break;case 3:P=d[I+1],F=d[I+2],(192&P)==128&&(192&F)==128&&(D=(15&U)<<12|(63&P)<<6|63&F)>2047&&(D<55296||D>57343)&&(Z=D);break;case 4:P=d[I+1],F=d[I+2],$=d[I+3],(192&P)==128&&(192&F)==128&&(192&$)==128&&(D=(15&U)<<18|(63&P)<<12|(63&F)<<6|63&$)>65535&&D<1114112&&(Z=D)}Z===null?(Z=65533,j=1):Z>65535&&(Z-=65536,w.push(Z>>>10&1023|55296),Z=56320|1023&Z),w.push(Z),I+=j}return decodeCodePointsArray(w)}Buffer.TYPED_ARRAY_SUPPORT=global$1.TYPED_ARRAY_SUPPORT===void 0||global$1.TYPED_ARRAY_SUPPORT,kMaxLength(),Buffer.poolSize=8192,Buffer._augment=function(d){return d.__proto__=Buffer.prototype,d},Buffer.from=function(d,m,g){return from(null,d,m,g)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&Buffer[Symbol.species]),Buffer.alloc=function(d,m,g){return alloc(null,d,m,g)},Buffer.allocUnsafe=function(d){return allocUnsafe(null,d)},Buffer.allocUnsafeSlow=function(d){return allocUnsafe(null,d)},Buffer.isBuffer=isBuffer,Buffer.compare=function(d,m){if(!internalIsBuffer(d)||!internalIsBuffer(m))throw new TypeError("Arguments must be Buffers");if(d===m)return 0;for(var g=d.length,w=m.length,I=0,P=Math.min(g,w);I<P;++I)if(d[I]!==m[I]){g=d[I],w=m[I];break}return g<w?-1:w<g?1:0},Buffer.isEncoding=function(d){switch(String(d).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(d,m){if(!isArray(d))throw new TypeError('"list" argument must be an Array of Buffers');if(d.length===0)return Buffer.alloc(0);var g;if(m===void 0)for(m=0,g=0;g<d.length;++g)m+=d[g].length;var w=Buffer.allocUnsafe(m),I=0;for(g=0;g<d.length;++g){var P=d[g];if(!internalIsBuffer(P))throw new TypeError('"list" argument must be an Array of Buffers');P.copy(w,I),I+=P.length}return w},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var d=this.length;if(d%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var m=0;m<d;m+=2)swap(this,m,m+1);return this},Buffer.prototype.swap32=function(){var d=this.length;if(d%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var m=0;m<d;m+=4)swap(this,m,m+3),swap(this,m+1,m+2);return this},Buffer.prototype.swap64=function(){var d=this.length;if(d%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var m=0;m<d;m+=8)swap(this,m,m+7),swap(this,m+1,m+6),swap(this,m+2,m+5),swap(this,m+3,m+4);return this},Buffer.prototype.toString=function(){var d=0|this.length;return d===0?"":arguments.length===0?utf8Slice(this,0,d):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(d){if(!internalIsBuffer(d))throw new TypeError("Argument must be a Buffer");return this===d||Buffer.compare(this,d)===0},Buffer.prototype.inspect=function(){var d="",m=INSPECT_MAX_BYTES;return this.length>0&&(d=this.toString("hex",0,m).match(/.{2}/g).join(" "),this.length>m&&(d+=" ... ")),"<Buffer "+d+">"},Buffer.prototype.compare=function(d,m,g,w,I){if(!internalIsBuffer(d))throw new TypeError("Argument must be a Buffer");if(m===void 0&&(m=0),g===void 0&&(g=d?d.length:0),w===void 0&&(w=0),I===void 0&&(I=this.length),m<0||g>d.length||w<0||I>this.length)throw new RangeError("out of range index");if(w>=I&&m>=g)return 0;if(w>=I)return-1;if(m>=g)return 1;if(this===d)return 0;for(var P=(I>>>=0)-(w>>>=0),F=(g>>>=0)-(m>>>=0),$=Math.min(P,F),D=this.slice(w,I),U=d.slice(m,g),Z=0;Z<$;++Z)if(D[Z]!==U[Z]){P=D[Z],F=U[Z];break}return P<F?-1:F<P?1:0},Buffer.prototype.includes=function(d,m,g){return this.indexOf(d,m,g)!==-1},Buffer.prototype.indexOf=function(d,m,g){return bidirectionalIndexOf(this,d,m,g,!0)},Buffer.prototype.lastIndexOf=function(d,m,g){return bidirectionalIndexOf(this,d,m,g,!1)},Buffer.prototype.write=function(d,m,g,w){if(m===void 0)w="utf8",g=this.length,m=0;else if(g===void 0&&typeof m=="string")w=m,g=this.length,m=0;else{if(!isFinite(m))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");m|=0,isFinite(g)?(g|=0,w===void 0&&(w="utf8")):(w=g,g=void 0)}var I=this.length-m;if((g===void 0||g>I)&&(g=I),d.length>0&&(g<0||m<0)||m>this.length)throw new RangeError("Attempt to write outside buffer bounds");w||(w="utf8");for(var P=!1;;)switch(w){case"hex":return hexWrite(this,d,m,g);case"utf8":case"utf-8":return utf8Write(this,d,m,g);case"ascii":return asciiWrite(this,d,m,g);case"latin1":case"binary":return latin1Write(this,d,m,g);case"base64":return base64Write(this,d,m,g);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,d,m,g);default:if(P)throw new TypeError("Unknown encoding: "+w);w=(""+w).toLowerCase(),P=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(d){var m=d.length;if(m<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,d);for(var g="",w=0;w<m;)g+=String.fromCharCode.apply(String,d.slice(w,w+=MAX_ARGUMENTS_LENGTH));return g}function asciiSlice(d,m,g){var w="";g=Math.min(d.length,g);for(var I=m;I<g;++I)w+=String.fromCharCode(127&d[I]);return w}function latin1Slice(d,m,g){var w="";g=Math.min(d.length,g);for(var I=m;I<g;++I)w+=String.fromCharCode(d[I]);return w}function hexSlice(d,m,g){var w=d.length;(!m||m<0)&&(m=0),(!g||g<0||g>w)&&(g=w);for(var I="",P=m;P<g;++P)I+=toHex(d[P]);return I}function utf16leSlice(d,m,g){for(var w=d.slice(m,g),I="",P=0;P<w.length;P+=2)I+=String.fromCharCode(w[P]+256*w[P+1]);return I}function checkOffset(d,m,g){if(d%1!=0||d<0)throw new RangeError("offset is not uint");if(d+m>g)throw new RangeError("Trying to access beyond buffer length")}function checkInt(d,m,g,w,I,P){if(!internalIsBuffer(d))throw new TypeError('"buffer" argument must be a Buffer instance');if(m>I||m<P)throw new RangeError('"value" argument is out of bounds');if(g+w>d.length)throw new RangeError("Index out of range")}function objectWriteUInt16(d,m,g,w){m<0&&(m=65535+m+1);for(var I=0,P=Math.min(d.length-g,2);I<P;++I)d[g+I]=(m&255<<8*(w?I:1-I))>>>8*(w?I:1-I)}function objectWriteUInt32(d,m,g,w){m<0&&(m=4294967295+m+1);for(var I=0,P=Math.min(d.length-g,4);I<P;++I)d[g+I]=m>>>8*(w?I:3-I)&255}function checkIEEE754(d,m,g,w,I,P){if(g+w>d.length)throw new RangeError("Index out of range");if(g<0)throw new RangeError("Index out of range")}function writeFloat(d,m,g,w,I){return I||checkIEEE754(d,m,g,4),write(d,m,g,w,23,4),g+4}function writeDouble(d,m,g,w,I){return I||checkIEEE754(d,m,g,8),write(d,m,g,w,52,8),g+8}Buffer.prototype.slice=function(d,m){var g,w=this.length;if((d=~~d)<0?(d+=w)<0&&(d=0):d>w&&(d=w),(m=m===void 0?w:~~m)<0?(m+=w)<0&&(m=0):m>w&&(m=w),m<d&&(m=d),Buffer.TYPED_ARRAY_SUPPORT)(g=this.subarray(d,m)).__proto__=Buffer.prototype;else{var I=m-d;g=new Buffer(I,void 0);for(var P=0;P<I;++P)g[P]=this[P+d]}return g},Buffer.prototype.readUIntLE=function(d,m,g){d|=0,m|=0,g||checkOffset(d,m,this.length);for(var w=this[d],I=1,P=0;++P<m&&(I*=256);)w+=this[d+P]*I;return w},Buffer.prototype.readUIntBE=function(d,m,g){d|=0,m|=0,g||checkOffset(d,m,this.length);for(var w=this[d+--m],I=1;m>0&&(I*=256);)w+=this[d+--m]*I;return w},Buffer.prototype.readUInt8=function(d,m){return m||checkOffset(d,1,this.length),this[d]},Buffer.prototype.readUInt16LE=function(d,m){return m||checkOffset(d,2,this.length),this[d]|this[d+1]<<8},Buffer.prototype.readUInt16BE=function(d,m){return m||checkOffset(d,2,this.length),this[d]<<8|this[d+1]},Buffer.prototype.readUInt32LE=function(d,m){return m||checkOffset(d,4,this.length),(this[d]|this[d+1]<<8|this[d+2]<<16)+16777216*this[d+3]},Buffer.prototype.readUInt32BE=function(d,m){return m||checkOffset(d,4,this.length),16777216*this[d]+(this[d+1]<<16|this[d+2]<<8|this[d+3])},Buffer.prototype.readIntLE=function(d,m,g){d|=0,m|=0,g||checkOffset(d,m,this.length);for(var w=this[d],I=1,P=0;++P<m&&(I*=256);)w+=this[d+P]*I;return w>=(I*=128)&&(w-=Math.pow(2,8*m)),w},Buffer.prototype.readIntBE=function(d,m,g){d|=0,m|=0,g||checkOffset(d,m,this.length);for(var w=m,I=1,P=this[d+--w];w>0&&(I*=256);)P+=this[d+--w]*I;return P>=(I*=128)&&(P-=Math.pow(2,8*m)),P},Buffer.prototype.readInt8=function(d,m){return m||checkOffset(d,1,this.length),128&this[d]?-1*(255-this[d]+1):this[d]},Buffer.prototype.readInt16LE=function(d,m){m||checkOffset(d,2,this.length);var g=this[d]|this[d+1]<<8;return 32768&g?4294901760|g:g},Buffer.prototype.readInt16BE=function(d,m){m||checkOffset(d,2,this.length);var g=this[d+1]|this[d]<<8;return 32768&g?4294901760|g:g},Buffer.prototype.readInt32LE=function(d,m){return m||checkOffset(d,4,this.length),this[d]|this[d+1]<<8|this[d+2]<<16|this[d+3]<<24},Buffer.prototype.readInt32BE=function(d,m){return m||checkOffset(d,4,this.length),this[d]<<24|this[d+1]<<16|this[d+2]<<8|this[d+3]},Buffer.prototype.readFloatLE=function(d,m){return m||checkOffset(d,4,this.length),read(this,d,!0,23,4)},Buffer.prototype.readFloatBE=function(d,m){return m||checkOffset(d,4,this.length),read(this,d,!1,23,4)},Buffer.prototype.readDoubleLE=function(d,m){return m||checkOffset(d,8,this.length),read(this,d,!0,52,8)},Buffer.prototype.readDoubleBE=function(d,m){return m||checkOffset(d,8,this.length),read(this,d,!1,52,8)},Buffer.prototype.writeUIntLE=function(d,m,g,w){d=+d,m|=0,g|=0,w||checkInt(this,d,m,g,Math.pow(2,8*g)-1,0);var I=1,P=0;for(this[m]=255&d;++P<g&&(I*=256);)this[m+P]=d/I&255;return m+g},Buffer.prototype.writeUIntBE=function(d,m,g,w){d=+d,m|=0,g|=0,w||checkInt(this,d,m,g,Math.pow(2,8*g)-1,0);var I=g-1,P=1;for(this[m+I]=255&d;--I>=0&&(P*=256);)this[m+I]=d/P&255;return m+g},Buffer.prototype.writeUInt8=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(d=Math.floor(d)),this[m]=255&d,m+1},Buffer.prototype.writeUInt16LE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[m]=255&d,this[m+1]=d>>>8):objectWriteUInt16(this,d,m,!0),m+2},Buffer.prototype.writeUInt16BE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[m]=d>>>8,this[m+1]=255&d):objectWriteUInt16(this,d,m,!1),m+2},Buffer.prototype.writeUInt32LE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[m+3]=d>>>24,this[m+2]=d>>>16,this[m+1]=d>>>8,this[m]=255&d):objectWriteUInt32(this,d,m,!0),m+4},Buffer.prototype.writeUInt32BE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[m]=d>>>24,this[m+1]=d>>>16,this[m+2]=d>>>8,this[m+3]=255&d):objectWriteUInt32(this,d,m,!1),m+4},Buffer.prototype.writeIntLE=function(d,m,g,w){if(d=+d,m|=0,!w){var I=Math.pow(2,8*g-1);checkInt(this,d,m,g,I-1,-I)}var P=0,F=1,$=0;for(this[m]=255&d;++P<g&&(F*=256);)d<0&&$===0&&this[m+P-1]!==0&&($=1),this[m+P]=(d/F|0)-$&255;return m+g},Buffer.prototype.writeIntBE=function(d,m,g,w){if(d=+d,m|=0,!w){var I=Math.pow(2,8*g-1);checkInt(this,d,m,g,I-1,-I)}var P=g-1,F=1,$=0;for(this[m+P]=255&d;--P>=0&&(F*=256);)d<0&&$===0&&this[m+P+1]!==0&&($=1),this[m+P]=(d/F|0)-$&255;return m+g},Buffer.prototype.writeInt8=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(d=Math.floor(d)),d<0&&(d=255+d+1),this[m]=255&d,m+1},Buffer.prototype.writeInt16LE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[m]=255&d,this[m+1]=d>>>8):objectWriteUInt16(this,d,m,!0),m+2},Buffer.prototype.writeInt16BE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[m]=d>>>8,this[m+1]=255&d):objectWriteUInt16(this,d,m,!1),m+2},Buffer.prototype.writeInt32LE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[m]=255&d,this[m+1]=d>>>8,this[m+2]=d>>>16,this[m+3]=d>>>24):objectWriteUInt32(this,d,m,!0),m+4},Buffer.prototype.writeInt32BE=function(d,m,g){return d=+d,m|=0,g||checkInt(this,d,m,4,2147483647,-2147483648),d<0&&(d=4294967295+d+1),Buffer.TYPED_ARRAY_SUPPORT?(this[m]=d>>>24,this[m+1]=d>>>16,this[m+2]=d>>>8,this[m+3]=255&d):objectWriteUInt32(this,d,m,!1),m+4},Buffer.prototype.writeFloatLE=function(d,m,g){return writeFloat(this,d,m,!0,g)},Buffer.prototype.writeFloatBE=function(d,m,g){return writeFloat(this,d,m,!1,g)},Buffer.prototype.writeDoubleLE=function(d,m,g){return writeDouble(this,d,m,!0,g)},Buffer.prototype.writeDoubleBE=function(d,m,g){return writeDouble(this,d,m,!1,g)},Buffer.prototype.copy=function(d,m,g,w){if(g||(g=0),w||w===0||(w=this.length),m>=d.length&&(m=d.length),m||(m=0),w>0&&w<g&&(w=g),w===g||d.length===0||this.length===0)return 0;if(m<0)throw new RangeError("targetStart out of bounds");if(g<0||g>=this.length)throw new RangeError("sourceStart out of bounds");if(w<0)throw new RangeError("sourceEnd out of bounds");w>this.length&&(w=this.length),d.length-m<w-g&&(w=d.length-m+g);var I,P=w-g;if(this===d&&g<m&&m<w)for(I=P-1;I>=0;--I)d[I+m]=this[I+g];else if(P<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(I=0;I<P;++I)d[I+m]=this[I+g];else Uint8Array.prototype.set.call(d,this.subarray(g,g+P),m);return P},Buffer.prototype.fill=function(d,m,g,w){if(typeof d=="string"){if(typeof m=="string"?(w=m,m=0,g=this.length):typeof g=="string"&&(w=g,g=this.length),d.length===1){var I=d.charCodeAt(0);I<256&&(d=I)}if(w!==void 0&&typeof w!="string")throw new TypeError("encoding must be a string");if(typeof w=="string"&&!Buffer.isEncoding(w))throw new TypeError("Unknown encoding: "+w)}else typeof d=="number"&&(d&=255);if(m<0||this.length<m||this.length<g)throw new RangeError("Out of range index");if(g<=m)return this;var P;if(m>>>=0,g=g===void 0?this.length:g>>>0,d||(d=0),typeof d=="number")for(P=m;P<g;++P)this[P]=d;else{var F=internalIsBuffer(d)?d:utf8ToBytes(new Buffer(d,w).toString()),$=F.length;for(P=0;P<g-m;++P)this[P+m]=F[P%$]}return this};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g,HeaderTypes;function base64clean(d){if((d=stringtrim(d).replace(INVALID_BASE64_RE,"")).length<2)return"";for(;d.length%4!=0;)d+="=";return d}function stringtrim(d){return d.trim?d.trim():d.replace(/^\s+|\s+$/g,"")}function toHex(d){return d<16?"0"+d.toString(16):d.toString(16)}function utf8ToBytes(d,m){var g;m=m||1/0;for(var w=d.length,I=null,P=[],F=0;F<w;++F){if((g=d.charCodeAt(F))>55295&&g<57344){if(!I){if(g>56319){(m-=3)>-1&&P.push(239,191,189);continue}if(F+1===w){(m-=3)>-1&&P.push(239,191,189);continue}I=g;continue}if(g<56320){(m-=3)>-1&&P.push(239,191,189),I=g;continue}g=65536+(I-55296<<10|g-56320)}else I&&(m-=3)>-1&&P.push(239,191,189);if(I=null,g<128){if((m-=1)<0)break;P.push(g)}else if(g<2048){if((m-=2)<0)break;P.push(g>>6|192,63&g|128)}else if(g<65536){if((m-=3)<0)break;P.push(g>>12|224,g>>6&63|128,63&g|128)}else{if(!(g<1114112))throw new Error("Invalid code point");if((m-=4)<0)break;P.push(g>>18|240,g>>12&63|128,g>>6&63|128,63&g|128)}}return P}function asciiToBytes(d){for(var m=[],g=0;g<d.length;++g)m.push(255&d.charCodeAt(g));return m}function utf16leToBytes(d,m){for(var g,w,I,P=[],F=0;F<d.length&&!((m-=2)<0);++F)w=(g=d.charCodeAt(F))>>8,I=g%256,P.push(I),P.push(w);return P}function base64ToBytes(d){return toByteArray(base64clean(d))}function blitBuffer(d,m,g,w){for(var I=0;I<w&&!(I+g>=m.length||I>=d.length);++I)m[I+g]=d[I];return I}function isnan(d){return d!=d}function isBuffer(d){return d!=null&&(!!d._isBuffer||isFastBuffer(d)||isSlowBuffer(d))}function isFastBuffer(d){return!!d.constructor&&typeof d.constructor.isBuffer=="function"&&d.constructor.isBuffer(d)}function isSlowBuffer(d){return typeof d.readFloatLE=="function"&&typeof d.slice=="function"&&isFastBuffer(d.slice(0,0))}(function(d){d[d.BITMAP_INFO_HEADER=40]="BITMAP_INFO_HEADER",d[d.BITMAP_V2_INFO_HEADER=52]="BITMAP_V2_INFO_HEADER",d[d.BITMAP_V3_INFO_HEADER=56]="BITMAP_V3_INFO_HEADER",d[d.BITMAP_V4_HEADER=108]="BITMAP_V4_HEADER",d[d.BITMAP_V5_HEADER=124]="BITMAP_V5_HEADER"})(HeaderTypes||(HeaderTypes={}));var HeaderTypes$1=HeaderTypes,BmpCompression;function maskColor(d,m,g,w){const I=1+~d&d,P=1+~m&m,F=1+~g&g,$=1+~w&w,D=d/I+1,U=m/P+1,Z=g/F+1,j=w/$+1;return{shiftRed:G=>(G&d)/I*256/D,shiftGreen:G=>(G&m)/P*256/U,shiftBlue:G=>(G&g)/F*256/Z,shiftAlpha:w!==0?G=>(G&w)/$*256/j:()=>255}}(function(d){d[d.NONE=0]="NONE",d[d.BI_RLE8=1]="BI_RLE8",d[d.BI_RLE4=2]="BI_RLE4",d[d.BI_BIT_FIELDS=3]="BI_BIT_FIELDS",d[d.BI_ALPHA_BIT_FIELDS=6]="BI_ALPHA_BIT_FIELDS"})(BmpCompression||(BmpCompression={}));class BmpDecoder{constructor(m,{toRGBA:g}={toRGBA:!1}){he(this,"flag");he(this,"fileSize");he(this,"reserved1");he(this,"reserved2");he(this,"offset");he(this,"headerSize");he(this,"width");he(this,"height");he(this,"planes");he(this,"bitPP");he(this,"compression");he(this,"rawSize");he(this,"hr");he(this,"vr");he(this,"colors");he(this,"importantColors");he(this,"palette");he(this,"data");he(this,"maskRed");he(this,"maskGreen");he(this,"maskBlue");he(this,"maskAlpha");he(this,"toRGBA");he(this,"pos");he(this,"bottomUp");he(this,"buffer");he(this,"locRed");he(this,"locGreen");he(this,"locBlue");he(this,"locAlpha");he(this,"shiftRed");he(this,"shiftGreen");he(this,"shiftBlue");he(this,"shiftAlpha");if(this.buffer=m,this.toRGBA=!!g,this.pos=0,this.bottomUp=!0,this.flag=this.buffer.toString("utf-8",0,this.pos+=2),this.flag!=="BM")throw new Error("Invalid BMP File");this.locRed=this.toRGBA?0:3,this.locGreen=this.toRGBA?1:2,this.locBlue=this.toRGBA?2:1,this.locAlpha=this.toRGBA?3:0,this.parseHeader(),this.parseRGBA()}parseHeader(){if(this.fileSize=this.readUInt32LE(),this.reserved1=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.reserved2=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.offset=this.readUInt32LE(),this.headerSize=this.readUInt32LE(),!(this.headerSize in HeaderTypes$1))throw new Error(`Unsupported BMP header size ${this.headerSize}`);if(this.width=this.readUInt32LE(),this.height=this.readUInt32LE(),this.height=this.height>2147483647?this.height-4294967296:this.height,this.planes=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.bitPP=this.buffer.readUInt16LE(this.pos),this.pos+=2,this.compression=this.readUInt32LE(),this.rawSize=this.readUInt32LE(),this.hr=this.readUInt32LE(),this.vr=this.readUInt32LE(),this.colors=this.readUInt32LE(),this.importantColors=this.readUInt32LE(),this.bitPP===32?(this.maskAlpha=0,this.maskRed=16711680,this.maskGreen=65280,this.maskBlue=255):this.bitPP===16&&(this.maskAlpha=0,this.maskRed=31744,this.maskGreen=992,this.maskBlue=31),(this.headerSize>HeaderTypes$1.BITMAP_INFO_HEADER||this.compression===BmpCompression.BI_BIT_FIELDS||this.compression===BmpCompression.BI_ALPHA_BIT_FIELDS)&&(this.maskRed=this.readUInt32LE(),this.maskGreen=this.readUInt32LE(),this.maskBlue=this.readUInt32LE()),(this.headerSize>HeaderTypes$1.BITMAP_V2_INFO_HEADER||this.compression===BmpCompression.BI_ALPHA_BIT_FIELDS)&&(this.maskAlpha=this.readUInt32LE()),this.headerSize>HeaderTypes$1.BITMAP_V3_INFO_HEADER&&(this.pos+=HeaderTypes$1.BITMAP_V4_HEADER-HeaderTypes$1.BITMAP_V3_INFO_HEADER),this.headerSize>HeaderTypes$1.BITMAP_V4_HEADER&&(this.pos+=HeaderTypes$1.BITMAP_V5_HEADER-HeaderTypes$1.BITMAP_V4_HEADER),this.bitPP<=8||this.colors>0){const g=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(g);for(let w=0;w<g;w++){const I=this.buffer.readUInt8(this.pos++),P=this.buffer.readUInt8(this.pos++),F=this.buffer.readUInt8(this.pos++),$=this.buffer.readUInt8(this.pos++);this.palette[w]={red:F,green:P,blue:I,quad:$}}}this.height<0&&(this.height*=-1,this.bottomUp=!1);const m=maskColor(this.maskRed,this.maskGreen,this.maskBlue,this.maskAlpha);this.shiftRed=m.shiftRed,this.shiftGreen=m.shiftGreen,this.shiftBlue=m.shiftBlue,this.shiftAlpha=m.shiftAlpha}parseRGBA(){switch(this.data=Buffer.alloc(this.width*this.height*4),this.bitPP){case 1:this.bit1();break;case 4:this.bit4();break;case 8:this.bit8();break;case 16:this.bit16();break;case 24:this.bit24();break;default:this.bit32()}}bit1(){const m=Math.ceil(this.width/8),g=m%4,w=g!==0?4-g:0;this.scanImage(w,m,(I,P)=>{const F=this.buffer.readUInt8(this.pos++),$=P*this.width*4+8*I*4;for(let D=0;D<8&&8*I+D<this.width;D++){const U=this.palette[F>>7-D&1];this.data[$+D*this.locAlpha]=0,this.data[$+4*D+this.locBlue]=U.blue,this.data[$+4*D+this.locGreen]=U.green,this.data[$+4*D+this.locRed]=U.red}})}bit4(){if(this.compression===BmpCompression.BI_RLE4){this.data.fill(0);let m=!1,g=this.bottomUp?this.height-1:0,w=0;for(;w<this.data.length;){const I=this.buffer.readUInt8(this.pos++),P=this.buffer.readUInt8(this.pos++);if(I===0){if(P===0){g+=this.bottomUp?-1:1,w=g*this.width*4,m=!1;continue}if(P===1)break;if(P===2){const F=this.buffer.readUInt8(this.pos++),$=this.buffer.readUInt8(this.pos++);g+=this.bottomUp?-$:$,w+=$*this.width*4+4*F}else{let F=this.buffer.readUInt8(this.pos++);for(let $=0;$<P;$++)w=this.setPixelData(w,m?15&F:(240&F)>>4),1&$&&$+1<P&&(F=this.buffer.readUInt8(this.pos++)),m=!m;(P+1>>1&1)==1&&this.pos++}}else for(let F=0;F<I;F++)w=this.setPixelData(w,m?15&P:(240&P)>>4),m=!m}}else{const m=Math.ceil(this.width/2),g=m%4,w=g!==0?4-g:0;this.scanImage(w,m,(I,P)=>{const F=this.buffer.readUInt8(this.pos++),$=P*this.width*4+2*I*4,D=F>>4;let U=this.palette[D];if(this.data[$]=0,this.data[$+1]=U.blue,this.data[$+2]=U.green,this.data[$+3]=U.red,2*I+1>=this.width)return!1;const Z=15&F;U=this.palette[Z],this.data[$+4]=0,this.data[$+4+1]=U.blue,this.data[$+4+2]=U.green,this.data[$+4+3]=U.red})}}bit8(){if(this.compression===BmpCompression.BI_RLE8){this.data.fill(0);let m=this.bottomUp?this.height-1:0,g=0;for(;g<this.data.length;){const w=this.buffer.readUInt8(this.pos++),I=this.buffer.readUInt8(this.pos++);if(w===0){if(I===0){m+=this.bottomUp?-1:1,g=m*this.width*4;continue}if(I===1)break;if(I===2){const P=this.buffer.readUInt8(this.pos++),F=this.buffer.readUInt8(this.pos++);m+=this.bottomUp?-F:F,g+=F*this.width*4+4*P}else{for(let P=0;P<I;P++){const F=this.buffer.readUInt8(this.pos++);g=this.setPixelData(g,F)}!0&I&&this.pos++}}else for(let P=0;P<w;P++)g=this.setPixelData(g,I)}}else{const m=this.width%4,g=m!==0?4-m:0;this.scanImage(g,this.width,(w,I)=>{const P=this.buffer.readUInt8(this.pos++),F=I*this.width*4+4*w;if(P<this.palette.length){const $=this.palette[P];this.data[F]=0,this.data[F+1]=$.blue,this.data[F+2]=$.green,this.data[F+3]=$.red}else this.data[F]=0,this.data[F+1]=255,this.data[F+2]=255,this.data[F+3]=255})}}bit16(){const m=this.width%2*2;this.scanImage(m,this.width,(g,w)=>{const I=w*this.width*4+4*g,P=this.buffer.readUInt16LE(this.pos);this.pos+=2,this.data[I+this.locRed]=this.shiftRed(P),this.data[I+this.locGreen]=this.shiftGreen(P),this.data[I+this.locBlue]=this.shiftBlue(P),this.data[I+this.locAlpha]=this.shiftAlpha(P)})}bit24(){const m=this.width%4;this.scanImage(m,this.width,(g,w)=>{const I=w*this.width*4+4*g,P=this.buffer.readUInt8(this.pos++),F=this.buffer.readUInt8(this.pos++),$=this.buffer.readUInt8(this.pos++);this.data[I+this.locRed]=$,this.data[I+this.locGreen]=F,this.data[I+this.locBlue]=P,this.data[I+this.locAlpha]=0})}bit32(){this.scanImage(0,this.width,(m,g)=>{const w=g*this.width*4+4*m,I=this.readUInt32LE();this.data[w+this.locRed]=this.shiftRed(I),this.data[w+this.locGreen]=this.shiftGreen(I),this.data[w+this.locBlue]=this.shiftBlue(I),this.data[w+this.locAlpha]=this.shiftAlpha(I)})}scanImage(m=0,g=this.width,w){for(let I=this.height-1;I>=0;I--){const P=this.bottomUp?I:this.height-1-I;for(let F=0;F<g;F++)if(w.call(this,F,P)===!1)return;this.pos+=m}}readUInt32LE(){const m=this.buffer.readUInt32LE(this.pos);return this.pos+=4,m}setPixelData(m,g){const{blue:w,green:I,red:P}=this.palette[g];return this.data[m+this.locAlpha]=0,this.data[m+1+this.locBlue]=w,this.data[m+2+this.locGreen]=I,this.data[m+3+this.locRed]=P,m+4}}function createInteger(d){return d.reduce((m,g)=>m<<1|g,0)}function createColor(d){return d.quad<<24|d.red<<16|d.green<<8|d.blue}class BmpEncoder{constructor(m){he(this,"fileSize");he(this,"reserved1");he(this,"reserved2");he(this,"offset");he(this,"width");he(this,"flag");he(this,"height");he(this,"planes");he(this,"bitPP");he(this,"compress");he(this,"hr");he(this,"vr");he(this,"colors");he(this,"importantColors");he(this,"rawSize");he(this,"headerSize");he(this,"data");he(this,"palette");he(this,"extraBytes");he(this,"buffer");he(this,"bytesInColor");he(this,"pos");switch(this.buffer=m.data,this.width=m.width,this.height=m.height,this.headerSize=HeaderTypes$1.BITMAP_INFO_HEADER,this.flag="BM",this.bitPP=m.bitPP||24,this.offset=54,this.reserved1=m.reserved1||0,this.reserved2=m.reserved2||0,this.planes=1,this.compress=0,this.hr=m.hr||0,this.vr=m.vr||0,this.importantColors=m.importantColors||0,this.colors=Math.min(2**(this.bitPP-1||1),m.colors||1/0),this.palette=m.palette||[],this.colors&&this.bitPP<16?this.offset+=4*this.colors:this.colors=0,this.bitPP){case 32:this.bytesInColor=4;break;case 16:this.bytesInColor=2;break;case 8:this.bytesInColor=1;break;case 4:this.bytesInColor=.5;break;case 1:this.bytesInColor=1/8;break;default:this.bytesInColor=3,this.bitPP=24}const g=this.width*this.bitPP/32,w=Math.ceil(g);this.extraBytes=4*(w-g),this.rawSize=this.height*w*4+2,this.fileSize=this.rawSize+this.offset,this.data=Buffer.alloc(this.fileSize,1),this.pos=0,this.encode()}encode(){switch(this.pos=0,this.writeHeader(),this.bitPP){case 32:this.bit32();break;case 16:this.bit16();break;case 8:this.bit8();break;case 4:this.bit4();break;case 1:this.bit1();break;default:this.bit24()}}writeHeader(){this.data.write(this.flag,this.pos,2),this.pos+=2,this.writeUInt32LE(this.fileSize),this.writeUInt32LE(this.reserved1<<16|this.reserved2),this.writeUInt32LE(this.offset),this.writeUInt32LE(this.headerSize),this.writeUInt32LE(this.width),this.writeUInt32LE(this.height),this.data.writeUInt16LE(this.planes,this.pos),this.pos+=2,this.data.writeUInt16LE(this.bitPP,this.pos),this.pos+=2,this.writeUInt32LE(this.compress),this.writeUInt32LE(this.rawSize),this.writeUInt32LE(this.hr),this.writeUInt32LE(this.vr),this.writeUInt32LE(this.colors),this.writeUInt32LE(this.importantColors)}bit1(){this.palette.length&&this.colors===2?this.initColors(1):(this.writeUInt32LE(16777215),this.writeUInt32LE(0)),this.pos+=1;let m=[];this.writeImage((g,w,I)=>{let P=w;P++;const F=this.buffer[P++],$=this.buffer[P++],D=.2126*this.buffer[P++]+.7152*$+.0722*F;return m.push(D>127?0:1),(I+1)%8==0?(this.data[g-1]=createInteger(m),m=[]):I===this.width-1&&m.length>0&&(this.data[g-1]=createInteger(m)<<4,m=[]),P})}bit4(){const m=this.initColors(4);let g=[];this.writeImage((w,I,P)=>{let F=I;const $=createColor({quad:this.buffer[F++],blue:this.buffer[F++],green:this.buffer[F++],red:this.buffer[F++]}),D=m.findIndex(U=>U===$);return D!==-1?g.push(D):g.push(0),(P+1)%2==0&&(this.data[w]=g[0]<<4|g[1],g=[]),F})}bit8(){const m=this.initColors(8);this.writeImage((g,w)=>{let I=w;const P=createColor({quad:this.buffer[I++],blue:this.buffer[I++],green:this.buffer[I++],red:this.buffer[I++]}),F=m.findIndex($=>$===P);return this.data[g]=F!==-1?F:0,I})}bit16(){this.writeImage((m,g)=>{let w=g+1;const I=this.buffer[w++]/8,P=this.buffer[w++]/8,F=this.buffer[w++]/8<<10|P<<5|I;return this.data[m]=255&F,this.data[m+1]=(65280&F)>>8,w})}bit24(){this.writeImage((m,g)=>{let w=g+1;return this.data[m]=this.buffer[w++],this.data[m+1]=this.buffer[w++],this.data[m+2]=this.buffer[w++],w})}bit32(){this.writeImage((m,g)=>{let w=g;return this.data[m+3]=this.buffer[w++],this.data[m]=this.buffer[w++],this.data[m+1]=this.buffer[w++],this.data[m+2]=this.buffer[w++],w})}writeImage(m){const g=this.extraBytes+this.width*this.bytesInColor;let w=0;for(let I=0;I<this.height;I++)for(let P=0;P<this.width;P++){const F=Math.floor(this.pos+(this.height-1-I)*g+P*this.bytesInColor);w=m.call(this,F,w,P,I)}}initColors(m){const g=[];if(!this.palette.length)throw new Error(`To encode ${m}-bit BMPs a pallette is needed. Please choose up to ${this.colors} colors. Colors must be 32-bit integers.`);for(let w=0;w<this.colors;w++){const I=createColor(this.palette[w]);this.writeUInt32LE(I),g.push(I)}return g}writeUInt32LE(m){this.data.writeUInt32LE(m,this.pos),this.pos+=4}}function decode$2(d,m){return new BmpDecoder(d,m)}function encode$2(d){return new BmpEncoder(d)}function _typeof(d){return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},_typeof(d)}var trimLeft=/^\s+/,trimRight=/\s+$/;function tinycolor(d,m){if(m=m||{},(d=d||"")instanceof tinycolor)return d;if(!(this instanceof tinycolor))return new tinycolor(d,m);var g=inputToRGB(d);this._originalInput=d,this._r=g.r,this._g=g.g,this._b=g.b,this._a=g.a,this._roundA=Math.round(100*this._a)/100,this._format=m.format||g.format,this._gradientType=m.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=g.ok}function inputToRGB(d){var m={r:0,g:0,b:0},g=1,w=null,I=null,P=null,F=!1,$=!1;return typeof d=="string"&&(d=stringInputToObject(d)),_typeof(d)=="object"&&(isValidCSSUnit(d.r)&&isValidCSSUnit(d.g)&&isValidCSSUnit(d.b)?(m=rgbToRgb(d.r,d.g,d.b),F=!0,$=String(d.r).substr(-1)==="%"?"prgb":"rgb"):isValidCSSUnit(d.h)&&isValidCSSUnit(d.s)&&isValidCSSUnit(d.v)?(w=convertToPercentage(d.s),I=convertToPercentage(d.v),m=hsvToRgb(d.h,w,I),F=!0,$="hsv"):isValidCSSUnit(d.h)&&isValidCSSUnit(d.s)&&isValidCSSUnit(d.l)&&(w=convertToPercentage(d.s),P=convertToPercentage(d.l),m=hslToRgb(d.h,w,P),F=!0,$="hsl"),d.hasOwnProperty("a")&&(g=d.a)),g=boundAlpha(g),{ok:F,format:d.format||$,r:Math.min(255,Math.max(m.r,0)),g:Math.min(255,Math.max(m.g,0)),b:Math.min(255,Math.max(m.b,0)),a:g}}function rgbToRgb(d,m,g){return{r:255*bound01(d,255),g:255*bound01(m,255),b:255*bound01(g,255)}}function rgbToHsl(d,m,g){d=bound01(d,255),m=bound01(m,255),g=bound01(g,255);var w,I,P=Math.max(d,m,g),F=Math.min(d,m,g),$=(P+F)/2;if(P==F)w=I=0;else{var D=P-F;switch(I=$>.5?D/(2-P-F):D/(P+F),P){case d:w=(m-g)/D+(m<g?6:0);break;case m:w=(g-d)/D+2;break;case g:w=(d-m)/D+4}w/=6}return{h:w,s:I,l:$}}function hslToRgb(d,m,g){var w,I,P;function F(U,Z,j){return j<0&&(j+=1),j>1&&(j-=1),j<1/6?U+6*(Z-U)*j:j<.5?Z:j<2/3?U+(Z-U)*(2/3-j)*6:U}if(d=bound01(d,360),m=bound01(m,100),g=bound01(g,100),m===0)w=I=P=g;else{var $=g<.5?g*(1+m):g+m-g*m,D=2*g-$;w=F(D,$,d+1/3),I=F(D,$,d),P=F(D,$,d-1/3)}return{r:255*w,g:255*I,b:255*P}}function rgbToHsv(d,m,g){d=bound01(d,255),m=bound01(m,255),g=bound01(g,255);var w,I,P=Math.max(d,m,g),F=Math.min(d,m,g),$=P,D=P-F;if(I=P===0?0:D/P,P==F)w=0;else{switch(P){case d:w=(m-g)/D+(m<g?6:0);break;case m:w=(g-d)/D+2;break;case g:w=(d-m)/D+4}w/=6}return{h:w,s:I,v:$}}function hsvToRgb(d,m,g){d=6*bound01(d,360),m=bound01(m,100),g=bound01(g,100);var w=Math.floor(d),I=d-w,P=g*(1-m),F=g*(1-I*m),$=g*(1-(1-I)*m),D=w%6;return{r:255*[g,F,P,P,$,g][D],g:255*[$,g,g,F,P,P][D],b:255*[P,P,$,g,g,F][D]}}function rgbToHex(d,m,g,w){var I=[pad2(Math.round(d).toString(16)),pad2(Math.round(m).toString(16)),pad2(Math.round(g).toString(16))];return w&&I[0].charAt(0)==I[0].charAt(1)&&I[1].charAt(0)==I[1].charAt(1)&&I[2].charAt(0)==I[2].charAt(1)?I[0].charAt(0)+I[1].charAt(0)+I[2].charAt(0):I.join("")}function rgbaToHex(d,m,g,w,I){var P=[pad2(Math.round(d).toString(16)),pad2(Math.round(m).toString(16)),pad2(Math.round(g).toString(16)),pad2(convertDecimalToHex(w))];return I&&P[0].charAt(0)==P[0].charAt(1)&&P[1].charAt(0)==P[1].charAt(1)&&P[2].charAt(0)==P[2].charAt(1)&&P[3].charAt(0)==P[3].charAt(1)?P[0].charAt(0)+P[1].charAt(0)+P[2].charAt(0)+P[3].charAt(0):P.join("")}function rgbaToArgbHex(d,m,g,w){return[pad2(convertDecimalToHex(w)),pad2(Math.round(d).toString(16)),pad2(Math.round(m).toString(16)),pad2(Math.round(g).toString(16))].join("")}function _desaturate(d,m){m=m===0?0:m||10;var g=tinycolor(d).toHsl();return g.s-=m/100,g.s=clamp01(g.s),tinycolor(g)}function _saturate(d,m){m=m===0?0:m||10;var g=tinycolor(d).toHsl();return g.s+=m/100,g.s=clamp01(g.s),tinycolor(g)}function _greyscale(d){return tinycolor(d).desaturate(100)}function _lighten(d,m){m=m===0?0:m||10;var g=tinycolor(d).toHsl();return g.l+=m/100,g.l=clamp01(g.l),tinycolor(g)}function _brighten(d,m){m=m===0?0:m||10;var g=tinycolor(d).toRgb();return g.r=Math.max(0,Math.min(255,g.r-Math.round(-m/100*255))),g.g=Math.max(0,Math.min(255,g.g-Math.round(-m/100*255))),g.b=Math.max(0,Math.min(255,g.b-Math.round(-m/100*255))),tinycolor(g)}function _darken(d,m){m=m===0?0:m||10;var g=tinycolor(d).toHsl();return g.l-=m/100,g.l=clamp01(g.l),tinycolor(g)}function _spin(d,m){var g=tinycolor(d).toHsl(),w=(g.h+m)%360;return g.h=w<0?360+w:w,tinycolor(g)}function _complement(d){var m=tinycolor(d).toHsl();return m.h=(m.h+180)%360,tinycolor(m)}function polyad(d,m){if(isNaN(m)||m<=0)throw new Error("Argument to polyad must be a positive number");for(var g=tinycolor(d).toHsl(),w=[tinycolor(d)],I=360/m,P=1;P<m;P++)w.push(tinycolor({h:(g.h+P*I)%360,s:g.s,l:g.l}));return w}function _splitcomplement(d){var m=tinycolor(d).toHsl(),g=m.h;return[tinycolor(d),tinycolor({h:(g+72)%360,s:m.s,l:m.l}),tinycolor({h:(g+216)%360,s:m.s,l:m.l})]}function _analogous(d,m,g){m=m||6,g=g||30;var w=tinycolor(d).toHsl(),I=360/g,P=[tinycolor(d)];for(w.h=(w.h-(I*m>>1)+720)%360;--m;)w.h=(w.h+I)%360,P.push(tinycolor(w));return P}function _monochromatic(d,m){m=m||6;for(var g=tinycolor(d).toHsv(),w=g.h,I=g.s,P=g.v,F=[],$=1/m;m--;)F.push(tinycolor({h:w,s:I,v:P})),P=(P+$)%1;return F}tinycolor.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var d=this.toRgb();return(299*d.r+587*d.g+114*d.b)/1e3},getLuminance:function(){var d,m,g,w=this.toRgb();return d=w.r/255,m=w.g/255,g=w.b/255,.2126*(d<=.03928?d/12.92:Math.pow((d+.055)/1.055,2.4))+.7152*(m<=.03928?m/12.92:Math.pow((m+.055)/1.055,2.4))+.0722*(g<=.03928?g/12.92:Math.pow((g+.055)/1.055,2.4))},setAlpha:function(d){return this._a=boundAlpha(d),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var d=rgbToHsv(this._r,this._g,this._b);return{h:360*d.h,s:d.s,v:d.v,a:this._a}},toHsvString:function(){var d=rgbToHsv(this._r,this._g,this._b),m=Math.round(360*d.h),g=Math.round(100*d.s),w=Math.round(100*d.v);return this._a==1?"hsv("+m+", "+g+"%, "+w+"%)":"hsva("+m+", "+g+"%, "+w+"%, "+this._roundA+")"},toHsl:function(){var d=rgbToHsl(this._r,this._g,this._b);return{h:360*d.h,s:d.s,l:d.l,a:this._a}},toHslString:function(){var d=rgbToHsl(this._r,this._g,this._b),m=Math.round(360*d.h),g=Math.round(100*d.s),w=Math.round(100*d.l);return this._a==1?"hsl("+m+", "+g+"%, "+w+"%)":"hsla("+m+", "+g+"%, "+w+"%, "+this._roundA+")"},toHex:function(d){return rgbToHex(this._r,this._g,this._b,d)},toHexString:function(d){return"#"+this.toHex(d)},toHex8:function(d){return rgbaToHex(this._r,this._g,this._b,this._a,d)},toHex8String:function(d){return"#"+this.toHex8(d)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(100*bound01(this._r,255))+"%",g:Math.round(100*bound01(this._g,255))+"%",b:Math.round(100*bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(100*bound01(this._r,255))+"%, "+Math.round(100*bound01(this._g,255))+"%, "+Math.round(100*bound01(this._b,255))+"%)":"rgba("+Math.round(100*bound01(this._r,255))+"%, "+Math.round(100*bound01(this._g,255))+"%, "+Math.round(100*bound01(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(hexNames[rgbToHex(this._r,this._g,this._b,!0)]||!1)},toFilter:function(d){var m="#"+rgbaToArgbHex(this._r,this._g,this._b,this._a),g=m,w=this._gradientType?"GradientType = 1, ":"";if(d){var I=tinycolor(d);g="#"+rgbaToArgbHex(I._r,I._g,I._b,I._a)}return"progid:DXImageTransform.Microsoft.gradient("+w+"startColorstr="+m+",endColorstr="+g+")"},toString:function(d){var m=!!d;d=d||this._format;var g=!1,w=this._a<1&&this._a>=0;return m||!w||d!=="hex"&&d!=="hex6"&&d!=="hex3"&&d!=="hex4"&&d!=="hex8"&&d!=="name"?(d==="rgb"&&(g=this.toRgbString()),d==="prgb"&&(g=this.toPercentageRgbString()),d!=="hex"&&d!=="hex6"||(g=this.toHexString()),d==="hex3"&&(g=this.toHexString(!0)),d==="hex4"&&(g=this.toHex8String(!0)),d==="hex8"&&(g=this.toHex8String()),d==="name"&&(g=this.toName()),d==="hsl"&&(g=this.toHslString()),d==="hsv"&&(g=this.toHsvString()),g||this.toHexString()):d==="name"&&this._a===0?this.toName():this.toRgbString()},clone:function(){return tinycolor(this.toString())},_applyModification:function(d,m){var g=d.apply(null,[this].concat([].slice.call(m)));return this._r=g._r,this._g=g._g,this._b=g._b,this.setAlpha(g._a),this},lighten:function(){return this._applyModification(_lighten,arguments)},brighten:function(){return this._applyModification(_brighten,arguments)},darken:function(){return this._applyModification(_darken,arguments)},desaturate:function(){return this._applyModification(_desaturate,arguments)},saturate:function(){return this._applyModification(_saturate,arguments)},greyscale:function(){return this._applyModification(_greyscale,arguments)},spin:function(){return this._applyModification(_spin,arguments)},_applyCombination:function(d,m){return d.apply(null,[this].concat([].slice.call(m)))},analogous:function(){return this._applyCombination(_analogous,arguments)},complement:function(){return this._applyCombination(_complement,arguments)},monochromatic:function(){return this._applyCombination(_monochromatic,arguments)},splitcomplement:function(){return this._applyCombination(_splitcomplement,arguments)},triad:function(){return this._applyCombination(polyad,[3])},tetrad:function(){return this._applyCombination(polyad,[4])}},tinycolor.fromRatio=function(d,m){if(_typeof(d)=="object"){var g={};for(var w in d)d.hasOwnProperty(w)&&(g[w]=w==="a"?d[w]:convertToPercentage(d[w]));d=g}return tinycolor(d,m)},tinycolor.equals=function(d,m){return!(!d||!m)&&tinycolor(d).toRgbString()==tinycolor(m).toRgbString()},tinycolor.random=function(){return tinycolor.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})},tinycolor.mix=function(d,m,g){g=g===0?0:g||50;var w=tinycolor(d).toRgb(),I=tinycolor(m).toRgb(),P=g/100;return tinycolor({r:(I.r-w.r)*P+w.r,g:(I.g-w.g)*P+w.g,b:(I.b-w.b)*P+w.b,a:(I.a-w.a)*P+w.a})},tinycolor.readability=function(d,m){var g=tinycolor(d),w=tinycolor(m);return(Math.max(g.getLuminance(),w.getLuminance())+.05)/(Math.min(g.getLuminance(),w.getLuminance())+.05)},tinycolor.isReadable=function(d,m,g){var w,I,P=tinycolor.readability(d,m);switch(I=!1,(w=validateWCAG2Parms(g)).level+w.size){case"AAsmall":case"AAAlarge":I=P>=4.5;break;case"AAlarge":I=P>=3;break;case"AAAsmall":I=P>=7}return I},tinycolor.mostReadable=function(d,m,g){var w,I,P,F,$=null,D=0;I=(g=g||{}).includeFallbackColors,P=g.level,F=g.size;for(var U=0;U<m.length;U++)(w=tinycolor.readability(d,m[U]))>D&&(D=w,$=tinycolor(m[U]));return tinycolor.isReadable(d,$,{level:P,size:F})||!I?$:(g.includeFallbackColors=!1,tinycolor.mostReadable(d,["#fff","#000"],g))};var names$1=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},hexNames=tinycolor.hexNames=flip(names$1);function flip(d){var m={};for(var g in d)d.hasOwnProperty(g)&&(m[d[g]]=g);return m}function boundAlpha(d){return d=parseFloat(d),(isNaN(d)||d<0||d>1)&&(d=1),d}function bound01(d,m){isOnePointZero(d)&&(d="100%");var g=isPercentage(d);return d=Math.min(m,Math.max(0,parseFloat(d))),g&&(d=parseInt(d*m,10)/100),Math.abs(d-m)<1e-6?1:d%m/parseFloat(m)}function clamp01(d){return Math.min(1,Math.max(0,d))}function parseIntFromHex(d){return parseInt(d,16)}function isOnePointZero(d){return typeof d=="string"&&d.indexOf(".")!=-1&&parseFloat(d)===1}function isPercentage(d){return typeof d=="string"&&d.indexOf("%")!=-1}function pad2(d){return d.length==1?"0"+d:""+d}function convertToPercentage(d){return d<=1&&(d=100*d+"%"),d}function convertDecimalToHex(d){return Math.round(255*parseFloat(d)).toString(16)}function convertHexToDecimal(d){return parseIntFromHex(d)/255}var matchers=(CSS_UNIT="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)",PERMISSIVE_MATCH3="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",PERMISSIVE_MATCH4="[\\s|\\(]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")[,|\\s]+("+CSS_UNIT+")\\s*\\)?",{CSS_UNIT:new RegExp(CSS_UNIT),rgb:new RegExp("rgb"+PERMISSIVE_MATCH3),rgba:new RegExp("rgba"+PERMISSIVE_MATCH4),hsl:new RegExp("hsl"+PERMISSIVE_MATCH3),hsla:new RegExp("hsla"+PERMISSIVE_MATCH4),hsv:new RegExp("hsv"+PERMISSIVE_MATCH3),hsva:new RegExp("hsva"+PERMISSIVE_MATCH4),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}),CSS_UNIT,PERMISSIVE_MATCH3,PERMISSIVE_MATCH4;function isValidCSSUnit(d){return!!matchers.CSS_UNIT.exec(d)}function stringInputToObject(d){d=d.replace(trimLeft,"").replace(trimRight,"").toLowerCase();var m,g=!1;if(names$1[d])d=names$1[d],g=!0;else if(d=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(m=matchers.rgb.exec(d))?{r:m[1],g:m[2],b:m[3]}:(m=matchers.rgba.exec(d))?{r:m[1],g:m[2],b:m[3],a:m[4]}:(m=matchers.hsl.exec(d))?{h:m[1],s:m[2],l:m[3]}:(m=matchers.hsla.exec(d))?{h:m[1],s:m[2],l:m[3],a:m[4]}:(m=matchers.hsv.exec(d))?{h:m[1],s:m[2],v:m[3]}:(m=matchers.hsva.exec(d))?{h:m[1],s:m[2],v:m[3],a:m[4]}:(m=matchers.hex8.exec(d))?{r:parseIntFromHex(m[1]),g:parseIntFromHex(m[2]),b:parseIntFromHex(m[3]),a:convertHexToDecimal(m[4]),format:g?"name":"hex8"}:(m=matchers.hex6.exec(d))?{r:parseIntFromHex(m[1]),g:parseIntFromHex(m[2]),b:parseIntFromHex(m[3]),format:g?"name":"hex"}:(m=matchers.hex4.exec(d))?{r:parseIntFromHex(m[1]+""+m[1]),g:parseIntFromHex(m[2]+""+m[2]),b:parseIntFromHex(m[3]+""+m[3]),a:convertHexToDecimal(m[4]+""+m[4]),format:g?"name":"hex8"}:!!(m=matchers.hex3.exec(d))&&{r:parseIntFromHex(m[1]+""+m[1]),g:parseIntFromHex(m[2]+""+m[2]),b:parseIntFromHex(m[3]+""+m[3]),format:g?"name":"hex"}}function validateWCAG2Parms(d){var m,g;return(m=((d=d||{level:"AA",size:"small"}).level||"AA").toUpperCase())!=="AA"&&m!=="AAA"&&(m="AA"),(g=(d.size||"small").toLowerCase())!=="small"&&g!=="large"&&(g="small"),{level:m,size:g}}function clone(d){const m={width:d.bitmap.width,height:d.bitmap.height,data:Buffer.from(d.bitmap.data)};return new d.constructor(m)}function scan(d,m,g,w,I,P){let F,$,D,U,Z;if(typeof m=="function")Z=m,F=0,$=0,D=d.bitmap.width,U=d.bitmap.height;else{if(F=m,typeof g!="number")throw new Error("y must be a number");if($=g,typeof w!="number")throw new Error("w must be a number");if(D=w,typeof I!="number")throw new Error("h must be a number");if(U=I,typeof P!="function")throw new Error("cb must be a function");Z=P}F=Math.round(F),$=Math.round($),D=Math.round(D),U=Math.round(U);const j=Z.bind(d);for(let G=$;G<$+U;G++)for(let H=F;H<F+D;H++)j(H,G,d.bitmap.width*G+H<<2);return d}function*scanIterator(d,m,g,w,I){m=Math.round(m),g=Math.round(g),w=Math.round(w),I=Math.round(I);for(let P=g;P<g+I;P++)for(let F=m;F<m+w;F++){const $=d.bitmap.width*P+F<<2;yield{x:F,y:P,idx:$,image:d}}}function intToRGBA$1(d){if(typeof d!="number")throw new Error("i must be a number");const m={r:0,g:0,b:0,a:0};return m.r=Math.floor(d/Math.pow(256,3)),m.g=Math.floor((d-m.r*Math.pow(256,3))/Math.pow(256,2)),m.b=Math.floor((d-m.r*Math.pow(256,3)-m.g*Math.pow(256,2))/Math.pow(256,1)),m.a=Math.floor((d-m.r*Math.pow(256,3)-m.g*Math.pow(256,2)-m.b*Math.pow(256,1))/Math.pow(256,0)),m}function colorDiff(d,m){const g=F=>Math.pow(F,2),{max:w}=Math,I="a"in d?d.a:255,P="a"in m?m.a:255;return(w(g(d.r-m.r),g(d.r-m.r-I+P))+w(g(d.g-m.g),g(d.g-m.g-I+P))+w(g(d.b-m.b),g(d.b-m.b-I+P)))/195075}function limit255(d){return d=Math.max(d,0),d=Math.min(d,255)}function cssColorToHex(d){return typeof d=="number"?d:parseInt(tinycolor(d).toHex8(),16)}function encode$1(d,m={}){return scan({bitmap:d},0,0,d.width,d.height,function(g,w,I){const P=d.data[I+0],F=d.data[I+1],$=d.data[I+2],D=d.data[I+3];d.data[I+0]=D,d.data[I+1]=$,d.data[I+2]=F,d.data[I+3]=P}),encode$2({...d,...m}).data}function decode$1(d,m){const g=decode$2(d,m);return scan({bitmap:g},0,0,g.width,g.height,function(w,I,P){const F=g.data[P+1],$=g.data[P+2],D=g.data[P+3];g.data[P+0]=D,g.data[P+1]=$,g.data[P+2]=F,g.data[P+3]=255}),g}function msBmp(){return{mime:"image/x-ms-bmp",encode:encode$1,decode:decode$1}}function bmp(){return{mime:"image/bmp",encode:encode$1,decode:decode$1}}var omggif={},GifReader_1,GifWriter_1;function GifWriter(d,m,g,w){var I=0,P=(w=w===void 0?{}:w).loop===void 0?null:w.loop,F=w.palette===void 0?null:w.palette;if(m<=0||g<=0||m>65535||g>65535)throw new Error("Width/Height invalid.");function $(Q){var q=Q.length;if(q<2||q>256||q&q-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return q}d[I++]=71,d[I++]=73,d[I++]=70,d[I++]=56,d[I++]=57,d[I++]=97;var D=0,U=0;if(F!==null){for(var Z=$(F);Z>>=1;)++D;if(Z=1<<D,--D,w.background!==void 0){if((U=w.background)>=Z)throw new Error("Background index out of range.");if(U===0)throw new Error("Background index explicitly passed as 0.")}}if(d[I++]=255&m,d[I++]=m>>8&255,d[I++]=255&g,d[I++]=g>>8&255,d[I++]=(F!==null?128:0)|D,d[I++]=U,d[I++]=0,F!==null)for(var j=0,G=F.length;j<G;++j){var H=F[j];d[I++]=H>>16&255,d[I++]=H>>8&255,d[I++]=255&H}if(P!==null){if(P<0||P>65535)throw new Error("Loop count invalid.");d[I++]=33,d[I++]=255,d[I++]=11,d[I++]=78,d[I++]=69,d[I++]=84,d[I++]=83,d[I++]=67,d[I++]=65,d[I++]=80,d[I++]=69,d[I++]=50,d[I++]=46,d[I++]=48,d[I++]=3,d[I++]=1,d[I++]=255&P,d[I++]=P>>8&255,d[I++]=0}var W=!1;this.addFrame=function(Q,q,rt,it,X,J){if(W===!0&&(--I,W=!1),J=J===void 0?{}:J,Q<0||q<0||Q>65535||q>65535)throw new Error("x/y invalid.");if(rt<=0||it<=0||rt>65535||it>65535)throw new Error("Width/Height invalid.");if(X.length<rt*it)throw new Error("Not enough pixels for the frame size.");var tt=!0,ot=J.palette;if(ot==null&&(tt=!1,ot=F),ot==null)throw new Error("Must supply either a local or global palette.");for(var nt=$(ot),lt=0;nt>>=1;)++lt;nt=1<<lt;var at=J.delay===void 0?0:J.delay,ut=J.disposal===void 0?0:J.disposal;if(ut<0||ut>3)throw new Error("Disposal out of range.");var V=!1,ht=0;if(J.transparent!==void 0&&J.transparent!==null&&(V=!0,(ht=J.transparent)<0||ht>=nt))throw new Error("Transparent color index.");if((ut!==0||V||at!==0)&&(d[I++]=33,d[I++]=249,d[I++]=4,d[I++]=ut<<2|(V===!0?1:0),d[I++]=255&at,d[I++]=at>>8&255,d[I++]=ht,d[I++]=0),d[I++]=44,d[I++]=255&Q,d[I++]=Q>>8&255,d[I++]=255&q,d[I++]=q>>8&255,d[I++]=255&rt,d[I++]=rt>>8&255,d[I++]=255&it,d[I++]=it>>8&255,d[I++]=tt===!0?128|lt-1:0,tt===!0)for(var vt=0,pt=ot.length;vt<pt;++vt){var st=ot[vt];d[I++]=st>>16&255,d[I++]=st>>8&255,d[I++]=255&st}return I=GifWriterOutputLZWCodeStream(d,I,lt<2?2:lt,X)},this.end=function(){return W===!1&&(d[I++]=59,W=!0),I},this.getOutputBuffer=function(){return d},this.setOutputBuffer=function(Q){d=Q},this.getOutputBufferPosition=function(){return I},this.setOutputBufferPosition=function(Q){I=Q}}function GifWriterOutputLZWCodeStream(d,m,g,w){d[m++]=g;var I=m++,P=1<<g,F=P-1,$=P+1,D=$+1,U=g+1,Z=0,j=0;function G(tt){for(;Z>=tt;)d[m++]=255&j,j>>=8,Z-=8,m===I+256&&(d[I]=255,I=m++)}function H(tt){j|=tt<<Z,Z+=U,G(8)}var W=w[0]&F,Q={};H(P);for(var q=1,rt=w.length;q<rt;++q){var it=w[q]&F,X=W<<8|it,J=Q[X];if(J===void 0){for(j|=W<<Z,Z+=U;Z>=8;)d[m++]=255&j,j>>=8,Z-=8,m===I+256&&(d[I]=255,I=m++);D===4096?(H(P),D=$+1,U=g+1,Q={}):(D>=1<<U&&++U,Q[X]=D++),W=it}else W=J}return H(W),H($),G(1),I+1===m?d[I]=0:(d[I]=m-I-1,d[m++]=0),m}function GifReader(d){var m=0;if(d[m++]!==71||d[m++]!==73||d[m++]!==70||d[m++]!==56||(d[m++]+1&253)!=56||d[m++]!==97)throw new Error("Invalid GIF 87a/89a header.");var g=d[m++]|d[m++]<<8,w=d[m++]|d[m++]<<8,I=d[m++],P=I>>7,F=1<<(7&I)+1;d[m++],d[m++];var $=null,D=null;P&&($=m,D=F,m+=3*F);var U=!0,Z=[],j=0,G=null,H=0,W=null;for(this.width=g,this.height=w;U&&m<d.length;)switch(d[m++]){case 33:switch(d[m++]){case 255:if(d[m]!==11||d[m+1]==78&&d[m+2]==69&&d[m+3]==84&&d[m+4]==83&&d[m+5]==67&&d[m+6]==65&&d[m+7]==80&&d[m+8]==69&&d[m+9]==50&&d[m+10]==46&&d[m+11]==48&&d[m+12]==3&&d[m+13]==1&&d[m+16]==0)m+=14,W=d[m++]|d[m++]<<8,m++;else for(m+=12;;){if(!((V=d[m++])>=0))throw Error("Invalid block size");if(V===0)break;m+=V}break;case 249:if(d[m++]!==4||d[m+4]!==0)throw new Error("Invalid graphics extension block.");var Q=d[m++];j=d[m++]|d[m++]<<8,G=d[m++],1&Q||(G=null),H=Q>>2&7,m++;break;case 254:for(;;){if(!((V=d[m++])>=0))throw Error("Invalid block size");if(V===0)break;m+=V}break;default:throw new Error("Unknown graphic control label: 0x"+d[m-1].toString(16))}break;case 44:var q=d[m++]|d[m++]<<8,rt=d[m++]|d[m++]<<8,it=d[m++]|d[m++]<<8,X=d[m++]|d[m++]<<8,J=d[m++],tt=J>>6&1,ot=1<<(7&J)+1,nt=$,lt=D,at=!1;J>>7&&(at=!0,nt=m,lt=ot,m+=3*ot);var ut=m;for(m++;;){var V;if(!((V=d[m++])>=0))throw Error("Invalid block size");if(V===0)break;m+=V}Z.push({x:q,y:rt,width:it,height:X,has_local_palette:at,palette_offset:nt,palette_size:lt,data_offset:ut,data_length:m-ut,transparent_index:G,interlaced:!!tt,delay:j,disposal:H});break;case 59:U=!1;break;default:throw new Error("Unknown gif block: 0x"+d[m-1].toString(16))}this.numFrames=function(){return Z.length},this.loopCount=function(){return W},this.frameInfo=function(ht){if(ht<0||ht>=Z.length)throw new Error("Frame index out of range.");return Z[ht]},this.decodeAndBlitFrameBGRA=function(ht,vt){var pt=this.frameInfo(ht),st=pt.width*pt.height,ct=new Uint8Array(st);GifReaderLZWOutputIndexStream(d,pt.data_offset,ct,st);var At=pt.palette_offset,kt=pt.transparent_index;kt===null&&(kt=256);var yt=pt.width,Ct=g-yt,xt=yt,Pt=4*(pt.y*g+pt.x),Ft=4*((pt.y+pt.height)*g+pt.x),Rt=Pt,Mt=4*Ct;pt.interlaced===!0&&(Mt+=4*g*7);for(var Bt=8,$t=0,Ot=ct.length;$t<Ot;++$t){var Zt=ct[$t];if(xt===0&&(xt=yt,(Rt+=Mt)>=Ft&&(Mt=4*Ct+4*g*(Bt-1),Rt=Pt+(yt+Ct)*(Bt<<1),Bt>>=1)),Zt===kt)Rt+=4;else{var Tt=d[At+3*Zt],et=d[At+3*Zt+1],It=d[At+3*Zt+2];vt[Rt++]=It,vt[Rt++]=et,vt[Rt++]=Tt,vt[Rt++]=255}--xt}},this.decodeAndBlitFrameRGBA=function(ht,vt){var pt=this.frameInfo(ht),st=pt.width*pt.height,ct=new Uint8Array(st);GifReaderLZWOutputIndexStream(d,pt.data_offset,ct,st);var At=pt.palette_offset,kt=pt.transparent_index;kt===null&&(kt=256);var yt=pt.width,Ct=g-yt,xt=yt,Pt=4*(pt.y*g+pt.x),Ft=4*((pt.y+pt.height)*g+pt.x),Rt=Pt,Mt=4*Ct;pt.interlaced===!0&&(Mt+=4*g*7);for(var Bt=8,$t=0,Ot=ct.length;$t<Ot;++$t){var Zt=ct[$t];if(xt===0&&(xt=yt,(Rt+=Mt)>=Ft&&(Mt=4*Ct+4*g*(Bt-1),Rt=Pt+(yt+Ct)*(Bt<<1),Bt>>=1)),Zt===kt)Rt+=4;else{var Tt=d[At+3*Zt],et=d[At+3*Zt+1],It=d[At+3*Zt+2];vt[Rt++]=Tt,vt[Rt++]=et,vt[Rt++]=It,vt[Rt++]=255}--xt}}}function GifReaderLZWOutputIndexStream(d,m,g,w){for(var I=d[m++],P=1<<I,F=P+1,$=F+1,D=I+1,U=(1<<D)-1,Z=0,j=0,G=0,H=d[m++],W=new Int32Array(4096),Q=null;;){for(;Z<16&&H!==0;)j|=d[m++]<<Z,Z+=8,H===1?H=d[m++]:--H;if(Z<D)break;var q=j&U;if(j>>=D,Z-=D,q!==P){if(q===F)break;for(var rt=q<$?q:Q,it=0,X=rt;X>P;)X=W[X]>>8,++it;var J=X;if(G+it+(rt!==q?1:0)>w)return void console.log("Warning, gif stream longer than expected.");g[G++]=J;var tt=G+=it;for(rt!==q&&(g[G++]=J),X=rt;it--;)X=W[X],g[--tt]=255&X,X>>=8;Q!==null&&$<4096&&(W[$++]=Q<<8|J,$>=U+1&&D<12&&(++D,U=U<<1|1)),Q=q}else $=F+1,U=(1<<(D=I+1))-1,Q=null}return G!==w&&console.log("Warning, gif stream shorter than expected."),g}try{GifWriter_1=omggif.GifWriter=GifWriter,GifReader_1=omggif.GifReader=GifReader}catch{}let BitmapImage$2=class Ae{constructor(...m){if(m.length===0)throw new Error("constructor requires parameters");const g=m[0];if(g!==null&&typeof g=="object")if(g instanceof Ae){const w=g.bitmap;this.bitmap={width:w.width,height:w.height,data:new Buffer(w.width*w.height*4)},w.data.copy(this.bitmap.data)}else{if(!(g.width&&g.height&&g.data))throw new Error("unrecognized constructor parameters");this.bitmap=g}else{if(typeof g!="number"||typeof m[1]!="number")throw new Error("unrecognized constructor parameters");{const w=g,I=m[1],P=m[2];this.bitmap={width:w,height:I},Buffer.isBuffer(P)?this.bitmap.data=P:(this.bitmap.data=new Buffer(w*I*4),typeof P=="number"&&this.fillRGBA(P))}}}blit(m,g,w,I,P,F,$){if(I+F>this.bitmap.width)throw new Error("copy exceeds width of source bitmap");if(g+F>m.bitmap.width)throw new Error("copy exceeds width of target bitmap");if(P+$>this.bitmap.height)throw new Error("copy exceeds height of source bitmap");if(w+$>m.bitmap.height)throw new Erro("copy exceeds height of target bitmap");const D=this.bitmap.data,U=m.bitmap.data,Z=4*this.bitmap.width,j=4*m.bitmap.width,G=4*F;let H=P*Z+4*I,W=w*j+4*g;for(;--$>=0;)D.copy(U,W,H,H+G),H+=Z,W+=j;return this}fillRGBA(m){const g=this.bitmap.data,w=4*this.bitmap.height;let I=0;for(;I<w;)g.writeUInt32BE(m,I),I+=4;for(;I<g.length;)g.copy(g,I,0,w),I+=w;return this}getRGBA(m,g){const w=4*(g*this.bitmap.width+m);return this.bitmap.data.readUInt32BE(w)}getRGBASet(){const m=new Set,g=this.bitmap.data;for(let w=0;w<g.length;w+=4)m.add(g.readUInt32BE(w,!0));return m}greyscale(){const m=this.bitmap.data;return this.scan(0,0,this.bitmap.width,this.bitmap.height,(g,w,I)=>{const P=Math.round(.299*m[I]+.587*m[I+1]+.114*m[I+2]);m[I]=P,m[I+1]=P,m[I+2]=P}),this}reframe(m,g,w,I,P){const F=m<0?0:m,$=g<0?0:g,D=w+F>this.bitmap.width?this.bitmap.width-F:w,U=I+$>this.bitmap.height?this.bitmap.height-$:I,Z=m<0?-m:0,j=g<0?-g:0;let G;if(P===void 0){if(F!==m||$!=g||D!==w||U!==I)throw new GifError("fillRGBA required for this reframing");G=new Ae(w,I)}else G=new Ae(w,I,P);return this.blit(G,Z,j,F,$,D,U),this.bitmap=G.bitmap,this}scale(m){if(m===1)return;if(!Number.isInteger(m)||m<1)throw new Error("the scale must be an integer >= 1");const g=this.bitmap.width,w=this.bitmap.height,I=g*m*4,P=this.bitmap.data,F=new Buffer(w*I*m);let $,D=0,U=0;for(let Z=0;Z<w;++Z){$=U;for(let j=0;j<g;++j){const G=P.readUInt32BE(D,!0);for(let H=0;H<m;++H)F.writeUInt32BE(G,U),U+=4;D+=4}for(let j=1;j<m;++j)F.copy(F,U,$,U),U+=I,$+=I}return this.bitmap={width:g*m,height:w*m,data:F},this}scanAllCoords(m){const g=this.bitmap.width,w=this.bitmap.data.length;let I=0,P=0;for(let F=0;F<w;F+=4)m(I,P,F),++I===g&&(I=0,++P)}scanAllIndexes(m){const g=this.bitmap.data.length;for(let w=0;w<g;w+=4)m(w)}};var bitmapimage=BitmapImage$2,gif$1={};let Gif$1=class{constructor(d,m,g){this.width=g.width,this.height=g.height,this.loops=g.loops,this.usesTransparency=g.usesTransparency,this.colorScope=g.colorScope,this.frames=m,this.buffer=d}};Gif$1.GlobalColorsPreferred=0,Gif$1.GlobalColorsOnly=1,Gif$1.LocalColorsOnly=2;let GifError$2=class extends Error{constructor(d){super(d),d instanceof Error&&(this.stack="Gif"+d.stack)}};gif$1.Gif=Gif$1,gif$1.GifError=GifError$2;var gifcodec={},gifutil={},_polyfillNode_fs={},_polyfillNode_fs$1=Object.freeze({__proto__:null,default:_polyfillNode_fs}),require$$0=getAugmentedNamespace(_polyfillNode_fs$1),__defProp$3=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__hasOwnProp=Object.prototype.hasOwnProperty,__defNormalProp$3=(d,m,g)=>m in d?__defProp$3(d,m,{enumerable:!0,configurable:!0,writable:!0,value:g}):d[m]=g,__markAsModule=d=>__defProp$3(d,"__esModule",{value:!0}),__export$1=(d,m)=>{for(var g in m)__defProp$3(d,g,{get:m[g],enumerable:!0})},__reExport=(d,m,g,w)=>{if(m&&typeof m=="object"||typeof m=="function")for(let I of __getOwnPropNames(m))!__hasOwnProp.call(d,I)&&g&&__defProp$3(d,I,{get:()=>m[I],enumerable:!(w=__getOwnPropDesc(m,I))||w.enumerable});return d},__toCommonJS=(d=>(m,g)=>d&&d.get(m)||(g=__reExport(__markAsModule({}),m,1),d&&d.set(m,g),g))(typeof WeakMap<"u"?new WeakMap:0),__publicField$3=(d,m,g)=>(__defNormalProp$3(d,typeof m!="symbol"?m+"":m,g),g),src_exports={};__export$1(src_exports,{applyPalette:()=>applyPalette,applyPaletteSync:()=>applyPaletteSync$1,buildPalette:()=>buildPalette,buildPaletteSync:()=>buildPaletteSync$1,constants:()=>constants_exports$1,conversion:()=>conversion_exports$1,distance:()=>distance_exports$1,image:()=>image_exports$1,palette:()=>palette_exports$1,quality:()=>quality_exports$1,utils:()=>utils_exports$1});var constants_exports$1={};__export$1(constants_exports$1,{bt709:()=>bt709_exports$1});var bt709_exports$1={};__export$1(bt709_exports$1,{Y:()=>Y$1,x:()=>x$2,y:()=>y$2});var Y$1=(d=>(d[d.RED=.2126]="RED",d[d.GREEN=.7152]="GREEN",d[d.BLUE=.0722]="BLUE",d[d.WHITE=1]="WHITE",d))(Y$1||{}),x$2=(d=>(d[d.RED=.64]="RED",d[d.GREEN=.3]="GREEN",d[d.BLUE=.15]="BLUE",d[d.WHITE=.3127]="WHITE",d))(x$2||{}),y$2=(d=>(d[d.RED=.33]="RED",d[d.GREEN=.6]="GREEN",d[d.BLUE=.06]="BLUE",d[d.WHITE=.329]="WHITE",d))(y$2||{}),conversion_exports$1={};function correctGamma$1(d){return d>.04045?((d+.055)/1.055)**2.4:d/12.92}function rgb2xyz$1(d,m,g){return{x:.4124*(d=correctGamma$1(d/255))+.3576*(m=correctGamma$1(m/255))+.1805*(g=correctGamma$1(g/255)),y:.2126*d+.7152*m+.0722*g,z:.0193*d+.1192*m+.9505*g}}__export$1(conversion_exports$1,{lab2rgb:()=>lab2rgb$1,lab2xyz:()=>lab2xyz$1,rgb2hsl:()=>rgb2hsl$1,rgb2lab:()=>rgb2lab$1,rgb2xyz:()=>rgb2xyz$1,xyz2lab:()=>xyz2lab$1,xyz2rgb:()=>xyz2rgb$1});var arithmetic_exports$1={};function degrees2radians$1(d){return d*(Math.PI/180)}function max3$1(d,m,g){let w=d;return w<m&&(w=m),w<g&&(w=g),w}function min3$1(d,m,g){let w=d;return w>m&&(w=m),w>g&&(w=g),w}function intInRange$1(d,m,g){return d>g&&(d=g),d<m&&(d=m),0|d}function inRange0to255Rounded$1(d){return(d=Math.round(d))>255?d=255:d<0&&(d=0),d}function inRange0to255$1(d){return d>255?d=255:d<0&&(d=0),d}function stableSort$1(d,m){const g=typeof d[0];let w;if(g==="number"||g==="string"){const I=Object.create(null);for(let P=0,F=d.length;P<F;P++){const $=d[P];I[$]||I[$]===0||(I[$]=P)}w=d.sort((P,F)=>m(P,F)||I[P]-I[F])}else{const I=d.slice(0);w=d.sort((P,F)=>m(P,F)||I.indexOf(P)-I.indexOf(F))}return w}function rgb2hsl$1(d,m,g){const w=min3$1(d,m,g),I=max3$1(d,m,g),P=I-w,F=(w+I)/510;let $=0;F>0&&F<1&&($=P/(F<.5?I+w:510-I-w));let D=0;return P>0&&(D=I===d?(m-g)/P:I===m?2+(g-d)/P:4+(d-m)/P,D*=60,D<0&&(D+=360)),{h:D,s:$,l:F}}__export$1(arithmetic_exports$1,{degrees2radians:()=>degrees2radians$1,inRange0to255:()=>inRange0to255$1,inRange0to255Rounded:()=>inRange0to255Rounded$1,intInRange:()=>intInRange$1,max3:()=>max3$1,min3:()=>min3$1,stableSort:()=>stableSort$1});var refX$1=.95047,refY$1=1,refZ$1=1.08883;function pivot$1(d){return d>.008856?d**(1/3):7.787*d+16/116}function xyz2lab$1(d,m,g){if(d=pivot$1(d/refX$1),m=pivot$1(m/refY$1),g=pivot$1(g/refZ$1),116*m-16<0)throw new Error("xxx");return{L:Math.max(0,116*m-16),a:500*(d-m),b:200*(m-g)}}function rgb2lab$1(d,m,g){const w=rgb2xyz$1(d,m,g);return xyz2lab$1(w.x,w.y,w.z)}var refX2$1=.95047,refY2$1=1,refZ2$1=1.08883;function pivot2$1(d){return d>.206893034?d**3:(d-16/116)/7.787}function lab2xyz$1(d,m,g){const w=(d+16)/116,I=w-g/200;return{x:refX2$1*pivot2$1(m/500+w),y:refY2$1*pivot2$1(w),z:refZ2$1*pivot2$1(I)}}function correctGamma2$1(d){return d>.0031308?1.055*d**(1/2.4)-.055:12.92*d}function xyz2rgb$1(d,m,g){const w=correctGamma2$1(3.2406*d+-1.5372*m+-.4986*g),I=correctGamma2$1(-.9689*d+1.8758*m+.0415*g),P=correctGamma2$1(.0557*d+-.204*m+1.057*g);return{r:inRange0to255Rounded$1(255*w),g:inRange0to255Rounded$1(255*I),b:inRange0to255Rounded$1(255*P)}}function lab2rgb$1(d,m,g){const w=lab2xyz$1(d,m,g);return xyz2rgb$1(w.x,w.y,w.z)}var distance_exports$1={};__export$1(distance_exports$1,{AbstractDistanceCalculator:()=>AbstractDistanceCalculator$1,AbstractEuclidean:()=>AbstractEuclidean$1,AbstractManhattan:()=>AbstractManhattan$1,CIE94GraphicArts:()=>CIE94GraphicArts$1,CIE94Textiles:()=>CIE94Textiles$1,CIEDE2000:()=>CIEDE2000$1,CMetric:()=>CMetric$1,Euclidean:()=>Euclidean$1,EuclideanBT709:()=>EuclideanBT709$1,EuclideanBT709NoAlpha:()=>EuclideanBT709NoAlpha$1,Manhattan:()=>Manhattan$1,ManhattanBT709:()=>ManhattanBT709$1,ManhattanNommyde:()=>ManhattanNommyde$1,PNGQuant:()=>PNGQuant$1});var AbstractDistanceCalculator$1=class{constructor(){__publicField$3(this,"_maxDistance"),__publicField$3(this,"_whitePoint"),this._setDefaults(),this.setWhitePoint(255,255,255,255)}setWhitePoint(d,m,g,w){this._whitePoint={r:d>0?255/d:0,g:m>0?255/m:0,b:g>0?255/g:0,a:w>0?255/w:0},this._maxDistance=this.calculateRaw(d,m,g,w,0,0,0,0)}calculateNormalized(d,m){return this.calculateRaw(d.r,d.g,d.b,d.a,m.r,m.g,m.b,m.a)/this._maxDistance}},AbstractCIE94$1=class extends AbstractDistanceCalculator$1{calculateRaw(d,m,g,w,I,P,F,$){const D=rgb2lab$1(inRange0to255$1(d*this._whitePoint.r),inRange0to255$1(m*this._whitePoint.g),inRange0to255$1(g*this._whitePoint.b)),U=rgb2lab$1(inRange0to255$1(I*this._whitePoint.r),inRange0to255$1(P*this._whitePoint.g),inRange0to255$1(F*this._whitePoint.b)),Z=D.L-U.L,j=D.a-U.a,G=D.b-U.b,H=Math.sqrt(D.a*D.a+D.b*D.b),W=H-Math.sqrt(U.a*U.a+U.b*U.b);let Q=j*j+G*G-W*W;Q=Q<0?0:Math.sqrt(Q);const q=($-w)*this._whitePoint.a*this._kA;return Math.sqrt((Z/this._Kl)**2+(W/(1+this._K1*H))**2+(Q/(1+this._K2*H))**2+q**2)}},CIE94Textiles$1=class extends AbstractCIE94$1{_setDefaults(){this._Kl=2,this._K1=.048,this._K2=.014,this._kA=12.5/255}},CIE94GraphicArts$1=class extends AbstractCIE94$1{_setDefaults(){this._Kl=1,this._K1=.045,this._K2=.015,this._kA=25/255}},_CIEDE2000$1=class extends AbstractDistanceCalculator$1{_setDefaults(){}static _calculatehp(d,m){const g=Math.atan2(d,m);return g>=0?g:g+_CIEDE2000$1._deg360InRad}static _calculateRT(d,m){const g=m**7,w=2*Math.sqrt(g/(g+_CIEDE2000$1._pow25to7)),I=_CIEDE2000$1._deg30InRad*Math.exp(-(((d-_CIEDE2000$1._deg275InRad)/_CIEDE2000$1._deg25InRad)**2));return-Math.sin(2*I)*w}static _calculateT(d){return 1-.17*Math.cos(d-_CIEDE2000$1._deg30InRad)+.24*Math.cos(2*d)+.32*Math.cos(3*d+_CIEDE2000$1._deg6InRad)-.2*Math.cos(4*d-_CIEDE2000$1._deg63InRad)}static _calculate_ahp(d,m,g,w){const I=g+w;return d===0?I:m<=_CIEDE2000$1._deg180InRad?I/2:I<_CIEDE2000$1._deg360InRad?(I+_CIEDE2000$1._deg360InRad)/2:(I-_CIEDE2000$1._deg360InRad)/2}static _calculate_dHp(d,m,g,w){let I;return I=d===0?0:m<=_CIEDE2000$1._deg180InRad?g-w:g<=w?g-w+_CIEDE2000$1._deg360InRad:g-w-_CIEDE2000$1._deg360InRad,2*Math.sqrt(d)*Math.sin(I/2)}calculateRaw(d,m,g,w,I,P,F,$){const D=rgb2lab$1(inRange0to255$1(d*this._whitePoint.r),inRange0to255$1(m*this._whitePoint.g),inRange0to255$1(g*this._whitePoint.b)),U=rgb2lab$1(inRange0to255$1(I*this._whitePoint.r),inRange0to255$1(P*this._whitePoint.g),inRange0to255$1(F*this._whitePoint.b)),Z=($-w)*this._whitePoint.a*_CIEDE2000$1._kA,j=this.calculateRawInLab(D,U);return Math.sqrt(j+Z*Z)}calculateRawInLab(d,m){const g=d.L,w=d.a,I=d.b,P=m.L,F=m.a,$=m.b,D=((Math.sqrt(w*w+I*I)+Math.sqrt(F*F+$*$))/2)**7,U=.5*(1-Math.sqrt(D/(D+_CIEDE2000$1._pow25to7))),Z=(1+U)*w,j=(1+U)*F,G=Math.sqrt(Z*Z+I*I),H=Math.sqrt(j*j+$*$),W=G*H,Q=_CIEDE2000$1._calculatehp(I,Z),q=_CIEDE2000$1._calculatehp($,j),rt=Math.abs(Q-q),it=P-g,X=H-G,J=_CIEDE2000$1._calculate_dHp(W,rt,q,Q),tt=_CIEDE2000$1._calculate_ahp(W,rt,Q,q),ot=(G+H)/2,nt=((g+P)/2-50)**2,lt=X/(1+.045*ot),at=J/(1+.015*_CIEDE2000$1._calculateT(tt)*ot);return(it/(1+.015*nt/Math.sqrt(20+nt)))**2+lt**2+at**2+_CIEDE2000$1._calculateRT(tt,ot)*lt*at}},CIEDE2000$1=_CIEDE2000$1;__publicField$3(CIEDE2000$1,"_kA",25/255),__publicField$3(CIEDE2000$1,"_pow25to7",25**7),__publicField$3(CIEDE2000$1,"_deg360InRad",degrees2radians$1(360)),__publicField$3(CIEDE2000$1,"_deg180InRad",degrees2radians$1(180)),__publicField$3(CIEDE2000$1,"_deg30InRad",degrees2radians$1(30)),__publicField$3(CIEDE2000$1,"_deg6InRad",degrees2radians$1(6)),__publicField$3(CIEDE2000$1,"_deg63InRad",degrees2radians$1(63)),__publicField$3(CIEDE2000$1,"_deg275InRad",degrees2radians$1(275)),__publicField$3(CIEDE2000$1,"_deg25InRad",degrees2radians$1(25));var CMetric$1=class extends AbstractDistanceCalculator$1{calculateRaw(d,m,g,w,I,P,F,$){const D=(d+I)/2*this._whitePoint.r,U=(d-I)*this._whitePoint.r,Z=(m-P)*this._whitePoint.g,j=(g-F)*this._whitePoint.b,G=((512+D)*U*U>>8)+4*Z*Z+((767-D)*j*j>>8),H=($-w)*this._whitePoint.a;return Math.sqrt(G+H*H)}_setDefaults(){}},AbstractEuclidean$1=class extends AbstractDistanceCalculator$1{calculateRaw(d,m,g,w,I,P,F,$){const D=I-d,U=P-m,Z=F-g,j=$-w;return Math.sqrt(this._kR*D*D+this._kG*U*U+this._kB*Z*Z+this._kA*j*j)}},Euclidean$1=class extends AbstractEuclidean$1{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},EuclideanBT709$1=class extends AbstractEuclidean$1{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},EuclideanBT709NoAlpha$1=class extends AbstractEuclidean$1{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=0}},AbstractManhattan$1=class extends AbstractDistanceCalculator$1{calculateRaw(d,m,g,w,I,P,F,$){let D=I-d,U=P-m,Z=F-g,j=$-w;return D<0&&(D=0-D),U<0&&(U=0-U),Z<0&&(Z=0-Z),j<0&&(j=0-j),this._kR*D+this._kG*U+this._kB*Z+this._kA*j}},Manhattan$1=class extends AbstractManhattan$1{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},ManhattanNommyde$1=class extends AbstractManhattan$1{_setDefaults(){this._kR=.4984,this._kG=.8625,this._kB=.2979,this._kA=1}},ManhattanBT709$1=class extends AbstractManhattan$1{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},PNGQuant$1=class extends AbstractDistanceCalculator$1{calculateRaw(d,m,g,w,I,P,F,$){const D=($-w)*this._whitePoint.a;return this._colordifferenceCh(d*this._whitePoint.r,I*this._whitePoint.r,D)+this._colordifferenceCh(m*this._whitePoint.g,P*this._whitePoint.g,D)+this._colordifferenceCh(g*this._whitePoint.b,F*this._whitePoint.b,D)}_colordifferenceCh(d,m,g){const w=d-m,I=w+g;return w*w+I*I}_setDefaults(){}},palette_exports$1={};__export$1(palette_exports$1,{AbstractPaletteQuantizer:()=>AbstractPaletteQuantizer$1,ColorHistogram:()=>ColorHistogram$1,NeuQuant:()=>NeuQuant$1,NeuQuantFloat:()=>NeuQuantFloat$1,RGBQuant:()=>RGBQuant$1,WuColorCube:()=>WuColorCube$1,WuQuant:()=>WuQuant$1});var AbstractPaletteQuantizer$1=class{quantizeSync(){for(const d of this.quantize())if(d.palette)return d.palette;throw new Error("unreachable")}},Point$1=class{constructor(){__publicField$3(this,"r"),__publicField$3(this,"g"),__publicField$3(this,"b"),__publicField$3(this,"a"),__publicField$3(this,"uint32"),__publicField$3(this,"rgba"),this.uint32=-1>>>0,this.r=this.g=this.b=this.a=0,this.rgba=new Array(4),this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}static createByQuadruplet(d){const m=new Point$1;return m.r=0|d[0],m.g=0|d[1],m.b=0|d[2],m.a=0|d[3],m._loadUINT32(),m._loadQuadruplet(),m}static createByRGBA(d,m,g,w){const I=new Point$1;return I.r=0|d,I.g=0|m,I.b=0|g,I.a=0|w,I._loadUINT32(),I._loadQuadruplet(),I}static createByUint32(d){const m=new Point$1;return m.uint32=d>>>0,m._loadRGBA(),m._loadQuadruplet(),m}from(d){this.r=d.r,this.g=d.g,this.b=d.b,this.a=d.a,this.uint32=d.uint32,this.rgba[0]=d.r,this.rgba[1]=d.g,this.rgba[2]=d.b,this.rgba[3]=d.a}getLuminosity(d){let m=this.r,g=this.g,w=this.b;return d&&(m=Math.min(255,255-this.a+this.a*m/255),g=Math.min(255,255-this.a+this.a*g/255),w=Math.min(255,255-this.a+this.a*w/255)),.2126*m+.7152*g+.0722*w}_loadUINT32(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0}_loadRGBA(){this.r=255&this.uint32,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255}_loadQuadruplet(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a}},PointContainer$1=class{constructor(){__publicField$3(this,"_pointArray"),__publicField$3(this,"_width"),__publicField$3(this,"_height"),this._width=0,this._height=0,this._pointArray=[]}getWidth(){return this._width}getHeight(){return this._height}setWidth(d){this._width=d}setHeight(d){this._height=d}getPointArray(){return this._pointArray}clone(){const d=new PointContainer$1;d._width=this._width,d._height=this._height;for(let m=0,g=this._pointArray.length;m<g;m++)d._pointArray[m]=Point$1.createByUint32(0|this._pointArray[m].uint32);return d}toUint32Array(){const d=this._pointArray.length,m=new Uint32Array(d);for(let g=0;g<d;g++)m[g]=this._pointArray[g].uint32;return m}toUint8Array(){return new Uint8Array(this.toUint32Array().buffer)}static fromHTMLImageElement(d){const m=d.naturalWidth,g=d.naturalHeight,w=document.createElement("canvas");return w.width=m,w.height=g,w.getContext("2d").drawImage(d,0,0,m,g,0,0,m,g),PointContainer$1.fromHTMLCanvasElement(w)}static fromHTMLCanvasElement(d){const m=d.width,g=d.height,w=d.getContext("2d").getImageData(0,0,m,g);return PointContainer$1.fromImageData(w)}static fromImageData(d){const m=d.width,g=d.height;return PointContainer$1.fromUint8Array(d.data,m,g)}static fromUint8Array(d,m,g){switch(Object.prototype.toString.call(d)){case"[object Uint8ClampedArray]":case"[object Uint8Array]":break;default:d=new Uint8Array(d)}const w=new Uint32Array(d.buffer);return PointContainer$1.fromUint32Array(w,m,g)}static fromUint32Array(d,m,g){const w=new PointContainer$1;w._width=m,w._height=g;for(let I=0,P=d.length;I<P;I++)w._pointArray[I]=Point$1.createByUint32(0|d[I]);return w}static fromBuffer(d,m,g){const w=new Uint32Array(d.buffer,d.byteOffset,d.byteLength/Uint32Array.BYTES_PER_ELEMENT);return PointContainer$1.fromUint32Array(w,m,g)}},hueGroups$1=10;function hueGroup$1(d,m){const g=360/m;for(let w=1,I=g-g/2;w<m;w++,I+=g)if(d>=I&&d<I+g)return w;return 0}var Palette$1=class{constructor(){__publicField$3(this,"_pointContainer"),__publicField$3(this,"_pointArray",[]),__publicField$3(this,"_i32idx",{}),this._pointContainer=new PointContainer$1,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}add(d){this._pointArray.push(d),this._pointContainer.setWidth(this._pointArray.length)}has(d){for(let m=this._pointArray.length-1;m>=0;m--)if(d.uint32===this._pointArray[m].uint32)return!0;return!1}getNearestColor(d,m){return this._pointArray[0|this._getNearestIndex(d,m)]}getPointContainer(){return this._pointContainer}_nearestPointFromCache(d){return typeof this._i32idx[d]=="number"?this._i32idx[d]:-1}_getNearestIndex(d,m){let g=this._nearestPointFromCache(""+m.uint32);if(g>=0)return g;let w=Number.MAX_VALUE;g=0;for(let I=0,P=this._pointArray.length;I<P;I++){const F=this._pointArray[I],$=d.calculateRaw(m.r,m.g,m.b,m.a,F.r,F.g,F.b,F.a);$<w&&(w=$,g=I)}return this._i32idx[m.uint32]=g,g}sort(){this._i32idx={},this._pointArray.sort((d,m)=>{const g=rgb2hsl$1(d.r,d.g,d.b),w=rgb2hsl$1(m.r,m.g,m.b),I=d.r===d.g&&d.g===d.b?0:1+hueGroup$1(g.h,hueGroups$1),P=(m.r===m.g&&m.g===m.b?0:1+hueGroup$1(w.h,hueGroups$1))-I;if(P)return-P;const F=d.getLuminosity(!0),$=m.getLuminosity(!0);if($-F!=0)return $-F;const D=(100*w.s|0)-(100*g.s|0);return D?-D:0})}},utils_exports$1={};__export$1(utils_exports$1,{HueStatistics:()=>HueStatistics$1,Palette:()=>Palette$1,Point:()=>Point$1,PointContainer:()=>PointContainer$1,ProgressTracker:()=>ProgressTracker$1,arithmetic:()=>arithmetic_exports$1});var HueGroup$1=class{constructor(){__publicField$3(this,"num",0),__publicField$3(this,"cols",[])}},HueStatistics$1=class{constructor(d,m){__publicField$3(this,"_numGroups"),__publicField$3(this,"_minCols"),__publicField$3(this,"_stats"),__publicField$3(this,"_groupsFull"),this._numGroups=d,this._minCols=m,this._stats=[];for(let g=0;g<=d;g++)this._stats[g]=new HueGroup$1;this._groupsFull=0}check(d){this._groupsFull===this._numGroups+1&&(this.check=()=>{});const m=255&d,g=d>>>8&255,w=d>>>16&255,I=m===g&&g===w?0:1+hueGroup$1(rgb2hsl$1(m,g,w).h,this._numGroups),P=this._stats[I],F=this._minCols;P.num++,P.num>F||(P.num===F&&this._groupsFull++,P.num<=F&&this._stats[I].cols.push(d))}injectIntoDictionary(d){for(let m=0;m<=this._numGroups;m++)this._stats[m].num<=this._minCols&&this._stats[m].cols.forEach(g=>{d[g]?d[g]++:d[g]=1})}injectIntoArray(d){for(let m=0;m<=this._numGroups;m++)this._stats[m].num<=this._minCols&&this._stats[m].cols.forEach(g=>{d.indexOf(g)===-1&&d.push(g)})}},_ProgressTracker$1=class{constructor(d,m){__publicField$3(this,"progress"),__publicField$3(this,"_step"),__publicField$3(this,"_range"),__publicField$3(this,"_last"),__publicField$3(this,"_progressRange"),this._range=d,this._progressRange=m,this._step=Math.max(1,this._range/(_ProgressTracker$1.steps+1)|0),this._last=-this._step,this.progress=0}shouldNotify(d){return d-this._last>=this._step&&(this._last=d,this.progress=Math.min(this._progressRange*this._last/this._range,this._progressRange),!0)}},ProgressTracker$1=_ProgressTracker$1;__publicField$3(ProgressTracker$1,"steps",100);var networkBiasShift$1=3,Neuron$1=class{constructor(d){__publicField$3(this,"r"),__publicField$3(this,"g"),__publicField$3(this,"b"),__publicField$3(this,"a"),this.r=this.g=this.b=this.a=d}toPoint(){return Point$1.createByRGBA(this.r>>networkBiasShift$1,this.g>>networkBiasShift$1,this.b>>networkBiasShift$1,this.a>>networkBiasShift$1)}subtract(d,m,g,w){this.r-=0|d,this.g-=0|m,this.b-=0|g,this.a-=0|w}},_NeuQuant$1=class extends AbstractPaletteQuantizer$1{constructor(d,m=256){super(),__publicField$3(this,"_pointArray"),__publicField$3(this,"_networkSize"),__publicField$3(this,"_network"),__publicField$3(this,"_sampleFactor"),__publicField$3(this,"_radPower"),__publicField$3(this,"_freq"),__publicField$3(this,"_bias"),__publicField$3(this,"_distance"),this._distance=d,this._pointArray=[],this._sampleFactor=1,this._networkSize=m,this._distance.setWhitePoint(255<<networkBiasShift$1,255<<networkBiasShift$1,255<<networkBiasShift$1,255<<networkBiasShift$1)}sample(d){this._pointArray=this._pointArray.concat(d.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let d=0;d<this._networkSize;d++)this._network[d]=new Neuron$1((d<<networkBiasShift$1+8)/this._networkSize|0),this._freq[d]=_NeuQuant$1._initialBias/this._networkSize|0,this._bias[d]=0}*_learn(){let d=this._sampleFactor;const m=this._pointArray.length;m<_NeuQuant$1._minpicturebytes&&(d=1);const g=30+(d-1)/3|0,w=m/d|0;let I,P=w/_NeuQuant$1._nCycles|0,F=_NeuQuant$1._initAlpha,$=(this._networkSize>>3)*_NeuQuant$1._radiusBias,D=$>>_NeuQuant$1._radiusBiasShift;D<=1&&(D=0);for(let Z=0;Z<D;Z++)this._radPower[Z]=F*((D*D-Z*Z)*_NeuQuant$1._radBias/(D*D))>>>0;I=m<_NeuQuant$1._minpicturebytes?1:m%_NeuQuant$1._prime1!=0?_NeuQuant$1._prime1:m%_NeuQuant$1._prime2!=0?_NeuQuant$1._prime2:m%_NeuQuant$1._prime3!=0?_NeuQuant$1._prime3:_NeuQuant$1._prime4;const U=new ProgressTracker$1(w,99);for(let Z=0,j=0;Z<w;){U.shouldNotify(Z)&&(yield{progress:U.progress});const G=this._pointArray[j],H=G.b<<networkBiasShift$1,W=G.g<<networkBiasShift$1,Q=G.r<<networkBiasShift$1,q=G.a<<networkBiasShift$1,rt=this._contest(H,W,Q,q);if(this._alterSingle(F,rt,H,W,Q,q),D!==0&&this._alterNeighbour(D,rt,H,W,Q,q),j+=I,j>=m&&(j-=m),Z++,P===0&&(P=1),Z%P==0){F-=F/g|0,$-=$/_NeuQuant$1._radiusDecrease|0,D=$>>_NeuQuant$1._radiusBiasShift,D<=1&&(D=0);for(let it=0;it<D;it++)this._radPower[it]=F*((D*D-it*it)*_NeuQuant$1._radBias/(D*D))>>>0}}}_buildPalette(){const d=new Palette$1;return this._network.forEach(m=>{d.add(m.toPoint())}),d.sort(),d}_alterNeighbour(d,m,g,w,I,P){let F=m-d;F<-1&&(F=-1);let $=m+d;$>this._networkSize&&($=this._networkSize);let D=m+1,U=m-1,Z=1;for(;D<$||U>F;){const j=this._radPower[Z++]/_NeuQuant$1._alphaRadBias;if(D<$){const G=this._network[D++];G.subtract(j*(G.r-I),j*(G.g-w),j*(G.b-g),j*(G.a-P))}if(U>F){const G=this._network[U--];G.subtract(j*(G.r-I),j*(G.g-w),j*(G.b-g),j*(G.a-P))}}}_alterSingle(d,m,g,w,I,P){d/=_NeuQuant$1._initAlpha;const F=this._network[m];F.subtract(d*(F.r-I),d*(F.g-w),d*(F.b-g),d*(F.a-P))}_contest(d,m,g,w){const I=1020<<networkBiasShift$1;let P=2147483647,F=P,$=-1,D=$;for(let U=0;U<this._networkSize;U++){const Z=this._network[U],j=this._distance.calculateNormalized(Z,{r:g,g:m,b:d,a:w})*I|0;j<P&&(P=j,$=U);const G=j-(this._bias[U]>>_NeuQuant$1._initialBiasShift-networkBiasShift$1);G<F&&(F=G,D=U);const H=this._freq[U]>>_NeuQuant$1._betaShift;this._freq[U]-=H,this._bias[U]+=H<<_NeuQuant$1._gammaShift}return this._freq[$]+=_NeuQuant$1._beta,this._bias[$]-=_NeuQuant$1._betaGamma,D}},NeuQuant$1=_NeuQuant$1;__publicField$3(NeuQuant$1,"_prime1",499),__publicField$3(NeuQuant$1,"_prime2",491),__publicField$3(NeuQuant$1,"_prime3",487),__publicField$3(NeuQuant$1,"_prime4",503),__publicField$3(NeuQuant$1,"_minpicturebytes",_NeuQuant$1._prime4),__publicField$3(NeuQuant$1,"_nCycles",100),__publicField$3(NeuQuant$1,"_initialBiasShift",16),__publicField$3(NeuQuant$1,"_initialBias",1<<_NeuQuant$1._initialBiasShift),__publicField$3(NeuQuant$1,"_gammaShift",10),__publicField$3(NeuQuant$1,"_betaShift",10),__publicField$3(NeuQuant$1,"_beta",_NeuQuant$1._initialBias>>_NeuQuant$1._betaShift),__publicField$3(NeuQuant$1,"_betaGamma",_NeuQuant$1._initialBias<<_NeuQuant$1._gammaShift-_NeuQuant$1._betaShift),__publicField$3(NeuQuant$1,"_radiusBiasShift",6),__publicField$3(NeuQuant$1,"_radiusBias",1<<_NeuQuant$1._radiusBiasShift),__publicField$3(NeuQuant$1,"_radiusDecrease",30),__publicField$3(NeuQuant$1,"_alphaBiasShift",10),__publicField$3(NeuQuant$1,"_initAlpha",1<<_NeuQuant$1._alphaBiasShift),__publicField$3(NeuQuant$1,"_radBiasShift",8),__publicField$3(NeuQuant$1,"_radBias",1<<_NeuQuant$1._radBiasShift),__publicField$3(NeuQuant$1,"_alphaRadBiasShift",_NeuQuant$1._alphaBiasShift+_NeuQuant$1._radBiasShift),__publicField$3(NeuQuant$1,"_alphaRadBias",1<<_NeuQuant$1._alphaRadBiasShift);var networkBiasShift2$1=3,NeuronFloat$1=class{constructor(d){__publicField$3(this,"r"),__publicField$3(this,"g"),__publicField$3(this,"b"),__publicField$3(this,"a"),this.r=this.g=this.b=this.a=d}toPoint(){return Point$1.createByRGBA(this.r>>networkBiasShift2$1,this.g>>networkBiasShift2$1,this.b>>networkBiasShift2$1,this.a>>networkBiasShift2$1)}subtract(d,m,g,w){this.r-=d,this.g-=m,this.b-=g,this.a-=w}},_NeuQuantFloat$1=class extends AbstractPaletteQuantizer$1{constructor(d,m=256){super(),__publicField$3(this,"_pointArray"),__publicField$3(this,"_networkSize"),__publicField$3(this,"_network"),__publicField$3(this,"_sampleFactor"),__publicField$3(this,"_radPower"),__publicField$3(this,"_freq"),__publicField$3(this,"_bias"),__publicField$3(this,"_distance"),this._distance=d,this._pointArray=[],this._sampleFactor=1,this._networkSize=m,this._distance.setWhitePoint(255<<networkBiasShift2$1,255<<networkBiasShift2$1,255<<networkBiasShift2$1,255<<networkBiasShift2$1)}sample(d){this._pointArray=this._pointArray.concat(d.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let d=0;d<this._networkSize;d++)this._network[d]=new NeuronFloat$1((d<<networkBiasShift2$1+8)/this._networkSize),this._freq[d]=_NeuQuantFloat$1._initialBias/this._networkSize,this._bias[d]=0}*_learn(){let d=this._sampleFactor;const m=this._pointArray.length;m<_NeuQuantFloat$1._minpicturebytes&&(d=1);const g=30+(d-1)/3,w=m/d;let I,P=w/_NeuQuantFloat$1._nCycles|0,F=_NeuQuantFloat$1._initAlpha,$=(this._networkSize>>3)*_NeuQuantFloat$1._radiusBias,D=$>>_NeuQuantFloat$1._radiusBiasShift;D<=1&&(D=0);for(let Z=0;Z<D;Z++)this._radPower[Z]=F*((D*D-Z*Z)*_NeuQuantFloat$1._radBias/(D*D));I=m<_NeuQuantFloat$1._minpicturebytes?1:m%_NeuQuantFloat$1._prime1!=0?_NeuQuantFloat$1._prime1:m%_NeuQuantFloat$1._prime2!=0?_NeuQuantFloat$1._prime2:m%_NeuQuantFloat$1._prime3!=0?_NeuQuantFloat$1._prime3:_NeuQuantFloat$1._prime4;const U=new ProgressTracker$1(w,99);for(let Z=0,j=0;Z<w;){U.shouldNotify(Z)&&(yield{progress:U.progress});const G=this._pointArray[j],H=G.b<<networkBiasShift2$1,W=G.g<<networkBiasShift2$1,Q=G.r<<networkBiasShift2$1,q=G.a<<networkBiasShift2$1,rt=this._contest(H,W,Q,q);if(this._alterSingle(F,rt,H,W,Q,q),D!==0&&this._alterNeighbour(D,rt,H,W,Q,q),j+=I,j>=m&&(j-=m),Z++,P===0&&(P=1),Z%P==0){F-=F/g,$-=$/_NeuQuantFloat$1._radiusDecrease,D=$>>_NeuQuantFloat$1._radiusBiasShift,D<=1&&(D=0);for(let it=0;it<D;it++)this._radPower[it]=F*((D*D-it*it)*_NeuQuantFloat$1._radBias/(D*D))}}}_buildPalette(){const d=new Palette$1;return this._network.forEach(m=>{d.add(m.toPoint())}),d.sort(),d}_alterNeighbour(d,m,g,w,I,P){let F=m-d;F<-1&&(F=-1);let $=m+d;$>this._networkSize&&($=this._networkSize);let D=m+1,U=m-1,Z=1;for(;D<$||U>F;){const j=this._radPower[Z++]/_NeuQuantFloat$1._alphaRadBias;if(D<$){const G=this._network[D++];G.subtract(j*(G.r-I),j*(G.g-w),j*(G.b-g),j*(G.a-P))}if(U>F){const G=this._network[U--];G.subtract(j*(G.r-I),j*(G.g-w),j*(G.b-g),j*(G.a-P))}}}_alterSingle(d,m,g,w,I,P){d/=_NeuQuantFloat$1._initAlpha;const F=this._network[m];F.subtract(d*(F.r-I),d*(F.g-w),d*(F.b-g),d*(F.a-P))}_contest(d,m,g,w){const I=1020<<networkBiasShift2$1;let P=2147483647,F=P,$=-1,D=$;for(let U=0;U<this._networkSize;U++){const Z=this._network[U],j=this._distance.calculateNormalized(Z,{r:g,g:m,b:d,a:w})*I;j<P&&(P=j,$=U);const G=j-(this._bias[U]>>_NeuQuantFloat$1._initialBiasShift-networkBiasShift2$1);G<F&&(F=G,D=U);const H=this._freq[U]>>_NeuQuantFloat$1._betaShift;this._freq[U]-=H,this._bias[U]+=H<<_NeuQuantFloat$1._gammaShift}return this._freq[$]+=_NeuQuantFloat$1._beta,this._bias[$]-=_NeuQuantFloat$1._betaGamma,D}},NeuQuantFloat$1=_NeuQuantFloat$1;__publicField$3(NeuQuantFloat$1,"_prime1",499),__publicField$3(NeuQuantFloat$1,"_prime2",491),__publicField$3(NeuQuantFloat$1,"_prime3",487),__publicField$3(NeuQuantFloat$1,"_prime4",503),__publicField$3(NeuQuantFloat$1,"_minpicturebytes",_NeuQuantFloat$1._prime4),__publicField$3(NeuQuantFloat$1,"_nCycles",100),__publicField$3(NeuQuantFloat$1,"_initialBiasShift",16),__publicField$3(NeuQuantFloat$1,"_initialBias",1<<_NeuQuantFloat$1._initialBiasShift),__publicField$3(NeuQuantFloat$1,"_gammaShift",10),__publicField$3(NeuQuantFloat$1,"_betaShift",10),__publicField$3(NeuQuantFloat$1,"_beta",_NeuQuantFloat$1._initialBias>>_NeuQuantFloat$1._betaShift),__publicField$3(NeuQuantFloat$1,"_betaGamma",_NeuQuantFloat$1._initialBias<<_NeuQuantFloat$1._gammaShift-_NeuQuantFloat$1._betaShift),__publicField$3(NeuQuantFloat$1,"_radiusBiasShift",6),__publicField$3(NeuQuantFloat$1,"_radiusBias",1<<_NeuQuantFloat$1._radiusBiasShift),__publicField$3(NeuQuantFloat$1,"_radiusDecrease",30),__publicField$3(NeuQuantFloat$1,"_alphaBiasShift",10),__publicField$3(NeuQuantFloat$1,"_initAlpha",1<<_NeuQuantFloat$1._alphaBiasShift),__publicField$3(NeuQuantFloat$1,"_radBiasShift",8),__publicField$3(NeuQuantFloat$1,"_radBias",1<<_NeuQuantFloat$1._radBiasShift),__publicField$3(NeuQuantFloat$1,"_alphaRadBiasShift",_NeuQuantFloat$1._alphaBiasShift+_NeuQuantFloat$1._radBiasShift),__publicField$3(NeuQuantFloat$1,"_alphaRadBias",1<<_NeuQuantFloat$1._alphaRadBiasShift);var _ColorHistogram$1=class{constructor(d,m){__publicField$3(this,"_method"),__publicField$3(this,"_hueStats"),__publicField$3(this,"_histogram"),__publicField$3(this,"_initColors"),__publicField$3(this,"_minHueCols"),this._method=d,this._minHueCols=m<<2,this._initColors=m<<2,this._hueStats=new HueStatistics$1(_ColorHistogram$1._hueGroups,this._minHueCols),this._histogram=Object.create(null)}sample(d){switch(this._method){case 1:this._colorStats1D(d);break;case 2:this._colorStats2D(d)}}getImportanceSortedColorsIDXI32(){const d=stableSort$1(Object.keys(this._histogram),(g,w)=>this._histogram[w]-this._histogram[g]);if(d.length===0)return[];let m;switch(this._method){case 1:const g=Math.min(d.length,this._initColors),w=d[g-1],I=this._histogram[w];m=d.slice(0,g);let P=g;const F=d.length;for(;P<F&&this._histogram[d[P]]===I;)m.push(d[P++]);this._hueStats.injectIntoArray(m);break;case 2:m=d;break;default:throw new Error("Incorrect method")}return m.map(g=>+g)}_colorStats1D(d){const m=this._histogram,g=d.getPointArray(),w=g.length;for(let I=0;I<w;I++){const P=g[I].uint32;this._hueStats.check(P),P in m?m[P]++:m[P]=1}}_colorStats2D(d){const m=d.getWidth(),g=d.getHeight(),w=d.getPointArray(),I=_ColorHistogram$1._boxSize[0],P=_ColorHistogram$1._boxSize[1],F=I*P,$=this._makeBoxes(m,g,I,P),D=this._histogram;$.forEach(U=>{let Z=Math.round(U.w*U.h/F)*_ColorHistogram$1._boxPixels;Z<2&&(Z=2);const j={};this._iterateBox(U,m,G=>{const H=w[G].uint32;this._hueStats.check(H),H in D?D[H]++:H in j?++j[H]>=Z&&(D[H]=j[H]):j[H]=1})}),this._hueStats.injectIntoDictionary(D)}_iterateBox(d,m,g){const w=d,I=w.y*m+w.x,P=(w.y+w.h-1)*m+(w.x+w.w-1),F=m-w.w+1;let $=0,D=I;do g.call(this,D),D+=++$%w.w==0?F:1;while(D<=P)}_makeBoxes(d,m,g,w){const I=d%g,P=m%w,F=d-I,$=m-P,D=[];for(let U=0;U<m;U+=w)for(let Z=0;Z<d;Z+=g)D.push({x:Z,y:U,w:Z===F?I:g,h:U===$?P:w});return D}},ColorHistogram$1=_ColorHistogram$1;__publicField$3(ColorHistogram$1,"_boxSize",[64,64]),__publicField$3(ColorHistogram$1,"_boxPixels",2),__publicField$3(ColorHistogram$1,"_hueGroups",10);var RemovedColor$1=class{constructor(d,m,g){__publicField$3(this,"index"),__publicField$3(this,"color"),__publicField$3(this,"distance"),this.index=d,this.color=m,this.distance=g}},RGBQuant$1=class extends AbstractPaletteQuantizer$1{constructor(d,m=256,g=2){super(),__publicField$3(this,"_colors"),__publicField$3(this,"_initialDistance"),__publicField$3(this,"_distanceIncrement"),__publicField$3(this,"_histogram"),__publicField$3(this,"_distance"),this._distance=d,this._colors=m,this._histogram=new ColorHistogram$1(g,m),this._initialDistance=.01,this._distanceIncrement=.005}sample(d){this._histogram.sample(d)}*quantize(){const d=this._histogram.getImportanceSortedColorsIDXI32();if(d.length===0)throw new Error("No colors in image");yield*this._buildPalette(d)}*_buildPalette(d){const m=new Palette$1,g=m.getPointContainer().getPointArray(),w=new Array(d.length);for(let Z=0;Z<d.length;Z++)g.push(Point$1.createByUint32(d[Z])),w[Z]=1;const I=g.length,P=[];let F=I,$=this._initialDistance;const D=new ProgressTracker$1(F-this._colors,99);for(;F>this._colors;){P.length=0;for(let Z=0;Z<I;Z++){if(D.shouldNotify(I-F)&&(yield{progress:D.progress}),w[Z]===0)continue;const j=g[Z];for(let G=Z+1;G<I;G++){if(w[G]===0)continue;const H=g[G],W=this._distance.calculateNormalized(j,H);W<$&&(P.push(new RemovedColor$1(G,H,W)),w[G]=0,F--)}}$+=F>3*this._colors?this._initialDistance:this._distanceIncrement}if(F<this._colors){stableSort$1(P,(j,G)=>G.distance-j.distance);let Z=0;for(;F<this._colors&&Z<P.length;)w[P[Z].index]=1,F++,Z++}let U=g.length;for(let Z=U-1;Z>=0;Z--)w[Z]===0&&(Z!==U-1&&(g[Z]=g[U-1]),--U);g.length=U,m.sort(),yield{palette:m,progress:100}}};function createArray1D$1(d){const m=[];for(let g=0;g<d;g++)m[g]=0;return m}function createArray4D$1(d,m,g,w){const I=new Array(d);for(let P=0;P<d;P++){I[P]=new Array(m);for(let F=0;F<m;F++){I[P][F]=new Array(g);for(let $=0;$<g;$++){I[P][F][$]=new Array(w);for(let D=0;D<w;D++)I[P][F][$][D]=0}}}return I}function createArray3D$1(d,m,g){const w=new Array(d);for(let I=0;I<d;I++){w[I]=new Array(m);for(let P=0;P<m;P++){w[I][P]=new Array(g);for(let F=0;F<g;F++)w[I][P][F]=0}}return w}function fillArray3D$1(d,m,g,w,I){for(let P=0;P<m;P++){d[P]=[];for(let F=0;F<g;F++){d[P][F]=[];for(let $=0;$<w;$++)d[P][F][$]=I}}}function fillArray1D$1(d,m,g){for(let w=0;w<m;w++)d[w]=g}var WuColorCube$1=class{constructor(){__publicField$3(this,"redMinimum"),__publicField$3(this,"redMaximum"),__publicField$3(this,"greenMinimum"),__publicField$3(this,"greenMaximum"),__publicField$3(this,"blueMinimum"),__publicField$3(this,"blueMaximum"),__publicField$3(this,"volume"),__publicField$3(this,"alphaMinimum"),__publicField$3(this,"alphaMaximum")}},_WuQuant$1=class extends AbstractPaletteQuantizer$1{constructor(d,m=256,g=5){super(),__publicField$3(this,"_reds"),__publicField$3(this,"_greens"),__publicField$3(this,"_blues"),__publicField$3(this,"_alphas"),__publicField$3(this,"_sums"),__publicField$3(this,"_weights"),__publicField$3(this,"_momentsRed"),__publicField$3(this,"_momentsGreen"),__publicField$3(this,"_momentsBlue"),__publicField$3(this,"_momentsAlpha"),__publicField$3(this,"_moments"),__publicField$3(this,"_table"),__publicField$3(this,"_pixels"),__publicField$3(this,"_cubes"),__publicField$3(this,"_colors"),__publicField$3(this,"_significantBitsPerChannel"),__publicField$3(this,"_maxSideIndex"),__publicField$3(this,"_alphaMaxSideIndex"),__publicField$3(this,"_sideSize"),__publicField$3(this,"_alphaSideSize"),__publicField$3(this,"_distance"),this._distance=d,this._setQuality(g),this._initialize(m)}sample(d){const m=d.getPointArray();for(let g=0,w=m.length;g<w;g++)this._addColor(m[g]);this._pixels=this._pixels.concat(m)}*quantize(){yield*this._preparePalette();const d=new Palette$1;for(let m=0;m<this._colors;m++)if(this._sums[m]>0){const g=this._sums[m],w=this._reds[m]/g,I=this._greens[m]/g,P=this._blues[m]/g,F=this._alphas[m]/g,$=Point$1.createByRGBA(0|w,0|I,0|P,0|F);d.add($)}d.sort(),yield{palette:d,progress:100}}*_preparePalette(){yield*this._calculateMoments();let d=0;const m=createArray1D$1(this._colors);for(let F=1;F<this._colors;++F){this._cut(this._cubes[d],this._cubes[F])?(m[d]=this._cubes[d].volume>1?this._calculateVariance(this._cubes[d]):0,m[F]=this._cubes[F].volume>1?this._calculateVariance(this._cubes[F]):0):(m[d]=0,F--),d=0;let $=m[0];for(let D=1;D<=F;++D)m[D]>$&&($=m[D],d=D);if($<=0){this._colors=F+1;break}}const g=[],w=[],I=[],P=[];for(let F=0;F<this._colors;++F){const $=_WuQuant$1._volume(this._cubes[F],this._weights);$>0?(g[F]=_WuQuant$1._volume(this._cubes[F],this._momentsRed)/$|0,w[F]=_WuQuant$1._volume(this._cubes[F],this._momentsGreen)/$|0,I[F]=_WuQuant$1._volume(this._cubes[F],this._momentsBlue)/$|0,P[F]=_WuQuant$1._volume(this._cubes[F],this._momentsAlpha)/$|0):(g[F]=0,w[F]=0,I[F]=0,P[F]=0)}this._reds=createArray1D$1(this._colors+1),this._greens=createArray1D$1(this._colors+1),this._blues=createArray1D$1(this._colors+1),this._alphas=createArray1D$1(this._colors+1),this._sums=createArray1D$1(this._colors+1);for(let F=0,$=this._pixels.length;F<$;F++){const D=this._pixels[F];let U=-1,Z=Number.MAX_VALUE;for(let j=0;j<this._colors;j++){const G=g[j],H=w[j],W=I[j],Q=P[j],q=this._distance.calculateRaw(G,H,W,Q,D.r,D.g,D.b,D.a);q<Z&&(Z=q,U=j)}this._reds[U]+=D.r,this._greens[U]+=D.g,this._blues[U]+=D.b,this._alphas[U]+=D.a,this._sums[U]++}}_addColor(d){const m=8-this._significantBitsPerChannel,g=1+(d.r>>m),w=1+(d.g>>m),I=1+(d.b>>m),P=1+(d.a>>m);this._weights[P][g][w][I]++,this._momentsRed[P][g][w][I]+=d.r,this._momentsGreen[P][g][w][I]+=d.g,this._momentsBlue[P][g][w][I]+=d.b,this._momentsAlpha[P][g][w][I]+=d.a,this._moments[P][g][w][I]+=this._table[d.r]+this._table[d.g]+this._table[d.b]+this._table[d.a]}*_calculateMoments(){const d=[],m=[],g=[],w=[],I=[],P=[],F=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),$=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),D=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),U=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),Z=createArray3D$1(this._sideSize,this._sideSize,this._sideSize),j=createArray3D$1(this._sideSize,this._sideSize,this._sideSize);let G=0;const H=new ProgressTracker$1(this._alphaMaxSideIndex*this._maxSideIndex,99);for(let W=1;W<=this._alphaMaxSideIndex;++W){fillArray3D$1(F,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1($,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1(D,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1(U,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1(Z,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D$1(j,this._sideSize,this._sideSize,this._sideSize,0);for(let Q=1;Q<=this._maxSideIndex;++Q,++G){H.shouldNotify(G)&&(yield{progress:H.progress}),fillArray1D$1(d,this._sideSize,0),fillArray1D$1(m,this._sideSize,0),fillArray1D$1(g,this._sideSize,0),fillArray1D$1(w,this._sideSize,0),fillArray1D$1(I,this._sideSize,0),fillArray1D$1(P,this._sideSize,0);for(let q=1;q<=this._maxSideIndex;++q){let rt=0,it=0,X=0,J=0,tt=0,ot=0;for(let nt=1;nt<=this._maxSideIndex;++nt)rt+=this._weights[W][Q][q][nt],it+=this._momentsRed[W][Q][q][nt],X+=this._momentsGreen[W][Q][q][nt],J+=this._momentsBlue[W][Q][q][nt],tt+=this._momentsAlpha[W][Q][q][nt],ot+=this._moments[W][Q][q][nt],d[nt]+=rt,m[nt]+=it,g[nt]+=X,w[nt]+=J,I[nt]+=tt,P[nt]+=ot,F[Q][q][nt]=F[Q-1][q][nt]+d[nt],$[Q][q][nt]=$[Q-1][q][nt]+m[nt],D[Q][q][nt]=D[Q-1][q][nt]+g[nt],U[Q][q][nt]=U[Q-1][q][nt]+w[nt],Z[Q][q][nt]=Z[Q-1][q][nt]+I[nt],j[Q][q][nt]=j[Q-1][q][nt]+P[nt],this._weights[W][Q][q][nt]=this._weights[W-1][Q][q][nt]+F[Q][q][nt],this._momentsRed[W][Q][q][nt]=this._momentsRed[W-1][Q][q][nt]+$[Q][q][nt],this._momentsGreen[W][Q][q][nt]=this._momentsGreen[W-1][Q][q][nt]+D[Q][q][nt],this._momentsBlue[W][Q][q][nt]=this._momentsBlue[W-1][Q][q][nt]+U[Q][q][nt],this._momentsAlpha[W][Q][q][nt]=this._momentsAlpha[W-1][Q][q][nt]+Z[Q][q][nt],this._moments[W][Q][q][nt]=this._moments[W-1][Q][q][nt]+j[Q][q][nt]}}}}static _volumeFloat(d,m){return m[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMaximum]-m[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMaximum]-m[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMaximum]+m[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]-m[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMaximum]+m[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]+m[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-m[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(m[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMinimum]-m[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]-m[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+m[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]-m[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]+m[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]+m[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]-m[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum])}static _volume(d,m){return 0|_WuQuant$1._volumeFloat(d,m)}static _top(d,m,g,w){let I;switch(m){case _WuQuant$1._alpha:I=w[g][d.redMaximum][d.greenMaximum][d.blueMaximum]-w[g][d.redMaximum][d.greenMinimum][d.blueMaximum]-w[g][d.redMinimum][d.greenMaximum][d.blueMaximum]+w[g][d.redMinimum][d.greenMinimum][d.blueMaximum]-(w[g][d.redMaximum][d.greenMaximum][d.blueMinimum]-w[g][d.redMaximum][d.greenMinimum][d.blueMinimum]-w[g][d.redMinimum][d.greenMaximum][d.blueMinimum]+w[g][d.redMinimum][d.greenMinimum][d.blueMinimum]);break;case _WuQuant$1._red:I=w[d.alphaMaximum][g][d.greenMaximum][d.blueMaximum]-w[d.alphaMaximum][g][d.greenMinimum][d.blueMaximum]-w[d.alphaMinimum][g][d.greenMaximum][d.blueMaximum]+w[d.alphaMinimum][g][d.greenMinimum][d.blueMaximum]-(w[d.alphaMaximum][g][d.greenMaximum][d.blueMinimum]-w[d.alphaMaximum][g][d.greenMinimum][d.blueMinimum]-w[d.alphaMinimum][g][d.greenMaximum][d.blueMinimum]+w[d.alphaMinimum][g][d.greenMinimum][d.blueMinimum]);break;case _WuQuant$1._green:I=w[d.alphaMaximum][d.redMaximum][g][d.blueMaximum]-w[d.alphaMaximum][d.redMinimum][g][d.blueMaximum]-w[d.alphaMinimum][d.redMaximum][g][d.blueMaximum]+w[d.alphaMinimum][d.redMinimum][g][d.blueMaximum]-(w[d.alphaMaximum][d.redMaximum][g][d.blueMinimum]-w[d.alphaMaximum][d.redMinimum][g][d.blueMinimum]-w[d.alphaMinimum][d.redMaximum][g][d.blueMinimum]+w[d.alphaMinimum][d.redMinimum][g][d.blueMinimum]);break;case _WuQuant$1._blue:I=w[d.alphaMaximum][d.redMaximum][d.greenMaximum][g]-w[d.alphaMaximum][d.redMaximum][d.greenMinimum][g]-w[d.alphaMaximum][d.redMinimum][d.greenMaximum][g]+w[d.alphaMaximum][d.redMinimum][d.greenMinimum][g]-(w[d.alphaMinimum][d.redMaximum][d.greenMaximum][g]-w[d.alphaMinimum][d.redMaximum][d.greenMinimum][g]-w[d.alphaMinimum][d.redMinimum][d.greenMaximum][g]+w[d.alphaMinimum][d.redMinimum][d.greenMinimum][g]);break;default:throw new Error("impossible")}return 0|I}static _bottom(d,m,g){switch(m){case _WuQuant$1._alpha:return-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMaximum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant$1._red:return-g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMaximum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant$1._green:return-g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMaximum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant$1._blue:return-g[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]-(-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);default:return 0}}_calculateVariance(d){const m=_WuQuant$1._volume(d,this._momentsRed),g=_WuQuant$1._volume(d,this._momentsGreen),w=_WuQuant$1._volume(d,this._momentsBlue),I=_WuQuant$1._volume(d,this._momentsAlpha);return _WuQuant$1._volumeFloat(d,this._moments)-(m*m+g*g+w*w+I*I)/_WuQuant$1._volume(d,this._weights)}_maximize(d,m,g,w,I,P,F,$,D){const U=0|_WuQuant$1._bottom(d,m,this._momentsRed),Z=0|_WuQuant$1._bottom(d,m,this._momentsGreen),j=0|_WuQuant$1._bottom(d,m,this._momentsBlue),G=0|_WuQuant$1._bottom(d,m,this._momentsAlpha),H=0|_WuQuant$1._bottom(d,m,this._weights);let W=0,Q=-1;for(let q=g;q<w;++q){let rt=U+_WuQuant$1._top(d,m,q,this._momentsRed),it=Z+_WuQuant$1._top(d,m,q,this._momentsGreen),X=j+_WuQuant$1._top(d,m,q,this._momentsBlue),J=G+_WuQuant$1._top(d,m,q,this._momentsAlpha),tt=H+_WuQuant$1._top(d,m,q,this._weights);if(tt!==0){let ot=rt*rt+it*it+X*X+J*J,nt=ot/tt;rt=I-rt,it=P-it,X=F-X,J=$-J,tt=D-tt,tt!==0&&(ot=rt*rt+it*it+X*X+J*J,nt+=ot/tt,nt>W&&(W=nt,Q=q))}}return{max:W,position:Q}}_cut(d,m){let g;const w=_WuQuant$1._volume(d,this._momentsRed),I=_WuQuant$1._volume(d,this._momentsGreen),P=_WuQuant$1._volume(d,this._momentsBlue),F=_WuQuant$1._volume(d,this._momentsAlpha),$=_WuQuant$1._volume(d,this._weights),D=this._maximize(d,_WuQuant$1._red,d.redMinimum+1,d.redMaximum,w,I,P,F,$),U=this._maximize(d,_WuQuant$1._green,d.greenMinimum+1,d.greenMaximum,w,I,P,F,$),Z=this._maximize(d,_WuQuant$1._blue,d.blueMinimum+1,d.blueMaximum,w,I,P,F,$),j=this._maximize(d,_WuQuant$1._alpha,d.alphaMinimum+1,d.alphaMaximum,w,I,P,F,$);if(j.max>=D.max&&j.max>=U.max&&j.max>=Z.max){if(g=_WuQuant$1._alpha,j.position<0)return!1}else g=D.max>=j.max&&D.max>=U.max&&D.max>=Z.max?_WuQuant$1._red:U.max>=j.max&&U.max>=D.max&&U.max>=Z.max?_WuQuant$1._green:_WuQuant$1._blue;switch(m.redMaximum=d.redMaximum,m.greenMaximum=d.greenMaximum,m.blueMaximum=d.blueMaximum,m.alphaMaximum=d.alphaMaximum,g){case _WuQuant$1._red:m.redMinimum=d.redMaximum=D.position,m.greenMinimum=d.greenMinimum,m.blueMinimum=d.blueMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant$1._green:m.greenMinimum=d.greenMaximum=U.position,m.redMinimum=d.redMinimum,m.blueMinimum=d.blueMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant$1._blue:m.blueMinimum=d.blueMaximum=Z.position,m.redMinimum=d.redMinimum,m.greenMinimum=d.greenMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant$1._alpha:m.alphaMinimum=d.alphaMaximum=j.position,m.blueMinimum=d.blueMinimum,m.redMinimum=d.redMinimum,m.greenMinimum=d.greenMinimum}return d.volume=(d.redMaximum-d.redMinimum)*(d.greenMaximum-d.greenMinimum)*(d.blueMaximum-d.blueMinimum)*(d.alphaMaximum-d.alphaMinimum),m.volume=(m.redMaximum-m.redMinimum)*(m.greenMaximum-m.greenMinimum)*(m.blueMaximum-m.blueMinimum)*(m.alphaMaximum-m.alphaMinimum),!0}_initialize(d){this._colors=d,this._cubes=[];for(let m=0;m<d;m++)this._cubes[m]=new WuColorCube$1;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=createArray4D$1(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(let m=0;m<256;++m)this._table[m]=m*m;this._pixels=[]}_setQuality(d=5){this._significantBitsPerChannel=d,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1}},WuQuant$1=_WuQuant$1;__publicField$3(WuQuant$1,"_alpha",3),__publicField$3(WuQuant$1,"_red",2),__publicField$3(WuQuant$1,"_green",1),__publicField$3(WuQuant$1,"_blue",0);var image_exports$1={};__export$1(image_exports$1,{AbstractImageQuantizer:()=>AbstractImageQuantizer$1,ErrorDiffusionArray:()=>ErrorDiffusionArray$1,ErrorDiffusionArrayKernel:()=>ErrorDiffusionArrayKernel$1,ErrorDiffusionRiemersma:()=>ErrorDiffusionRiemersma$1,NearestColor:()=>NearestColor$1});var AbstractImageQuantizer$1=class{quantizeSync(d,m){for(const g of this.quantize(d,m))if(g.pointContainer)return g.pointContainer;throw new Error("unreachable")}},NearestColor$1=class extends AbstractImageQuantizer$1{constructor(d){super(),__publicField$3(this,"_distance"),this._distance=d}*quantize(d,m){const g=d.getPointArray(),w=d.getWidth(),I=d.getHeight(),P=new ProgressTracker$1(I,99);for(let F=0;F<I;F++){P.shouldNotify(F)&&(yield{progress:P.progress});for(let $=0,D=F*w;$<w;$++,D++){const U=g[D];U.from(m.getNearestColor(this._distance,U))}}yield{pointContainer:d,progress:100}}},ErrorDiffusionArrayKernel$1=(d=>(d[d.FloydSteinberg=0]="FloydSteinberg",d[d.FalseFloydSteinberg=1]="FalseFloydSteinberg",d[d.Stucki=2]="Stucki",d[d.Atkinson=3]="Atkinson",d[d.Jarvis=4]="Jarvis",d[d.Burkes=5]="Burkes",d[d.Sierra=6]="Sierra",d[d.TwoSierra=7]="TwoSierra",d[d.SierraLite=8]="SierraLite",d))(ErrorDiffusionArrayKernel$1||{}),ErrorDiffusionArray$1=class extends AbstractImageQuantizer$1{constructor(d,m,g=!0,w=0,I=!1){super(),__publicField$3(this,"_minColorDistance"),__publicField$3(this,"_serpentine"),__publicField$3(this,"_kernel"),__publicField$3(this,"_calculateErrorLikeGIMP"),__publicField$3(this,"_distance"),this._setKernel(m),this._distance=d,this._minColorDistance=w,this._serpentine=g,this._calculateErrorLikeGIMP=I}*quantize(d,m){const g=d.getPointArray(),w=new Point$1,I=d.getWidth(),P=d.getHeight(),F=[];let $=1,D=1;for(const Z of this._kernel){const j=Z[2]+1;D<j&&(D=j)}for(let Z=0;Z<D;Z++)this._fillErrorLine(F[Z]=[],I);const U=new ProgressTracker$1(P,99);for(let Z=0;Z<P;Z++){U.shouldNotify(Z)&&(yield{progress:U.progress}),this._serpentine&&($*=-1);const j=Z*I,G=$===1?0:I-1,H=$===1?I:-1;this._fillErrorLine(F[0],I),F.push(F.shift());const W=F[0];for(let Q=G,q=j+G;Q!==H;Q+=$,q+=$){const rt=g[q],it=W[Q];w.from(rt);const X=Point$1.createByRGBA(inRange0to255Rounded$1(rt.r+it[0]),inRange0to255Rounded$1(rt.g+it[1]),inRange0to255Rounded$1(rt.b+it[2]),inRange0to255Rounded$1(rt.a+it[3])),J=m.getNearestColor(this._distance,X);if(rt.from(J),this._minColorDistance&&this._distance.calculateNormalized(w,J)<this._minColorDistance)continue;let tt,ot,nt,lt;this._calculateErrorLikeGIMP?(tt=X.r-J.r,ot=X.g-J.g,nt=X.b-J.b,lt=X.a-J.a):(tt=w.r-J.r,ot=w.g-J.g,nt=w.b-J.b,lt=w.a-J.a);const at=$===1?0:this._kernel.length-1,ut=$===1?this._kernel.length:-1;for(let V=at;V!==ut;V+=$){const ht=this._kernel[V][1]*$,vt=this._kernel[V][2];if(ht+Q>=0&&ht+Q<I&&vt+Z>=0&&vt+Z<P){const pt=this._kernel[V][0],st=F[vt][ht+Q];st[0]+=tt*pt,st[1]+=ot*pt,st[2]+=nt*pt,st[3]+=lt*pt}}}}yield{pointContainer:d,progress:100}}_fillErrorLine(d,m){d.length>m&&(d.length=m);const g=d.length;for(let w=0;w<g;w++){const I=d[w];I[0]=I[1]=I[2]=I[3]=0}for(let w=g;w<m;w++)d[w]=[0,0,0,0]}_setKernel(d){switch(d){case 0:this._kernel=[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]];break;case 1:this._kernel=[[3/8,1,0],[3/8,0,1],[2/8,1,1]];break;case 2:this._kernel=[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]];break;case 3:this._kernel=[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]];break;case 4:this._kernel=[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]];break;case 5:this._kernel=[[.25,1,0],[4/32,2,0],[2/32,-2,1],[4/32,-1,1],[.25,0,1],[4/32,1,1],[2/32,2,1]];break;case 6:this._kernel=[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[4/32,-1,1],[5/32,0,1],[4/32,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]];break;case 7:this._kernel=[[.25,1,0],[3/16,2,0],[1/16,-2,1],[2/16,-1,1],[3/16,0,1],[2/16,1,1],[1/16,2,1]];break;case 8:this._kernel=[[.5,1,0],[1/4,-1,1],[1/4,0,1]];break;default:throw new Error(`ErrorDiffusionArray: unknown kernel = ${d}`)}}};function*hilbertCurve$1(d,m,g){const w=Math.max(d,m),I={width:d,height:m,level:Math.floor(Math.log(w)/Math.log(2)+1),callback:g,tracker:new ProgressTracker$1(d*m,99),index:0,x:0,y:0};yield*walkHilbert$1(I,1),visit$1(I,0)}function*walkHilbert$1(d,m){if(!(d.level<1)){switch(d.tracker.shouldNotify(d.index)&&(yield{progress:d.tracker.progress}),d.level--,m){case 2:yield*walkHilbert$1(d,1),visit$1(d,3),yield*walkHilbert$1(d,2),visit$1(d,4),yield*walkHilbert$1(d,2),visit$1(d,2),yield*walkHilbert$1(d,4);break;case 3:yield*walkHilbert$1(d,4),visit$1(d,2),yield*walkHilbert$1(d,3),visit$1(d,1),yield*walkHilbert$1(d,3),visit$1(d,3),yield*walkHilbert$1(d,1);break;case 1:yield*walkHilbert$1(d,2),visit$1(d,4),yield*walkHilbert$1(d,1),visit$1(d,3),yield*walkHilbert$1(d,1),visit$1(d,1),yield*walkHilbert$1(d,3);break;case 4:yield*walkHilbert$1(d,3),visit$1(d,1),yield*walkHilbert$1(d,4),visit$1(d,2),yield*walkHilbert$1(d,4),visit$1(d,4),yield*walkHilbert$1(d,2)}d.level++}}function visit$1(d,m){switch(d.x>=0&&d.x<d.width&&d.y>=0&&d.y<d.height&&(d.callback(d.x,d.y),d.index++),m){case 2:d.x--;break;case 3:d.x++;break;case 1:d.y--;break;case 4:d.y++}}var ErrorDiffusionRiemersma$1=class extends AbstractImageQuantizer$1{constructor(d,m=16,g=1){super(),__publicField$3(this,"_distance"),__publicField$3(this,"_weights"),__publicField$3(this,"_errorQueueSize"),this._distance=d,this._errorQueueSize=m,this._weights=ErrorDiffusionRiemersma$1._createWeights(g,m)}*quantize(d,m){const g=d.getPointArray(),w=d.getWidth(),I=d.getHeight(),P=[];let F=0;for(let $=0;$<this._errorQueueSize;$++)P[$]={r:0,g:0,b:0,a:0};yield*hilbertCurve$1(w,I,($,D)=>{const U=g[$+D*w];let{r:Z,g:j,b:G,a:H}=U;for(let rt=0;rt<this._errorQueueSize;rt++){const it=this._weights[rt],X=P[(rt+F)%this._errorQueueSize];Z+=X.r*it,j+=X.g*it,G+=X.b*it,H+=X.a*it}const W=Point$1.createByRGBA(inRange0to255Rounded$1(Z),inRange0to255Rounded$1(j),inRange0to255Rounded$1(G),inRange0to255Rounded$1(H)),Q=m.getNearestColor(this._distance,W);F=(F+1)%this._errorQueueSize;const q=(F+this._errorQueueSize-1)%this._errorQueueSize;P[q].r=U.r-Q.r,P[q].g=U.g-Q.g,P[q].b=U.b-Q.b,P[q].a=U.a-Q.a,U.from(Q)}),yield{pointContainer:d,progress:100}}static _createWeights(d,m){const g=[],w=Math.exp(Math.log(m)/(m-1));for(let I=0,P=1;I<m;I++)g[I]=(P+.5|0)/m*d,P*=w;return g}},quality_exports$1={};__export$1(quality_exports$1,{ssim:()=>ssim$1});var K1$1=.01,K2$1=.03;function ssim$1(d,m){if(d.getHeight()!==m.getHeight()||d.getWidth()!==m.getWidth())throw new Error("Images have different sizes!");const g=(255*K1$1)**2,w=(255*K2$1)**2;let I=0,P=0;return iterate$1(d,m,(F,$,D,U)=>{let Z=0,j=0,G=0;for(let W=0;W<F.length;W++)j+=(F[W]-D)**2,G+=($[W]-U)**2,Z+=(F[W]-D)*($[W]-U);const H=F.length-1;j/=H,G/=H,Z/=H,P+=(2*D*U+g)*(2*Z+w)/((D**2+U**2+g)*(j+G+w)),I++}),P/I}function iterate$1(d,m,g){const w=d.getWidth(),I=d.getHeight();for(let P=0;P<I;P+=8)for(let F=0;F<w;F+=8){const $=Math.min(8,w-F),D=Math.min(8,I-P),U=calculateLumaValuesForWindow$1(d,F,P,$,D),Z=calculateLumaValuesForWindow$1(m,F,P,$,D);g(U,Z,calculateAverageLuma$1(U),calculateAverageLuma$1(Z))}}function calculateLumaValuesForWindow$1(d,m,g,w,I){const P=d.getPointArray(),F=[];let $=0;for(let D=g;D<g+I;D++){const U=D*d.getWidth();for(let Z=m;Z<m+w;Z++){const j=P[U+Z];F[$]=.2126*j.r+.7152*j.g+.0722*j.b,$++}}return F}function calculateAverageLuma$1(d){let m=0;for(const g of d)m+=g;return m/d.length}var setImmediateImpl=typeof setImmediate=="function"?setImmediate:typeof process<"u"&&typeof(process==null?void 0:process.nextTick)=="function"?d=>process.nextTick(d):d=>setTimeout(d,0);function buildPaletteSync$1(d,{colorDistanceFormula:m,paletteQuantization:g,colors:w}={}){const I=paletteQuantizationToPaletteQuantizer$1(colorDistanceFormulaToColorDistance$1(m),g,w);return d.forEach(P=>I.sample(P)),I.quantizeSync()}async function buildPalette(d,{colorDistanceFormula:m,paletteQuantization:g,colors:w,onProgress:I}={}){return new Promise((P,F)=>{const $=paletteQuantizationToPaletteQuantizer$1(colorDistanceFormulaToColorDistance$1(m),g,w);let D;d.forEach(j=>$.sample(j));const U=$.quantize(),Z=()=>{try{const j=U.next();j.done?P(D):(j.value.palette&&(D=j.value.palette),I&&I(j.value.progress),setImmediateImpl(Z))}catch(j){F(j)}};setImmediateImpl(Z)})}function applyPaletteSync$1(d,m,{colorDistanceFormula:g,imageQuantization:w}={}){return imageQuantizationToImageQuantizer$1(colorDistanceFormulaToColorDistance$1(g),w).quantizeSync(d,m)}async function applyPalette(d,m,{colorDistanceFormula:g,imageQuantization:w,onProgress:I}={}){return new Promise((P,F)=>{let $;const D=imageQuantizationToImageQuantizer$1(colorDistanceFormulaToColorDistance$1(g),w).quantize(d,m),U=()=>{try{const Z=D.next();Z.done?P($):(Z.value.pointContainer&&($=Z.value.pointContainer),I&&I(Z.value.progress),setImmediateImpl(U))}catch(Z){F(Z)}};setImmediateImpl(U)})}function colorDistanceFormulaToColorDistance$1(d="euclidean-bt709"){switch(d){case"cie94-graphic-arts":return new CIE94GraphicArts$1;case"cie94-textiles":return new CIE94Textiles$1;case"ciede2000":return new CIEDE2000$1;case"color-metric":return new CMetric$1;case"euclidean":return new Euclidean$1;case"euclidean-bt709":return new EuclideanBT709$1;case"euclidean-bt709-noalpha":return new EuclideanBT709NoAlpha$1;case"manhattan":return new Manhattan$1;case"manhattan-bt709":return new ManhattanBT709$1;case"manhattan-nommyde":return new ManhattanNommyde$1;case"pngquant":return new PNGQuant$1;default:throw new Error(`Unknown colorDistanceFormula ${d}`)}}function imageQuantizationToImageQuantizer$1(d,m="floyd-steinberg"){switch(m){case"nearest":return new NearestColor$1(d);case"riemersma":return new ErrorDiffusionRiemersma$1(d);case"floyd-steinberg":return new ErrorDiffusionArray$1(d,0);case"false-floyd-steinberg":return new ErrorDiffusionArray$1(d,1);case"stucki":return new ErrorDiffusionArray$1(d,2);case"atkinson":return new ErrorDiffusionArray$1(d,3);case"jarvis":return new ErrorDiffusionArray$1(d,4);case"burkes":return new ErrorDiffusionArray$1(d,5);case"sierra":return new ErrorDiffusionArray$1(d,6);case"two-sierra":return new ErrorDiffusionArray$1(d,7);case"sierra-lite":return new ErrorDiffusionArray$1(d,8);default:throw new Error(`Unknown imageQuantization ${m}`)}}function paletteQuantizationToPaletteQuantizer$1(d,m="wuquant",g=256){switch(m){case"neuquant":return new NeuQuant$1(d,g);case"rgbquant":return new RGBQuant$1(d,g);case"wuquant":return new WuQuant$1(d,g);case"neuquant-float":return new NeuQuantFloat$1(d,g);default:throw new Error(`Unknown paletteQuantization ${m}`)}}var imageQ=__toCommonJS(src_exports),gifframe={};const BitmapImage$1=bitmapimage;let GifFrame$1=class Ie extends BitmapImage$1{constructor(...m){if(super(...m),m[0]instanceof Ie){const g=m[0];this.xOffset=g.xOffset,this.yOffset=g.yOffset,this.disposalMethod=g.disposalMethod,this.delayCentisecs=g.delayCentisecs,this.interlaced=g.interlaced}else{const g=m[m.length-1];let w={};typeof g!="object"||g instanceof BitmapImage$1||(w=g),this.xOffset=w.xOffset||0,this.yOffset=w.yOffset||0,this.disposalMethod=w.disposalMethod!==void 0?w.disposalMethod:Ie.DisposeToBackgroundColor,this.delayCentisecs=w.delayCentisecs||8,this.interlaced=w.interlaced||!1}}getPalette(){const m=new Set,g=this.bitmap.data;let w=0,I=!1;for(;w<g.length;){if(g[w+3]===0)I=!0;else{const D=g.readUInt32BE(w,!0)>>8&16777215;m.add(D)}w+=4}const P=new Array(m.size),F=m.values();for(w=0;w<P.length;++w)P[w]=F.next().value;P.sort((D,U)=>D-U);let $=P.length;return I&&++$,{colors:P,usesTransparency:I,indexCount:$}}};var hasRequiredGifutil,hasRequiredGifcodec;function requireGifutil(){return hasRequiredGifutil||(hasRequiredGifutil=1,function(d){const m=require$$0,g=imageQ,w=bitmapimage,{GifFrame:I}=gifframe,{GifError:P}=gif$1,{GifCodec:F}=requireGifcodec(),$=[".jpg",".jpeg",".png",".bmp"],D=new F;function U(Z,j,G,H,W){const Q=Array.isArray(Z)?Z:[Z];if(W){if(["FloydSteinberg","FalseFloydSteinberg","Stucki","Atkinson","Jarvis","Burkes","Sierra","TwoSierra","SierraLite"].indexOf(W.ditherAlgorithm)<0)throw new Error(`Invalid ditherAlgorithm '${W.ditherAlgorithm}'`);W.serpentine===void 0&&(W.serpentine=!0),W.minimumColorDistanceToDither===void 0&&(W.minimumColorDistanceToDither=0),W.calculateErrorLikeGIMP===void 0&&(W.calculateErrorLikeGIMP=!1)}const q=new g.distance.Euclidean,rt=new g.palette[j](q,G,H);let it;it=W?new g.image.ErrorDiffusionArray(q,g.image.ErrorDiffusionArrayKernel[W.ditherAlgorithm],W.serpentine,W.minimumColorDistanceToDither,W.calculateErrorLikeGIMP):new g.image.NearestColor(q);const X=[];Q.forEach(tt=>{const ot=tt.bitmap.data,nt=new ArrayBuffer(ot.length),lt=new Uint32Array(nt);for(let ut=0,V=0;ut<ot.length;ut+=4,++V)lt[V]=ot.readUInt32LE(ut,!0);const at=g.utils.PointContainer.fromUint32Array(lt,tt.bitmap.width,tt.bitmap.height);rt.sample(at),X.push(at)});const J=rt.quantizeSync();for(let tt=0;tt<Q.length;++tt){const ot=Q[tt].bitmap.data,nt=it.quantizeSync(X[tt],J).toUint32Array();for(let lt=0,at=0;lt<ot.length;lt+=4,++at)ot.writeUInt32LE(nt[at],lt)}}d.cloneFrames=function(Z){let j=[];return Z.forEach(G=>{j.push(new I(G))}),j},d.getColorInfo=function(Z,j){let G=!1;const H=[];for(let it=0;it<Z.length;++it){let X=Z[it].getPalette();if(X.usesTransparency&&(G=!0),X.indexCount>256)throw new P(`Frame ${it} uses more than 256 color indexes`);H.push(X)}if(j===0)return{usesTransparency:G,palettes:H};const W=new Set;H.forEach(it=>{it.colors.forEach(X=>{W.add(X)})});let Q=W.size;if(G&&++Q,j&&Q>j)return{usesTransparency:G,palettes:H};const q=new Array(W.size),rt=W.values();for(let it=0;it<q.length;++it)q[it]=rt.next().value;return q.sort((it,X)=>it-X),{colors:q,indexCount:Q,usesTransparency:G,palettes:H}},d.copyAsJimp=function(Z,j){return d.shareAsJimp(Z,new w(j))},d.getMaxDimensions=function(Z){let j=0,G=0;return Z.forEach(H=>{const W=H.xOffset+H.bitmap.width;W>j&&(j=W);const Q=H.yOffset+H.bitmap.height;Q>G&&(G=Q)}),{maxWidth:j,maxHeight:G}},d.quantizeDekker=function(Z,j,G){U(Z,"NeuQuantFloat",j=j||256,0,G)},d.quantizeSorokin=function(Z,j,G,H){let W;switch(j=j||256,G=G||"min-pop"){case"min-pop":W=2;break;case"top-pop":W=1;break;default:throw new Error(`Invalid quantizeSorokin histogram '${G}'`)}U(Z,"RGBQuant",j,W,H)},d.quantizeWu=function(Z,j,G,H){if(j=j||256,(G=G||5)<1||G>8)throw new Error("Invalid quantization quality");U(Z,"WuQuant",j,G,H)},d.read=function(Z,j){return j=j||D,Buffer.isBuffer(Z)?j.decodeGif(Z):function(G){return new Promise((H,W)=>{m.readFile(G,(Q,q)=>Q?W(Q):H(q))})}(Z).then(G=>j.decodeGif(G))},d.shareAsJimp=function(Z,j){const G=new Z(j.bitmap.width,j.bitmap.height,0);return G.bitmap.data=j.bitmap.data,G},d.write=function(Z,j,G,H){H=H||D;const W=Z.match(/\.[a-zA-Z]+$/);if(W!==null&&$.includes(W[0].toLowerCase()))throw new Error(`GIF '${Z}' has an unexpected suffix`);return H.encodeGif(j,G).then(Q=>function(q,rt){return new Promise((it,X)=>{m.writeFile(q,rt,J=>J?X(J):it())})}(Z,Q.buffer).then(()=>Q))}}(gifutil)),gifutil}function requireGifcodec(){if(hasRequiredGifcodec)return gifcodec;hasRequiredGifcodec=1;const d=omggif,{Gif:m,GifError:g}=gif$1;function w(){const j=requireGifutil();return w=function(){return j},j}const{GifFrame:I}=gifframe;function P(j,G){const H=j.indexOf(G);return H===-1?null:H}function F(j,G){for(var H,W=0,Q=j.length-1;W<=Q;)if(j[H=Math.floor((W+Q)/2)]>G)Q=H-1;else{if(!(j[H]<G))return H;W=H+1}return null}function $(j){const G=j.colors;j.usesTransparency&&G.push(0);const H=G.length;let W=2;for(;H>W;)W<<=1;G.length=W,G.fill(0,H)}function D(j,G){let H=j.bitmap.width*j.bitmap.height;return H=Math.ceil(H*G/8),H+=Math.ceil(H/255),100+H+768}function U(j){let G=j.indexCount,H=0;for(--G;G;)++H,G>>=1;return H>0?H:1}function Z(j,G,H,W,Q){if(H.interlaced)throw new g("writing interlaced GIFs is not supported");const q=function(it,X,J){const tt=J.colors,ot=tt.length<=8?P:F,nt=X.bitmap.data,lt=new Buffer(nt.length/4);let at=tt.length,ut=0,V=0;for(;ut<nt.length;){if(nt[ut+3]!==0){const ht=nt.readUInt32BE(ut,!0)>>8&16777215;lt[V]=ot(tt,ht)}else lt[V]=at;ut+=4,++V}if(J.usesTransparency){if(at===256)throw new g(`Frame ${it} already has 256 colorsand so can't use transparency`)}else at=null;return{buffer:lt,transparentIndex:at}}(G,H,W),rt={delay:H.delayCentisecs,disposal:H.disposalMethod,transparent:q.transparentIndex};Q&&($(W),rt.palette=W.colors);try{let it,X=j.getOutputBuffer(),J=j.getOutputBufferPosition(),tt=!0;for(;tt;)if(it=j.addFrame(H.xOffset,H.yOffset,H.bitmap.width,H.bitmap.height,q.buffer,rt),tt=!1,it>=X.length-1){const ot=new Buffer(1.5*X.length);X.copy(ot),j.setOutputBuffer(ot),j.setOutputBufferPosition(J),X=ot,tt=!0}return X}catch(it){throw new g(it)}}return gifcodec.GifCodec=class{constructor(j={}){this._transparentRGB=null,typeof j.transparentRGB=="number"&&j.transparentRGB!==0&&(this._transparentRGBA=256*j.transparentRGB),this._testInitialBufferSize=0}decodeGif(j){try{let G;try{G=new d.GifReader(j)}catch(q){throw new g(q)}const H=G.numFrames(),W=[],Q={width:G.width,height:G.height,loops:G.loopCount(),usesTransparency:!1};for(let q=0;q<H;++q){const rt=this._decodeFrame(G,q,Q.usesTransparency);W.push(rt.frame),rt.usesTransparency&&(Q.usesTransparency=!0)}return Promise.resolve(new m(j,W,Q))}catch(G){return Promise.reject(G)}}encodeGif(j,G={}){try{if(j===null||j.length===0)throw new g("there are no frames");const H=w().getMaxDimensions(j);return(G=Object.assign({},G)).width=H.maxWidth,G.height=H.maxHeight,G.loops===void 0&&(G.loops=0),G.colorScope=G.colorScope||m.GlobalColorsPreferred,Promise.resolve(this._encodeGif(j,G))}catch(H){return Promise.reject(H)}}_decodeFrame(j,G,H){let W,Q;try{if(W=j.frameInfo(G),Q=new Buffer(j.width*j.height*4),j.decodeAndBlitFrameRGBA(G,Q),W.width!==j.width||W.height!==j.height){if(W.y&&(Q=Q.slice(W.y*j.width*4)),j.width>W.width)for(let rt=0;rt<W.height;++rt)Q.copy(Q,rt*W.width*4,4*(W.x+rt*j.width),4*(W.x+rt*j.width)+4*W.width);Q=Q.slice(0,W.width*W.height*4)}}catch(rt){throw new g(rt)}let q=!1;if(this._transparentRGBA===null){if(!H)for(let rt=3;rt<Q.length;rt+=4)Q[rt]===0&&(q=!0,rt=Q.length)}else for(let rt=3;rt<Q.length;rt+=4)Q[rt]===0&&(Q.writeUInt32BE(this._transparentRGBA,rt-3),q=!0);return{frame:new I(W.width,W.height,Q,{xOffset:W.x,yOffset:W.y,disposalMethod:W.disposal,interlaced:W.interlaced,delayCentisecs:W.delay}),usesTransparency:q}}_encodeGif(j,G){let H;if(G.colorScope===m.LocalColorsOnly)H=w().getColorInfo(j,0);else if(H=w().getColorInfo(j,256),!H.colors){if(G.colorScope===m.GlobalColorsOnly)throw new g("Too many color indexes for global color table");G.colorScope=m.LocalColorsOnly}G.usesTransparency=H.usesTransparency;const W=H.palettes;return G.colorScope===m.LocalColorsOnly?function(Q,q,rt,it){const X={loop:q.loops};let J,tt=new Buffer(rt);try{J=new d.GifWriter(tt,q.width,q.height,X)}catch(ot){throw new g(ot)}for(let ot=0;ot<Q.length;++ot)tt=Z(J,ot,Q[ot],it[ot],!0);return new m(tt.slice(0,J.end()),Q,q)}(j,G,2e3,W):function(Q,q,rt,it){const X={colors:it.colors.slice(),usesTransparency:it.usesTransparency};$(X);const J={palette:X.colors,loop:q.loops};let tt,ot=new Buffer(rt);try{tt=new d.GifWriter(ot,q.width,q.height,J)}catch(nt){throw new g(nt)}for(let nt=0;nt<Q.length;++nt)ot=Z(tt,nt,Q[nt],it,!1);return new m(ot.slice(0,tt.end()),Q,q)}(j,G,2e3,H)}_getSizeEstimateGlobal(j,G){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;let H=968;const W=U(j);return G.forEach(Q=>{H+=D(Q,W)}),H}_getSizeEstimateLocal(j,G){if(this._testInitialBufferSize>0)return this._testInitialBufferSize;let H=200;for(let W=0;W<G.length;++W){const Q=U(j[W]);H+=D(G[W],Q)}return H}},gifcodec}GifFrame$1.DisposeToAnything=0,GifFrame$1.DisposeNothing=1,GifFrame$1.DisposeToBackgroundColor=2,GifFrame$1.DisposeToPrevious=3,gifframe.GifFrame=GifFrame$1;const BitmapImage=bitmapimage,{GifCodec}=requireGifcodec(),{GifFrame}=gifframe,GifUtil=requireGifutil();var src={BitmapImage,GifCodec,GifFrame,GifUtil};function gif(){return{mime:"image/gif",encode:async d=>{const m=new src.BitmapImage(d);src.GifUtil.quantizeDekker(m,256);const g=new src.GifFrame(d);return(await new src.GifCodec().encodeGif([g],{})).buffer},decode:d=>{const m=new omggif.GifReader(d),g=Buffer.alloc(m.width*m.height*4);return m.decodeAndBlitFrameRGBA(0,g),{data:g,width:m.width,height:m.height}}}}var encoder={exports:{}};(function(d){function m(g){var w,I,P,F,$,D=Math.floor,U=new Array(64),Z=new Array(64),j=new Array(64),G=new Array(64),H=new Array(65535),W=new Array(65535),Q=new Array(64),q=new Array(64),rt=[],it=0,X=7,J=new Array(64),tt=new Array(64),ot=new Array(64),nt=new Array(256),lt=new Array(2048),at=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],ut=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],V=[0,1,2,3,4,5,6,7,8,9,10,11],ht=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],vt=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],pt=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],st=[0,1,2,3,4,5,6,7,8,9,10,11],ct=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],At=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function kt(Rt,Mt){for(var Bt=0,$t=0,Ot=new Array,Zt=1;Zt<=16;Zt++){for(var Tt=1;Tt<=Rt[Zt];Tt++)Ot[Mt[$t]]=[],Ot[Mt[$t]][0]=Bt,Ot[Mt[$t]][1]=Zt,$t++,Bt++;Bt*=2}return Ot}function yt(Rt){for(var Mt=Rt[0],Bt=Rt[1]-1;Bt>=0;)Mt&1<<Bt&&(it|=1<<X),Bt--,--X<0&&(it==255?(Ct(255),Ct(0)):Ct(it),X=7,it=0)}function Ct(Rt){rt.push(Rt)}function xt(Rt){Ct(Rt>>8&255),Ct(255&Rt)}function Pt(Rt,Mt,Bt,$t,Ot){for(var Zt,Tt=Ot[0],et=Ot[240],It=function(wt,Lt){var jt,Kt,te,Vt,ee,Jt,oe,ne,ae,fe,ie=0;for(ae=0;ae<8;++ae){jt=wt[ie],Kt=wt[ie+1],te=wt[ie+2],Vt=wt[ie+3],ee=wt[ie+4],Jt=wt[ie+5],oe=wt[ie+6];var Nt=jt+(ne=wt[ie+7]),Xt=jt-ne,Ut=Kt+oe,Qt=Kt-oe,St=te+Jt,Yt=te-Jt,ue=Vt+ee,dt=Vt-ee,qt=Nt+ue,Gt=Nt-ue,Dt=Ut+St,Ht=Ut-St;wt[ie]=qt+Dt,wt[ie+4]=qt-Dt;var Wt=.707106781*(Ht+Gt);wt[ie+2]=Gt+Wt,wt[ie+6]=Gt-Wt;var le=.382683433*((qt=dt+Yt)-(Ht=Qt+Xt)),re=.5411961*qt+le,se=1.306562965*Ht+le,ce=.707106781*(Dt=Yt+Qt),xe=Xt+ce,de=Xt-ce;wt[ie+5]=de+re,wt[ie+3]=de-re,wt[ie+1]=xe+se,wt[ie+7]=xe-se,ie+=8}for(ie=0,ae=0;ae<8;++ae){jt=wt[ie],Kt=wt[ie+8],te=wt[ie+16],Vt=wt[ie+24],ee=wt[ie+32],Jt=wt[ie+40],oe=wt[ie+48];var pe=jt+(ne=wt[ie+56]),ge=jt-ne,be=Kt+oe,ke=Kt-oe,Se=te+Jt,me=te-Jt,we=Vt+ee,Ee=Vt-ee,ve=pe+we,ye=pe-we,_e=be+Se,Me=be-Se;wt[ie]=ve+_e,wt[ie+32]=ve-_e;var Te=.707106781*(Me+ye);wt[ie+16]=ye+Te,wt[ie+48]=ye-Te;var Pe=.382683433*((ve=Ee+me)-(Me=ke+ge)),Be=.5411961*ve+Pe,Ce=1.306562965*Me+Pe,Re=.707106781*(_e=me+ke),ze=ge+Re,Ne=ge-Re;wt[ie+40]=Ne+Be,wt[ie+24]=Ne-Be,wt[ie+8]=ze+Ce,wt[ie+56]=ze-Ce,ie++}for(ae=0;ae<64;++ae)fe=wt[ae]*Lt[ae],Q[ae]=fe>0?fe+.5|0:fe-.5|0;return Q}(Rt,Mt),mt=0;mt<64;++mt)q[at[mt]]=It[mt];var gt=q[0]-Bt;Bt=q[0],gt==0?yt($t[0]):(yt($t[W[Zt=32767+gt]]),yt(H[Zt]));for(var _t=63;_t>0&&q[_t]==0;_t--);if(_t==0)return yt(Tt),Bt;for(var Et,zt=1;zt<=_t;){for(var K=zt;q[zt]==0&&zt<=_t;++zt);var ft=zt-K;if(ft>=16){Et=ft>>4;for(var bt=1;bt<=Et;++bt)yt(et);ft&=15}Zt=32767+q[zt],yt(Ot[(ft<<4)+W[Zt]]),yt(H[Zt]),zt++}return _t!=63&&yt(Tt),Bt}function Ft(Rt){Rt<=0&&(Rt=1),Rt>100&&(Rt=100),$!=Rt&&(function(Mt){for(var Bt=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],$t=0;$t<64;$t++){var Ot=D((Bt[$t]*Mt+50)/100);Ot<1?Ot=1:Ot>255&&(Ot=255),U[at[$t]]=Ot}for(var Zt=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Tt=0;Tt<64;Tt++){var et=D((Zt[Tt]*Mt+50)/100);et<1?et=1:et>255&&(et=255),Z[at[Tt]]=et}for(var It=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],mt=0,gt=0;gt<8;gt++)for(var _t=0;_t<8;_t++)j[mt]=1/(U[at[mt]]*It[gt]*It[_t]*8),G[mt]=1/(Z[at[mt]]*It[gt]*It[_t]*8),mt++}(Rt<50?Math.floor(5e3/Rt):Math.floor(200-2*Rt)),$=Rt)}this.encode=function(Rt,Mt){var Bt;new Date().getTime(),Mt&&Ft(Mt),rt=new Array,it=0,X=7,xt(65496),xt(65504),xt(16),Ct(74),Ct(70),Ct(73),Ct(70),Ct(0),Ct(1),Ct(1),Ct(0),xt(1),xt(1),Ct(0),Ct(0),(Bt=Rt.comments)!==void 0&&Bt.constructor===Array&&Bt.forEach(te=>{if(typeof te=="string"){xt(65534);var Vt,ee=te.length;for(xt(ee+2),Vt=0;Vt<ee;Vt++)Ct(te.charCodeAt(Vt))}}),function(te){if(te){xt(65505),te[0]===69&&te[1]===120&&te[2]===105&&te[3]===102?xt(te.length+2):(xt(te.length+5+2),Ct(69),Ct(120),Ct(105),Ct(102),Ct(0));for(var Vt=0;Vt<te.length;Vt++)Ct(te[Vt])}}(Rt.exifBuffer),function(){xt(65499),xt(132),Ct(0);for(var te=0;te<64;te++)Ct(U[te]);Ct(1);for(var Vt=0;Vt<64;Vt++)Ct(Z[Vt])}(),function(te,Vt){xt(65472),xt(17),Ct(8),xt(Vt),xt(te),Ct(3),Ct(1),Ct(17),Ct(0),Ct(2),Ct(17),Ct(1),Ct(3),Ct(17),Ct(1)}(Rt.width,Rt.height),function(){xt(65476),xt(418),Ct(0);for(var te=0;te<16;te++)Ct(ut[te+1]);for(var Vt=0;Vt<=11;Vt++)Ct(V[Vt]);Ct(16);for(var ee=0;ee<16;ee++)Ct(ht[ee+1]);for(var Jt=0;Jt<=161;Jt++)Ct(vt[Jt]);Ct(1);for(var oe=0;oe<16;oe++)Ct(pt[oe+1]);for(var ne=0;ne<=11;ne++)Ct(st[ne]);Ct(17);for(var ae=0;ae<16;ae++)Ct(ct[ae+1]);for(var fe=0;fe<=161;fe++)Ct(At[fe])}(),xt(65498),xt(12),Ct(3),Ct(1),Ct(0),Ct(2),Ct(17),Ct(3),Ct(17),Ct(0),Ct(63),Ct(0);var $t=0,Ot=0,Zt=0;it=0,X=7,this.encode.displayName="_encode_";for(var Tt,et,It,mt,gt,_t,Et,zt,K,ft=Rt.data,bt=Rt.width,wt=Rt.height,Lt=4*bt,jt=0;jt<wt;){for(Tt=0;Tt<Lt;){for(_t=gt=Lt*jt+Tt,Et=-1,zt=0,K=0;K<64;K++)_t=gt+(zt=K>>3)*Lt+(Et=4*(7&K)),jt+zt>=wt&&(_t-=Lt*(jt+1+zt-wt)),Tt+Et>=Lt&&(_t-=Tt+Et-Lt+4),et=ft[_t++],It=ft[_t++],mt=ft[_t++],J[K]=(lt[et]+lt[It+256|0]+lt[mt+512|0]>>16)-128,tt[K]=(lt[et+768|0]+lt[It+1024|0]+lt[mt+1280|0]>>16)-128,ot[K]=(lt[et+1280|0]+lt[It+1536|0]+lt[mt+1792|0]>>16)-128;$t=Pt(J,j,$t,w,P),Ot=Pt(tt,G,Ot,I,F),Zt=Pt(ot,G,Zt,I,F),Tt+=32}jt+=8}if(X>=0){var Kt=[];Kt[1]=X+1,Kt[0]=(1<<X+1)-1,yt(Kt)}return xt(65497),Buffer.from(rt)},new Date().getTime(),g||(g=50),function(){for(var Rt=String.fromCharCode,Mt=0;Mt<256;Mt++)nt[Mt]=Rt(Mt)}(),w=kt(ut,V),I=kt(pt,st),P=kt(ht,vt),F=kt(ct,At),function(){for(var Rt=1,Mt=2,Bt=1;Bt<=15;Bt++){for(var $t=Rt;$t<Mt;$t++)W[32767+$t]=Bt,H[32767+$t]=[],H[32767+$t][1]=Bt,H[32767+$t][0]=$t;for(var Ot=-(Mt-1);Ot<=-Rt;Ot++)W[32767+Ot]=Bt,H[32767+Ot]=[],H[32767+Ot][1]=Bt,H[32767+Ot][0]=Mt-1+Ot;Rt<<=1,Mt<<=1}}(),function(){for(var Rt=0;Rt<256;Rt++)lt[Rt]=19595*Rt,lt[Rt+256|0]=38470*Rt,lt[Rt+512|0]=7471*Rt+32768,lt[Rt+768|0]=-11059*Rt,lt[Rt+1024|0]=-21709*Rt,lt[Rt+1280|0]=32768*Rt+8421375,lt[Rt+1536|0]=-27439*Rt,lt[Rt+1792|0]=-5329*Rt}(),Ft(g),new Date().getTime()}encoder.exports=function(g,w){w===void 0&&(w=50);var I=new m(w),P=I.encode(g,w);return{data:P,width:g.width,height:g.height}}})();var encoderExports=encoder.exports,decoder={exports:{}},module,JpegImage;module=decoder,JpegImage=function(){var d=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),m=4017,g=799,w=3406,I=2276,P=1567,F=3784,$=5793,D=2896;function U(){}function Z(rt,it){for(var X,J,tt=0,ot=[],nt=16;nt>0&&!rt[nt-1];)nt--;ot.push({children:[],index:0});var lt,at=ot[0];for(X=0;X<nt;X++){for(J=0;J<rt[X];J++){for((at=ot.pop()).children[at.index]=it[tt];at.index>0;){if(ot.length===0)throw new Error("Could not recreate Huffman Table");at=ot.pop()}for(at.index++,ot.push(at);ot.length<=X;)ot.push(lt={children:[],index:0}),at.children[at.index]=lt.children,at=lt;tt++}X+1<nt&&(ot.push(lt={children:[],index:0}),at.children[at.index]=lt.children,at=lt)}return ot[0].children}function j(rt,it,X,J,tt,ot,nt,lt,at,ut){X.precision,X.samplesPerLine,X.scanLines;var V=X.mcusPerLine,ht=X.progressive;X.maxH,X.maxV;var vt=it,pt=0,st=0;function ct(){if(st>0)return st--,pt>>st&1;if((pt=rt[it++])==255){var zt=rt[it++];if(zt)throw new Error("unexpected marker: "+(pt<<8|zt).toString(16))}return st=7,pt>>>7}function At(zt){for(var K,ft=zt;(K=ct())!==null;){if(typeof(ft=ft[K])=="number")return ft;if(typeof ft!="object")throw new Error("invalid huffman sequence")}return null}function kt(zt){for(var K=0;zt>0;){var ft=ct();if(ft===null)return;K=K<<1|ft,zt--}return K}function yt(zt){var K=kt(zt);return K>=1<<zt-1?K:K+(-1<<zt)+1}var Ct,xt=0,Pt=0;function Ft(zt,K,ft,bt,wt){var Lt=ft%V,jt=(ft/V|0)*zt.v+bt,Kt=Lt*zt.h+wt;zt.blocks[jt]===void 0&&ut.tolerantDecoding||K(zt,zt.blocks[jt][Kt])}function Rt(zt,K,ft){var bt=ft/zt.blocksPerLine|0,wt=ft%zt.blocksPerLine;zt.blocks[bt]===void 0&&ut.tolerantDecoding||K(zt,zt.blocks[bt][wt])}var Mt,Bt,$t,Ot,Zt,Tt,et=J.length;Tt=ht?ot===0?lt===0?function(zt,K){var ft=At(zt.huffmanTableDC),bt=ft===0?0:yt(ft)<<at;K[0]=zt.pred+=bt}:function(zt,K){K[0]|=ct()<<at}:lt===0?function(zt,K){if(xt>0)xt--;else for(var ft=ot,bt=nt;ft<=bt;){var wt=At(zt.huffmanTableAC),Lt=15&wt,jt=wt>>4;if(Lt!==0)K[d[ft+=jt]]=yt(Lt)*(1<<at),ft++;else{if(jt<15){xt=kt(jt)+(1<<jt)-1;break}ft+=16}}}:function(zt,K){for(var ft=ot,bt=nt,wt=0;ft<=bt;){var Lt=d[ft],jt=K[Lt]<0?-1:1;switch(Pt){case 0:var Kt=At(zt.huffmanTableAC),te=15&Kt;if(wt=Kt>>4,te===0)wt<15?(xt=kt(wt)+(1<<wt),Pt=4):(wt=16,Pt=1);else{if(te!==1)throw new Error("invalid ACn encoding");Ct=yt(te),Pt=wt?2:3}continue;case 1:case 2:K[Lt]?K[Lt]+=(ct()<<at)*jt:--wt==0&&(Pt=Pt==2?3:0);break;case 3:K[Lt]?K[Lt]+=(ct()<<at)*jt:(K[Lt]=Ct<<at,Pt=0);break;case 4:K[Lt]&&(K[Lt]+=(ct()<<at)*jt)}ft++}Pt===4&&--xt==0&&(Pt=0)}:function(zt,K){var ft=At(zt.huffmanTableDC),bt=ft===0?0:yt(ft);K[0]=zt.pred+=bt;for(var wt=1;wt<64;){var Lt=At(zt.huffmanTableAC),jt=15&Lt,Kt=Lt>>4;if(jt!==0)K[d[wt+=Kt]]=yt(jt),wt++;else{if(Kt<15)break;wt+=16}}};var It,mt,gt,_t,Et=0;for(mt=et==1?J[0].blocksPerLine*J[0].blocksPerColumn:V*X.mcusPerColumn,tt||(tt=mt);Et<mt;){for(Bt=0;Bt<et;Bt++)J[Bt].pred=0;if(xt=0,et==1)for(Mt=J[0],Zt=0;Zt<tt;Zt++)Rt(Mt,Tt,Et),Et++;else for(Zt=0;Zt<tt;Zt++){for(Bt=0;Bt<et;Bt++)for(gt=(Mt=J[Bt]).h,_t=Mt.v,$t=0;$t<_t;$t++)for(Ot=0;Ot<gt;Ot++)Ft(Mt,Tt,Et,$t,Ot);if(++Et===mt)break}if(Et===mt)do{if(rt[it]===255&&rt[it+1]!==0)break;it+=1}while(it<rt.length-2);if(st=0,(It=rt[it]<<8|rt[it+1])<65280)throw new Error("marker was not found");if(!(It>=65488&&It<=65495))break;it+=2}return it-vt}function G(rt,it){var X,J,tt=[],ot=it.blocksPerLine,nt=it.blocksPerColumn,lt=ot<<3,at=new Int32Array(64),ut=new Uint8Array(64);function V(kt,yt,Ct){var xt,Pt,Ft,Rt,Mt,Bt,$t,Ot,Zt,Tt,et=it.quantizationTable,It=Ct;for(Tt=0;Tt<64;Tt++)It[Tt]=kt[Tt]*et[Tt];for(Tt=0;Tt<8;++Tt){var mt=8*Tt;It[1+mt]!=0||It[2+mt]!=0||It[3+mt]!=0||It[4+mt]!=0||It[5+mt]!=0||It[6+mt]!=0||It[7+mt]!=0?(xt=$*It[0+mt]+128>>8,Pt=$*It[4+mt]+128>>8,Ft=It[2+mt],Rt=It[6+mt],Mt=D*(It[1+mt]-It[7+mt])+128>>8,Ot=D*(It[1+mt]+It[7+mt])+128>>8,Bt=It[3+mt]<<4,$t=It[5+mt]<<4,Zt=xt-Pt+1>>1,xt=xt+Pt+1>>1,Pt=Zt,Zt=Ft*F+Rt*P+128>>8,Ft=Ft*P-Rt*F+128>>8,Rt=Zt,Zt=Mt-$t+1>>1,Mt=Mt+$t+1>>1,$t=Zt,Zt=Ot+Bt+1>>1,Bt=Ot-Bt+1>>1,Ot=Zt,Zt=xt-Rt+1>>1,xt=xt+Rt+1>>1,Rt=Zt,Zt=Pt-Ft+1>>1,Pt=Pt+Ft+1>>1,Ft=Zt,Zt=Mt*I+Ot*w+2048>>12,Mt=Mt*w-Ot*I+2048>>12,Ot=Zt,Zt=Bt*g+$t*m+2048>>12,Bt=Bt*m-$t*g+2048>>12,$t=Zt,It[0+mt]=xt+Ot,It[7+mt]=xt-Ot,It[1+mt]=Pt+$t,It[6+mt]=Pt-$t,It[2+mt]=Ft+Bt,It[5+mt]=Ft-Bt,It[3+mt]=Rt+Mt,It[4+mt]=Rt-Mt):(Zt=$*It[0+mt]+512>>10,It[0+mt]=Zt,It[1+mt]=Zt,It[2+mt]=Zt,It[3+mt]=Zt,It[4+mt]=Zt,It[5+mt]=Zt,It[6+mt]=Zt,It[7+mt]=Zt)}for(Tt=0;Tt<8;++Tt){var gt=Tt;It[8+gt]!=0||It[16+gt]!=0||It[24+gt]!=0||It[32+gt]!=0||It[40+gt]!=0||It[48+gt]!=0||It[56+gt]!=0?(xt=$*It[0+gt]+2048>>12,Pt=$*It[32+gt]+2048>>12,Ft=It[16+gt],Rt=It[48+gt],Mt=D*(It[8+gt]-It[56+gt])+2048>>12,Ot=D*(It[8+gt]+It[56+gt])+2048>>12,Bt=It[24+gt],$t=It[40+gt],Zt=xt-Pt+1>>1,xt=xt+Pt+1>>1,Pt=Zt,Zt=Ft*F+Rt*P+2048>>12,Ft=Ft*P-Rt*F+2048>>12,Rt=Zt,Zt=Mt-$t+1>>1,Mt=Mt+$t+1>>1,$t=Zt,Zt=Ot+Bt+1>>1,Bt=Ot-Bt+1>>1,Ot=Zt,Zt=xt-Rt+1>>1,xt=xt+Rt+1>>1,Rt=Zt,Zt=Pt-Ft+1>>1,Pt=Pt+Ft+1>>1,Ft=Zt,Zt=Mt*I+Ot*w+2048>>12,Mt=Mt*w-Ot*I+2048>>12,Ot=Zt,Zt=Bt*g+$t*m+2048>>12,Bt=Bt*m-$t*g+2048>>12,$t=Zt,It[0+gt]=xt+Ot,It[56+gt]=xt-Ot,It[8+gt]=Pt+$t,It[48+gt]=Pt-$t,It[16+gt]=Ft+Bt,It[40+gt]=Ft-Bt,It[24+gt]=Rt+Mt,It[32+gt]=Rt-Mt):(Zt=$*Ct[Tt+0]+8192>>14,It[0+gt]=Zt,It[8+gt]=Zt,It[16+gt]=Zt,It[24+gt]=Zt,It[32+gt]=Zt,It[40+gt]=Zt,It[48+gt]=Zt,It[56+gt]=Zt)}for(Tt=0;Tt<64;++Tt){var _t=128+(It[Tt]+8>>4);yt[Tt]=_t<0?0:_t>255?255:_t}}q(lt*nt*8);for(var ht=0;ht<nt;ht++){var vt=ht<<3;for(X=0;X<8;X++)tt.push(new Uint8Array(lt));for(var pt=0;pt<ot;pt++){V(it.blocks[ht][pt],ut,at);var st=0,ct=pt<<3;for(J=0;J<8;J++){var At=tt[vt+J];for(X=0;X<8;X++)At[ct+X]=ut[st++]}}}return tt}function H(rt){return rt<0?0:rt>255?255:rt}U.prototype={load:function(rt){var it=new XMLHttpRequest;it.open("GET",rt,!0),it.responseType="arraybuffer",it.onload=(function(){var X=new Uint8Array(it.response||it.mozResponseArrayBuffer);this.parse(X),this.onload&&this.onload()}).bind(this),it.send(null)},parse:function(rt){var it=1e3*this.opts.maxResolutionInMP*1e3,X=0;function J(){var Vt=rt[X]<<8|rt[X+1];return X+=2,Vt}function tt(Vt){var ee,Jt,oe=1,ne=1;for(Jt in Vt.components)Vt.components.hasOwnProperty(Jt)&&(oe<(ee=Vt.components[Jt]).h&&(oe=ee.h),ne<ee.v&&(ne=ee.v));var ae=Math.ceil(Vt.samplesPerLine/8/oe),fe=Math.ceil(Vt.scanLines/8/ne);for(Jt in Vt.components)if(Vt.components.hasOwnProperty(Jt)){ee=Vt.components[Jt];var ie=Math.ceil(Math.ceil(Vt.samplesPerLine/8)*ee.h/oe),Nt=Math.ceil(Math.ceil(Vt.scanLines/8)*ee.v/ne),Xt=ae*ee.h,Ut=fe*ee.v,Qt=[];q(Ut*Xt*256);for(var St=0;St<Ut;St++){for(var Yt=[],ue=0;ue<Xt;ue++)Yt.push(new Int32Array(64));Qt.push(Yt)}ee.blocksPerLine=ie,ee.blocksPerColumn=Nt,ee.blocks=Qt}Vt.maxH=oe,Vt.maxV=ne,Vt.mcusPerLine=ae,Vt.mcusPerColumn=fe}rt.length;var ot,nt,lt,at,ut=null,V=null,ht=[],vt=[],pt=[],st=[],ct=J(),At=-1;if(this.comments=[],ct!=65496)throw new Error("SOI not found");for(ct=J();ct!=65497;){switch(ct){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var kt=(lt=void 0,at=void 0,lt=J(),at=rt.subarray(X,X+lt-2),X+=at.length,at);if(ct===65534){var yt=String.fromCharCode.apply(null,kt);this.comments.push(yt)}ct===65504&&kt[0]===74&&kt[1]===70&&kt[2]===73&&kt[3]===70&&kt[4]===0&&(ut={version:{major:kt[5],minor:kt[6]},densityUnits:kt[7],xDensity:kt[8]<<8|kt[9],yDensity:kt[10]<<8|kt[11],thumbWidth:kt[12],thumbHeight:kt[13],thumbData:kt.subarray(14,14+3*kt[12]*kt[13])}),ct===65505&&kt[0]===69&&kt[1]===120&&kt[2]===105&&kt[3]===102&&kt[4]===0&&(this.exifBuffer=kt.subarray(5,kt.length)),ct===65518&&kt[0]===65&&kt[1]===100&&kt[2]===111&&kt[3]===98&&kt[4]===101&&kt[5]===0&&(V={version:kt[6],flags0:kt[7]<<8|kt[8],flags1:kt[9]<<8|kt[10],transformCode:kt[11]});break;case 65499:for(var Ct=J()+X-2;X<Ct;){var xt=rt[X++];q(256);var Pt=new Int32Array(64);if(xt>>4){if(xt>>4!=1)throw new Error("DQT: invalid table spec");for(Kt=0;Kt<64;Kt++)Pt[d[Kt]]=J()}else for(Kt=0;Kt<64;Kt++)Pt[d[Kt]]=rt[X++];ht[15&xt]=Pt}break;case 65472:case 65473:case 65474:J(),(ot={}).extended=ct===65473,ot.progressive=ct===65474,ot.precision=rt[X++],ot.scanLines=J(),ot.samplesPerLine=J(),ot.components={},ot.componentsOrder=[];var Ft=ot.scanLines*ot.samplesPerLine;if(Ft>it){var Rt=Math.ceil((Ft-it)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${Rt}MP`)}var Mt,Bt=rt[X++];for(Lt=0;Lt<Bt;Lt++){Mt=rt[X];var $t=rt[X+1]>>4,Ot=15&rt[X+1],Zt=rt[X+2];if($t<=0||Ot<=0)throw new Error("Invalid sampling factor, expected values above 0");ot.componentsOrder.push(Mt),ot.components[Mt]={h:$t,v:Ot,quantizationIdx:Zt},X+=3}tt(ot),vt.push(ot);break;case 65476:var Tt=J();for(Lt=2;Lt<Tt;){var et=rt[X++],It=new Uint8Array(16),mt=0;for(Kt=0;Kt<16;Kt++,X++)mt+=It[Kt]=rt[X];q(16+mt);var gt=new Uint8Array(mt);for(Kt=0;Kt<mt;Kt++,X++)gt[Kt]=rt[X];Lt+=17+mt,(et>>4?pt:st)[15&et]=Z(It,gt)}break;case 65501:J(),nt=J();break;case 65500:J(),J();break;case 65498:J();var _t=rt[X++],Et=[];for(Lt=0;Lt<_t;Lt++){te=ot.components[rt[X++]];var zt=rt[X++];te.huffmanTableDC=st[zt>>4],te.huffmanTableAC=pt[15&zt],Et.push(te)}var K=rt[X++],ft=rt[X++],bt=rt[X++],wt=j(rt,X,ot,Et,nt,K,ft,bt>>4,15&bt,this.opts);X+=wt;break;case 65535:rt[X]!==255&&X--;break;default:if(rt[X-3]==255&&rt[X-2]>=192&&rt[X-2]<=254){X-=3;break}if(ct===224||ct==225){if(At!==-1)throw new Error(`first unknown JPEG marker at offset ${At.toString(16)}, second unknown JPEG marker ${ct.toString(16)} at offset ${(X-1).toString(16)}`);At=X-1;const Vt=J();if(rt[X+Vt-2]===255){X+=Vt-2;break}}throw new Error("unknown JPEG marker "+ct.toString(16))}ct=J()}if(vt.length!=1)throw new Error("only single frame JPEGs supported");for(var Lt=0;Lt<vt.length;Lt++){var jt=vt[Lt].components;for(var Kt in jt)jt[Kt].quantizationTable=ht[jt[Kt].quantizationIdx],delete jt[Kt].quantizationIdx}for(this.width=ot.samplesPerLine,this.height=ot.scanLines,this.jfif=ut,this.adobe=V,this.components=[],Lt=0;Lt<ot.componentsOrder.length;Lt++){var te=ot.components[ot.componentsOrder[Lt]];this.components.push({lines:G(0,te),scaleX:te.h/ot.maxH,scaleY:te.v/ot.maxV})}},getData:function(rt,it){var X,J,tt,ot,nt,lt,at,ut,V,ht,vt,pt,st,ct,At,kt,yt,Ct,xt,Pt,Ft,Rt=this.width/rt,Mt=this.height/it,Bt=0,$t=rt*it*this.components.length;q($t);var Ot=new Uint8Array($t);switch(this.components.length){case 1:for(X=this.components[0],ht=0;ht<it;ht++)for(nt=X.lines[0|ht*X.scaleY*Mt],V=0;V<rt;V++)vt=nt[0|V*X.scaleX*Rt],Ot[Bt++]=vt;break;case 2:for(X=this.components[0],J=this.components[1],ht=0;ht<it;ht++)for(nt=X.lines[0|ht*X.scaleY*Mt],lt=J.lines[0|ht*J.scaleY*Mt],V=0;V<rt;V++)vt=nt[0|V*X.scaleX*Rt],Ot[Bt++]=vt,vt=lt[0|V*J.scaleX*Rt],Ot[Bt++]=vt;break;case 3:for(Ft=!0,this.adobe&&this.adobe.transformCode?Ft=!0:this.opts.colorTransform!==void 0&&(Ft=!!this.opts.colorTransform),X=this.components[0],J=this.components[1],tt=this.components[2],ht=0;ht<it;ht++)for(nt=X.lines[0|ht*X.scaleY*Mt],lt=J.lines[0|ht*J.scaleY*Mt],at=tt.lines[0|ht*tt.scaleY*Mt],V=0;V<rt;V++)Ft?(vt=nt[0|V*X.scaleX*Rt],pt=lt[0|V*J.scaleX*Rt],Ct=H(vt+1.402*((st=at[0|V*tt.scaleX*Rt])-128)),xt=H(vt-.3441363*(pt-128)-.71413636*(st-128)),Pt=H(vt+1.772*(pt-128))):(Ct=nt[0|V*X.scaleX*Rt],xt=lt[0|V*J.scaleX*Rt],Pt=at[0|V*tt.scaleX*Rt]),Ot[Bt++]=Ct,Ot[Bt++]=xt,Ot[Bt++]=Pt;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(Ft=!1,this.adobe&&this.adobe.transformCode?Ft=!0:this.opts.colorTransform!==void 0&&(Ft=!!this.opts.colorTransform),X=this.components[0],J=this.components[1],tt=this.components[2],ot=this.components[3],ht=0;ht<it;ht++)for(nt=X.lines[0|ht*X.scaleY*Mt],lt=J.lines[0|ht*J.scaleY*Mt],at=tt.lines[0|ht*tt.scaleY*Mt],ut=ot.lines[0|ht*ot.scaleY*Mt],V=0;V<rt;V++)Ft?(vt=nt[0|V*X.scaleX*Rt],pt=lt[0|V*J.scaleX*Rt],st=at[0|V*tt.scaleX*Rt],ct=ut[0|V*ot.scaleX*Rt],At=255-H(vt+1.402*(st-128)),kt=255-H(vt-.3441363*(pt-128)-.71413636*(st-128)),yt=255-H(vt+1.772*(pt-128))):(At=nt[0|V*X.scaleX*Rt],kt=lt[0|V*J.scaleX*Rt],yt=at[0|V*tt.scaleX*Rt],ct=ut[0|V*ot.scaleX*Rt]),Ot[Bt++]=255-At,Ot[Bt++]=255-kt,Ot[Bt++]=255-yt,Ot[Bt++]=255-ct;break;default:throw new Error("Unsupported color mode")}return Ot},copyToImageData:function(rt,it){var X,J,tt,ot,nt,lt,at,ut,V,ht=rt.width,vt=rt.height,pt=rt.data,st=this.getData(ht,vt),ct=0,At=0;switch(this.components.length){case 1:for(J=0;J<vt;J++)for(X=0;X<ht;X++)tt=st[ct++],pt[At++]=tt,pt[At++]=tt,pt[At++]=tt,it&&(pt[At++]=255);break;case 3:for(J=0;J<vt;J++)for(X=0;X<ht;X++)at=st[ct++],ut=st[ct++],V=st[ct++],pt[At++]=at,pt[At++]=ut,pt[At++]=V,it&&(pt[At++]=255);break;case 4:for(J=0;J<vt;J++)for(X=0;X<ht;X++)nt=st[ct++],lt=st[ct++],tt=st[ct++],at=255-H(nt*(1-(ot=st[ct++])/255)+ot),ut=255-H(lt*(1-ot/255)+ot),V=255-H(tt*(1-ot/255)+ot),pt[At++]=at,pt[At++]=ut,pt[At++]=V,it&&(pt[At++]=255);break;default:throw new Error("Unsupported color mode")}}};var W=0,Q=0;function q(rt=0){var it=W+rt;if(it>Q){var X=Math.ceil((it-Q)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${X}MB`)}W=it}return U.resetMaxMemoryUsage=function(rt){W=0,Q=rt},U.getBytesAllocated=function(){return W},U.requestMemoryAllocation=q,U}(),module.exports=function(d,m={}){var g={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512,...m},w=new Uint8Array(d),I=new JpegImage;I.opts=g,JpegImage.resetMaxMemoryUsage(1024*g.maxMemoryUsageInMB*1024),I.parse(w);var P=g.formatAsRGBA?4:3,F=I.width*I.height*P;try{JpegImage.requestMemoryAllocation(F);var $={width:I.width,height:I.height,exifBuffer:I.exifBuffer,data:g.useTArray?new Uint8Array(F):Buffer.alloc(F)};I.comments.length>0&&($.comments=I.comments)}catch(D){throw D instanceof RangeError?new Error("Could not allocate enough memory for the image. Required: "+F):D instanceof ReferenceError&&D.message==="Buffer is not defined"?new Error("Buffer is not globally defined in this environment. Consider setting useTArray to true"):D}return I.copyToImageData($,g.formatAsRGBA),$};var decoderExports=decoder.exports,encode=encoderExports,decode=decoderExports,jpegJs={encode,decode},JPEG=getDefaultExportFromCjs(jpegJs);function jpeg$2(){return{mime:"image/jpeg",encode:(d,{quality:m=100}={})=>JPEG.encode(d,m).data,decode:(d,m)=>JPEG.decode(d,m)}}function commonjsRequire(d){throw new Error('Could not dynamically require "'+d+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var browser$1={exports:{}};browser$1.exports=function(){function d(m,g,w){function I($,D){if(!g[$]){if(!m[$]){var U=typeof commonjsRequire=="function"&&commonjsRequire;if(!D&&U)return U($,!0);if(P)return P($,!0);var Z=new Error("Cannot find module '"+$+"'");throw Z.code="MODULE_NOT_FOUND",Z}var j=g[$]={exports:{}};m[$][0].call(j.exports,function(G){return I(m[$][1][G]||G)},j,j.exports,d,m,g,w)}return g[$].exports}for(var P=typeof commonjsRequire=="function"&&commonjsRequire,F=0;F<w.length;F++)I(w[F]);return I}return d}()({1:[function(d,m,g){(function(w){(function(){let I=d("./interlace"),P=[function(){},function(Z,j,G,H){if(H===j.length)throw new Error("Ran out of data");let W=j[H];Z[G]=W,Z[G+1]=W,Z[G+2]=W,Z[G+3]=255},function(Z,j,G,H){if(H+1>=j.length)throw new Error("Ran out of data");let W=j[H];Z[G]=W,Z[G+1]=W,Z[G+2]=W,Z[G+3]=j[H+1]},function(Z,j,G,H){if(H+2>=j.length)throw new Error("Ran out of data");Z[G]=j[H],Z[G+1]=j[H+1],Z[G+2]=j[H+2],Z[G+3]=255},function(Z,j,G,H){if(H+3>=j.length)throw new Error("Ran out of data");Z[G]=j[H],Z[G+1]=j[H+1],Z[G+2]=j[H+2],Z[G+3]=j[H+3]}],F=[function(){},function(Z,j,G,H){let W=j[0];Z[G]=W,Z[G+1]=W,Z[G+2]=W,Z[G+3]=H},function(Z,j,G){let H=j[0];Z[G]=H,Z[G+1]=H,Z[G+2]=H,Z[G+3]=j[1]},function(Z,j,G,H){Z[G]=j[0],Z[G+1]=j[1],Z[G+2]=j[2],Z[G+3]=H},function(Z,j,G){Z[G]=j[0],Z[G+1]=j[1],Z[G+2]=j[2],Z[G+3]=j[3]}];function $(Z,j){let G=[],H=0;function W(){if(H===Z.length)throw new Error("Ran out of data");let Q,q,rt,it,X,J,tt,ot,nt=Z[H];switch(H++,j){default:throw new Error("unrecognised depth");case 16:tt=Z[H],H++,G.push((nt<<8)+tt);break;case 4:tt=15&nt,ot=nt>>4,G.push(ot,tt);break;case 2:X=3&nt,J=nt>>2&3,tt=nt>>4&3,ot=nt>>6&3,G.push(ot,tt,J,X);break;case 1:Q=1&nt,q=nt>>1&1,rt=nt>>2&1,it=nt>>3&1,X=nt>>4&1,J=nt>>5&1,tt=nt>>6&1,ot=nt>>7&1,G.push(ot,tt,J,X,it,rt,q,Q)}}return{get:function(Q){for(;G.length<Q;)W();let q=G.slice(0,Q);return G=G.slice(Q),q},resetAfterLine:function(){G.length=0},end:function(){if(H!==Z.length)throw new Error("extra data found")}}}function D(Z,j,G,H,W,Q){let q=Z.width,rt=Z.height,it=Z.index;for(let X=0;X<rt;X++)for(let J=0;J<q;J++){let tt=G(J,X,it);P[H](j,W,tt,Q),Q+=H}return Q}function U(Z,j,G,H,W,Q){let q=Z.width,rt=Z.height,it=Z.index;for(let X=0;X<rt;X++){for(let J=0;J<q;J++){let tt=W.get(H),ot=G(J,X,it);F[H](j,tt,ot,Q)}W.resetAfterLine()}}g.dataToBitMap=function(Z,j){let G,H,W=j.width,Q=j.height,q=j.depth,rt=j.bpp,it=j.interlace;q!==8&&(G=$(Z,q)),H=q<=8?w.alloc(W*Q*4):new Uint16Array(W*Q*4);let X,J,tt=Math.pow(2,q)-1,ot=0;if(it)X=I.getImagePasses(W,Q),J=I.getInterlaceIterator(W,Q);else{let nt=0;J=function(){let lt=nt;return nt+=4,lt},X=[{width:W,height:Q}]}for(let nt=0;nt<X.length;nt++)q===8?ot=D(X[nt],H,J,rt,Z,ot):U(X[nt],H,J,rt,G,tt);if(q===8){if(ot!==Z.length)throw new Error("extra data found")}else G.end();return H}}).call(this)}).call(this,d("buffer").Buffer)},{"./interlace":11,buffer:32}],2:[function(d,m,g){(function(w){(function(){let I=d("./constants");m.exports=function(P,F,$,D){let U=[I.COLORTYPE_COLOR_ALPHA,I.COLORTYPE_ALPHA].indexOf(D.colorType)!==-1;if(D.colorType===D.inputColorType){let X=function(){let J=new ArrayBuffer(2);return new DataView(J).setInt16(0,256,!0),new Int16Array(J)[0]!==256}();if(D.bitDepth===8||D.bitDepth===16&&X)return P}let Z=D.bitDepth!==16?P:new Uint16Array(P.buffer),j=255,G=I.COLORTYPE_TO_BPP_MAP[D.inputColorType];G!==4||D.inputHasAlpha||(G=3);let H=I.COLORTYPE_TO_BPP_MAP[D.colorType];D.bitDepth===16&&(j=65535,H*=2);let W=w.alloc(F*$*H),Q=0,q=0,rt=D.bgColor||{};function it(){let X,J,tt,ot=j;switch(D.inputColorType){case I.COLORTYPE_COLOR_ALPHA:ot=Z[Q+3],X=Z[Q],J=Z[Q+1],tt=Z[Q+2];break;case I.COLORTYPE_COLOR:X=Z[Q],J=Z[Q+1],tt=Z[Q+2];break;case I.COLORTYPE_ALPHA:ot=Z[Q+1],X=Z[Q],J=X,tt=X;break;case I.COLORTYPE_GRAYSCALE:X=Z[Q],J=X,tt=X;break;default:throw new Error("input color type:"+D.inputColorType+" is not supported at present")}return D.inputHasAlpha&&(U||(ot/=j,X=Math.min(Math.max(Math.round((1-ot)*rt.red+ot*X),0),j),J=Math.min(Math.max(Math.round((1-ot)*rt.green+ot*J),0),j),tt=Math.min(Math.max(Math.round((1-ot)*rt.blue+ot*tt),0),j))),{red:X,green:J,blue:tt,alpha:ot}}rt.red===void 0&&(rt.red=j),rt.green===void 0&&(rt.green=j),rt.blue===void 0&&(rt.blue=j);for(let X=0;X<$;X++)for(let J=0;J<F;J++){let tt=it();switch(D.colorType){case I.COLORTYPE_COLOR_ALPHA:case I.COLORTYPE_COLOR:D.bitDepth===8?(W[q]=tt.red,W[q+1]=tt.green,W[q+2]=tt.blue,U&&(W[q+3]=tt.alpha)):(W.writeUInt16BE(tt.red,q),W.writeUInt16BE(tt.green,q+2),W.writeUInt16BE(tt.blue,q+4),U&&W.writeUInt16BE(tt.alpha,q+6));break;case I.COLORTYPE_ALPHA:case I.COLORTYPE_GRAYSCALE:{let ot=(tt.red+tt.green+tt.blue)/3;D.bitDepth===8?(W[q]=ot,U&&(W[q+1]=tt.alpha)):(W.writeUInt16BE(ot,q),U&&W.writeUInt16BE(tt.alpha,q+2));break}default:throw new Error("unrecognised color Type "+D.colorType)}Q+=G,q+=H}return W}}).call(this)}).call(this,d("buffer").Buffer)},{"./constants":4,buffer:32}],3:[function(d,m,g){(function(w,I){(function(){let P=d("util"),F=d("stream"),$=m.exports=function(){F.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};P.inherits($,F),$.prototype.read=function(D,U){this._reads.push({length:Math.abs(D),allowLess:D<0,func:U}),w.nextTick((function(){this._process(),this._paused&&this._reads&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}).bind(this))},$.prototype.write=function(D,U){if(!this.writable)return this.emit("error",new Error("Stream not writable")),!1;let Z;return Z=I.isBuffer(D)?D:I.from(D,U||this._encoding),this._buffers.push(Z),this._buffered+=Z.length,this._process(),this._reads&&this._reads.length===0&&(this._paused=!0),this.writable&&!this._paused},$.prototype.end=function(D,U){D&&this.write(D,U),this.writable=!1,this._buffers&&(this._buffers.length===0?this._end():(this._buffers.push(null),this._process()))},$.prototype.destroySoon=$.prototype.end,$.prototype._end=function(){this._reads.length>0&&this.emit("error",new Error("Unexpected end of input")),this.destroy()},$.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},$.prototype._processReadAllowingLess=function(D){this._reads.shift();let U=this._buffers[0];U.length>D.length?(this._buffered-=D.length,this._buffers[0]=U.slice(D.length),D.func.call(this,U.slice(0,D.length))):(this._buffered-=U.length,this._buffers.shift(),D.func.call(this,U))},$.prototype._processRead=function(D){this._reads.shift();let U=0,Z=0,j=I.alloc(D.length);for(;U<D.length;){let G=this._buffers[Z++],H=Math.min(G.length,D.length-U);G.copy(j,U,0,H),U+=H,H!==G.length&&(this._buffers[--Z]=G.slice(H))}Z>0&&this._buffers.splice(0,Z),this._buffered-=D.length,D.func.call(this,j)},$.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){let D=this._reads[0];if(D.allowLess)this._processReadAllowingLess(D);else{if(!(this._buffered>=D.length))break;this._processRead(D)}}this._buffers&&!this.writable&&this._end()}catch(D){this.emit("error",D)}}}).call(this)}).call(this,d("_process"),d("buffer").Buffer)},{_process:63,buffer:32,stream:65,util:84}],4:[function(d,m,g){m.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}},{}],5:[function(d,m,g){let w=[];(function(){for(let P=0;P<256;P++){let F=P;for(let $=0;$<8;$++)1&F?F=3988292384^F>>>1:F>>>=1;w[P]=F}})();let I=m.exports=function(){this._crc=-1};I.prototype.write=function(P){for(let F=0;F<P.length;F++)this._crc=w[255&(this._crc^P[F])]^this._crc>>>8;return!0},I.prototype.crc32=function(){return~this._crc},I.crc32=function(P){let F=-1;for(let $=0;$<P.length;$++)F=w[255&(F^P[$])]^F>>>8;return~F}},{}],6:[function(d,m,g){(function(w){(function(){let I=d("./paeth-predictor");function P(rt,it,X,J,tt){for(let ot=0;ot<X;ot++)J[tt+ot]=rt[it+ot]}function F(rt,it,X){let J=0,tt=it+X;for(let ot=it;ot<tt;ot++)J+=Math.abs(rt[ot]);return J}function $(rt,it,X,J,tt,ot){for(let nt=0;nt<X;nt++){let lt=nt>=ot?rt[it+nt-ot]:0,at=rt[it+nt]-lt;J[tt+nt]=at}}function D(rt,it,X,J){let tt=0;for(let ot=0;ot<X;ot++){let nt=ot>=J?rt[it+ot-J]:0,lt=rt[it+ot]-nt;tt+=Math.abs(lt)}return tt}function U(rt,it,X,J,tt){for(let ot=0;ot<X;ot++){let nt=it>0?rt[it+ot-X]:0,lt=rt[it+ot]-nt;J[tt+ot]=lt}}function Z(rt,it,X){let J=0,tt=it+X;for(let ot=it;ot<tt;ot++){let nt=it>0?rt[ot-X]:0,lt=rt[ot]-nt;J+=Math.abs(lt)}return J}function j(rt,it,X,J,tt,ot){for(let nt=0;nt<X;nt++){let lt=nt>=ot?rt[it+nt-ot]:0,at=it>0?rt[it+nt-X]:0,ut=rt[it+nt]-(lt+at>>1);J[tt+nt]=ut}}function G(rt,it,X,J){let tt=0;for(let ot=0;ot<X;ot++){let nt=ot>=J?rt[it+ot-J]:0,lt=it>0?rt[it+ot-X]:0,at=rt[it+ot]-(nt+lt>>1);tt+=Math.abs(at)}return tt}function H(rt,it,X,J,tt,ot){for(let nt=0;nt<X;nt++){let lt=nt>=ot?rt[it+nt-ot]:0,at=it>0?rt[it+nt-X]:0,ut=it>0&&nt>=ot?rt[it+nt-(X+ot)]:0,V=rt[it+nt]-I(lt,at,ut);J[tt+nt]=V}}function W(rt,it,X,J){let tt=0;for(let ot=0;ot<X;ot++){let nt=ot>=J?rt[it+ot-J]:0,lt=it>0?rt[it+ot-X]:0,at=it>0&&ot>=J?rt[it+ot-(X+J)]:0,ut=rt[it+ot]-I(nt,lt,at);tt+=Math.abs(ut)}return tt}let Q={0:P,1:$,2:U,3:j,4:H},q={0:F,1:D,2:Z,3:G,4:W};m.exports=function(rt,it,X,J,tt){let ot;if("filterType"in J&&J.filterType!==-1){if(typeof J.filterType!="number")throw new Error("unrecognised filter types");ot=[J.filterType]}else ot=[0,1,2,3,4];J.bitDepth===16&&(tt*=2);let nt=it*tt,lt=0,at=0,ut=w.alloc((nt+1)*X),V=ot[0];for(let ht=0;ht<X;ht++){if(ot.length>1){let vt=1/0;for(let pt=0;pt<ot.length;pt++){let st=q[ot[pt]](rt,at,nt,tt);st<vt&&(V=ot[pt],vt=st)}}ut[lt]=V,lt++,Q[V](rt,at,nt,ut,lt,tt),lt+=nt,at+=nt}return ut}}).call(this)}).call(this,d("buffer").Buffer)},{"./paeth-predictor":15,buffer:32}],7:[function(d,m,g){(function(w){(function(){let I=d("util"),P=d("./chunkstream"),F=d("./filter-parse"),$=m.exports=function(D){P.call(this);let U=[],Z=this;this._filter=new F(D,{read:this.read.bind(this),write:function(j){U.push(j)},complete:function(){Z.emit("complete",w.concat(U))}}),this._filter.start()};I.inherits($,P)}).call(this)}).call(this,d("buffer").Buffer)},{"./chunkstream":3,"./filter-parse":9,buffer:32,util:84}],8:[function(d,m,g){(function(w){(function(){let I=d("./sync-reader"),P=d("./filter-parse");g.process=function(F,$){let D=[],U=new I(F);return new P($,{read:U.read.bind(U),write:function(Z){D.push(Z)},complete:function(){}}).start(),U.process(),w.concat(D)}}).call(this)}).call(this,d("buffer").Buffer)},{"./filter-parse":9,"./sync-reader":22,buffer:32}],9:[function(d,m,g){(function(w){(function(){let I=d("./interlace"),P=d("./paeth-predictor");function F(D,U,Z){let j=D*U;return Z!==8&&(j=Math.ceil(j/(8/Z))),j}let $=m.exports=function(D,U){let Z=D.width,j=D.height,G=D.interlace,H=D.bpp,W=D.depth;if(this.read=U.read,this.write=U.write,this.complete=U.complete,this._imageIndex=0,this._images=[],G){let Q=I.getImagePasses(Z,j);for(let q=0;q<Q.length;q++)this._images.push({byteWidth:F(Q[q].width,H,W),height:Q[q].height,lineIndex:0})}else this._images.push({byteWidth:F(Z,H,W),height:j,lineIndex:0});this._xComparison=W===8?H:W===16?2*H:1};$.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},$.prototype._unFilterType1=function(D,U,Z){let j=this._xComparison,G=j-1;for(let H=0;H<Z;H++){let W=D[1+H],Q=H>G?U[H-j]:0;U[H]=W+Q}},$.prototype._unFilterType2=function(D,U,Z){let j=this._lastLine;for(let G=0;G<Z;G++){let H=D[1+G],W=j?j[G]:0;U[G]=H+W}},$.prototype._unFilterType3=function(D,U,Z){let j=this._xComparison,G=j-1,H=this._lastLine;for(let W=0;W<Z;W++){let Q=D[1+W],q=H?H[W]:0,rt=W>G?U[W-j]:0,it=Math.floor((rt+q)/2);U[W]=Q+it}},$.prototype._unFilterType4=function(D,U,Z){let j=this._xComparison,G=j-1,H=this._lastLine;for(let W=0;W<Z;W++){let Q=D[1+W],q=H?H[W]:0,rt=W>G?U[W-j]:0,it=W>G&&H?H[W-j]:0,X=P(rt,q,it);U[W]=Q+X}},$.prototype._reverseFilterLine=function(D){let U,Z=D[0],j=this._images[this._imageIndex],G=j.byteWidth;if(Z===0)U=D.slice(1,G+1);else switch(U=w.alloc(G),Z){case 1:this._unFilterType1(D,U,G);break;case 2:this._unFilterType2(D,U,G);break;case 3:this._unFilterType3(D,U,G);break;case 4:this._unFilterType4(D,U,G);break;default:throw new Error("Unrecognised filter type - "+Z)}this.write(U),j.lineIndex++,j.lineIndex>=j.height?(this._lastLine=null,this._imageIndex++,j=this._images[this._imageIndex]):this._lastLine=U,j?this.read(j.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())}}).call(this)}).call(this,d("buffer").Buffer)},{"./interlace":11,"./paeth-predictor":15,buffer:32}],10:[function(d,m,g){(function(w){(function(){function I($,D,U,Z,j){let G=0;for(let H=0;H<Z;H++)for(let W=0;W<U;W++){let Q=j[$[G]];if(!Q)throw new Error("index "+$[G]+" not in palette");for(let q=0;q<4;q++)D[G+q]=Q[q];G+=4}}function P($,D,U,Z,j){let G=0;for(let H=0;H<Z;H++)for(let W=0;W<U;W++){let Q=!1;if(j.length===1?j[0]===$[G]&&(Q=!0):j[0]===$[G]&&j[1]===$[G+1]&&j[2]===$[G+2]&&(Q=!0),Q)for(let q=0;q<4;q++)D[G+q]=0;G+=4}}function F($,D,U,Z,j){let G=255,H=Math.pow(2,j)-1,W=0;for(let Q=0;Q<Z;Q++)for(let q=0;q<U;q++){for(let rt=0;rt<4;rt++)D[W+rt]=Math.floor($[W+rt]*G/H+.5);W+=4}}m.exports=function($,D,U=!1){let Z=D.depth,j=D.width,G=D.height,H=D.colorType,W=D.transColor,Q=D.palette,q=$;return H===3?I($,q,j,G,Q):(W&&P($,q,j,G,W),Z===8||U||(Z===16&&(q=w.alloc(j*G*4)),F($,q,j,G,Z))),q}}).call(this)}).call(this,d("buffer").Buffer)},{buffer:32}],11:[function(d,m,g){let w=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];g.getImagePasses=function(I,P){let F=[],$=I%8,D=P%8,U=(I-$)/8,Z=(P-D)/8;for(let j=0;j<w.length;j++){let G=w[j],H=U*G.x.length,W=Z*G.y.length;for(let Q=0;Q<G.x.length&&G.x[Q]<$;Q++)H++;for(let Q=0;Q<G.y.length&&G.y[Q]<D;Q++)W++;H>0&&W>0&&F.push({width:H,height:W,index:j})}return F},g.getInterlaceIterator=function(I){return function(P,F,$){let D=P%w[$].x.length,U=(P-D)/w[$].x.length*8+w[$].x[D],Z=F%w[$].y.length;return 4*U+((F-Z)/w[$].y.length*8+w[$].y[Z])*I*4}}},{}],12:[function(d,m,g){(function(w){(function(){let I=d("util"),P=d("stream"),F=d("./constants"),$=d("./packer"),D=m.exports=function(U){P.call(this);let Z=U||{};this._packer=new $(Z),this._deflate=this._packer.createDeflate(),this.readable=!0};I.inherits(D,P),D.prototype.pack=function(U,Z,j,G){this.emit("data",w.from(F.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(Z,j)),G&&this.emit("data",this._packer.packGAMA(G));let H=this._packer.filterData(U,Z,j);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",(function(W){this.emit("data",this._packer.packIDAT(W))}).bind(this)),this._deflate.on("end",(function(){this.emit("data",this._packer.packIEND()),this.emit("end")}).bind(this)),this._deflate.end(H)}}).call(this)}).call(this,d("buffer").Buffer)},{"./constants":4,"./packer":14,buffer:32,stream:65,util:84}],13:[function(d,m,g){(function(w){(function(){let I=!0,P=d("zlib");P.deflateSync||(I=!1);let F=d("./constants"),$=d("./packer");m.exports=function(D,U){if(!I)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let Z=new $(U||{}),j=[];j.push(w.from(F.PNG_SIGNATURE)),j.push(Z.packIHDR(D.width,D.height)),D.gamma&&j.push(Z.packGAMA(D.gamma));let G=Z.filterData(D.data,D.width,D.height),H=P.deflateSync(G,Z.getDeflateOptions());if(G=null,!H||!H.length)throw new Error("bad png - invalid compressed data response");return j.push(Z.packIDAT(H)),j.push(Z.packIEND()),w.concat(j)}}).call(this)}).call(this,d("buffer").Buffer)},{"./constants":4,"./packer":14,buffer:32,zlib:31}],14:[function(d,m,g){(function(w){(function(){let I=d("./constants"),P=d("./crc"),F=d("./bitpacker"),$=d("./filter-pack"),D=d("zlib"),U=m.exports=function(Z){if(this._options=Z,Z.deflateChunkSize=Z.deflateChunkSize||32768,Z.deflateLevel=Z.deflateLevel!=null?Z.deflateLevel:9,Z.deflateStrategy=Z.deflateStrategy!=null?Z.deflateStrategy:3,Z.inputHasAlpha=Z.inputHasAlpha==null||Z.inputHasAlpha,Z.deflateFactory=Z.deflateFactory||D.createDeflate,Z.bitDepth=Z.bitDepth||8,Z.colorType=typeof Z.colorType=="number"?Z.colorType:I.COLORTYPE_COLOR_ALPHA,Z.inputColorType=typeof Z.inputColorType=="number"?Z.inputColorType:I.COLORTYPE_COLOR_ALPHA,[I.COLORTYPE_GRAYSCALE,I.COLORTYPE_COLOR,I.COLORTYPE_COLOR_ALPHA,I.COLORTYPE_ALPHA].indexOf(Z.colorType)===-1)throw new Error("option color type:"+Z.colorType+" is not supported at present");if([I.COLORTYPE_GRAYSCALE,I.COLORTYPE_COLOR,I.COLORTYPE_COLOR_ALPHA,I.COLORTYPE_ALPHA].indexOf(Z.inputColorType)===-1)throw new Error("option input color type:"+Z.inputColorType+" is not supported at present");if(Z.bitDepth!==8&&Z.bitDepth!==16)throw new Error("option bit depth:"+Z.bitDepth+" is not supported at present")};U.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},U.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},U.prototype.filterData=function(Z,j,G){let H=F(Z,j,G,this._options),W=I.COLORTYPE_TO_BPP_MAP[this._options.colorType];return $(H,j,G,this._options,W)},U.prototype._packChunk=function(Z,j){let G=j?j.length:0,H=w.alloc(G+12);return H.writeUInt32BE(G,0),H.writeUInt32BE(Z,4),j&&j.copy(H,8),H.writeInt32BE(P.crc32(H.slice(4,H.length-4)),H.length-4),H},U.prototype.packGAMA=function(Z){let j=w.alloc(4);return j.writeUInt32BE(Math.floor(Z*I.GAMMA_DIVISION),0),this._packChunk(I.TYPE_gAMA,j)},U.prototype.packIHDR=function(Z,j){let G=w.alloc(13);return G.writeUInt32BE(Z,0),G.writeUInt32BE(j,4),G[8]=this._options.bitDepth,G[9]=this._options.colorType,G[10]=0,G[11]=0,G[12]=0,this._packChunk(I.TYPE_IHDR,G)},U.prototype.packIDAT=function(Z){return this._packChunk(I.TYPE_IDAT,Z)},U.prototype.packIEND=function(){return this._packChunk(I.TYPE_IEND,null)}}).call(this)}).call(this,d("buffer").Buffer)},{"./bitpacker":2,"./constants":4,"./crc":5,"./filter-pack":6,buffer:32,zlib:31}],15:[function(d,m,g){m.exports=function(w,I,P){let F=w+I-P,$=Math.abs(F-w),D=Math.abs(F-I),U=Math.abs(F-P);return $<=D&&$<=U?w:D<=U?I:P}},{}],16:[function(d,m,g){let w=d("util"),I=d("zlib"),P=d("./chunkstream"),F=d("./filter-parse-async"),$=d("./parser"),D=d("./bitmapper"),U=d("./format-normaliser"),Z=m.exports=function(j){P.call(this),this._parser=new $(j,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this),simpleTransparency:this._simpleTransparency.bind(this),headersFinished:this._headersFinished.bind(this)}),this._options=j,this.writable=!0,this._parser.start()};w.inherits(Z,P),Z.prototype._handleError=function(j){this.emit("error",j),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this._filter&&(this._filter.destroy(),this._filter.on("error",function(){})),this.errord=!0},Z.prototype._inflateData=function(j){if(!this._inflate)if(this._bitmapInfo.interlace)this._inflate=I.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter);else{let G=(1+(this._bitmapInfo.width*this._bitmapInfo.bpp*this._bitmapInfo.depth+7>>3))*this._bitmapInfo.height,H=Math.max(G,I.Z_MIN_CHUNK);this._inflate=I.createInflate({chunkSize:H});let W=G,Q=this.emit.bind(this,"error");this._inflate.on("error",function(rt){W&&Q(rt)}),this._filter.on("complete",this._complete.bind(this));let q=this._filter.write.bind(this._filter);this._inflate.on("data",function(rt){W&&(rt.length>W&&(rt=rt.slice(0,W)),W-=rt.length,q(rt))}),this._inflate.on("end",this._filter.end.bind(this._filter))}this._inflate.write(j)},Z.prototype._handleMetaData=function(j){this._metaData=j,this._bitmapInfo=Object.create(j),this._filter=new F(this._bitmapInfo)},Z.prototype._handleTransColor=function(j){this._bitmapInfo.transColor=j},Z.prototype._handlePalette=function(j){this._bitmapInfo.palette=j},Z.prototype._simpleTransparency=function(){this._metaData.alpha=!0},Z.prototype._headersFinished=function(){this.emit("metadata",this._metaData)},Z.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"))},Z.prototype._complete=function(j){if(this.errord)return;let G;try{let H=D.dataToBitMap(j,this._bitmapInfo);G=U(H,this._bitmapInfo,this._options.skipRescale),H=null}catch(H){return void this._handleError(H)}this.emit("parsed",G)}},{"./bitmapper":1,"./chunkstream":3,"./filter-parse-async":7,"./format-normaliser":10,"./parser":18,util:84,zlib:31}],17:[function(d,m,g){(function(w){(function(){let I=!0,P=d("zlib"),F=d("./sync-inflate");P.deflateSync||(I=!1);let $=d("./sync-reader"),D=d("./filter-parse-sync"),U=d("./parser"),Z=d("./bitmapper"),j=d("./format-normaliser");m.exports=function(G,H){if(!I)throw new Error("To use the sync capability of this library in old node versions, please pin pngjs to v2.3.0");let W,Q,q;function rt(st){W=st}function it(st){Q=st}function X(st){Q.transColor=st}function J(st){Q.palette=st}function tt(){Q.alpha=!0}function ot(st){q=st}let nt=[];function lt(st){nt.push(st)}let at=new $(G);if(new U(H,{read:at.read.bind(at),error:rt,metadata:it,gamma:ot,palette:J,transColor:X,inflateData:lt,simpleTransparency:tt}).start(),at.process(),W)throw W;let ut,V=w.concat(nt);if(nt.length=0,Q.interlace)ut=P.inflateSync(V);else{let st=(1+(Q.width*Q.bpp*Q.depth+7>>3))*Q.height;ut=F(V,{chunkSize:st,maxLength:st})}if(V=null,!ut||!ut.length)throw new Error("bad png - invalid inflate data response");let ht=D.process(ut,Q);V=null;let vt=Z.dataToBitMap(ht,Q);ht=null;let pt=j(vt,Q,H.skipRescale);return Q.data=pt,Q.gamma=q||0,Q}}).call(this)}).call(this,d("buffer").Buffer)},{"./bitmapper":1,"./filter-parse-sync":8,"./format-normaliser":10,"./parser":18,"./sync-inflate":21,"./sync-reader":22,buffer:32,zlib:31}],18:[function(d,m,g){(function(w){(function(){let I=d("./constants"),P=d("./crc"),F=m.exports=function($,D){this._options=$,$.checkCRC=$.checkCRC!==!1,this._hasIHDR=!1,this._hasIEND=!1,this._emittedHeadersFinished=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[I.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[I.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[I.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[I.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[I.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[I.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=D.read,this.error=D.error,this.metadata=D.metadata,this.gamma=D.gamma,this.transColor=D.transColor,this.palette=D.palette,this.parsed=D.parsed,this.inflateData=D.inflateData,this.finished=D.finished,this.simpleTransparency=D.simpleTransparency,this.headersFinished=D.headersFinished||function(){}};F.prototype.start=function(){this.read(I.PNG_SIGNATURE.length,this._parseSignature.bind(this))},F.prototype._parseSignature=function($){let D=I.PNG_SIGNATURE;for(let U=0;U<D.length;U++)if($[U]!==D[U])return void this.error(new Error("Invalid file signature"));this.read(8,this._parseChunkBegin.bind(this))},F.prototype._parseChunkBegin=function($){let D=$.readUInt32BE(0),U=$.readUInt32BE(4),Z="";for(let G=4;G<8;G++)Z+=String.fromCharCode($[G]);let j=!!(32&$[4]);if(this._hasIHDR||U===I.TYPE_IHDR){if(this._crc=new P,this._crc.write(w.from(Z)),this._chunks[U])return this._chunks[U](D);j?this.read(D+4,this._skipChunk.bind(this)):this.error(new Error("Unsupported critical chunk type "+Z))}else this.error(new Error("Expected IHDR on beggining"))},F.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},F.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},F.prototype._parseChunkEnd=function($){let D=$.readInt32BE(0),U=this._crc.crc32();this._options.checkCRC&&U!==D?this.error(new Error("Crc error - "+D+" - "+U)):this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},F.prototype._handleIHDR=function($){this.read($,this._parseIHDR.bind(this))},F.prototype._parseIHDR=function($){this._crc.write($);let D=$.readUInt32BE(0),U=$.readUInt32BE(4),Z=$[8],j=$[9],G=$[10],H=$[11],W=$[12];if(Z!==8&&Z!==4&&Z!==2&&Z!==1&&Z!==16)return void this.error(new Error("Unsupported bit depth "+Z));if(!(j in I.COLORTYPE_TO_BPP_MAP))return void this.error(new Error("Unsupported color type"));if(G!==0)return void this.error(new Error("Unsupported compression method"));if(H!==0)return void this.error(new Error("Unsupported filter method"));if(W!==0&&W!==1)return void this.error(new Error("Unsupported interlace method"));this._colorType=j;let Q=I.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:D,height:U,depth:Z,interlace:!!W,palette:!!(j&I.COLORTYPE_PALETTE),color:!!(j&I.COLORTYPE_COLOR),alpha:!!(j&I.COLORTYPE_ALPHA),bpp:Q,colorType:j}),this._handleChunkEnd()},F.prototype._handlePLTE=function($){this.read($,this._parsePLTE.bind(this))},F.prototype._parsePLTE=function($){this._crc.write($);let D=Math.floor($.length/3);for(let U=0;U<D;U++)this._palette.push([$[3*U],$[3*U+1],$[3*U+2],255]);this.palette(this._palette),this._handleChunkEnd()},F.prototype._handleTRNS=function($){this.simpleTransparency(),this.read($,this._parseTRNS.bind(this))},F.prototype._parseTRNS=function($){if(this._crc.write($),this._colorType===I.COLORTYPE_PALETTE_COLOR){if(this._palette.length===0)return void this.error(new Error("Transparency chunk must be after palette"));if($.length>this._palette.length)return void this.error(new Error("More transparent colors than palette size"));for(let D=0;D<$.length;D++)this._palette[D][3]=$[D];this.palette(this._palette)}this._colorType===I.COLORTYPE_GRAYSCALE&&this.transColor([$.readUInt16BE(0)]),this._colorType===I.COLORTYPE_COLOR&&this.transColor([$.readUInt16BE(0),$.readUInt16BE(2),$.readUInt16BE(4)]),this._handleChunkEnd()},F.prototype._handleGAMA=function($){this.read($,this._parseGAMA.bind(this))},F.prototype._parseGAMA=function($){this._crc.write($),this.gamma($.readUInt32BE(0)/I.GAMMA_DIVISION),this._handleChunkEnd()},F.prototype._handleIDAT=function($){this._emittedHeadersFinished||(this._emittedHeadersFinished=!0,this.headersFinished()),this.read(-$,this._parseIDAT.bind(this,$))},F.prototype._parseIDAT=function($,D){if(this._crc.write(D),this._colorType===I.COLORTYPE_PALETTE_COLOR&&this._palette.length===0)throw new Error("Expected palette not found");this.inflateData(D);let U=$-D.length;U>0?this._handleIDAT(U):this._handleChunkEnd()},F.prototype._handleIEND=function($){this.read($,this._parseIEND.bind(this))},F.prototype._parseIEND=function($){this._crc.write($),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()}}).call(this)}).call(this,d("buffer").Buffer)},{"./constants":4,"./crc":5,buffer:32}],19:[function(d,m,g){let w=d("./parser-sync"),I=d("./packer-sync");g.read=function(P,F){return w(P,F||{})},g.write=function(P,F){return I(P,F)}},{"./packer-sync":13,"./parser-sync":17}],20:[function(d,m,g){(function(w,I){(function(){let P=d("util"),F=d("stream"),$=d("./parser-async"),D=d("./packer-async"),U=d("./png-sync"),Z=g.PNG=function(j){F.call(this),j=j||{},this.width=0|j.width,this.height=0|j.height,this.data=this.width>0&&this.height>0?I.alloc(4*this.width*this.height):null,j.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new $(j),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",(function(G){this.data=G,this.emit("parsed",G)}).bind(this)),this._packer=new D(j),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};P.inherits(Z,F),Z.sync=U,Z.prototype.pack=function(){return this.data&&this.data.length?(w.nextTick((function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}).bind(this)),this):(this.emit("error","No data provided"),this)},Z.prototype.parse=function(j,G){if(G){let H,W;H=(function(Q){this.removeListener("error",W),this.data=Q,G(null,this)}).bind(this),W=(function(Q){this.removeListener("parsed",H),G(Q,null)}).bind(this),this.once("parsed",H),this.once("error",W)}return this.end(j),this},Z.prototype.write=function(j){return this._parser.write(j),!0},Z.prototype.end=function(j){this._parser.end(j)},Z.prototype._metadata=function(j){this.width=j.width,this.height=j.height,this.emit("metadata",j)},Z.prototype._gamma=function(j){this.gamma=j},Z.prototype._handleClose=function(){this._parser.writable||this._packer.readable||this.emit("close")},Z.bitblt=function(j,G,H,W,Q,q,rt,it){if(W|=0,Q|=0,q|=0,rt|=0,it|=0,(H|=0)>j.width||W>j.height||H+Q>j.width||W+q>j.height)throw new Error("bitblt reading outside image");if(rt>G.width||it>G.height||rt+Q>G.width||it+q>G.height)throw new Error("bitblt writing outside image");for(let X=0;X<q;X++)j.data.copy(G.data,(it+X)*G.width+rt<<2,(W+X)*j.width+H<<2,(W+X)*j.width+H+Q<<2)},Z.prototype.bitblt=function(j,G,H,W,Q,q,rt){return Z.bitblt(this,j,G,H,W,Q,q,rt),this},Z.adjustGamma=function(j){if(j.gamma){for(let G=0;G<j.height;G++)for(let H=0;H<j.width;H++){let W=j.width*G+H<<2;for(let Q=0;Q<3;Q++){let q=j.data[W+Q]/255;q=Math.pow(q,1/2.2/j.gamma),j.data[W+Q]=Math.round(255*q)}}j.gamma=0}},Z.prototype.adjustGamma=function(){Z.adjustGamma(this)}}).call(this)}).call(this,d("_process"),d("buffer").Buffer)},{"./packer-async":12,"./parser-async":16,"./png-sync":19,_process:63,buffer:32,stream:65,util:84}],21:[function(d,m,g){(function(w,I){(function(){let P=d("assert").ok,F=d("zlib"),$=d("util"),D=d("buffer").kMaxLength;function U(W){if(!(this instanceof U))return new U(W);W&&W.chunkSize<F.Z_MIN_CHUNK&&(W.chunkSize=F.Z_MIN_CHUNK),F.Inflate.call(this,W),this._offset=this._offset===void 0?this._outOffset:this._offset,this._buffer=this._buffer||this._outBuffer,W&&W.maxLength!=null&&(this._maxLength=W.maxLength)}function Z(W){return new U(W)}function j(W,Q){W._handle&&(W._handle.close(),W._handle=null)}function G(W,Q){if(typeof Q=="string"&&(Q=I.from(Q)),!(Q instanceof I))throw new TypeError("Not a string or buffer");let q=W._finishFlushFlag;return q==null&&(q=F.Z_FINISH),W._processChunk(Q,q)}function H(W,Q){return G(new U(Q),W)}U.prototype._processChunk=function(W,Q,q){if(typeof q=="function")return F.Inflate._processChunk.call(this,W,Q,q);let rt,it,X=this,J=W&&W.length,tt=this._chunkSize-this._offset,ot=this._maxLength,nt=0,lt=[],at=0;function ut(ht,vt){if(X._hadError)return;let pt=tt-vt;if(P(pt>=0,"have should not go down"),pt>0){let st=X._buffer.slice(X._offset,X._offset+pt);if(X._offset+=pt,st.length>ot&&(st=st.slice(0,ot)),lt.push(st),at+=st.length,ot-=st.length,ot===0)return!1}return(vt===0||X._offset>=X._chunkSize)&&(tt=X._chunkSize,X._offset=0,X._buffer=I.allocUnsafe(X._chunkSize)),vt===0&&(nt+=J-ht,J=ht,!0)}this.on("error",function(ht){rt=ht}),P(this._handle,"zlib binding closed");do it=this._handle.writeSync(Q,W,nt,J,this._buffer,this._offset,tt),it=it||this._writeState;while(!this._hadError&&ut(it[0],it[1]));if(this._hadError)throw rt;if(at>=D)throw j(this),new RangeError("Cannot create final Buffer. It would be larger than 0x"+D.toString(16)+" bytes");let V=I.concat(lt,at);return j(this),V},$.inherits(U,F.Inflate),m.exports=g=H,g.Inflate=U,g.createInflate=Z,g.inflateSync=H}).call(this)}).call(this,d("_process"),d("buffer").Buffer)},{_process:63,assert:23,buffer:32,util:84,zlib:31}],22:[function(d,m,g){let w=m.exports=function(I){this._buffer=I,this._reads=[]};w.prototype.read=function(I,P){this._reads.push({length:Math.abs(I),allowLess:I<0,func:P})},w.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){let I=this._reads[0];if(!this._buffer.length||!(this._buffer.length>=I.length||I.allowLess))break;{this._reads.shift();let P=this._buffer;this._buffer=P.slice(I.length),I.func.call(this,P.slice(0,I.length))}}if(this._reads.length>0)throw new Error("There are some read requests waitng on finished stream");if(this._buffer.length>0)throw new Error("unrecognised content at end of stream")}},{}],23:[function(d,m,g){(function(w){(function(){var I=d("object-assign");/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
	 * @license  MIT
	 */function P(pt,st){if(pt===st)return 0;for(var ct=pt.length,At=st.length,kt=0,yt=Math.min(ct,At);kt<yt;++kt)if(pt[kt]!==st[kt]){ct=pt[kt],At=st[kt];break}return ct<At?-1:At<ct?1:0}function F(pt){return w.Buffer&&typeof w.Buffer.isBuffer=="function"?w.Buffer.isBuffer(pt):!(pt==null||!pt._isBuffer)}var $=d("util/"),D=Object.prototype.hasOwnProperty,U=Array.prototype.slice,Z=(function(){}).name==="foo";function j(pt){return Object.prototype.toString.call(pt)}function G(pt){return!F(pt)&&typeof w.ArrayBuffer=="function"&&(typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(pt):!!pt&&(pt instanceof DataView||!!(pt.buffer&&pt.buffer instanceof ArrayBuffer)))}var H=m.exports=J,W=/\s*function\s+([^\(\s]*)\s*/;function Q(pt){if($.isFunction(pt)){if(Z)return pt.name;var st=pt.toString().match(W);return st&&st[1]}}function q(pt,st){return typeof pt=="string"?pt.length<st?pt:pt.slice(0,st):pt}function rt(pt){if(Z||!$.isFunction(pt))return $.inspect(pt);var st=Q(pt);return"[Function"+(st?": "+st:"")+"]"}function it(pt){return q(rt(pt.actual),128)+" "+pt.operator+" "+q(rt(pt.expected),128)}function X(pt,st,ct,At,kt){throw new H.AssertionError({message:ct,actual:pt,expected:st,operator:At,stackStartFunction:kt})}function J(pt,st){pt||X(pt,!0,st,"==",H.ok)}function tt(pt,st,ct,At){if(pt===st)return!0;if(F(pt)&&F(st))return P(pt,st)===0;if($.isDate(pt)&&$.isDate(st))return pt.getTime()===st.getTime();if($.isRegExp(pt)&&$.isRegExp(st))return pt.source===st.source&&pt.global===st.global&&pt.multiline===st.multiline&&pt.lastIndex===st.lastIndex&&pt.ignoreCase===st.ignoreCase;if(pt!==null&&typeof pt=="object"||st!==null&&typeof st=="object"){if(G(pt)&&G(st)&&j(pt)===j(st)&&!(pt instanceof Float32Array||pt instanceof Float64Array))return P(new Uint8Array(pt.buffer),new Uint8Array(st.buffer))===0;if(F(pt)!==F(st))return!1;var kt=(At=At||{actual:[],expected:[]}).actual.indexOf(pt);return kt!==-1&&kt===At.expected.indexOf(st)||(At.actual.push(pt),At.expected.push(st),nt(pt,st,ct,At))}return ct?pt===st:pt==st}function ot(pt){return Object.prototype.toString.call(pt)=="[object Arguments]"}function nt(pt,st,ct,At){if(pt==null||st==null)return!1;if($.isPrimitive(pt)||$.isPrimitive(st))return pt===st;if(ct&&Object.getPrototypeOf(pt)!==Object.getPrototypeOf(st))return!1;var kt=ot(pt),yt=ot(st);if(kt&&!yt||!kt&&yt)return!1;if(kt)return tt(pt=U.call(pt),st=U.call(st),ct);var Ct,xt,Pt=vt(pt),Ft=vt(st);if(Pt.length!==Ft.length)return!1;for(Pt.sort(),Ft.sort(),xt=Pt.length-1;xt>=0;xt--)if(Pt[xt]!==Ft[xt])return!1;for(xt=Pt.length-1;xt>=0;xt--)if(!tt(pt[Ct=Pt[xt]],st[Ct],ct,At))return!1;return!0}function lt(pt,st,ct){tt(pt,st,!0)&&X(pt,st,ct,"notDeepStrictEqual",lt)}function at(pt,st){if(!pt||!st)return!1;if(Object.prototype.toString.call(st)=="[object RegExp]")return st.test(pt);try{if(pt instanceof st)return!0}catch{}return!Error.isPrototypeOf(st)&&st.call({},pt)===!0}function ut(pt){var st;try{pt()}catch(ct){st=ct}return st}function V(pt,st,ct,At){var kt;if(typeof st!="function")throw new TypeError('"block" argument must be a function');typeof ct=="string"&&(At=ct,ct=null),kt=ut(st),At=(ct&&ct.name?" ("+ct.name+").":".")+(At?" "+At:"."),pt&&!kt&&X(kt,ct,"Missing expected exception"+At);var yt=typeof At=="string",Ct=!pt&&kt&&!ct;if((!pt&&$.isError(kt)&&yt&&at(kt,ct)||Ct)&&X(kt,ct,"Got unwanted exception"+At),pt&&kt&&ct&&!at(kt,ct)||!pt&&kt)throw kt}function ht(pt,st){pt||X(pt,!0,st,"==",ht)}H.AssertionError=function(pt){this.name="AssertionError",this.actual=pt.actual,this.expected=pt.expected,this.operator=pt.operator,pt.message?(this.message=pt.message,this.generatedMessage=!1):(this.message=it(this),this.generatedMessage=!0);var st=pt.stackStartFunction||X;if(Error.captureStackTrace)Error.captureStackTrace(this,st);else{var ct=new Error;if(ct.stack){var At=ct.stack,kt=Q(st),yt=At.indexOf(`
`+kt);if(yt>=0){var Ct=At.indexOf(`
`,yt+1);At=At.substring(Ct+1)}this.stack=At}}},$.inherits(H.AssertionError,Error),H.fail=X,H.ok=J,H.equal=function(pt,st,ct){pt!=st&&X(pt,st,ct,"==",H.equal)},H.notEqual=function(pt,st,ct){pt==st&&X(pt,st,ct,"!=",H.notEqual)},H.deepEqual=function(pt,st,ct){tt(pt,st,!1)||X(pt,st,ct,"deepEqual",H.deepEqual)},H.deepStrictEqual=function(pt,st,ct){tt(pt,st,!0)||X(pt,st,ct,"deepStrictEqual",H.deepStrictEqual)},H.notDeepEqual=function(pt,st,ct){tt(pt,st,!1)&&X(pt,st,ct,"notDeepEqual",H.notDeepEqual)},H.notDeepStrictEqual=lt,H.strictEqual=function(pt,st,ct){pt!==st&&X(pt,st,ct,"===",H.strictEqual)},H.notStrictEqual=function(pt,st,ct){pt===st&&X(pt,st,ct,"!==",H.notStrictEqual)},H.throws=function(pt,st,ct){V(!0,pt,st,ct)},H.doesNotThrow=function(pt,st,ct){V(!1,pt,st,ct)},H.ifError=function(pt){if(pt)throw pt},H.strict=I(ht,H,{equal:H.strictEqual,deepEqual:H.deepStrictEqual,notEqual:H.notStrictEqual,notDeepEqual:H.notDeepStrictEqual}),H.strict.strict=H.strict;var vt=Object.keys||function(pt){var st=[];for(var ct in pt)D.call(pt,ct)&&st.push(ct);return st}}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"object-assign":51,"util/":26}],24:[function(d,m,g){typeof Object.create=="function"?m.exports=function(w,I){w.super_=I,w.prototype=Object.create(I.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}})}:m.exports=function(w,I){w.super_=I;var P=function(){};P.prototype=I.prototype,w.prototype=new P,w.prototype.constructor=w}},{}],25:[function(d,m,g){m.exports=function(w){return w&&typeof w=="object"&&typeof w.copy=="function"&&typeof w.fill=="function"&&typeof w.readUInt8=="function"}},{}],26:[function(d,m,g){(function(w,I){(function(){var P=/%[sdj%]/g;g.format=function(xt){if(!nt(xt)){for(var Pt=[],Ft=0;Ft<arguments.length;Ft++)Pt.push(D(arguments[Ft]));return Pt.join(" ")}Ft=1;for(var Rt=arguments,Mt=Rt.length,Bt=String(xt).replace(P,function(Ot){if(Ot==="%%")return"%";if(Ft>=Mt)return Ot;switch(Ot){case"%s":return String(Rt[Ft++]);case"%d":return Number(Rt[Ft++]);case"%j":try{return JSON.stringify(Rt[Ft++])}catch{return"[Circular]"}default:return Ot}}),$t=Rt[Ft];Ft<Mt;$t=Rt[++Ft])J($t)||!V($t)?Bt+=" "+$t:Bt+=" "+D($t);return Bt},g.deprecate=function(xt,Pt){if(at(I.process))return function(){return g.deprecate(xt,Pt).apply(this,arguments)};if(w.noDeprecation===!0)return xt;var Ft=!1;function Rt(){if(!Ft){if(w.throwDeprecation)throw new Error(Pt);w.traceDeprecation?console.trace(Pt):console.error(Pt),Ft=!0}return xt.apply(this,arguments)}return Rt};var F,$={};function D(xt,Pt){var Ft={seen:[],stylize:Z};return arguments.length>=3&&(Ft.depth=arguments[2]),arguments.length>=4&&(Ft.colors=arguments[3]),X(Pt)?Ft.showHidden=Pt:Pt&&g._extend(Ft,Pt),at(Ft.showHidden)&&(Ft.showHidden=!1),at(Ft.depth)&&(Ft.depth=2),at(Ft.colors)&&(Ft.colors=!1),at(Ft.customInspect)&&(Ft.customInspect=!0),Ft.colors&&(Ft.stylize=U),G(Ft,xt,Ft.depth)}function U(xt,Pt){var Ft=D.styles[Pt];return Ft?"\x1B["+D.colors[Ft][0]+"m"+xt+"\x1B["+D.colors[Ft][1]+"m":xt}function Z(xt,Pt){return xt}function j(xt){var Pt={};return xt.forEach(function(Ft,Rt){Pt[Ft]=!0}),Pt}function G(xt,Pt,Ft){if(xt.customInspect&&Pt&&pt(Pt.inspect)&&Pt.inspect!==g.inspect&&(!Pt.constructor||Pt.constructor.prototype!==Pt)){var Rt=Pt.inspect(Ft,xt);return nt(Rt)||(Rt=G(xt,Rt,Ft)),Rt}var Mt=H(xt,Pt);if(Mt)return Mt;var Bt=Object.keys(Pt),$t=j(Bt);if(xt.showHidden&&(Bt=Object.getOwnPropertyNames(Pt)),vt(Pt)&&(Bt.indexOf("message")>=0||Bt.indexOf("description")>=0))return W(Pt);if(Bt.length===0){if(pt(Pt)){var Ot=Pt.name?": "+Pt.name:"";return xt.stylize("[Function"+Ot+"]","special")}if(ut(Pt))return xt.stylize(RegExp.prototype.toString.call(Pt),"regexp");if(ht(Pt))return xt.stylize(Date.prototype.toString.call(Pt),"date");if(vt(Pt))return W(Pt)}var Zt,Tt="",et=!1,It=["{","}"];return it(Pt)&&(et=!0,It=["[","]"]),pt(Pt)&&(Tt=" [Function"+(Pt.name?": "+Pt.name:"")+"]"),ut(Pt)&&(Tt=" "+RegExp.prototype.toString.call(Pt)),ht(Pt)&&(Tt=" "+Date.prototype.toUTCString.call(Pt)),vt(Pt)&&(Tt=" "+W(Pt)),Bt.length!==0||et&&Pt.length!=0?Ft<0?ut(Pt)?xt.stylize(RegExp.prototype.toString.call(Pt),"regexp"):xt.stylize("[Object]","special"):(xt.seen.push(Pt),Zt=et?Q(xt,Pt,Ft,$t,Bt):Bt.map(function(mt){return q(xt,Pt,Ft,$t,mt,et)}),xt.seen.pop(),rt(Zt,Tt,It)):It[0]+Tt+It[1]}function H(xt,Pt){if(at(Pt))return xt.stylize("undefined","undefined");if(nt(Pt)){var Ft="'"+JSON.stringify(Pt).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return xt.stylize(Ft,"string")}return ot(Pt)?xt.stylize(""+Pt,"number"):X(Pt)?xt.stylize(""+Pt,"boolean"):J(Pt)?xt.stylize("null","null"):void 0}function W(xt){return"["+Error.prototype.toString.call(xt)+"]"}function Q(xt,Pt,Ft,Rt,Mt){for(var Bt=[],$t=0,Ot=Pt.length;$t<Ot;++$t)Ct(Pt,String($t))?Bt.push(q(xt,Pt,Ft,Rt,String($t),!0)):Bt.push("");return Mt.forEach(function(Zt){Zt.match(/^\d+$/)||Bt.push(q(xt,Pt,Ft,Rt,Zt,!0))}),Bt}function q(xt,Pt,Ft,Rt,Mt,Bt){var $t,Ot,Zt;if((Zt=Object.getOwnPropertyDescriptor(Pt,Mt)||{value:Pt[Mt]}).get?Ot=Zt.set?xt.stylize("[Getter/Setter]","special"):xt.stylize("[Getter]","special"):Zt.set&&(Ot=xt.stylize("[Setter]","special")),Ct(Rt,Mt)||($t="["+Mt+"]"),Ot||(xt.seen.indexOf(Zt.value)<0?(Ot=J(Ft)?G(xt,Zt.value,null):G(xt,Zt.value,Ft-1)).indexOf(`
`)>-1&&(Ot=Bt?Ot.split(`
`).map(function(Tt){return"  "+Tt}).join(`
`).substr(2):`
`+Ot.split(`
`).map(function(Tt){return"   "+Tt}).join(`
`)):Ot=xt.stylize("[Circular]","special")),at($t)){if(Bt&&Mt.match(/^\d+$/))return Ot;($t=JSON.stringify(""+Mt)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?($t=$t.substr(1,$t.length-2),$t=xt.stylize($t,"name")):($t=$t.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),$t=xt.stylize($t,"string"))}return $t+": "+Ot}function rt(xt,Pt,Ft){return xt.reduce(function(Rt,Mt){return Mt.indexOf(`
`),Rt+Mt.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?Ft[0]+(Pt===""?"":Pt+`
 `)+" "+xt.join(`,
  `)+" "+Ft[1]:Ft[0]+Pt+" "+xt.join(", ")+" "+Ft[1]}function it(xt){return Array.isArray(xt)}function X(xt){return typeof xt=="boolean"}function J(xt){return xt===null}function tt(xt){return xt==null}function ot(xt){return typeof xt=="number"}function nt(xt){return typeof xt=="string"}function lt(xt){return typeof xt=="symbol"}function at(xt){return xt===void 0}function ut(xt){return V(xt)&&ct(xt)==="[object RegExp]"}function V(xt){return typeof xt=="object"&&xt!==null}function ht(xt){return V(xt)&&ct(xt)==="[object Date]"}function vt(xt){return V(xt)&&(ct(xt)==="[object Error]"||xt instanceof Error)}function pt(xt){return typeof xt=="function"}function st(xt){return xt===null||typeof xt=="boolean"||typeof xt=="number"||typeof xt=="string"||typeof xt=="symbol"||xt===void 0}function ct(xt){return Object.prototype.toString.call(xt)}function At(xt){return xt<10?"0"+xt.toString(10):xt.toString(10)}g.debuglog=function(xt){if(at(F)&&(F=w.env.NODE_DEBUG||""),xt=xt.toUpperCase(),!$[xt])if(new RegExp("\\b"+xt+"\\b","i").test(F)){var Pt=w.pid;$[xt]=function(){var Ft=g.format.apply(g,arguments);console.error("%s %d: %s",xt,Pt,Ft)}}else $[xt]=function(){};return $[xt]},g.inspect=D,D.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},D.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},g.isArray=it,g.isBoolean=X,g.isNull=J,g.isNullOrUndefined=tt,g.isNumber=ot,g.isString=nt,g.isSymbol=lt,g.isUndefined=at,g.isRegExp=ut,g.isObject=V,g.isDate=ht,g.isError=vt,g.isFunction=pt,g.isPrimitive=st,g.isBuffer=d("./support/isBuffer");var kt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function yt(){var xt=new Date,Pt=[At(xt.getHours()),At(xt.getMinutes()),At(xt.getSeconds())].join(":");return[xt.getDate(),kt[xt.getMonth()],Pt].join(" ")}function Ct(xt,Pt){return Object.prototype.hasOwnProperty.call(xt,Pt)}g.log=function(){console.log("%s - %s",yt(),g.format.apply(g,arguments))},g.inherits=d("inherits"),g._extend=function(xt,Pt){if(!Pt||!V(Pt))return xt;for(var Ft=Object.keys(Pt),Rt=Ft.length;Rt--;)xt[Ft[Rt]]=Pt[Ft[Rt]];return xt}}).call(this)}).call(this,d("_process"),commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":25,_process:63,inherits:24}],27:[function(d,m,g){(function(w){(function(){var I=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],P=typeof globalThis>"u"?w:globalThis;m.exports=function(){for(var F=[],$=0;$<I.length;$++)typeof P[I[$]]=="function"&&(F[F.length]=I[$]);return F}}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}],28:[function(d,m,g){g.byteLength=Z,g.toByteArray=G,g.fromByteArray=Q;for(var w=[],I=[],P=typeof Uint8Array<"u"?Uint8Array:Array,F="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$=0,D=F.length;$<D;++$)w[$]=F[$],I[F.charCodeAt($)]=$;function U(q){var rt=q.length;if(rt%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var it=q.indexOf("=");return it===-1&&(it=rt),[it,it===rt?0:4-it%4]}function Z(q){var rt=U(q),it=rt[0],X=rt[1];return 3*(it+X)/4-X}function j(q,rt,it){return 3*(rt+it)/4-it}function G(q){var rt,it,X=U(q),J=X[0],tt=X[1],ot=new P(j(q,J,tt)),nt=0,lt=tt>0?J-4:J;for(it=0;it<lt;it+=4)rt=I[q.charCodeAt(it)]<<18|I[q.charCodeAt(it+1)]<<12|I[q.charCodeAt(it+2)]<<6|I[q.charCodeAt(it+3)],ot[nt++]=rt>>16&255,ot[nt++]=rt>>8&255,ot[nt++]=255&rt;return tt===2&&(rt=I[q.charCodeAt(it)]<<2|I[q.charCodeAt(it+1)]>>4,ot[nt++]=255&rt),tt===1&&(rt=I[q.charCodeAt(it)]<<10|I[q.charCodeAt(it+1)]<<4|I[q.charCodeAt(it+2)]>>2,ot[nt++]=rt>>8&255,ot[nt++]=255&rt),ot}function H(q){return w[q>>18&63]+w[q>>12&63]+w[q>>6&63]+w[63&q]}function W(q,rt,it){for(var X,J=[],tt=rt;tt<it;tt+=3)X=(q[tt]<<16&16711680)+(q[tt+1]<<8&65280)+(255&q[tt+2]),J.push(H(X));return J.join("")}function Q(q){for(var rt,it=q.length,X=it%3,J=[],tt=16383,ot=0,nt=it-X;ot<nt;ot+=tt)J.push(W(q,ot,ot+tt>nt?nt:ot+tt));return X===1?(rt=q[it-1],J.push(w[rt>>2]+w[rt<<4&63]+"==")):X===2&&(rt=(q[it-2]<<8)+q[it-1],J.push(w[rt>>10]+w[rt>>4&63]+w[rt<<2&63]+"=")),J.join("")}I[45]=62,I[95]=63},{}],29:[function(d,m,g){},{}],30:[function(d,m,g){(function(w,I){(function(){var P=d("assert"),F=d("pako/lib/zlib/zstream"),$=d("pako/lib/zlib/deflate.js"),D=d("pako/lib/zlib/inflate.js"),U=d("pako/lib/zlib/constants");for(var Z in U)g[Z]=U[Z];g.NONE=0,g.DEFLATE=1,g.INFLATE=2,g.GZIP=3,g.GUNZIP=4,g.DEFLATERAW=5,g.INFLATERAW=6,g.UNZIP=7;var j=31,G=139;function H(W){if(typeof W!="number"||W<g.DEFLATE||W>g.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=W,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}H.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,P(this.init_done,"close before init"),P(this.mode<=g.UNZIP),this.mode===g.DEFLATE||this.mode===g.GZIP||this.mode===g.DEFLATERAW?$.deflateEnd(this.strm):this.mode!==g.INFLATE&&this.mode!==g.GUNZIP&&this.mode!==g.INFLATERAW&&this.mode!==g.UNZIP||D.inflateEnd(this.strm),this.mode=g.NONE,this.dictionary=null)},H.prototype.write=function(W,Q,q,rt,it,X,J){return this._write(!0,W,Q,q,rt,it,X,J)},H.prototype.writeSync=function(W,Q,q,rt,it,X,J){return this._write(!1,W,Q,q,rt,it,X,J)},H.prototype._write=function(W,Q,q,rt,it,X,J,tt){if(P.equal(arguments.length,8),P(this.init_done,"write before init"),P(this.mode!==g.NONE,"already finalized"),P.equal(!1,this.write_in_progress,"write already in progress"),P.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,P.equal(!1,Q===void 0,"must provide flush value"),this.write_in_progress=!0,Q!==g.Z_NO_FLUSH&&Q!==g.Z_PARTIAL_FLUSH&&Q!==g.Z_SYNC_FLUSH&&Q!==g.Z_FULL_FLUSH&&Q!==g.Z_FINISH&&Q!==g.Z_BLOCK)throw new Error("Invalid flush value");if(q==null&&(q=I.alloc(0),it=0,rt=0),this.strm.avail_in=it,this.strm.input=q,this.strm.next_in=rt,this.strm.avail_out=tt,this.strm.output=X,this.strm.next_out=J,this.flush=Q,!W)return this._process(),this._checkError()?this._afterSync():void 0;var ot=this;return w.nextTick(function(){ot._process(),ot._after()}),this},H.prototype._afterSync=function(){var W=this.strm.avail_out,Q=this.strm.avail_in;return this.write_in_progress=!1,[Q,W]},H.prototype._process=function(){var W=null;switch(this.mode){case g.DEFLATE:case g.GZIP:case g.DEFLATERAW:this.err=$.deflate(this.strm,this.flush);break;case g.UNZIP:switch(this.strm.avail_in>0&&(W=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(W===null)break;if(this.strm.input[W]!==j){this.mode=g.INFLATE;break}if(this.gzip_id_bytes_read=1,W++,this.strm.avail_in===1)break;case 1:if(W===null)break;this.strm.input[W]===G?(this.gzip_id_bytes_read=2,this.mode=g.GUNZIP):this.mode=g.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case g.INFLATE:case g.GUNZIP:case g.INFLATERAW:for(this.err=D.inflate(this.strm,this.flush),this.err===g.Z_NEED_DICT&&this.dictionary&&(this.err=D.inflateSetDictionary(this.strm,this.dictionary),this.err===g.Z_OK?this.err=D.inflate(this.strm,this.flush):this.err===g.Z_DATA_ERROR&&(this.err=g.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===g.GUNZIP&&this.err===g.Z_STREAM_END&&this.strm.next_in[0]!==0;)this.reset(),this.err=D.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},H.prototype._checkError=function(){switch(this.err){case g.Z_OK:case g.Z_BUF_ERROR:if(this.strm.avail_out!==0&&this.flush===g.Z_FINISH)return this._error("unexpected end of file"),!1;break;case g.Z_STREAM_END:break;case g.Z_NEED_DICT:return this.dictionary==null?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},H.prototype._after=function(){if(this._checkError()){var W=this.strm.avail_out,Q=this.strm.avail_in;this.write_in_progress=!1,this.callback(Q,W),this.pending_close&&this.close()}},H.prototype._error=function(W){this.strm.msg&&(W=this.strm.msg),this.onerror(W,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},H.prototype.init=function(W,Q,q,rt,it){P(arguments.length===4||arguments.length===5,"init(windowBits, level, memLevel, strategy, [dictionary])"),P(W>=8&&W<=15,"invalid windowBits"),P(Q>=-1&&Q<=9,"invalid compression level"),P(q>=1&&q<=9,"invalid memlevel"),P(rt===g.Z_FILTERED||rt===g.Z_HUFFMAN_ONLY||rt===g.Z_RLE||rt===g.Z_FIXED||rt===g.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(Q,W,q,rt,it),this._setDictionary()},H.prototype.params=function(){throw new Error("deflateParams Not supported")},H.prototype.reset=function(){this._reset(),this._setDictionary()},H.prototype._init=function(W,Q,q,rt,it){switch(this.level=W,this.windowBits=Q,this.memLevel=q,this.strategy=rt,this.flush=g.Z_NO_FLUSH,this.err=g.Z_OK,this.mode!==g.GZIP&&this.mode!==g.GUNZIP||(this.windowBits+=16),this.mode===g.UNZIP&&(this.windowBits+=32),this.mode!==g.DEFLATERAW&&this.mode!==g.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new F,this.mode){case g.DEFLATE:case g.GZIP:case g.DEFLATERAW:this.err=$.deflateInit2(this.strm,this.level,g.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case g.INFLATE:case g.GUNZIP:case g.INFLATERAW:case g.UNZIP:this.err=D.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==g.Z_OK&&this._error("Init error"),this.dictionary=it,this.write_in_progress=!1,this.init_done=!0},H.prototype._setDictionary=function(){if(this.dictionary!=null){switch(this.err=g.Z_OK,this.mode){case g.DEFLATE:case g.DEFLATERAW:this.err=$.deflateSetDictionary(this.strm,this.dictionary)}this.err!==g.Z_OK&&this._error("Failed to set dictionary")}},H.prototype._reset=function(){switch(this.err=g.Z_OK,this.mode){case g.DEFLATE:case g.DEFLATERAW:case g.GZIP:this.err=$.deflateReset(this.strm);break;case g.INFLATE:case g.INFLATERAW:case g.GUNZIP:this.err=D.inflateReset(this.strm)}this.err!==g.Z_OK&&this._error("Failed to reset stream")},g.Zlib=H}).call(this)}).call(this,d("_process"),d("buffer").Buffer)},{_process:63,assert:23,buffer:32,"pako/lib/zlib/constants":54,"pako/lib/zlib/deflate.js":56,"pako/lib/zlib/inflate.js":58,"pako/lib/zlib/zstream":62}],31:[function(d,m,g){(function(w){(function(){var I=d("buffer").Buffer,P=d("stream").Transform,F=d("./binding"),$=d("util"),D=d("assert").ok,U=d("buffer").kMaxLength,Z="Cannot create final Buffer. It would be larger than 0x"+U.toString(16)+" bytes";F.Z_MIN_WINDOWBITS=8,F.Z_MAX_WINDOWBITS=15,F.Z_DEFAULT_WINDOWBITS=15,F.Z_MIN_CHUNK=64,F.Z_MAX_CHUNK=1/0,F.Z_DEFAULT_CHUNK=16384,F.Z_MIN_MEMLEVEL=1,F.Z_MAX_MEMLEVEL=9,F.Z_DEFAULT_MEMLEVEL=8,F.Z_MIN_LEVEL=-1,F.Z_MAX_LEVEL=9,F.Z_DEFAULT_LEVEL=F.Z_DEFAULT_COMPRESSION;for(var j=Object.keys(F),G=0;G<j.length;G++){var H=j[G];H.match(/^Z/)&&Object.defineProperty(g,H,{enumerable:!0,value:F[H],writable:!1})}for(var W={Z_OK:F.Z_OK,Z_STREAM_END:F.Z_STREAM_END,Z_NEED_DICT:F.Z_NEED_DICT,Z_ERRNO:F.Z_ERRNO,Z_STREAM_ERROR:F.Z_STREAM_ERROR,Z_DATA_ERROR:F.Z_DATA_ERROR,Z_MEM_ERROR:F.Z_MEM_ERROR,Z_BUF_ERROR:F.Z_BUF_ERROR,Z_VERSION_ERROR:F.Z_VERSION_ERROR},Q=Object.keys(W),q=0;q<Q.length;q++){var rt=Q[q];W[W[rt]]=rt}function it(st,ct,At){var kt=[],yt=0;function Ct(){for(var Ft;(Ft=st.read())!==null;)kt.push(Ft),yt+=Ft.length;st.once("readable",Ct)}function xt(Ft){st.removeListener("end",Pt),st.removeListener("readable",Ct),At(Ft)}function Pt(){var Ft,Rt=null;yt>=U?Rt=new RangeError(Z):Ft=I.concat(kt,yt),kt=[],st.close(),At(Rt,Ft)}st.on("error",xt),st.on("end",Pt),st.end(ct),Ct()}function X(st,ct){if(typeof ct=="string"&&(ct=I.from(ct)),!I.isBuffer(ct))throw new TypeError("Not a string or buffer");var At=st._finishFlushFlag;return st._processChunk(ct,At)}function J(st){if(!(this instanceof J))return new J(st);ht.call(this,st,F.DEFLATE)}function tt(st){if(!(this instanceof tt))return new tt(st);ht.call(this,st,F.INFLATE)}function ot(st){if(!(this instanceof ot))return new ot(st);ht.call(this,st,F.GZIP)}function nt(st){if(!(this instanceof nt))return new nt(st);ht.call(this,st,F.GUNZIP)}function lt(st){if(!(this instanceof lt))return new lt(st);ht.call(this,st,F.DEFLATERAW)}function at(st){if(!(this instanceof at))return new at(st);ht.call(this,st,F.INFLATERAW)}function ut(st){if(!(this instanceof ut))return new ut(st);ht.call(this,st,F.UNZIP)}function V(st){return st===F.Z_NO_FLUSH||st===F.Z_PARTIAL_FLUSH||st===F.Z_SYNC_FLUSH||st===F.Z_FULL_FLUSH||st===F.Z_FINISH||st===F.Z_BLOCK}function ht(st,ct){var At=this;if(this._opts=st=st||{},this._chunkSize=st.chunkSize||g.Z_DEFAULT_CHUNK,P.call(this,st),st.flush&&!V(st.flush))throw new Error("Invalid flush flag: "+st.flush);if(st.finishFlush&&!V(st.finishFlush))throw new Error("Invalid flush flag: "+st.finishFlush);if(this._flushFlag=st.flush||F.Z_NO_FLUSH,this._finishFlushFlag=st.finishFlush!==void 0?st.finishFlush:F.Z_FINISH,st.chunkSize&&(st.chunkSize<g.Z_MIN_CHUNK||st.chunkSize>g.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+st.chunkSize);if(st.windowBits&&(st.windowBits<g.Z_MIN_WINDOWBITS||st.windowBits>g.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+st.windowBits);if(st.level&&(st.level<g.Z_MIN_LEVEL||st.level>g.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+st.level);if(st.memLevel&&(st.memLevel<g.Z_MIN_MEMLEVEL||st.memLevel>g.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+st.memLevel);if(st.strategy&&st.strategy!=g.Z_FILTERED&&st.strategy!=g.Z_HUFFMAN_ONLY&&st.strategy!=g.Z_RLE&&st.strategy!=g.Z_FIXED&&st.strategy!=g.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+st.strategy);if(st.dictionary&&!I.isBuffer(st.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new F.Zlib(ct);var kt=this;this._hadError=!1,this._handle.onerror=function(xt,Pt){vt(kt),kt._hadError=!0;var Ft=new Error(xt);Ft.errno=Pt,Ft.code=g.codes[Pt],kt.emit("error",Ft)};var yt=g.Z_DEFAULT_COMPRESSION;typeof st.level=="number"&&(yt=st.level);var Ct=g.Z_DEFAULT_STRATEGY;typeof st.strategy=="number"&&(Ct=st.strategy),this._handle.init(st.windowBits||g.Z_DEFAULT_WINDOWBITS,yt,st.memLevel||g.Z_DEFAULT_MEMLEVEL,Ct,st.dictionary),this._buffer=I.allocUnsafe(this._chunkSize),this._offset=0,this._level=yt,this._strategy=Ct,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!At._handle},configurable:!0,enumerable:!0})}function vt(st,ct){ct&&w.nextTick(ct),st._handle&&(st._handle.close(),st._handle=null)}function pt(st){st.emit("close")}Object.defineProperty(g,"codes",{enumerable:!0,value:Object.freeze(W),writable:!1}),g.Deflate=J,g.Inflate=tt,g.Gzip=ot,g.Gunzip=nt,g.DeflateRaw=lt,g.InflateRaw=at,g.Unzip=ut,g.createDeflate=function(st){return new J(st)},g.createInflate=function(st){return new tt(st)},g.createDeflateRaw=function(st){return new lt(st)},g.createInflateRaw=function(st){return new at(st)},g.createGzip=function(st){return new ot(st)},g.createGunzip=function(st){return new nt(st)},g.createUnzip=function(st){return new ut(st)},g.deflate=function(st,ct,At){return typeof ct=="function"&&(At=ct,ct={}),it(new J(ct),st,At)},g.deflateSync=function(st,ct){return X(new J(ct),st)},g.gzip=function(st,ct,At){return typeof ct=="function"&&(At=ct,ct={}),it(new ot(ct),st,At)},g.gzipSync=function(st,ct){return X(new ot(ct),st)},g.deflateRaw=function(st,ct,At){return typeof ct=="function"&&(At=ct,ct={}),it(new lt(ct),st,At)},g.deflateRawSync=function(st,ct){return X(new lt(ct),st)},g.unzip=function(st,ct,At){return typeof ct=="function"&&(At=ct,ct={}),it(new ut(ct),st,At)},g.unzipSync=function(st,ct){return X(new ut(ct),st)},g.inflate=function(st,ct,At){return typeof ct=="function"&&(At=ct,ct={}),it(new tt(ct),st,At)},g.inflateSync=function(st,ct){return X(new tt(ct),st)},g.gunzip=function(st,ct,At){return typeof ct=="function"&&(At=ct,ct={}),it(new nt(ct),st,At)},g.gunzipSync=function(st,ct){return X(new nt(ct),st)},g.inflateRaw=function(st,ct,At){return typeof ct=="function"&&(At=ct,ct={}),it(new at(ct),st,At)},g.inflateRawSync=function(st,ct){return X(new at(ct),st)},$.inherits(ht,P),ht.prototype.params=function(st,ct,At){if(st<g.Z_MIN_LEVEL||st>g.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+st);if(ct!=g.Z_FILTERED&&ct!=g.Z_HUFFMAN_ONLY&&ct!=g.Z_RLE&&ct!=g.Z_FIXED&&ct!=g.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+ct);if(this._level!==st||this._strategy!==ct){var kt=this;this.flush(F.Z_SYNC_FLUSH,function(){D(kt._handle,"zlib binding closed"),kt._handle.params(st,ct),kt._hadError||(kt._level=st,kt._strategy=ct,At&&At())})}else w.nextTick(At)},ht.prototype.reset=function(){return D(this._handle,"zlib binding closed"),this._handle.reset()},ht.prototype._flush=function(st){this._transform(I.alloc(0),"",st)},ht.prototype.flush=function(st,ct){var At=this,kt=this._writableState;(typeof st=="function"||st===void 0&&!ct)&&(ct=st,st=F.Z_FULL_FLUSH),kt.ended?ct&&w.nextTick(ct):kt.ending?ct&&this.once("end",ct):kt.needDrain?ct&&this.once("drain",function(){return At.flush(st,ct)}):(this._flushFlag=st,this.write(I.alloc(0),"",ct))},ht.prototype.close=function(st){vt(this,st),w.nextTick(pt,this)},ht.prototype._transform=function(st,ct,At){var kt,yt=this._writableState,Ct=(yt.ending||yt.ended)&&(!st||yt.length===st.length);return st===null||I.isBuffer(st)?this._handle?(Ct?kt=this._finishFlushFlag:(kt=this._flushFlag,st.length>=yt.length&&(this._flushFlag=this._opts.flush||F.Z_NO_FLUSH)),void this._processChunk(st,kt,At)):At(new Error("zlib binding closed")):At(new Error("invalid input"))},ht.prototype._processChunk=function(st,ct,At){var kt=st&&st.length,yt=this._chunkSize-this._offset,Ct=0,xt=this,Pt=typeof At=="function";if(!Pt){var Ft,Rt=[],Mt=0;this.on("error",function(Tt){Ft=Tt}),D(this._handle,"zlib binding closed");do var Bt=this._handle.writeSync(ct,st,Ct,kt,this._buffer,this._offset,yt);while(!this._hadError&&Zt(Bt[0],Bt[1]));if(this._hadError)throw Ft;if(Mt>=U)throw vt(this),new RangeError(Z);var $t=I.concat(Rt,Mt);return vt(this),$t}D(this._handle,"zlib binding closed");var Ot=this._handle.write(ct,st,Ct,kt,this._buffer,this._offset,yt);function Zt(Tt,et){if(this&&(this.buffer=null,this.callback=null),!xt._hadError){var It=yt-et;if(D(It>=0,"have should not go down"),It>0){var mt=xt._buffer.slice(xt._offset,xt._offset+It);xt._offset+=It,Pt?xt.push(mt):(Rt.push(mt),Mt+=mt.length)}if((et===0||xt._offset>=xt._chunkSize)&&(yt=xt._chunkSize,xt._offset=0,xt._buffer=I.allocUnsafe(xt._chunkSize)),et===0){if(Ct+=kt-Tt,kt=Tt,!Pt)return!0;var gt=xt._handle.write(ct,st,Ct,kt,xt._buffer,xt._offset,xt._chunkSize);return gt.callback=Zt,void(gt.buffer=st)}if(!Pt)return!1;At()}}Ot.buffer=st,Ot.callback=Zt},$.inherits(J,ht),$.inherits(tt,ht),$.inherits(ot,ht),$.inherits(nt,ht),$.inherits(lt,ht),$.inherits(at,ht),$.inherits(ut,ht)}).call(this)}).call(this,d("_process"))},{"./binding":30,_process:63,assert:23,buffer:32,stream:65,util:84}],32:[function(d,m,g){(function(w){(function(){var I=d("base64-js"),P=d("ieee754");g.Buffer=U,g.SlowBuffer=X,g.INSPECT_MAX_BYTES=50;var F=2147483647;function $(){try{var K=new Uint8Array(1);return K.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},K.foo()===42}catch{return!1}}function D(K){if(K>F)throw new RangeError('The value "'+K+'" is invalid for option "size"');var ft=new Uint8Array(K);return ft.__proto__=U.prototype,ft}function U(K,ft,bt){if(typeof K=="number"){if(typeof ft=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return H(K)}return Z(K,ft,bt)}function Z(K,ft,bt){if(typeof K=="string")return W(K,ft);if(ArrayBuffer.isView(K))return Q(K);if(K==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof K);if(Et(K,ArrayBuffer)||K&&Et(K.buffer,ArrayBuffer))return q(K,ft,bt);if(typeof K=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var wt=K.valueOf&&K.valueOf();if(wt!=null&&wt!==K)return U.from(wt,ft,bt);var Lt=rt(K);if(Lt)return Lt;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof K[Symbol.toPrimitive]=="function")return U.from(K[Symbol.toPrimitive]("string"),ft,bt);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof K)}function j(K){if(typeof K!="number")throw new TypeError('"size" argument must be of type number');if(K<0)throw new RangeError('The value "'+K+'" is invalid for option "size"')}function G(K,ft,bt){return j(K),K<=0?D(K):ft!==void 0?typeof bt=="string"?D(K).fill(ft,bt):D(K).fill(ft):D(K)}function H(K){return j(K),D(K<0?0:0|it(K))}function W(K,ft){if(typeof ft=="string"&&ft!==""||(ft="utf8"),!U.isEncoding(ft))throw new TypeError("Unknown encoding: "+ft);var bt=0|J(K,ft),wt=D(bt),Lt=wt.write(K,ft);return Lt!==bt&&(wt=wt.slice(0,Lt)),wt}function Q(K){for(var ft=K.length<0?0:0|it(K.length),bt=D(ft),wt=0;wt<ft;wt+=1)bt[wt]=255&K[wt];return bt}function q(K,ft,bt){if(ft<0||K.byteLength<ft)throw new RangeError('"offset" is outside of buffer bounds');if(K.byteLength<ft+(bt||0))throw new RangeError('"length" is outside of buffer bounds');var wt;return(wt=ft===void 0&&bt===void 0?new Uint8Array(K):bt===void 0?new Uint8Array(K,ft):new Uint8Array(K,ft,bt)).__proto__=U.prototype,wt}function rt(K){if(U.isBuffer(K)){var ft=0|it(K.length),bt=D(ft);return bt.length===0||K.copy(bt,0,0,ft),bt}return K.length!==void 0?typeof K.length!="number"||zt(K.length)?D(0):Q(K):K.type==="Buffer"&&Array.isArray(K.data)?Q(K.data):void 0}function it(K){if(K>=F)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+F.toString(16)+" bytes");return 0|K}function X(K){return+K!=K&&(K=0),U.alloc(+K)}function J(K,ft){if(U.isBuffer(K))return K.length;if(ArrayBuffer.isView(K)||Et(K,ArrayBuffer))return K.byteLength;if(typeof K!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof K);var bt=K.length,wt=arguments.length>2&&arguments[2]===!0;if(!wt&&bt===0)return 0;for(var Lt=!1;;)switch(ft){case"ascii":case"latin1":case"binary":return bt;case"utf8":case"utf-8":return et(K).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*bt;case"hex":return bt>>>1;case"base64":return gt(K).length;default:if(Lt)return wt?-1:et(K).length;ft=(""+ft).toLowerCase(),Lt=!0}}function tt(K,ft,bt){var wt=!1;if((ft===void 0||ft<0)&&(ft=0),ft>this.length||((bt===void 0||bt>this.length)&&(bt=this.length),bt<=0)||(bt>>>=0)<=(ft>>>=0))return"";for(K||(K="utf8");;)switch(K){case"hex":return xt(this,ft,bt);case"utf8":case"utf-8":return ct(this,ft,bt);case"ascii":return yt(this,ft,bt);case"latin1":case"binary":return Ct(this,ft,bt);case"base64":return st(this,ft,bt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Pt(this,ft,bt);default:if(wt)throw new TypeError("Unknown encoding: "+K);K=(K+"").toLowerCase(),wt=!0}}function ot(K,ft,bt){var wt=K[ft];K[ft]=K[bt],K[bt]=wt}function nt(K,ft,bt,wt,Lt){if(K.length===0)return-1;if(typeof bt=="string"?(wt=bt,bt=0):bt>2147483647?bt=2147483647:bt<-2147483648&&(bt=-2147483648),zt(bt=+bt)&&(bt=Lt?0:K.length-1),bt<0&&(bt=K.length+bt),bt>=K.length){if(Lt)return-1;bt=K.length-1}else if(bt<0){if(!Lt)return-1;bt=0}if(typeof ft=="string"&&(ft=U.from(ft,wt)),U.isBuffer(ft))return ft.length===0?-1:lt(K,ft,bt,wt,Lt);if(typeof ft=="number")return ft&=255,typeof Uint8Array.prototype.indexOf=="function"?Lt?Uint8Array.prototype.indexOf.call(K,ft,bt):Uint8Array.prototype.lastIndexOf.call(K,ft,bt):lt(K,[ft],bt,wt,Lt);throw new TypeError("val must be string, number or Buffer")}function lt(K,ft,bt,wt,Lt){var jt,Kt=1,te=K.length,Vt=ft.length;if(wt!==void 0&&((wt=String(wt).toLowerCase())==="ucs2"||wt==="ucs-2"||wt==="utf16le"||wt==="utf-16le")){if(K.length<2||ft.length<2)return-1;Kt=2,te/=2,Vt/=2,bt/=2}function ee(ae,fe){return Kt===1?ae[fe]:ae.readUInt16BE(fe*Kt)}if(Lt){var Jt=-1;for(jt=bt;jt<te;jt++)if(ee(K,jt)===ee(ft,Jt===-1?0:jt-Jt)){if(Jt===-1&&(Jt=jt),jt-Jt+1===Vt)return Jt*Kt}else Jt!==-1&&(jt-=jt-Jt),Jt=-1}else for(bt+Vt>te&&(bt=te-Vt),jt=bt;jt>=0;jt--){for(var oe=!0,ne=0;ne<Vt;ne++)if(ee(K,jt+ne)!==ee(ft,ne)){oe=!1;break}if(oe)return jt}return-1}function at(K,ft,bt,wt){bt=Number(bt)||0;var Lt=K.length-bt;wt?(wt=Number(wt))>Lt&&(wt=Lt):wt=Lt;var jt=ft.length;wt>jt/2&&(wt=jt/2);for(var Kt=0;Kt<wt;++Kt){var te=parseInt(ft.substr(2*Kt,2),16);if(zt(te))return Kt;K[bt+Kt]=te}return Kt}function ut(K,ft,bt,wt){return _t(et(ft,K.length-bt),K,bt,wt)}function V(K,ft,bt,wt){return _t(It(ft),K,bt,wt)}function ht(K,ft,bt,wt){return V(K,ft,bt,wt)}function vt(K,ft,bt,wt){return _t(gt(ft),K,bt,wt)}function pt(K,ft,bt,wt){return _t(mt(ft,K.length-bt),K,bt,wt)}function st(K,ft,bt){return ft===0&&bt===K.length?I.fromByteArray(K):I.fromByteArray(K.slice(ft,bt))}function ct(K,ft,bt){bt=Math.min(K.length,bt);for(var wt=[],Lt=ft;Lt<bt;){var jt,Kt,te,Vt,ee=K[Lt],Jt=null,oe=ee>239?4:ee>223?3:ee>191?2:1;if(Lt+oe<=bt)switch(oe){case 1:ee<128&&(Jt=ee);break;case 2:(192&(jt=K[Lt+1]))==128&&(Vt=(31&ee)<<6|63&jt)>127&&(Jt=Vt);break;case 3:jt=K[Lt+1],Kt=K[Lt+2],(192&jt)==128&&(192&Kt)==128&&(Vt=(15&ee)<<12|(63&jt)<<6|63&Kt)>2047&&(Vt<55296||Vt>57343)&&(Jt=Vt);break;case 4:jt=K[Lt+1],Kt=K[Lt+2],te=K[Lt+3],(192&jt)==128&&(192&Kt)==128&&(192&te)==128&&(Vt=(15&ee)<<18|(63&jt)<<12|(63&Kt)<<6|63&te)>65535&&Vt<1114112&&(Jt=Vt)}Jt===null?(Jt=65533,oe=1):Jt>65535&&(Jt-=65536,wt.push(Jt>>>10&1023|55296),Jt=56320|1023&Jt),wt.push(Jt),Lt+=oe}return kt(wt)}g.kMaxLength=F,U.TYPED_ARRAY_SUPPORT=$(),U.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(U.prototype,"parent",{enumerable:!0,get:function(){if(U.isBuffer(this))return this.buffer}}),Object.defineProperty(U.prototype,"offset",{enumerable:!0,get:function(){if(U.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&U[Symbol.species]===U&&Object.defineProperty(U,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),U.poolSize=8192,U.from=function(K,ft,bt){return Z(K,ft,bt)},U.prototype.__proto__=Uint8Array.prototype,U.__proto__=Uint8Array,U.alloc=function(K,ft,bt){return G(K,ft,bt)},U.allocUnsafe=function(K){return H(K)},U.allocUnsafeSlow=function(K){return H(K)},U.isBuffer=function(K){return K!=null&&K._isBuffer===!0&&K!==U.prototype},U.compare=function(K,ft){if(Et(K,Uint8Array)&&(K=U.from(K,K.offset,K.byteLength)),Et(ft,Uint8Array)&&(ft=U.from(ft,ft.offset,ft.byteLength)),!U.isBuffer(K)||!U.isBuffer(ft))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(K===ft)return 0;for(var bt=K.length,wt=ft.length,Lt=0,jt=Math.min(bt,wt);Lt<jt;++Lt)if(K[Lt]!==ft[Lt]){bt=K[Lt],wt=ft[Lt];break}return bt<wt?-1:wt<bt?1:0},U.isEncoding=function(K){switch(String(K).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},U.concat=function(K,ft){if(!Array.isArray(K))throw new TypeError('"list" argument must be an Array of Buffers');if(K.length===0)return U.alloc(0);var bt;if(ft===void 0)for(ft=0,bt=0;bt<K.length;++bt)ft+=K[bt].length;var wt=U.allocUnsafe(ft),Lt=0;for(bt=0;bt<K.length;++bt){var jt=K[bt];if(Et(jt,Uint8Array)&&(jt=U.from(jt)),!U.isBuffer(jt))throw new TypeError('"list" argument must be an Array of Buffers');jt.copy(wt,Lt),Lt+=jt.length}return wt},U.byteLength=J,U.prototype._isBuffer=!0,U.prototype.swap16=function(){var K=this.length;if(K%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var ft=0;ft<K;ft+=2)ot(this,ft,ft+1);return this},U.prototype.swap32=function(){var K=this.length;if(K%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var ft=0;ft<K;ft+=4)ot(this,ft,ft+3),ot(this,ft+1,ft+2);return this},U.prototype.swap64=function(){var K=this.length;if(K%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var ft=0;ft<K;ft+=8)ot(this,ft,ft+7),ot(this,ft+1,ft+6),ot(this,ft+2,ft+5),ot(this,ft+3,ft+4);return this},U.prototype.toString=function(){var K=this.length;return K===0?"":arguments.length===0?ct(this,0,K):tt.apply(this,arguments)},U.prototype.toLocaleString=U.prototype.toString,U.prototype.equals=function(K){if(!U.isBuffer(K))throw new TypeError("Argument must be a Buffer");return this===K||U.compare(this,K)===0},U.prototype.inspect=function(){var K="",ft=g.INSPECT_MAX_BYTES;return K=this.toString("hex",0,ft).replace(/(.{2})/g,"$1 ").trim(),this.length>ft&&(K+=" ... "),"<Buffer "+K+">"},U.prototype.compare=function(K,ft,bt,wt,Lt){if(Et(K,Uint8Array)&&(K=U.from(K,K.offset,K.byteLength)),!U.isBuffer(K))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof K);if(ft===void 0&&(ft=0),bt===void 0&&(bt=K?K.length:0),wt===void 0&&(wt=0),Lt===void 0&&(Lt=this.length),ft<0||bt>K.length||wt<0||Lt>this.length)throw new RangeError("out of range index");if(wt>=Lt&&ft>=bt)return 0;if(wt>=Lt)return-1;if(ft>=bt)return 1;if(this===K)return 0;for(var jt=(Lt>>>=0)-(wt>>>=0),Kt=(bt>>>=0)-(ft>>>=0),te=Math.min(jt,Kt),Vt=this.slice(wt,Lt),ee=K.slice(ft,bt),Jt=0;Jt<te;++Jt)if(Vt[Jt]!==ee[Jt]){jt=Vt[Jt],Kt=ee[Jt];break}return jt<Kt?-1:Kt<jt?1:0},U.prototype.includes=function(K,ft,bt){return this.indexOf(K,ft,bt)!==-1},U.prototype.indexOf=function(K,ft,bt){return nt(this,K,ft,bt,!0)},U.prototype.lastIndexOf=function(K,ft,bt){return nt(this,K,ft,bt,!1)},U.prototype.write=function(K,ft,bt,wt){if(ft===void 0)wt="utf8",bt=this.length,ft=0;else if(bt===void 0&&typeof ft=="string")wt=ft,bt=this.length,ft=0;else{if(!isFinite(ft))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");ft>>>=0,isFinite(bt)?(bt>>>=0,wt===void 0&&(wt="utf8")):(wt=bt,bt=void 0)}var Lt=this.length-ft;if((bt===void 0||bt>Lt)&&(bt=Lt),K.length>0&&(bt<0||ft<0)||ft>this.length)throw new RangeError("Attempt to write outside buffer bounds");wt||(wt="utf8");for(var jt=!1;;)switch(wt){case"hex":return at(this,K,ft,bt);case"utf8":case"utf-8":return ut(this,K,ft,bt);case"ascii":return V(this,K,ft,bt);case"latin1":case"binary":return ht(this,K,ft,bt);case"base64":return vt(this,K,ft,bt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return pt(this,K,ft,bt);default:if(jt)throw new TypeError("Unknown encoding: "+wt);wt=(""+wt).toLowerCase(),jt=!0}},U.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var At=4096;function kt(K){var ft=K.length;if(ft<=At)return String.fromCharCode.apply(String,K);for(var bt="",wt=0;wt<ft;)bt+=String.fromCharCode.apply(String,K.slice(wt,wt+=At));return bt}function yt(K,ft,bt){var wt="";bt=Math.min(K.length,bt);for(var Lt=ft;Lt<bt;++Lt)wt+=String.fromCharCode(127&K[Lt]);return wt}function Ct(K,ft,bt){var wt="";bt=Math.min(K.length,bt);for(var Lt=ft;Lt<bt;++Lt)wt+=String.fromCharCode(K[Lt]);return wt}function xt(K,ft,bt){var wt=K.length;(!ft||ft<0)&&(ft=0),(!bt||bt<0||bt>wt)&&(bt=wt);for(var Lt="",jt=ft;jt<bt;++jt)Lt+=Tt(K[jt]);return Lt}function Pt(K,ft,bt){for(var wt=K.slice(ft,bt),Lt="",jt=0;jt<wt.length;jt+=2)Lt+=String.fromCharCode(wt[jt]+256*wt[jt+1]);return Lt}function Ft(K,ft,bt){if(K%1!=0||K<0)throw new RangeError("offset is not uint");if(K+ft>bt)throw new RangeError("Trying to access beyond buffer length")}function Rt(K,ft,bt,wt,Lt,jt){if(!U.isBuffer(K))throw new TypeError('"buffer" argument must be a Buffer instance');if(ft>Lt||ft<jt)throw new RangeError('"value" argument is out of bounds');if(bt+wt>K.length)throw new RangeError("Index out of range")}function Mt(K,ft,bt,wt,Lt,jt){if(bt+wt>K.length)throw new RangeError("Index out of range");if(bt<0)throw new RangeError("Index out of range")}function Bt(K,ft,bt,wt,Lt){return ft=+ft,bt>>>=0,Lt||Mt(K,ft,bt,4),P.write(K,ft,bt,wt,23,4),bt+4}function $t(K,ft,bt,wt,Lt){return ft=+ft,bt>>>=0,Lt||Mt(K,ft,bt,8),P.write(K,ft,bt,wt,52,8),bt+8}U.prototype.slice=function(K,ft){var bt=this.length;(K=~~K)<0?(K+=bt)<0&&(K=0):K>bt&&(K=bt),(ft=ft===void 0?bt:~~ft)<0?(ft+=bt)<0&&(ft=0):ft>bt&&(ft=bt),ft<K&&(ft=K);var wt=this.subarray(K,ft);return wt.__proto__=U.prototype,wt},U.prototype.readUIntLE=function(K,ft,bt){K>>>=0,ft>>>=0,bt||Ft(K,ft,this.length);for(var wt=this[K],Lt=1,jt=0;++jt<ft&&(Lt*=256);)wt+=this[K+jt]*Lt;return wt},U.prototype.readUIntBE=function(K,ft,bt){K>>>=0,ft>>>=0,bt||Ft(K,ft,this.length);for(var wt=this[K+--ft],Lt=1;ft>0&&(Lt*=256);)wt+=this[K+--ft]*Lt;return wt},U.prototype.readUInt8=function(K,ft){return K>>>=0,ft||Ft(K,1,this.length),this[K]},U.prototype.readUInt16LE=function(K,ft){return K>>>=0,ft||Ft(K,2,this.length),this[K]|this[K+1]<<8},U.prototype.readUInt16BE=function(K,ft){return K>>>=0,ft||Ft(K,2,this.length),this[K]<<8|this[K+1]},U.prototype.readUInt32LE=function(K,ft){return K>>>=0,ft||Ft(K,4,this.length),(this[K]|this[K+1]<<8|this[K+2]<<16)+16777216*this[K+3]},U.prototype.readUInt32BE=function(K,ft){return K>>>=0,ft||Ft(K,4,this.length),16777216*this[K]+(this[K+1]<<16|this[K+2]<<8|this[K+3])},U.prototype.readIntLE=function(K,ft,bt){K>>>=0,ft>>>=0,bt||Ft(K,ft,this.length);for(var wt=this[K],Lt=1,jt=0;++jt<ft&&(Lt*=256);)wt+=this[K+jt]*Lt;return wt>=(Lt*=128)&&(wt-=Math.pow(2,8*ft)),wt},U.prototype.readIntBE=function(K,ft,bt){K>>>=0,ft>>>=0,bt||Ft(K,ft,this.length);for(var wt=ft,Lt=1,jt=this[K+--wt];wt>0&&(Lt*=256);)jt+=this[K+--wt]*Lt;return jt>=(Lt*=128)&&(jt-=Math.pow(2,8*ft)),jt},U.prototype.readInt8=function(K,ft){return K>>>=0,ft||Ft(K,1,this.length),128&this[K]?-1*(255-this[K]+1):this[K]},U.prototype.readInt16LE=function(K,ft){K>>>=0,ft||Ft(K,2,this.length);var bt=this[K]|this[K+1]<<8;return 32768&bt?4294901760|bt:bt},U.prototype.readInt16BE=function(K,ft){K>>>=0,ft||Ft(K,2,this.length);var bt=this[K+1]|this[K]<<8;return 32768&bt?4294901760|bt:bt},U.prototype.readInt32LE=function(K,ft){return K>>>=0,ft||Ft(K,4,this.length),this[K]|this[K+1]<<8|this[K+2]<<16|this[K+3]<<24},U.prototype.readInt32BE=function(K,ft){return K>>>=0,ft||Ft(K,4,this.length),this[K]<<24|this[K+1]<<16|this[K+2]<<8|this[K+3]},U.prototype.readFloatLE=function(K,ft){return K>>>=0,ft||Ft(K,4,this.length),P.read(this,K,!0,23,4)},U.prototype.readFloatBE=function(K,ft){return K>>>=0,ft||Ft(K,4,this.length),P.read(this,K,!1,23,4)},U.prototype.readDoubleLE=function(K,ft){return K>>>=0,ft||Ft(K,8,this.length),P.read(this,K,!0,52,8)},U.prototype.readDoubleBE=function(K,ft){return K>>>=0,ft||Ft(K,8,this.length),P.read(this,K,!1,52,8)},U.prototype.writeUIntLE=function(K,ft,bt,wt){K=+K,ft>>>=0,bt>>>=0,wt||Rt(this,K,ft,bt,Math.pow(2,8*bt)-1,0);var Lt=1,jt=0;for(this[ft]=255&K;++jt<bt&&(Lt*=256);)this[ft+jt]=K/Lt&255;return ft+bt},U.prototype.writeUIntBE=function(K,ft,bt,wt){K=+K,ft>>>=0,bt>>>=0,wt||Rt(this,K,ft,bt,Math.pow(2,8*bt)-1,0);var Lt=bt-1,jt=1;for(this[ft+Lt]=255&K;--Lt>=0&&(jt*=256);)this[ft+Lt]=K/jt&255;return ft+bt},U.prototype.writeUInt8=function(K,ft,bt){return K=+K,ft>>>=0,bt||Rt(this,K,ft,1,255,0),this[ft]=255&K,ft+1},U.prototype.writeUInt16LE=function(K,ft,bt){return K=+K,ft>>>=0,bt||Rt(this,K,ft,2,65535,0),this[ft]=255&K,this[ft+1]=K>>>8,ft+2},U.prototype.writeUInt16BE=function(K,ft,bt){return K=+K,ft>>>=0,bt||Rt(this,K,ft,2,65535,0),this[ft]=K>>>8,this[ft+1]=255&K,ft+2},U.prototype.writeUInt32LE=function(K,ft,bt){return K=+K,ft>>>=0,bt||Rt(this,K,ft,4,4294967295,0),this[ft+3]=K>>>24,this[ft+2]=K>>>16,this[ft+1]=K>>>8,this[ft]=255&K,ft+4},U.prototype.writeUInt32BE=function(K,ft,bt){return K=+K,ft>>>=0,bt||Rt(this,K,ft,4,4294967295,0),this[ft]=K>>>24,this[ft+1]=K>>>16,this[ft+2]=K>>>8,this[ft+3]=255&K,ft+4},U.prototype.writeIntLE=function(K,ft,bt,wt){if(K=+K,ft>>>=0,!wt){var Lt=Math.pow(2,8*bt-1);Rt(this,K,ft,bt,Lt-1,-Lt)}var jt=0,Kt=1,te=0;for(this[ft]=255&K;++jt<bt&&(Kt*=256);)K<0&&te===0&&this[ft+jt-1]!==0&&(te=1),this[ft+jt]=(K/Kt|0)-te&255;return ft+bt},U.prototype.writeIntBE=function(K,ft,bt,wt){if(K=+K,ft>>>=0,!wt){var Lt=Math.pow(2,8*bt-1);Rt(this,K,ft,bt,Lt-1,-Lt)}var jt=bt-1,Kt=1,te=0;for(this[ft+jt]=255&K;--jt>=0&&(Kt*=256);)K<0&&te===0&&this[ft+jt+1]!==0&&(te=1),this[ft+jt]=(K/Kt|0)-te&255;return ft+bt},U.prototype.writeInt8=function(K,ft,bt){return K=+K,ft>>>=0,bt||Rt(this,K,ft,1,127,-128),K<0&&(K=255+K+1),this[ft]=255&K,ft+1},U.prototype.writeInt16LE=function(K,ft,bt){return K=+K,ft>>>=0,bt||Rt(this,K,ft,2,32767,-32768),this[ft]=255&K,this[ft+1]=K>>>8,ft+2},U.prototype.writeInt16BE=function(K,ft,bt){return K=+K,ft>>>=0,bt||Rt(this,K,ft,2,32767,-32768),this[ft]=K>>>8,this[ft+1]=255&K,ft+2},U.prototype.writeInt32LE=function(K,ft,bt){return K=+K,ft>>>=0,bt||Rt(this,K,ft,4,2147483647,-2147483648),this[ft]=255&K,this[ft+1]=K>>>8,this[ft+2]=K>>>16,this[ft+3]=K>>>24,ft+4},U.prototype.writeInt32BE=function(K,ft,bt){return K=+K,ft>>>=0,bt||Rt(this,K,ft,4,2147483647,-2147483648),K<0&&(K=4294967295+K+1),this[ft]=K>>>24,this[ft+1]=K>>>16,this[ft+2]=K>>>8,this[ft+3]=255&K,ft+4},U.prototype.writeFloatLE=function(K,ft,bt){return Bt(this,K,ft,!0,bt)},U.prototype.writeFloatBE=function(K,ft,bt){return Bt(this,K,ft,!1,bt)},U.prototype.writeDoubleLE=function(K,ft,bt){return $t(this,K,ft,!0,bt)},U.prototype.writeDoubleBE=function(K,ft,bt){return $t(this,K,ft,!1,bt)},U.prototype.copy=function(K,ft,bt,wt){if(!U.isBuffer(K))throw new TypeError("argument should be a Buffer");if(bt||(bt=0),wt||wt===0||(wt=this.length),ft>=K.length&&(ft=K.length),ft||(ft=0),wt>0&&wt<bt&&(wt=bt),wt===bt||K.length===0||this.length===0)return 0;if(ft<0)throw new RangeError("targetStart out of bounds");if(bt<0||bt>=this.length)throw new RangeError("Index out of range");if(wt<0)throw new RangeError("sourceEnd out of bounds");wt>this.length&&(wt=this.length),K.length-ft<wt-bt&&(wt=K.length-ft+bt);var Lt=wt-bt;if(this===K&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(ft,bt,wt);else if(this===K&&bt<ft&&ft<wt)for(var jt=Lt-1;jt>=0;--jt)K[jt+ft]=this[jt+bt];else Uint8Array.prototype.set.call(K,this.subarray(bt,wt),ft);return Lt},U.prototype.fill=function(K,ft,bt,wt){if(typeof K=="string"){if(typeof ft=="string"?(wt=ft,ft=0,bt=this.length):typeof bt=="string"&&(wt=bt,bt=this.length),wt!==void 0&&typeof wt!="string")throw new TypeError("encoding must be a string");if(typeof wt=="string"&&!U.isEncoding(wt))throw new TypeError("Unknown encoding: "+wt);if(K.length===1){var Lt=K.charCodeAt(0);(wt==="utf8"&&Lt<128||wt==="latin1")&&(K=Lt)}}else typeof K=="number"&&(K&=255);if(ft<0||this.length<ft||this.length<bt)throw new RangeError("Out of range index");if(bt<=ft)return this;var jt;if(ft>>>=0,bt=bt===void 0?this.length:bt>>>0,K||(K=0),typeof K=="number")for(jt=ft;jt<bt;++jt)this[jt]=K;else{var Kt=U.isBuffer(K)?K:U.from(K,wt),te=Kt.length;if(te===0)throw new TypeError('The value "'+K+'" is invalid for argument "value"');for(jt=0;jt<bt-ft;++jt)this[jt+ft]=Kt[jt%te]}return this};var Ot=/[^+/0-9A-Za-z-_]/g;function Zt(K){if((K=(K=K.split("=")[0]).trim().replace(Ot,"")).length<2)return"";for(;K.length%4!=0;)K+="=";return K}function Tt(K){return K<16?"0"+K.toString(16):K.toString(16)}function et(K,ft){var bt;ft=ft||1/0;for(var wt=K.length,Lt=null,jt=[],Kt=0;Kt<wt;++Kt){if((bt=K.charCodeAt(Kt))>55295&&bt<57344){if(!Lt){if(bt>56319){(ft-=3)>-1&&jt.push(239,191,189);continue}if(Kt+1===wt){(ft-=3)>-1&&jt.push(239,191,189);continue}Lt=bt;continue}if(bt<56320){(ft-=3)>-1&&jt.push(239,191,189),Lt=bt;continue}bt=65536+(Lt-55296<<10|bt-56320)}else Lt&&(ft-=3)>-1&&jt.push(239,191,189);if(Lt=null,bt<128){if((ft-=1)<0)break;jt.push(bt)}else if(bt<2048){if((ft-=2)<0)break;jt.push(bt>>6|192,63&bt|128)}else if(bt<65536){if((ft-=3)<0)break;jt.push(bt>>12|224,bt>>6&63|128,63&bt|128)}else{if(!(bt<1114112))throw new Error("Invalid code point");if((ft-=4)<0)break;jt.push(bt>>18|240,bt>>12&63|128,bt>>6&63|128,63&bt|128)}}return jt}function It(K){for(var ft=[],bt=0;bt<K.length;++bt)ft.push(255&K.charCodeAt(bt));return ft}function mt(K,ft){for(var bt,wt,Lt,jt=[],Kt=0;Kt<K.length&&!((ft-=2)<0);++Kt)wt=(bt=K.charCodeAt(Kt))>>8,Lt=bt%256,jt.push(Lt),jt.push(wt);return jt}function gt(K){return I.toByteArray(Zt(K))}function _t(K,ft,bt,wt){for(var Lt=0;Lt<wt&&!(Lt+bt>=ft.length||Lt>=K.length);++Lt)ft[Lt+bt]=K[Lt];return Lt}function Et(K,ft){return K instanceof ft||K!=null&&K.constructor!=null&&K.constructor.name!=null&&K.constructor.name===ft.name}function zt(K){return K!=K}}).call(this)}).call(this,d("buffer").Buffer)},{"base64-js":28,buffer:32,ieee754:45}],33:[function(d,m,g){var w=d("get-intrinsic"),I=d("./"),P=I(w("String.prototype.indexOf"));m.exports=function(F,$){var D=w(F,!!$);return typeof D=="function"&&P(F,".prototype.")>-1?I(D):D}},{"./":34,"get-intrinsic":39}],34:[function(d,m,g){var w=d("function-bind"),I=d("get-intrinsic"),P=I("%Function.prototype.apply%"),F=I("%Function.prototype.call%"),$=I("%Reflect.apply%",!0)||w.call(F,P),D=I("%Object.getOwnPropertyDescriptor%",!0),U=I("%Object.defineProperty%",!0),Z=I("%Math.max%");if(U)try{U({},"a",{value:1})}catch{U=null}m.exports=function(G){var H=$(w,F,arguments);return D&&U&&D(H,"length").configurable&&U(H,"length",{value:1+Z(0,G.length-(arguments.length-1))}),H};var j=function(){return $(w,P,arguments)};U?U(m.exports,"apply",{value:j}):m.exports.apply=j},{"function-bind":38,"get-intrinsic":39}],35:[function(d,m,g){var w,I=typeof Reflect=="object"?Reflect:null,P=I&&typeof I.apply=="function"?I.apply:function(nt,lt,at){return Function.prototype.apply.call(nt,lt,at)};function F(nt){console&&console.warn&&console.warn(nt)}w=I&&typeof I.ownKeys=="function"?I.ownKeys:Object.getOwnPropertySymbols?function(nt){return Object.getOwnPropertyNames(nt).concat(Object.getOwnPropertySymbols(nt))}:function(nt){return Object.getOwnPropertyNames(nt)};var $=Number.isNaN||function(nt){return nt!=nt};function D(){D.init.call(this)}m.exports=D,m.exports.once=J,D.EventEmitter=D,D.prototype._events=void 0,D.prototype._eventsCount=0,D.prototype._maxListeners=void 0;var U=10;function Z(nt){if(typeof nt!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof nt)}function j(nt){return nt._maxListeners===void 0?D.defaultMaxListeners:nt._maxListeners}function G(nt,lt,at,ut){var V,ht,vt;if(Z(at),(ht=nt._events)===void 0?(ht=nt._events=Object.create(null),nt._eventsCount=0):(ht.newListener!==void 0&&(nt.emit("newListener",lt,at.listener?at.listener:at),ht=nt._events),vt=ht[lt]),vt===void 0)vt=ht[lt]=at,++nt._eventsCount;else if(typeof vt=="function"?vt=ht[lt]=ut?[at,vt]:[vt,at]:ut?vt.unshift(at):vt.push(at),(V=j(nt))>0&&vt.length>V&&!vt.warned){vt.warned=!0;var pt=new Error("Possible EventEmitter memory leak detected. "+vt.length+" "+String(lt)+" listeners added. Use emitter.setMaxListeners() to increase limit");pt.name="MaxListenersExceededWarning",pt.emitter=nt,pt.type=lt,pt.count=vt.length,F(pt)}return nt}function H(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function W(nt,lt,at){var ut={fired:!1,wrapFn:void 0,target:nt,type:lt,listener:at},V=H.bind(ut);return V.listener=at,ut.wrapFn=V,V}function Q(nt,lt,at){var ut=nt._events;if(ut===void 0)return[];var V=ut[lt];return V===void 0?[]:typeof V=="function"?at?[V.listener||V]:[V]:at?X(V):rt(V,V.length)}function q(nt){var lt=this._events;if(lt!==void 0){var at=lt[nt];if(typeof at=="function")return 1;if(at!==void 0)return at.length}return 0}function rt(nt,lt){for(var at=new Array(lt),ut=0;ut<lt;++ut)at[ut]=nt[ut];return at}function it(nt,lt){for(;lt+1<nt.length;lt++)nt[lt]=nt[lt+1];nt.pop()}function X(nt){for(var lt=new Array(nt.length),at=0;at<lt.length;++at)lt[at]=nt[at].listener||nt[at];return lt}function J(nt,lt){return new Promise(function(at,ut){function V(vt){nt.removeListener(lt,ht),ut(vt)}function ht(){typeof nt.removeListener=="function"&&nt.removeListener("error",V),at([].slice.call(arguments))}ot(nt,lt,ht,{once:!0}),lt!=="error"&&tt(nt,V,{once:!0})})}function tt(nt,lt,at){typeof nt.on=="function"&&ot(nt,"error",lt,at)}function ot(nt,lt,at,ut){if(typeof nt.on=="function")ut.once?nt.once(lt,at):nt.on(lt,at);else{if(typeof nt.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof nt);nt.addEventListener(lt,function V(ht){ut.once&&nt.removeEventListener(lt,V),at(ht)})}}Object.defineProperty(D,"defaultMaxListeners",{enumerable:!0,get:function(){return U},set:function(nt){if(typeof nt!="number"||nt<0||$(nt))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+nt+".");U=nt}}),D.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},D.prototype.setMaxListeners=function(nt){if(typeof nt!="number"||nt<0||$(nt))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+nt+".");return this._maxListeners=nt,this},D.prototype.getMaxListeners=function(){return j(this)},D.prototype.emit=function(nt){for(var lt=[],at=1;at<arguments.length;at++)lt.push(arguments[at]);var ut=nt==="error",V=this._events;if(V!==void 0)ut=ut&&V.error===void 0;else if(!ut)return!1;if(ut){var ht;if(lt.length>0&&(ht=lt[0]),ht instanceof Error)throw ht;var vt=new Error("Unhandled error."+(ht?" ("+ht.message+")":""));throw vt.context=ht,vt}var pt=V[nt];if(pt===void 0)return!1;if(typeof pt=="function")P(pt,this,lt);else{var st=pt.length,ct=rt(pt,st);for(at=0;at<st;++at)P(ct[at],this,lt)}return!0},D.prototype.addListener=function(nt,lt){return G(this,nt,lt,!1)},D.prototype.on=D.prototype.addListener,D.prototype.prependListener=function(nt,lt){return G(this,nt,lt,!0)},D.prototype.once=function(nt,lt){return Z(lt),this.on(nt,W(this,nt,lt)),this},D.prototype.prependOnceListener=function(nt,lt){return Z(lt),this.prependListener(nt,W(this,nt,lt)),this},D.prototype.removeListener=function(nt,lt){var at,ut,V,ht,vt;if(Z(lt),(ut=this._events)===void 0)return this;if((at=ut[nt])===void 0)return this;if(at===lt||at.listener===lt)--this._eventsCount==0?this._events=Object.create(null):(delete ut[nt],ut.removeListener&&this.emit("removeListener",nt,at.listener||lt));else if(typeof at!="function"){for(V=-1,ht=at.length-1;ht>=0;ht--)if(at[ht]===lt||at[ht].listener===lt){vt=at[ht].listener,V=ht;break}if(V<0)return this;V===0?at.shift():it(at,V),at.length===1&&(ut[nt]=at[0]),ut.removeListener!==void 0&&this.emit("removeListener",nt,vt||lt)}return this},D.prototype.off=D.prototype.removeListener,D.prototype.removeAllListeners=function(nt){var lt,at,ut;if((at=this._events)===void 0)return this;if(at.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):at[nt]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete at[nt]),this;if(arguments.length===0){var V,ht=Object.keys(at);for(ut=0;ut<ht.length;++ut)(V=ht[ut])!=="removeListener"&&this.removeAllListeners(V);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(lt=at[nt])=="function")this.removeListener(nt,lt);else if(lt!==void 0)for(ut=lt.length-1;ut>=0;ut--)this.removeListener(nt,lt[ut]);return this},D.prototype.listeners=function(nt){return Q(this,nt,!0)},D.prototype.rawListeners=function(nt){return Q(this,nt,!1)},D.listenerCount=function(nt,lt){return typeof nt.listenerCount=="function"?nt.listenerCount(lt):q.call(nt,lt)},D.prototype.listenerCount=q,D.prototype.eventNames=function(){return this._eventsCount>0?w(this._events):[]}},{}],36:[function(d,m,g){var w=d("is-callable"),I=Object.prototype.toString,P=Object.prototype.hasOwnProperty,F=function(Z,j,G){for(var H=0,W=Z.length;H<W;H++)P.call(Z,H)&&(G==null?j(Z[H],H,Z):j.call(G,Z[H],H,Z))},$=function(Z,j,G){for(var H=0,W=Z.length;H<W;H++)G==null?j(Z.charAt(H),H,Z):j.call(G,Z.charAt(H),H,Z)},D=function(Z,j,G){for(var H in Z)P.call(Z,H)&&(G==null?j(Z[H],H,Z):j.call(G,Z[H],H,Z))},U=function(Z,j,G){if(!w(j))throw new TypeError("iterator must be a function");var H;arguments.length>=3&&(H=G),I.call(Z)==="[object Array]"?F(Z,j,H):typeof Z=="string"?$(Z,j,H):D(Z,j,H)};m.exports=U},{"is-callable":48}],37:[function(d,m,g){var w="Function.prototype.bind called on incompatible ",I=Array.prototype.slice,P=Object.prototype.toString,F="[object Function]";m.exports=function($){var D=this;if(typeof D!="function"||P.call(D)!==F)throw new TypeError(w+D);for(var U,Z=I.call(arguments,1),j=function(){if(this instanceof U){var q=D.apply(this,Z.concat(I.call(arguments)));return Object(q)===q?q:this}return D.apply($,Z.concat(I.call(arguments)))},G=Math.max(0,D.length-Z.length),H=[],W=0;W<G;W++)H.push("$"+W);if(U=Function("binder","return function ("+H.join(",")+"){ return binder.apply(this,arguments); }")(j),D.prototype){var Q=function(){};Q.prototype=D.prototype,U.prototype=new Q,Q.prototype=null}return U}},{}],38:[function(d,m,g){var w=d("./implementation");m.exports=Function.prototype.bind||w},{"./implementation":37}],39:[function(d,m,g){var w,I=SyntaxError,P=Function,F=TypeError,$=function(pt){try{return P('"use strict"; return ('+pt+").constructor;")()}catch{}},D=Object.getOwnPropertyDescriptor;if(D)try{D({},"")}catch{D=null}var U=function(){throw new F},Z=D?function(){try{return U}catch{try{return D(arguments,"callee").get}catch{return U}}}():U,j=d("has-symbols")(),G=Object.getPrototypeOf||function(pt){return pt.__proto__},H={},W=typeof Uint8Array>"u"?w:G(Uint8Array),Q={"%AggregateError%":typeof AggregateError>"u"?w:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?w:ArrayBuffer,"%ArrayIteratorPrototype%":j?G([][Symbol.iterator]()):w,"%AsyncFromSyncIteratorPrototype%":w,"%AsyncFunction%":H,"%AsyncGenerator%":H,"%AsyncGeneratorFunction%":H,"%AsyncIteratorPrototype%":H,"%Atomics%":typeof Atomics>"u"?w:Atomics,"%BigInt%":typeof BigInt>"u"?w:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?w:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?w:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?w:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?w:Float32Array,"%Float64Array%":typeof Float64Array>"u"?w:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?w:FinalizationRegistry,"%Function%":P,"%GeneratorFunction%":H,"%Int8Array%":typeof Int8Array>"u"?w:Int8Array,"%Int16Array%":typeof Int16Array>"u"?w:Int16Array,"%Int32Array%":typeof Int32Array>"u"?w:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":j?G(G([][Symbol.iterator]())):w,"%JSON%":typeof JSON=="object"?JSON:w,"%Map%":typeof Map>"u"?w:Map,"%MapIteratorPrototype%":typeof Map<"u"&&j?G(new Map()[Symbol.iterator]()):w,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?w:Promise,"%Proxy%":typeof Proxy>"u"?w:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?w:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?w:Set,"%SetIteratorPrototype%":typeof Set<"u"&&j?G(new Set()[Symbol.iterator]()):w,"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?w:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":j?G(""[Symbol.iterator]()):w,"%Symbol%":j?Symbol:w,"%SyntaxError%":I,"%ThrowTypeError%":Z,"%TypedArray%":W,"%TypeError%":F,"%Uint8Array%":typeof Uint8Array>"u"?w:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?w:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?w:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?w:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?w:WeakMap,"%WeakRef%":typeof WeakRef>"u"?w:WeakRef,"%WeakSet%":typeof WeakSet>"u"?w:WeakSet};try{null.error}catch(pt){var q=G(G(pt));Q["%Error.prototype%"]=q}var rt=function pt(st){var ct;if(st==="%AsyncFunction%")ct=$("async function () {}");else if(st==="%GeneratorFunction%")ct=$("function* () {}");else if(st==="%AsyncGeneratorFunction%")ct=$("async function* () {}");else if(st==="%AsyncGenerator%"){var At=pt("%AsyncGeneratorFunction%");At&&(ct=At.prototype)}else if(st==="%AsyncIteratorPrototype%"){var kt=pt("%AsyncGenerator%");kt&&(ct=G(kt.prototype))}return Q[st]=ct,ct},it={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},X=d("function-bind"),J=d("has"),tt=X.call(Function.call,Array.prototype.concat),ot=X.call(Function.apply,Array.prototype.splice),nt=X.call(Function.call,String.prototype.replace),lt=X.call(Function.call,String.prototype.slice),at=X.call(Function.call,RegExp.prototype.exec),ut=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,V=/\\(\\)?/g,ht=function(pt){var st=lt(pt,0,1),ct=lt(pt,-1);if(st==="%"&&ct!=="%")throw new I("invalid intrinsic syntax, expected closing `%`");if(ct==="%"&&st!=="%")throw new I("invalid intrinsic syntax, expected opening `%`");var At=[];return nt(pt,ut,function(kt,yt,Ct,xt){At[At.length]=Ct?nt(xt,V,"$1"):yt||kt}),At},vt=function(pt,st){var ct,At=pt;if(J(it,At)&&(At="%"+(ct=it[At])[0]+"%"),J(Q,At)){var kt=Q[At];if(kt===H&&(kt=rt(At)),kt===void 0&&!st)throw new F("intrinsic "+pt+" exists, but is not available. Please file an issue!");return{alias:ct,name:At,value:kt}}throw new I("intrinsic "+pt+" does not exist!")};m.exports=function(pt,st){if(typeof pt!="string"||pt.length===0)throw new F("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof st!="boolean")throw new F('"allowMissing" argument must be a boolean');if(at(/^%?[^%]*%?$/,pt)===null)throw new I("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var ct=ht(pt),At=ct.length>0?ct[0]:"",kt=vt("%"+At+"%",st),yt=kt.name,Ct=kt.value,xt=!1,Pt=kt.alias;Pt&&(At=Pt[0],ot(ct,tt([0,1],Pt)));for(var Ft=1,Rt=!0;Ft<ct.length;Ft+=1){var Mt=ct[Ft],Bt=lt(Mt,0,1),$t=lt(Mt,-1);if((Bt==='"'||Bt==="'"||Bt==="`"||$t==='"'||$t==="'"||$t==="`")&&Bt!==$t)throw new I("property names with quotes must have matching quotes");if(Mt!=="constructor"&&Rt||(xt=!0),J(Q,yt="%"+(At+="."+Mt)+"%"))Ct=Q[yt];else if(Ct!=null){if(!(Mt in Ct)){if(!st)throw new F("base intrinsic for "+pt+" exists, but the property is not available.");return}if(D&&Ft+1>=ct.length){var Ot=D(Ct,Mt);Ct=(Rt=!!Ot)&&"get"in Ot&&!("originalValue"in Ot.get)?Ot.get:Ct[Mt]}else Rt=J(Ct,Mt),Ct=Ct[Mt];Rt&&!xt&&(Q[yt]=Ct)}}return Ct}},{"function-bind":38,has:44,"has-symbols":41}],40:[function(d,m,g){var w=d("get-intrinsic")("%Object.getOwnPropertyDescriptor%",!0);if(w)try{w([],"length")}catch{w=null}m.exports=w},{"get-intrinsic":39}],41:[function(d,m,g){var w=typeof Symbol<"u"&&Symbol,I=d("./shams");m.exports=function(){return typeof w=="function"&&typeof Symbol=="function"&&typeof w("foo")=="symbol"&&typeof Symbol("bar")=="symbol"&&I()}},{"./shams":42}],42:[function(d,m,g){m.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var w={},I=Symbol("test"),P=Object(I);if(typeof I=="string"||Object.prototype.toString.call(I)!=="[object Symbol]"||Object.prototype.toString.call(P)!=="[object Symbol]")return!1;var F=42;for(I in w[I]=F,w)return!1;if(typeof Object.keys=="function"&&Object.keys(w).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(w).length!==0)return!1;var $=Object.getOwnPropertySymbols(w);if($.length!==1||$[0]!==I||!Object.prototype.propertyIsEnumerable.call(w,I))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var D=Object.getOwnPropertyDescriptor(w,I);if(D.value!==F||D.enumerable!==!0)return!1}return!0}},{}],43:[function(d,m,g){var w=d("has-symbols/shams");m.exports=function(){return w()&&!!Symbol.toStringTag}},{"has-symbols/shams":42}],44:[function(d,m,g){var w=d("function-bind");m.exports=w.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":38}],45:[function(d,m,g){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */g.read=function(w,I,P,F,$){var D,U,Z=8*$-F-1,j=(1<<Z)-1,G=j>>1,H=-7,W=P?$-1:0,Q=P?-1:1,q=w[I+W];for(W+=Q,D=q&(1<<-H)-1,q>>=-H,H+=Z;H>0;D=256*D+w[I+W],W+=Q,H-=8);for(U=D&(1<<-H)-1,D>>=-H,H+=F;H>0;U=256*U+w[I+W],W+=Q,H-=8);if(D===0)D=1-G;else{if(D===j)return U?NaN:1/0*(q?-1:1);U+=Math.pow(2,F),D-=G}return(q?-1:1)*U*Math.pow(2,D-F)},g.write=function(w,I,P,F,$,D){var U,Z,j,G=8*D-$-1,H=(1<<G)-1,W=H>>1,Q=$===23?Math.pow(2,-24)-Math.pow(2,-77):0,q=F?0:D-1,rt=F?1:-1,it=I<0||I===0&&1/I<0?1:0;for(I=Math.abs(I),isNaN(I)||I===1/0?(Z=isNaN(I)?1:0,U=H):(U=Math.floor(Math.log(I)/Math.LN2),I*(j=Math.pow(2,-U))<1&&(U--,j*=2),(I+=U+W>=1?Q/j:Q*Math.pow(2,1-W))*j>=2&&(U++,j/=2),U+W>=H?(Z=0,U=H):U+W>=1?(Z=(I*j-1)*Math.pow(2,$),U+=W):(Z=I*Math.pow(2,W-1)*Math.pow(2,$),U=0));$>=8;w[P+q]=255&Z,q+=rt,Z/=256,$-=8);for(U=U<<$|Z,G+=$;G>0;w[P+q]=255&U,q+=rt,U/=256,G-=8);w[P+q-rt]|=128*it}},{}],46:[function(d,m,g){typeof Object.create=="function"?m.exports=function(w,I){I&&(w.super_=I,w.prototype=Object.create(I.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}))}:m.exports=function(w,I){if(I){w.super_=I;var P=function(){};P.prototype=I.prototype,w.prototype=new P,w.prototype.constructor=w}}},{}],47:[function(d,m,g){var w=d("has-tostringtag/shams")(),I=d("call-bind/callBound")("Object.prototype.toString"),P=function(D){return!(w&&D&&typeof D=="object"&&Symbol.toStringTag in D)&&I(D)==="[object Arguments]"},F=function(D){return!!P(D)||D!==null&&typeof D=="object"&&typeof D.length=="number"&&D.length>=0&&I(D)!=="[object Array]"&&I(D.callee)==="[object Function]"},$=function(){return P(arguments)}();P.isLegacyArguments=F,m.exports=$?P:F},{"call-bind/callBound":33,"has-tostringtag/shams":43}],48:[function(d,m,g){var w,I,P=Function.prototype.toString,F=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply;if(typeof F=="function"&&typeof Object.defineProperty=="function")try{w=Object.defineProperty({},"length",{get:function(){throw I}}),I={},F(function(){throw 42},null,w)}catch(tt){tt!==I&&(F=null)}else F=null;var $=/^\s*class\b/,D=function(tt){try{var ot=P.call(tt);return $.test(ot)}catch{return!1}},U=function(tt){try{return!D(tt)&&(P.call(tt),!0)}catch{return!1}},Z=Object.prototype.toString,j="[object Object]",G="[object Function]",H="[object GeneratorFunction]",W="[object HTMLAllCollection]",Q="[object HTML document.all class]",q="[object HTMLCollection]",rt=typeof Symbol=="function"&&!!Symbol.toStringTag,it=!(0 in[,]),X=function(){return!1};if(typeof document=="object"){var J=document.all;Z.call(J)===Z.call(document.all)&&(X=function(tt){if((it||!tt)&&(tt===void 0||typeof tt=="object"))try{var ot=Z.call(tt);return(ot===W||ot===Q||ot===q||ot===j)&&tt("")==null}catch{}return!1})}m.exports=F?function(tt){if(X(tt))return!0;if(!tt||typeof tt!="function"&&typeof tt!="object")return!1;try{F(tt,null,w)}catch(ot){if(ot!==I)return!1}return!D(tt)&&U(tt)}:function(tt){if(X(tt))return!0;if(!tt||typeof tt!="function"&&typeof tt!="object")return!1;if(rt)return U(tt);if(D(tt))return!1;var ot=Z.call(tt);return!(ot!==G&&ot!==H&&!/^\[object HTML/.test(ot))&&U(tt)}},{}],49:[function(d,m,g){var w,I=Object.prototype.toString,P=Function.prototype.toString,F=/^\s*(?:function)?\*/,$=d("has-tostringtag/shams")(),D=Object.getPrototypeOf,U=function(){if(!$)return!1;try{return Function("return function*() {}")()}catch{}};m.exports=function(Z){if(typeof Z!="function")return!1;if(F.test(P.call(Z)))return!0;if(!$)return I.call(Z)==="[object GeneratorFunction]";if(!D)return!1;if(w===void 0){var j=U();w=!!j&&D(j)}return D(Z)===w}},{"has-tostringtag/shams":43}],50:[function(d,m,g){(function(w){(function(){var I=d("for-each"),P=d("available-typed-arrays"),F=d("call-bind/callBound"),$=F("Object.prototype.toString"),D=d("has-tostringtag/shams")(),U=d("gopd"),Z=typeof globalThis>"u"?w:globalThis,j=P(),G=F("Array.prototype.indexOf",!0)||function(rt,it){for(var X=0;X<rt.length;X+=1)if(rt[X]===it)return X;return-1},H=F("String.prototype.slice"),W={},Q=Object.getPrototypeOf;D&&U&&Q&&I(j,function(rt){var it=new Z[rt];if(Symbol.toStringTag in it){var X=Q(it),J=U(X,Symbol.toStringTag);if(!J){var tt=Q(X);J=U(tt,Symbol.toStringTag)}W[rt]=J.get}});var q=function(rt){var it=!1;return I(W,function(X,J){if(!it)try{it=X.call(rt)===J}catch{}}),it};m.exports=function(rt){if(!rt||typeof rt!="object")return!1;if(!D||!(Symbol.toStringTag in rt)){var it=H($(rt),8,-1);return G(j,it)>-1}return!!U&&q(rt)}}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"available-typed-arrays":27,"call-bind/callBound":33,"for-each":36,gopd:40,"has-tostringtag/shams":43}],51:[function(d,m,g){var w=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;function F(D){if(D==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(D)}function $(){try{if(!Object.assign)return!1;var D=new String("abc");if(D[5]="de",Object.getOwnPropertyNames(D)[0]==="5")return!1;for(var U={},Z=0;Z<10;Z++)U["_"+String.fromCharCode(Z)]=Z;var j=Object.getOwnPropertyNames(U).map(function(H){return U[H]});if(j.join("")!=="0123456789")return!1;var G={};return"abcdefghijklmnopqrst".split("").forEach(function(H){G[H]=H}),Object.keys(Object.assign({},G)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}m.exports=$()?Object.assign:function(D,U){for(var Z,j,G=F(D),H=1;H<arguments.length;H++){for(var W in Z=Object(arguments[H]))I.call(Z,W)&&(G[W]=Z[W]);if(w){j=w(Z);for(var Q=0;Q<j.length;Q++)P.call(Z,j[Q])&&(G[j[Q]]=Z[j[Q]])}}return G}},{}],52:[function(d,m,g){var w=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function I($,D){return Object.prototype.hasOwnProperty.call($,D)}g.assign=function($){for(var D=Array.prototype.slice.call(arguments,1);D.length;){var U=D.shift();if(U){if(typeof U!="object")throw new TypeError(U+"must be non-object");for(var Z in U)I(U,Z)&&($[Z]=U[Z])}}return $},g.shrinkBuf=function($,D){return $.length===D?$:$.subarray?$.subarray(0,D):($.length=D,$)};var P={arraySet:function($,D,U,Z,j){if(D.subarray&&$.subarray)$.set(D.subarray(U,U+Z),j);else for(var G=0;G<Z;G++)$[j+G]=D[U+G]},flattenChunks:function($){var D,U,Z,j,G,H;for(Z=0,D=0,U=$.length;D<U;D++)Z+=$[D].length;for(H=new Uint8Array(Z),j=0,D=0,U=$.length;D<U;D++)G=$[D],H.set(G,j),j+=G.length;return H}},F={arraySet:function($,D,U,Z,j){for(var G=0;G<Z;G++)$[j+G]=D[U+G]},flattenChunks:function($){return[].concat.apply([],$)}};g.setTyped=function($){$?(g.Buf8=Uint8Array,g.Buf16=Uint16Array,g.Buf32=Int32Array,g.assign(g,P)):(g.Buf8=Array,g.Buf16=Array,g.Buf32=Array,g.assign(g,F))},g.setTyped(w)},{}],53:[function(d,m,g){function w(I,P,F,$){for(var D=65535&I,U=I>>>16&65535,Z=0;F!==0;){F-=Z=F>2e3?2e3:F;do U=U+(D=D+P[$++]|0)|0;while(--Z);D%=65521,U%=65521}return D|U<<16}m.exports=w},{}],54:[function(d,m,g){m.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],55:[function(d,m,g){function w(){for(var F,$=[],D=0;D<256;D++){F=D;for(var U=0;U<8;U++)F=1&F?3988292384^F>>>1:F>>>1;$[D]=F}return $}var I=w();function P(F,$,D,U){var Z=I,j=U+D;F^=-1;for(var G=U;G<j;G++)F=F>>>8^Z[255&(F^$[G])];return~F}m.exports=P},{}],56:[function(d,m,g){var w,I=d("../utils/common"),P=d("./trees"),F=d("./adler32"),$=d("./crc32"),D=d("./messages"),U=0,Z=1,j=3,G=4,H=5,W=0,Q=1,q=-2,rt=-3,it=-5,X=-1,J=1,tt=2,ot=3,nt=4,lt=0,at=2,ut=8,V=9,ht=15,vt=8,pt=286,st=30,ct=19,At=2*pt+1,kt=15,yt=3,Ct=258,xt=Ct+yt+1,Pt=32,Ft=42,Rt=69,Mt=73,Bt=91,$t=103,Ot=113,Zt=666,Tt=1,et=2,It=3,mt=4,gt=3;function _t(dt,qt){return dt.msg=D[qt],qt}function Et(dt){return(dt<<1)-(dt>4?9:0)}function zt(dt){for(var qt=dt.length;--qt>=0;)dt[qt]=0}function K(dt){var qt=dt.state,Gt=qt.pending;Gt>dt.avail_out&&(Gt=dt.avail_out),Gt!==0&&(I.arraySet(dt.output,qt.pending_buf,qt.pending_out,Gt,dt.next_out),dt.next_out+=Gt,qt.pending_out+=Gt,dt.total_out+=Gt,dt.avail_out-=Gt,qt.pending-=Gt,qt.pending===0&&(qt.pending_out=0))}function ft(dt,qt){P._tr_flush_block(dt,dt.block_start>=0?dt.block_start:-1,dt.strstart-dt.block_start,qt),dt.block_start=dt.strstart,K(dt.strm)}function bt(dt,qt){dt.pending_buf[dt.pending++]=qt}function wt(dt,qt){dt.pending_buf[dt.pending++]=qt>>>8&255,dt.pending_buf[dt.pending++]=255&qt}function Lt(dt,qt,Gt,Dt){var Ht=dt.avail_in;return Ht>Dt&&(Ht=Dt),Ht===0?0:(dt.avail_in-=Ht,I.arraySet(qt,dt.input,dt.next_in,Ht,Gt),dt.state.wrap===1?dt.adler=F(dt.adler,qt,Ht,Gt):dt.state.wrap===2&&(dt.adler=$(dt.adler,qt,Ht,Gt)),dt.next_in+=Ht,dt.total_in+=Ht,Ht)}function jt(dt,qt){var Gt,Dt,Ht=dt.max_chain_length,Wt=dt.strstart,le=dt.prev_length,re=dt.nice_match,se=dt.strstart>dt.w_size-xt?dt.strstart-(dt.w_size-xt):0,ce=dt.window,xe=dt.w_mask,de=dt.prev,pe=dt.strstart+Ct,ge=ce[Wt+le-1],be=ce[Wt+le];dt.prev_length>=dt.good_match&&(Ht>>=2),re>dt.lookahead&&(re=dt.lookahead);do if(ce[(Gt=qt)+le]===be&&ce[Gt+le-1]===ge&&ce[Gt]===ce[Wt]&&ce[++Gt]===ce[Wt+1]){Wt+=2,Gt++;do;while(ce[++Wt]===ce[++Gt]&&ce[++Wt]===ce[++Gt]&&ce[++Wt]===ce[++Gt]&&ce[++Wt]===ce[++Gt]&&ce[++Wt]===ce[++Gt]&&ce[++Wt]===ce[++Gt]&&ce[++Wt]===ce[++Gt]&&ce[++Wt]===ce[++Gt]&&Wt<pe);if(Dt=Ct-(pe-Wt),Wt=pe-Ct,Dt>le){if(dt.match_start=qt,le=Dt,Dt>=re)break;ge=ce[Wt+le-1],be=ce[Wt+le]}}while((qt=de[qt&xe])>se&&--Ht!=0);return le<=dt.lookahead?le:dt.lookahead}function Kt(dt){var qt,Gt,Dt,Ht,Wt,le=dt.w_size;do{if(Ht=dt.window_size-dt.lookahead-dt.strstart,dt.strstart>=le+(le-xt)){I.arraySet(dt.window,dt.window,le,le,0),dt.match_start-=le,dt.strstart-=le,dt.block_start-=le,qt=Gt=dt.hash_size;do Dt=dt.head[--qt],dt.head[qt]=Dt>=le?Dt-le:0;while(--Gt);qt=Gt=le;do Dt=dt.prev[--qt],dt.prev[qt]=Dt>=le?Dt-le:0;while(--Gt);Ht+=le}if(dt.strm.avail_in===0)break;if(Gt=Lt(dt.strm,dt.window,dt.strstart+dt.lookahead,Ht),dt.lookahead+=Gt,dt.lookahead+dt.insert>=yt)for(Wt=dt.strstart-dt.insert,dt.ins_h=dt.window[Wt],dt.ins_h=(dt.ins_h<<dt.hash_shift^dt.window[Wt+1])&dt.hash_mask;dt.insert&&(dt.ins_h=(dt.ins_h<<dt.hash_shift^dt.window[Wt+yt-1])&dt.hash_mask,dt.prev[Wt&dt.w_mask]=dt.head[dt.ins_h],dt.head[dt.ins_h]=Wt,Wt++,dt.insert--,!(dt.lookahead+dt.insert<yt)););}while(dt.lookahead<xt&&dt.strm.avail_in!==0)}function te(dt,qt){var Gt=65535;for(Gt>dt.pending_buf_size-5&&(Gt=dt.pending_buf_size-5);;){if(dt.lookahead<=1){if(Kt(dt),dt.lookahead===0&&qt===U)return Tt;if(dt.lookahead===0)break}dt.strstart+=dt.lookahead,dt.lookahead=0;var Dt=dt.block_start+Gt;if((dt.strstart===0||dt.strstart>=Dt)&&(dt.lookahead=dt.strstart-Dt,dt.strstart=Dt,ft(dt,!1),dt.strm.avail_out===0)||dt.strstart-dt.block_start>=dt.w_size-xt&&(ft(dt,!1),dt.strm.avail_out===0))return Tt}return dt.insert=0,qt===G?(ft(dt,!0),dt.strm.avail_out===0?It:mt):(dt.strstart>dt.block_start&&(ft(dt,!1),dt.strm.avail_out),Tt)}function Vt(dt,qt){for(var Gt,Dt;;){if(dt.lookahead<xt){if(Kt(dt),dt.lookahead<xt&&qt===U)return Tt;if(dt.lookahead===0)break}if(Gt=0,dt.lookahead>=yt&&(dt.ins_h=(dt.ins_h<<dt.hash_shift^dt.window[dt.strstart+yt-1])&dt.hash_mask,Gt=dt.prev[dt.strstart&dt.w_mask]=dt.head[dt.ins_h],dt.head[dt.ins_h]=dt.strstart),Gt!==0&&dt.strstart-Gt<=dt.w_size-xt&&(dt.match_length=jt(dt,Gt)),dt.match_length>=yt)if(Dt=P._tr_tally(dt,dt.strstart-dt.match_start,dt.match_length-yt),dt.lookahead-=dt.match_length,dt.match_length<=dt.max_lazy_match&&dt.lookahead>=yt){dt.match_length--;do dt.strstart++,dt.ins_h=(dt.ins_h<<dt.hash_shift^dt.window[dt.strstart+yt-1])&dt.hash_mask,Gt=dt.prev[dt.strstart&dt.w_mask]=dt.head[dt.ins_h],dt.head[dt.ins_h]=dt.strstart;while(--dt.match_length!=0);dt.strstart++}else dt.strstart+=dt.match_length,dt.match_length=0,dt.ins_h=dt.window[dt.strstart],dt.ins_h=(dt.ins_h<<dt.hash_shift^dt.window[dt.strstart+1])&dt.hash_mask;else Dt=P._tr_tally(dt,0,dt.window[dt.strstart]),dt.lookahead--,dt.strstart++;if(Dt&&(ft(dt,!1),dt.strm.avail_out===0))return Tt}return dt.insert=dt.strstart<yt-1?dt.strstart:yt-1,qt===G?(ft(dt,!0),dt.strm.avail_out===0?It:mt):dt.last_lit&&(ft(dt,!1),dt.strm.avail_out===0)?Tt:et}function ee(dt,qt){for(var Gt,Dt,Ht;;){if(dt.lookahead<xt){if(Kt(dt),dt.lookahead<xt&&qt===U)return Tt;if(dt.lookahead===0)break}if(Gt=0,dt.lookahead>=yt&&(dt.ins_h=(dt.ins_h<<dt.hash_shift^dt.window[dt.strstart+yt-1])&dt.hash_mask,Gt=dt.prev[dt.strstart&dt.w_mask]=dt.head[dt.ins_h],dt.head[dt.ins_h]=dt.strstart),dt.prev_length=dt.match_length,dt.prev_match=dt.match_start,dt.match_length=yt-1,Gt!==0&&dt.prev_length<dt.max_lazy_match&&dt.strstart-Gt<=dt.w_size-xt&&(dt.match_length=jt(dt,Gt),dt.match_length<=5&&(dt.strategy===J||dt.match_length===yt&&dt.strstart-dt.match_start>4096)&&(dt.match_length=yt-1)),dt.prev_length>=yt&&dt.match_length<=dt.prev_length){Ht=dt.strstart+dt.lookahead-yt,Dt=P._tr_tally(dt,dt.strstart-1-dt.prev_match,dt.prev_length-yt),dt.lookahead-=dt.prev_length-1,dt.prev_length-=2;do++dt.strstart<=Ht&&(dt.ins_h=(dt.ins_h<<dt.hash_shift^dt.window[dt.strstart+yt-1])&dt.hash_mask,Gt=dt.prev[dt.strstart&dt.w_mask]=dt.head[dt.ins_h],dt.head[dt.ins_h]=dt.strstart);while(--dt.prev_length!=0);if(dt.match_available=0,dt.match_length=yt-1,dt.strstart++,Dt&&(ft(dt,!1),dt.strm.avail_out===0))return Tt}else if(dt.match_available){if((Dt=P._tr_tally(dt,0,dt.window[dt.strstart-1]))&&ft(dt,!1),dt.strstart++,dt.lookahead--,dt.strm.avail_out===0)return Tt}else dt.match_available=1,dt.strstart++,dt.lookahead--}return dt.match_available&&(Dt=P._tr_tally(dt,0,dt.window[dt.strstart-1]),dt.match_available=0),dt.insert=dt.strstart<yt-1?dt.strstart:yt-1,qt===G?(ft(dt,!0),dt.strm.avail_out===0?It:mt):dt.last_lit&&(ft(dt,!1),dt.strm.avail_out===0)?Tt:et}function Jt(dt,qt){for(var Gt,Dt,Ht,Wt,le=dt.window;;){if(dt.lookahead<=Ct){if(Kt(dt),dt.lookahead<=Ct&&qt===U)return Tt;if(dt.lookahead===0)break}if(dt.match_length=0,dt.lookahead>=yt&&dt.strstart>0&&(Dt=le[Ht=dt.strstart-1])===le[++Ht]&&Dt===le[++Ht]&&Dt===le[++Ht]){Wt=dt.strstart+Ct;do;while(Dt===le[++Ht]&&Dt===le[++Ht]&&Dt===le[++Ht]&&Dt===le[++Ht]&&Dt===le[++Ht]&&Dt===le[++Ht]&&Dt===le[++Ht]&&Dt===le[++Ht]&&Ht<Wt);dt.match_length=Ct-(Wt-Ht),dt.match_length>dt.lookahead&&(dt.match_length=dt.lookahead)}if(dt.match_length>=yt?(Gt=P._tr_tally(dt,1,dt.match_length-yt),dt.lookahead-=dt.match_length,dt.strstart+=dt.match_length,dt.match_length=0):(Gt=P._tr_tally(dt,0,dt.window[dt.strstart]),dt.lookahead--,dt.strstart++),Gt&&(ft(dt,!1),dt.strm.avail_out===0))return Tt}return dt.insert=0,qt===G?(ft(dt,!0),dt.strm.avail_out===0?It:mt):dt.last_lit&&(ft(dt,!1),dt.strm.avail_out===0)?Tt:et}function oe(dt,qt){for(var Gt;;){if(dt.lookahead===0&&(Kt(dt),dt.lookahead===0)){if(qt===U)return Tt;break}if(dt.match_length=0,Gt=P._tr_tally(dt,0,dt.window[dt.strstart]),dt.lookahead--,dt.strstart++,Gt&&(ft(dt,!1),dt.strm.avail_out===0))return Tt}return dt.insert=0,qt===G?(ft(dt,!0),dt.strm.avail_out===0?It:mt):dt.last_lit&&(ft(dt,!1),dt.strm.avail_out===0)?Tt:et}function ne(dt,qt,Gt,Dt,Ht){this.good_length=dt,this.max_lazy=qt,this.nice_length=Gt,this.max_chain=Dt,this.func=Ht}function ae(dt){dt.window_size=2*dt.w_size,zt(dt.head),dt.max_lazy_match=w[dt.level].max_lazy,dt.good_match=w[dt.level].good_length,dt.nice_match=w[dt.level].nice_length,dt.max_chain_length=w[dt.level].max_chain,dt.strstart=0,dt.block_start=0,dt.lookahead=0,dt.insert=0,dt.match_length=dt.prev_length=yt-1,dt.match_available=0,dt.ins_h=0}function fe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ut,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new I.Buf16(2*At),this.dyn_dtree=new I.Buf16(2*(2*st+1)),this.bl_tree=new I.Buf16(2*(2*ct+1)),zt(this.dyn_ltree),zt(this.dyn_dtree),zt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new I.Buf16(kt+1),this.heap=new I.Buf16(2*pt+1),zt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new I.Buf16(2*pt+1),zt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ie(dt){var qt;return dt&&dt.state?(dt.total_in=dt.total_out=0,dt.data_type=at,(qt=dt.state).pending=0,qt.pending_out=0,qt.wrap<0&&(qt.wrap=-qt.wrap),qt.status=qt.wrap?Ft:Ot,dt.adler=qt.wrap===2?0:1,qt.last_flush=U,P._tr_init(qt),W):_t(dt,q)}function Nt(dt){var qt=ie(dt);return qt===W&&ae(dt.state),qt}function Xt(dt,qt){return dt&&dt.state?dt.state.wrap!==2?q:(dt.state.gzhead=qt,W):q}function Ut(dt,qt,Gt,Dt,Ht,Wt){if(!dt)return q;var le=1;if(qt===X&&(qt=6),Dt<0?(le=0,Dt=-Dt):Dt>15&&(le=2,Dt-=16),Ht<1||Ht>V||Gt!==ut||Dt<8||Dt>15||qt<0||qt>9||Wt<0||Wt>nt)return _t(dt,q);Dt===8&&(Dt=9);var re=new fe;return dt.state=re,re.strm=dt,re.wrap=le,re.gzhead=null,re.w_bits=Dt,re.w_size=1<<re.w_bits,re.w_mask=re.w_size-1,re.hash_bits=Ht+7,re.hash_size=1<<re.hash_bits,re.hash_mask=re.hash_size-1,re.hash_shift=~~((re.hash_bits+yt-1)/yt),re.window=new I.Buf8(2*re.w_size),re.head=new I.Buf16(re.hash_size),re.prev=new I.Buf16(re.w_size),re.lit_bufsize=1<<Ht+6,re.pending_buf_size=4*re.lit_bufsize,re.pending_buf=new I.Buf8(re.pending_buf_size),re.d_buf=1*re.lit_bufsize,re.l_buf=3*re.lit_bufsize,re.level=qt,re.strategy=Wt,re.method=Gt,Nt(dt)}function Qt(dt,qt){return Ut(dt,qt,ut,ht,vt,lt)}function St(dt,qt){var Gt,Dt,Ht,Wt;if(!dt||!dt.state||qt>H||qt<0)return dt?_t(dt,q):q;if(Dt=dt.state,!dt.output||!dt.input&&dt.avail_in!==0||Dt.status===Zt&&qt!==G)return _t(dt,dt.avail_out===0?it:q);if(Dt.strm=dt,Gt=Dt.last_flush,Dt.last_flush=qt,Dt.status===Ft)if(Dt.wrap===2)dt.adler=0,bt(Dt,31),bt(Dt,139),bt(Dt,8),Dt.gzhead?(bt(Dt,(Dt.gzhead.text?1:0)+(Dt.gzhead.hcrc?2:0)+(Dt.gzhead.extra?4:0)+(Dt.gzhead.name?8:0)+(Dt.gzhead.comment?16:0)),bt(Dt,255&Dt.gzhead.time),bt(Dt,Dt.gzhead.time>>8&255),bt(Dt,Dt.gzhead.time>>16&255),bt(Dt,Dt.gzhead.time>>24&255),bt(Dt,Dt.level===9?2:Dt.strategy>=tt||Dt.level<2?4:0),bt(Dt,255&Dt.gzhead.os),Dt.gzhead.extra&&Dt.gzhead.extra.length&&(bt(Dt,255&Dt.gzhead.extra.length),bt(Dt,Dt.gzhead.extra.length>>8&255)),Dt.gzhead.hcrc&&(dt.adler=$(dt.adler,Dt.pending_buf,Dt.pending,0)),Dt.gzindex=0,Dt.status=Rt):(bt(Dt,0),bt(Dt,0),bt(Dt,0),bt(Dt,0),bt(Dt,0),bt(Dt,Dt.level===9?2:Dt.strategy>=tt||Dt.level<2?4:0),bt(Dt,gt),Dt.status=Ot);else{var le=ut+(Dt.w_bits-8<<4)<<8;le|=(Dt.strategy>=tt||Dt.level<2?0:Dt.level<6?1:Dt.level===6?2:3)<<6,Dt.strstart!==0&&(le|=Pt),le+=31-le%31,Dt.status=Ot,wt(Dt,le),Dt.strstart!==0&&(wt(Dt,dt.adler>>>16),wt(Dt,65535&dt.adler)),dt.adler=1}if(Dt.status===Rt)if(Dt.gzhead.extra){for(Ht=Dt.pending;Dt.gzindex<(65535&Dt.gzhead.extra.length)&&(Dt.pending!==Dt.pending_buf_size||(Dt.gzhead.hcrc&&Dt.pending>Ht&&(dt.adler=$(dt.adler,Dt.pending_buf,Dt.pending-Ht,Ht)),K(dt),Ht=Dt.pending,Dt.pending!==Dt.pending_buf_size));)bt(Dt,255&Dt.gzhead.extra[Dt.gzindex]),Dt.gzindex++;Dt.gzhead.hcrc&&Dt.pending>Ht&&(dt.adler=$(dt.adler,Dt.pending_buf,Dt.pending-Ht,Ht)),Dt.gzindex===Dt.gzhead.extra.length&&(Dt.gzindex=0,Dt.status=Mt)}else Dt.status=Mt;if(Dt.status===Mt)if(Dt.gzhead.name){Ht=Dt.pending;do{if(Dt.pending===Dt.pending_buf_size&&(Dt.gzhead.hcrc&&Dt.pending>Ht&&(dt.adler=$(dt.adler,Dt.pending_buf,Dt.pending-Ht,Ht)),K(dt),Ht=Dt.pending,Dt.pending===Dt.pending_buf_size)){Wt=1;break}Wt=Dt.gzindex<Dt.gzhead.name.length?255&Dt.gzhead.name.charCodeAt(Dt.gzindex++):0,bt(Dt,Wt)}while(Wt!==0);Dt.gzhead.hcrc&&Dt.pending>Ht&&(dt.adler=$(dt.adler,Dt.pending_buf,Dt.pending-Ht,Ht)),Wt===0&&(Dt.gzindex=0,Dt.status=Bt)}else Dt.status=Bt;if(Dt.status===Bt)if(Dt.gzhead.comment){Ht=Dt.pending;do{if(Dt.pending===Dt.pending_buf_size&&(Dt.gzhead.hcrc&&Dt.pending>Ht&&(dt.adler=$(dt.adler,Dt.pending_buf,Dt.pending-Ht,Ht)),K(dt),Ht=Dt.pending,Dt.pending===Dt.pending_buf_size)){Wt=1;break}Wt=Dt.gzindex<Dt.gzhead.comment.length?255&Dt.gzhead.comment.charCodeAt(Dt.gzindex++):0,bt(Dt,Wt)}while(Wt!==0);Dt.gzhead.hcrc&&Dt.pending>Ht&&(dt.adler=$(dt.adler,Dt.pending_buf,Dt.pending-Ht,Ht)),Wt===0&&(Dt.status=$t)}else Dt.status=$t;if(Dt.status===$t&&(Dt.gzhead.hcrc?(Dt.pending+2>Dt.pending_buf_size&&K(dt),Dt.pending+2<=Dt.pending_buf_size&&(bt(Dt,255&dt.adler),bt(Dt,dt.adler>>8&255),dt.adler=0,Dt.status=Ot)):Dt.status=Ot),Dt.pending!==0){if(K(dt),dt.avail_out===0)return Dt.last_flush=-1,W}else if(dt.avail_in===0&&Et(qt)<=Et(Gt)&&qt!==G)return _t(dt,it);if(Dt.status===Zt&&dt.avail_in!==0)return _t(dt,it);if(dt.avail_in!==0||Dt.lookahead!==0||qt!==U&&Dt.status!==Zt){var re=Dt.strategy===tt?oe(Dt,qt):Dt.strategy===ot?Jt(Dt,qt):w[Dt.level].func(Dt,qt);if(re!==It&&re!==mt||(Dt.status=Zt),re===Tt||re===It)return dt.avail_out===0&&(Dt.last_flush=-1),W;if(re===et&&(qt===Z?P._tr_align(Dt):qt!==H&&(P._tr_stored_block(Dt,0,0,!1),qt===j&&(zt(Dt.head),Dt.lookahead===0&&(Dt.strstart=0,Dt.block_start=0,Dt.insert=0))),K(dt),dt.avail_out===0))return Dt.last_flush=-1,W}return qt!==G?W:Dt.wrap<=0?Q:(Dt.wrap===2?(bt(Dt,255&dt.adler),bt(Dt,dt.adler>>8&255),bt(Dt,dt.adler>>16&255),bt(Dt,dt.adler>>24&255),bt(Dt,255&dt.total_in),bt(Dt,dt.total_in>>8&255),bt(Dt,dt.total_in>>16&255),bt(Dt,dt.total_in>>24&255)):(wt(Dt,dt.adler>>>16),wt(Dt,65535&dt.adler)),K(dt),Dt.wrap>0&&(Dt.wrap=-Dt.wrap),Dt.pending!==0?W:Q)}function Yt(dt){var qt;return dt&&dt.state?(qt=dt.state.status)!==Ft&&qt!==Rt&&qt!==Mt&&qt!==Bt&&qt!==$t&&qt!==Ot&&qt!==Zt?_t(dt,q):(dt.state=null,qt===Ot?_t(dt,rt):W):q}function ue(dt,qt){var Gt,Dt,Ht,Wt,le,re,se,ce,xe=qt.length;if(!dt||!dt.state||(Wt=(Gt=dt.state).wrap)===2||Wt===1&&Gt.status!==Ft||Gt.lookahead)return q;for(Wt===1&&(dt.adler=F(dt.adler,qt,xe,0)),Gt.wrap=0,xe>=Gt.w_size&&(Wt===0&&(zt(Gt.head),Gt.strstart=0,Gt.block_start=0,Gt.insert=0),ce=new I.Buf8(Gt.w_size),I.arraySet(ce,qt,xe-Gt.w_size,Gt.w_size,0),qt=ce,xe=Gt.w_size),le=dt.avail_in,re=dt.next_in,se=dt.input,dt.avail_in=xe,dt.next_in=0,dt.input=qt,Kt(Gt);Gt.lookahead>=yt;){Dt=Gt.strstart,Ht=Gt.lookahead-(yt-1);do Gt.ins_h=(Gt.ins_h<<Gt.hash_shift^Gt.window[Dt+yt-1])&Gt.hash_mask,Gt.prev[Dt&Gt.w_mask]=Gt.head[Gt.ins_h],Gt.head[Gt.ins_h]=Dt,Dt++;while(--Ht);Gt.strstart=Dt,Gt.lookahead=yt-1,Kt(Gt)}return Gt.strstart+=Gt.lookahead,Gt.block_start=Gt.strstart,Gt.insert=Gt.lookahead,Gt.lookahead=0,Gt.match_length=Gt.prev_length=yt-1,Gt.match_available=0,dt.next_in=re,dt.input=se,dt.avail_in=le,Gt.wrap=Wt,W}w=[new ne(0,0,0,0,te),new ne(4,4,8,4,Vt),new ne(4,5,16,8,Vt),new ne(4,6,32,32,Vt),new ne(4,4,16,16,ee),new ne(8,16,32,32,ee),new ne(8,16,128,128,ee),new ne(8,32,128,256,ee),new ne(32,128,258,1024,ee),new ne(32,258,258,4096,ee)],g.deflateInit=Qt,g.deflateInit2=Ut,g.deflateReset=Nt,g.deflateResetKeep=ie,g.deflateSetHeader=Xt,g.deflate=St,g.deflateEnd=Yt,g.deflateSetDictionary=ue,g.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":52,"./adler32":53,"./crc32":55,"./messages":60,"./trees":61}],57:[function(d,m,g){var w=30,I=12;m.exports=function(P,F){var $,D,U,Z,j,G,H,W,Q,q,rt,it,X,J,tt,ot,nt,lt,at,ut,V,ht,vt,pt,st;$=P.state,D=P.next_in,pt=P.input,U=D+(P.avail_in-5),Z=P.next_out,st=P.output,j=Z-(F-P.avail_out),G=Z+(P.avail_out-257),H=$.dmax,W=$.wsize,Q=$.whave,q=$.wnext,rt=$.window,it=$.hold,X=$.bits,J=$.lencode,tt=$.distcode,ot=(1<<$.lenbits)-1,nt=(1<<$.distbits)-1;t:do{X<15&&(it+=pt[D++]<<X,X+=8,it+=pt[D++]<<X,X+=8),lt=J[it&ot];e:for(;;){if(it>>>=at=lt>>>24,X-=at,(at=lt>>>16&255)==0)st[Z++]=65535&lt;else{if(!(16&at)){if(64&at){if(32&at){$.mode=I;break t}P.msg="invalid literal/length code",$.mode=w;break t}lt=J[(65535&lt)+(it&(1<<at)-1)];continue e}for(ut=65535&lt,(at&=15)&&(X<at&&(it+=pt[D++]<<X,X+=8),ut+=it&(1<<at)-1,it>>>=at,X-=at),X<15&&(it+=pt[D++]<<X,X+=8,it+=pt[D++]<<X,X+=8),lt=tt[it&nt];;){if(it>>>=at=lt>>>24,X-=at,16&(at=lt>>>16&255)){if(V=65535&lt,X<(at&=15)&&(it+=pt[D++]<<X,(X+=8)<at&&(it+=pt[D++]<<X,X+=8)),(V+=it&(1<<at)-1)>H){P.msg="invalid distance too far back",$.mode=w;break t}if(it>>>=at,X-=at,V>(at=Z-j)){if((at=V-at)>Q&&$.sane){P.msg="invalid distance too far back",$.mode=w;break t}if(ht=0,vt=rt,q===0){if(ht+=W-at,at<ut){ut-=at;do st[Z++]=rt[ht++];while(--at);ht=Z-V,vt=st}}else if(q<at){if(ht+=W+q-at,(at-=q)<ut){ut-=at;do st[Z++]=rt[ht++];while(--at);if(ht=0,q<ut){ut-=at=q;do st[Z++]=rt[ht++];while(--at);ht=Z-V,vt=st}}}else if(ht+=q-at,at<ut){ut-=at;do st[Z++]=rt[ht++];while(--at);ht=Z-V,vt=st}for(;ut>2;)st[Z++]=vt[ht++],st[Z++]=vt[ht++],st[Z++]=vt[ht++],ut-=3;ut&&(st[Z++]=vt[ht++],ut>1&&(st[Z++]=vt[ht++]))}else{ht=Z-V;do st[Z++]=st[ht++],st[Z++]=st[ht++],st[Z++]=st[ht++],ut-=3;while(ut>2);ut&&(st[Z++]=st[ht++],ut>1&&(st[Z++]=st[ht++]))}break}if(64&at){P.msg="invalid distance code",$.mode=w;break t}lt=tt[(65535&lt)+(it&(1<<at)-1)]}}break}}while(D<U&&Z<G);D-=ut=X>>3,it&=(1<<(X-=ut<<3))-1,P.next_in=D,P.next_out=Z,P.avail_in=D<U?U-D+5:5-(D-U),P.avail_out=Z<G?G-Z+257:257-(Z-G),$.hold=it,$.bits=X}},{}],58:[function(d,m,g){var w=d("../utils/common"),I=d("./adler32"),P=d("./crc32"),F=d("./inffast"),$=d("./inftrees"),D=0,U=1,Z=2,j=4,G=5,H=6,W=0,Q=1,q=2,rt=-2,it=-3,X=-4,J=-5,tt=8,ot=1,nt=2,lt=3,at=4,ut=5,V=6,ht=7,vt=8,pt=9,st=10,ct=11,At=12,kt=13,yt=14,Ct=15,xt=16,Pt=17,Ft=18,Rt=19,Mt=20,Bt=21,$t=22,Ot=23,Zt=24,Tt=25,et=26,It=27,mt=28,gt=29,_t=30,Et=31,zt=852,K=592,ft=15;function bt(Ut){return(Ut>>>24&255)+(Ut>>>8&65280)+((65280&Ut)<<8)+((255&Ut)<<24)}function wt(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new w.Buf16(320),this.work=new w.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Lt(Ut){var Qt;return Ut&&Ut.state?(Qt=Ut.state,Ut.total_in=Ut.total_out=Qt.total=0,Ut.msg="",Qt.wrap&&(Ut.adler=1&Qt.wrap),Qt.mode=ot,Qt.last=0,Qt.havedict=0,Qt.dmax=32768,Qt.head=null,Qt.hold=0,Qt.bits=0,Qt.lencode=Qt.lendyn=new w.Buf32(zt),Qt.distcode=Qt.distdyn=new w.Buf32(K),Qt.sane=1,Qt.back=-1,W):rt}function jt(Ut){var Qt;return Ut&&Ut.state?((Qt=Ut.state).wsize=0,Qt.whave=0,Qt.wnext=0,Lt(Ut)):rt}function Kt(Ut,Qt){var St,Yt;return Ut&&Ut.state?(Yt=Ut.state,Qt<0?(St=0,Qt=-Qt):(St=1+(Qt>>4),Qt<48&&(Qt&=15)),Qt&&(Qt<8||Qt>15)?rt:(Yt.window!==null&&Yt.wbits!==Qt&&(Yt.window=null),Yt.wrap=St,Yt.wbits=Qt,jt(Ut))):rt}function te(Ut,Qt){var St,Yt;return Ut?(Yt=new wt,Ut.state=Yt,Yt.window=null,(St=Kt(Ut,Qt))!==W&&(Ut.state=null),St):rt}function Vt(Ut){return te(Ut,ft)}var ee,Jt,oe=!0;function ne(Ut){if(oe){var Qt;for(ee=new w.Buf32(512),Jt=new w.Buf32(32),Qt=0;Qt<144;)Ut.lens[Qt++]=8;for(;Qt<256;)Ut.lens[Qt++]=9;for(;Qt<280;)Ut.lens[Qt++]=7;for(;Qt<288;)Ut.lens[Qt++]=8;for($(U,Ut.lens,0,288,ee,0,Ut.work,{bits:9}),Qt=0;Qt<32;)Ut.lens[Qt++]=5;$(Z,Ut.lens,0,32,Jt,0,Ut.work,{bits:5}),oe=!1}Ut.lencode=ee,Ut.lenbits=9,Ut.distcode=Jt,Ut.distbits=5}function ae(Ut,Qt,St,Yt){var ue,dt=Ut.state;return dt.window===null&&(dt.wsize=1<<dt.wbits,dt.wnext=0,dt.whave=0,dt.window=new w.Buf8(dt.wsize)),Yt>=dt.wsize?(w.arraySet(dt.window,Qt,St-dt.wsize,dt.wsize,0),dt.wnext=0,dt.whave=dt.wsize):((ue=dt.wsize-dt.wnext)>Yt&&(ue=Yt),w.arraySet(dt.window,Qt,St-Yt,ue,dt.wnext),(Yt-=ue)?(w.arraySet(dt.window,Qt,St-Yt,Yt,0),dt.wnext=Yt,dt.whave=dt.wsize):(dt.wnext+=ue,dt.wnext===dt.wsize&&(dt.wnext=0),dt.whave<dt.wsize&&(dt.whave+=ue))),0}function fe(Ut,Qt){var St,Yt,ue,dt,qt,Gt,Dt,Ht,Wt,le,re,se,ce,xe,de,pe,ge,be,ke,Se,me,we,Ee,ve,ye=0,_e=new w.Buf8(4),Me=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Ut||!Ut.state||!Ut.output||!Ut.input&&Ut.avail_in!==0)return rt;(St=Ut.state).mode===At&&(St.mode=kt),qt=Ut.next_out,ue=Ut.output,Dt=Ut.avail_out,dt=Ut.next_in,Yt=Ut.input,Gt=Ut.avail_in,Ht=St.hold,Wt=St.bits,le=Gt,re=Dt,we=W;t:for(;;)switch(St.mode){case ot:if(St.wrap===0){St.mode=kt;break}for(;Wt<16;){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}if(2&St.wrap&&Ht===35615){St.check=0,_e[0]=255&Ht,_e[1]=Ht>>>8&255,St.check=P(St.check,_e,2,0),Ht=0,Wt=0,St.mode=nt;break}if(St.flags=0,St.head&&(St.head.done=!1),!(1&St.wrap)||(((255&Ht)<<8)+(Ht>>8))%31){Ut.msg="incorrect header check",St.mode=_t;break}if((15&Ht)!==tt){Ut.msg="unknown compression method",St.mode=_t;break}if(Wt-=4,me=8+(15&(Ht>>>=4)),St.wbits===0)St.wbits=me;else if(me>St.wbits){Ut.msg="invalid window size",St.mode=_t;break}St.dmax=1<<me,Ut.adler=St.check=1,St.mode=512&Ht?st:At,Ht=0,Wt=0;break;case nt:for(;Wt<16;){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}if(St.flags=Ht,(255&St.flags)!==tt){Ut.msg="unknown compression method",St.mode=_t;break}if(57344&St.flags){Ut.msg="unknown header flags set",St.mode=_t;break}St.head&&(St.head.text=Ht>>8&1),512&St.flags&&(_e[0]=255&Ht,_e[1]=Ht>>>8&255,St.check=P(St.check,_e,2,0)),Ht=0,Wt=0,St.mode=lt;case lt:for(;Wt<32;){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}St.head&&(St.head.time=Ht),512&St.flags&&(_e[0]=255&Ht,_e[1]=Ht>>>8&255,_e[2]=Ht>>>16&255,_e[3]=Ht>>>24&255,St.check=P(St.check,_e,4,0)),Ht=0,Wt=0,St.mode=at;case at:for(;Wt<16;){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}St.head&&(St.head.xflags=255&Ht,St.head.os=Ht>>8),512&St.flags&&(_e[0]=255&Ht,_e[1]=Ht>>>8&255,St.check=P(St.check,_e,2,0)),Ht=0,Wt=0,St.mode=ut;case ut:if(1024&St.flags){for(;Wt<16;){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}St.length=Ht,St.head&&(St.head.extra_len=Ht),512&St.flags&&(_e[0]=255&Ht,_e[1]=Ht>>>8&255,St.check=P(St.check,_e,2,0)),Ht=0,Wt=0}else St.head&&(St.head.extra=null);St.mode=V;case V:if(1024&St.flags&&((se=St.length)>Gt&&(se=Gt),se&&(St.head&&(me=St.head.extra_len-St.length,St.head.extra||(St.head.extra=new Array(St.head.extra_len)),w.arraySet(St.head.extra,Yt,dt,se,me)),512&St.flags&&(St.check=P(St.check,Yt,se,dt)),Gt-=se,dt+=se,St.length-=se),St.length))break t;St.length=0,St.mode=ht;case ht:if(2048&St.flags){if(Gt===0)break t;se=0;do me=Yt[dt+se++],St.head&&me&&St.length<65536&&(St.head.name+=String.fromCharCode(me));while(me&&se<Gt);if(512&St.flags&&(St.check=P(St.check,Yt,se,dt)),Gt-=se,dt+=se,me)break t}else St.head&&(St.head.name=null);St.length=0,St.mode=vt;case vt:if(4096&St.flags){if(Gt===0)break t;se=0;do me=Yt[dt+se++],St.head&&me&&St.length<65536&&(St.head.comment+=String.fromCharCode(me));while(me&&se<Gt);if(512&St.flags&&(St.check=P(St.check,Yt,se,dt)),Gt-=se,dt+=se,me)break t}else St.head&&(St.head.comment=null);St.mode=pt;case pt:if(512&St.flags){for(;Wt<16;){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}if(Ht!==(65535&St.check)){Ut.msg="header crc mismatch",St.mode=_t;break}Ht=0,Wt=0}St.head&&(St.head.hcrc=St.flags>>9&1,St.head.done=!0),Ut.adler=St.check=0,St.mode=At;break;case st:for(;Wt<32;){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}Ut.adler=St.check=bt(Ht),Ht=0,Wt=0,St.mode=ct;case ct:if(St.havedict===0)return Ut.next_out=qt,Ut.avail_out=Dt,Ut.next_in=dt,Ut.avail_in=Gt,St.hold=Ht,St.bits=Wt,q;Ut.adler=St.check=1,St.mode=At;case At:if(Qt===G||Qt===H)break t;case kt:if(St.last){Ht>>>=7&Wt,Wt-=7&Wt,St.mode=It;break}for(;Wt<3;){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}switch(St.last=1&Ht,Wt-=1,3&(Ht>>>=1)){case 0:St.mode=yt;break;case 1:if(ne(St),St.mode=Mt,Qt===H){Ht>>>=2,Wt-=2;break t}break;case 2:St.mode=Pt;break;case 3:Ut.msg="invalid block type",St.mode=_t}Ht>>>=2,Wt-=2;break;case yt:for(Ht>>>=7&Wt,Wt-=7&Wt;Wt<32;){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}if((65535&Ht)!=(Ht>>>16^65535)){Ut.msg="invalid stored block lengths",St.mode=_t;break}if(St.length=65535&Ht,Ht=0,Wt=0,St.mode=Ct,Qt===H)break t;case Ct:St.mode=xt;case xt:if(se=St.length){if(se>Gt&&(se=Gt),se>Dt&&(se=Dt),se===0)break t;w.arraySet(ue,Yt,dt,se,qt),Gt-=se,dt+=se,Dt-=se,qt+=se,St.length-=se;break}St.mode=At;break;case Pt:for(;Wt<14;){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}if(St.nlen=257+(31&Ht),Ht>>>=5,Wt-=5,St.ndist=1+(31&Ht),Ht>>>=5,Wt-=5,St.ncode=4+(15&Ht),Ht>>>=4,Wt-=4,St.nlen>286||St.ndist>30){Ut.msg="too many length or distance symbols",St.mode=_t;break}St.have=0,St.mode=Ft;case Ft:for(;St.have<St.ncode;){for(;Wt<3;){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}St.lens[Me[St.have++]]=7&Ht,Ht>>>=3,Wt-=3}for(;St.have<19;)St.lens[Me[St.have++]]=0;if(St.lencode=St.lendyn,St.lenbits=7,Ee={bits:St.lenbits},we=$(D,St.lens,0,19,St.lencode,0,St.work,Ee),St.lenbits=Ee.bits,we){Ut.msg="invalid code lengths set",St.mode=_t;break}St.have=0,St.mode=Rt;case Rt:for(;St.have<St.nlen+St.ndist;){for(;pe=(ye=St.lencode[Ht&(1<<St.lenbits)-1])>>>16&255,ge=65535&ye,!((de=ye>>>24)<=Wt);){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}if(ge<16)Ht>>>=de,Wt-=de,St.lens[St.have++]=ge;else{if(ge===16){for(ve=de+2;Wt<ve;){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}if(Ht>>>=de,Wt-=de,St.have===0){Ut.msg="invalid bit length repeat",St.mode=_t;break}me=St.lens[St.have-1],se=3+(3&Ht),Ht>>>=2,Wt-=2}else if(ge===17){for(ve=de+3;Wt<ve;){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}Wt-=de,me=0,se=3+(7&(Ht>>>=de)),Ht>>>=3,Wt-=3}else{for(ve=de+7;Wt<ve;){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}Wt-=de,me=0,se=11+(127&(Ht>>>=de)),Ht>>>=7,Wt-=7}if(St.have+se>St.nlen+St.ndist){Ut.msg="invalid bit length repeat",St.mode=_t;break}for(;se--;)St.lens[St.have++]=me}}if(St.mode===_t)break;if(St.lens[256]===0){Ut.msg="invalid code -- missing end-of-block",St.mode=_t;break}if(St.lenbits=9,Ee={bits:St.lenbits},we=$(U,St.lens,0,St.nlen,St.lencode,0,St.work,Ee),St.lenbits=Ee.bits,we){Ut.msg="invalid literal/lengths set",St.mode=_t;break}if(St.distbits=6,St.distcode=St.distdyn,Ee={bits:St.distbits},we=$(Z,St.lens,St.nlen,St.ndist,St.distcode,0,St.work,Ee),St.distbits=Ee.bits,we){Ut.msg="invalid distances set",St.mode=_t;break}if(St.mode=Mt,Qt===H)break t;case Mt:St.mode=Bt;case Bt:if(Gt>=6&&Dt>=258){Ut.next_out=qt,Ut.avail_out=Dt,Ut.next_in=dt,Ut.avail_in=Gt,St.hold=Ht,St.bits=Wt,F(Ut,re),qt=Ut.next_out,ue=Ut.output,Dt=Ut.avail_out,dt=Ut.next_in,Yt=Ut.input,Gt=Ut.avail_in,Ht=St.hold,Wt=St.bits,St.mode===At&&(St.back=-1);break}for(St.back=0;pe=(ye=St.lencode[Ht&(1<<St.lenbits)-1])>>>16&255,ge=65535&ye,!((de=ye>>>24)<=Wt);){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}if(pe&&!(240&pe)){for(be=de,ke=pe,Se=ge;pe=(ye=St.lencode[Se+((Ht&(1<<be+ke)-1)>>be)])>>>16&255,ge=65535&ye,!(be+(de=ye>>>24)<=Wt);){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}Ht>>>=be,Wt-=be,St.back+=be}if(Ht>>>=de,Wt-=de,St.back+=de,St.length=ge,pe===0){St.mode=et;break}if(32&pe){St.back=-1,St.mode=At;break}if(64&pe){Ut.msg="invalid literal/length code",St.mode=_t;break}St.extra=15&pe,St.mode=$t;case $t:if(St.extra){for(ve=St.extra;Wt<ve;){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}St.length+=Ht&(1<<St.extra)-1,Ht>>>=St.extra,Wt-=St.extra,St.back+=St.extra}St.was=St.length,St.mode=Ot;case Ot:for(;pe=(ye=St.distcode[Ht&(1<<St.distbits)-1])>>>16&255,ge=65535&ye,!((de=ye>>>24)<=Wt);){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}if(!(240&pe)){for(be=de,ke=pe,Se=ge;pe=(ye=St.distcode[Se+((Ht&(1<<be+ke)-1)>>be)])>>>16&255,ge=65535&ye,!(be+(de=ye>>>24)<=Wt);){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}Ht>>>=be,Wt-=be,St.back+=be}if(Ht>>>=de,Wt-=de,St.back+=de,64&pe){Ut.msg="invalid distance code",St.mode=_t;break}St.offset=ge,St.extra=15&pe,St.mode=Zt;case Zt:if(St.extra){for(ve=St.extra;Wt<ve;){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}St.offset+=Ht&(1<<St.extra)-1,Ht>>>=St.extra,Wt-=St.extra,St.back+=St.extra}if(St.offset>St.dmax){Ut.msg="invalid distance too far back",St.mode=_t;break}St.mode=Tt;case Tt:if(Dt===0)break t;if(se=re-Dt,St.offset>se){if((se=St.offset-se)>St.whave&&St.sane){Ut.msg="invalid distance too far back",St.mode=_t;break}se>St.wnext?(se-=St.wnext,ce=St.wsize-se):ce=St.wnext-se,se>St.length&&(se=St.length),xe=St.window}else xe=ue,ce=qt-St.offset,se=St.length;se>Dt&&(se=Dt),Dt-=se,St.length-=se;do ue[qt++]=xe[ce++];while(--se);St.length===0&&(St.mode=Bt);break;case et:if(Dt===0)break t;ue[qt++]=St.length,Dt--,St.mode=Bt;break;case It:if(St.wrap){for(;Wt<32;){if(Gt===0)break t;Gt--,Ht|=Yt[dt++]<<Wt,Wt+=8}if(re-=Dt,Ut.total_out+=re,St.total+=re,re&&(Ut.adler=St.check=St.flags?P(St.check,ue,re,qt-re):I(St.check,ue,re,qt-re)),re=Dt,(St.flags?Ht:bt(Ht))!==St.check){Ut.msg="incorrect data check",St.mode=_t;break}Ht=0,Wt=0}St.mode=mt;case mt:if(St.wrap&&St.flags){for(;Wt<32;){if(Gt===0)break t;Gt--,Ht+=Yt[dt++]<<Wt,Wt+=8}if(Ht!==(4294967295&St.total)){Ut.msg="incorrect length check",St.mode=_t;break}Ht=0,Wt=0}St.mode=gt;case gt:we=Q;break t;case _t:we=it;break t;case Et:return X;default:return rt}return Ut.next_out=qt,Ut.avail_out=Dt,Ut.next_in=dt,Ut.avail_in=Gt,St.hold=Ht,St.bits=Wt,(St.wsize||re!==Ut.avail_out&&St.mode<_t&&(St.mode<It||Qt!==j))&&ae(Ut,Ut.output,Ut.next_out,re-Ut.avail_out),le-=Ut.avail_in,re-=Ut.avail_out,Ut.total_in+=le,Ut.total_out+=re,St.total+=re,St.wrap&&re&&(Ut.adler=St.check=St.flags?P(St.check,ue,re,Ut.next_out-re):I(St.check,ue,re,Ut.next_out-re)),Ut.data_type=St.bits+(St.last?64:0)+(St.mode===At?128:0)+(St.mode===Mt||St.mode===Ct?256:0),(le===0&&re===0||Qt===j)&&we===W&&(we=J),we}function ie(Ut){if(!Ut||!Ut.state)return rt;var Qt=Ut.state;return Qt.window&&(Qt.window=null),Ut.state=null,W}function Nt(Ut,Qt){var St;return Ut&&Ut.state&&2&(St=Ut.state).wrap?(St.head=Qt,Qt.done=!1,W):rt}function Xt(Ut,Qt){var St,Yt=Qt.length;return Ut&&Ut.state?(St=Ut.state).wrap!==0&&St.mode!==ct?rt:St.mode===ct&&I(1,Qt,Yt,0)!==St.check?it:ae(Ut,Qt,Yt,Yt)?(St.mode=Et,X):(St.havedict=1,W):rt}g.inflateReset=jt,g.inflateReset2=Kt,g.inflateResetKeep=Lt,g.inflateInit=Vt,g.inflateInit2=te,g.inflate=fe,g.inflateEnd=ie,g.inflateGetHeader=Nt,g.inflateSetDictionary=Xt,g.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":52,"./adler32":53,"./crc32":55,"./inffast":57,"./inftrees":59}],59:[function(d,m,g){var w=d("../utils/common"),I=15,P=852,F=592,$=0,D=1,U=2,Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],j=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],G=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],H=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];m.exports=function(W,Q,q,rt,it,X,J,tt){var ot,nt,lt,at,ut,V,ht,vt,pt,st=tt.bits,ct=0,At=0,kt=0,yt=0,Ct=0,xt=0,Pt=0,Ft=0,Rt=0,Mt=0,Bt=null,$t=0,Ot=new w.Buf16(I+1),Zt=new w.Buf16(I+1),Tt=null,et=0;for(ct=0;ct<=I;ct++)Ot[ct]=0;for(At=0;At<rt;At++)Ot[Q[q+At]]++;for(Ct=st,yt=I;yt>=1&&Ot[yt]===0;yt--);if(Ct>yt&&(Ct=yt),yt===0)return it[X++]=20971520,it[X++]=20971520,tt.bits=1,0;for(kt=1;kt<yt&&Ot[kt]===0;kt++);for(Ct<kt&&(Ct=kt),Ft=1,ct=1;ct<=I;ct++)if(Ft<<=1,(Ft-=Ot[ct])<0)return-1;if(Ft>0&&(W===$||yt!==1))return-1;for(Zt[1]=0,ct=1;ct<I;ct++)Zt[ct+1]=Zt[ct]+Ot[ct];for(At=0;At<rt;At++)Q[q+At]!==0&&(J[Zt[Q[q+At]]++]=At);if(W===$?(Bt=Tt=J,V=19):W===D?(Bt=Z,$t-=257,Tt=j,et-=257,V=256):(Bt=G,Tt=H,V=-1),Mt=0,At=0,ct=kt,ut=X,xt=Ct,Pt=0,lt=-1,at=(Rt=1<<Ct)-1,W===D&&Rt>P||W===U&&Rt>F)return 1;for(;;){ht=ct-Pt,J[At]<V?(vt=0,pt=J[At]):J[At]>V?(vt=Tt[et+J[At]],pt=Bt[$t+J[At]]):(vt=96,pt=0),ot=1<<ct-Pt,kt=nt=1<<xt;do it[ut+(Mt>>Pt)+(nt-=ot)]=ht<<24|vt<<16|pt;while(nt!==0);for(ot=1<<ct-1;Mt&ot;)ot>>=1;if(ot!==0?(Mt&=ot-1,Mt+=ot):Mt=0,At++,--Ot[ct]==0){if(ct===yt)break;ct=Q[q+J[At]]}if(ct>Ct&&(Mt&at)!==lt){for(Pt===0&&(Pt=Ct),ut+=kt,Ft=1<<(xt=ct-Pt);xt+Pt<yt&&!((Ft-=Ot[xt+Pt])<=0);)xt++,Ft<<=1;if(Rt+=1<<xt,W===D&&Rt>P||W===U&&Rt>F)return 1;it[lt=Mt&at]=Ct<<24|xt<<16|ut-X}}return Mt!==0&&(it[ut+Mt]=ct-Pt<<24|64<<16),tt.bits=Ct,0}},{"../utils/common":52}],60:[function(d,m,g){m.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],61:[function(d,m,g){var w=d("../utils/common"),I=4,P=0,F=1,$=2;function D(Nt){for(var Xt=Nt.length;--Xt>=0;)Nt[Xt]=0}var U=0,Z=1,j=2,G=3,H=258,W=29,Q=256,q=Q+1+W,rt=30,it=19,X=2*q+1,J=15,tt=16,ot=7,nt=256,lt=16,at=17,ut=18,V=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ht=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],vt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],pt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],st=512,ct=new Array(2*(q+2));D(ct);var At=new Array(2*rt);D(At);var kt=new Array(st);D(kt);var yt=new Array(H-G+1);D(yt);var Ct=new Array(W);D(Ct);var xt,Pt,Ft,Rt=new Array(rt);function Mt(Nt,Xt,Ut,Qt,St){this.static_tree=Nt,this.extra_bits=Xt,this.extra_base=Ut,this.elems=Qt,this.max_length=St,this.has_stree=Nt&&Nt.length}function Bt(Nt,Xt){this.dyn_tree=Nt,this.max_code=0,this.stat_desc=Xt}function $t(Nt){return Nt<256?kt[Nt]:kt[256+(Nt>>>7)]}function Ot(Nt,Xt){Nt.pending_buf[Nt.pending++]=255&Xt,Nt.pending_buf[Nt.pending++]=Xt>>>8&255}function Zt(Nt,Xt,Ut){Nt.bi_valid>tt-Ut?(Nt.bi_buf|=Xt<<Nt.bi_valid&65535,Ot(Nt,Nt.bi_buf),Nt.bi_buf=Xt>>tt-Nt.bi_valid,Nt.bi_valid+=Ut-tt):(Nt.bi_buf|=Xt<<Nt.bi_valid&65535,Nt.bi_valid+=Ut)}function Tt(Nt,Xt,Ut){Zt(Nt,Ut[2*Xt],Ut[2*Xt+1])}function et(Nt,Xt){var Ut=0;do Ut|=1&Nt,Nt>>>=1,Ut<<=1;while(--Xt>0);return Ut>>>1}function It(Nt){Nt.bi_valid===16?(Ot(Nt,Nt.bi_buf),Nt.bi_buf=0,Nt.bi_valid=0):Nt.bi_valid>=8&&(Nt.pending_buf[Nt.pending++]=255&Nt.bi_buf,Nt.bi_buf>>=8,Nt.bi_valid-=8)}function mt(Nt,Xt){var Ut,Qt,St,Yt,ue,dt,qt=Xt.dyn_tree,Gt=Xt.max_code,Dt=Xt.stat_desc.static_tree,Ht=Xt.stat_desc.has_stree,Wt=Xt.stat_desc.extra_bits,le=Xt.stat_desc.extra_base,re=Xt.stat_desc.max_length,se=0;for(Yt=0;Yt<=J;Yt++)Nt.bl_count[Yt]=0;for(qt[2*Nt.heap[Nt.heap_max]+1]=0,Ut=Nt.heap_max+1;Ut<X;Ut++)(Yt=qt[2*qt[2*(Qt=Nt.heap[Ut])+1]+1]+1)>re&&(Yt=re,se++),qt[2*Qt+1]=Yt,Qt>Gt||(Nt.bl_count[Yt]++,ue=0,Qt>=le&&(ue=Wt[Qt-le]),dt=qt[2*Qt],Nt.opt_len+=dt*(Yt+ue),Ht&&(Nt.static_len+=dt*(Dt[2*Qt+1]+ue)));if(se!==0){do{for(Yt=re-1;Nt.bl_count[Yt]===0;)Yt--;Nt.bl_count[Yt]--,Nt.bl_count[Yt+1]+=2,Nt.bl_count[re]--,se-=2}while(se>0);for(Yt=re;Yt!==0;Yt--)for(Qt=Nt.bl_count[Yt];Qt!==0;)(St=Nt.heap[--Ut])>Gt||(qt[2*St+1]!==Yt&&(Nt.opt_len+=(Yt-qt[2*St+1])*qt[2*St],qt[2*St+1]=Yt),Qt--)}}function gt(Nt,Xt,Ut){var Qt,St,Yt=new Array(J+1),ue=0;for(Qt=1;Qt<=J;Qt++)Yt[Qt]=ue=ue+Ut[Qt-1]<<1;for(St=0;St<=Xt;St++){var dt=Nt[2*St+1];dt!==0&&(Nt[2*St]=et(Yt[dt]++,dt))}}function _t(){var Nt,Xt,Ut,Qt,St,Yt=new Array(J+1);for(Ut=0,Qt=0;Qt<W-1;Qt++)for(Ct[Qt]=Ut,Nt=0;Nt<1<<V[Qt];Nt++)yt[Ut++]=Qt;for(yt[Ut-1]=Qt,St=0,Qt=0;Qt<16;Qt++)for(Rt[Qt]=St,Nt=0;Nt<1<<ht[Qt];Nt++)kt[St++]=Qt;for(St>>=7;Qt<rt;Qt++)for(Rt[Qt]=St<<7,Nt=0;Nt<1<<ht[Qt]-7;Nt++)kt[256+St++]=Qt;for(Xt=0;Xt<=J;Xt++)Yt[Xt]=0;for(Nt=0;Nt<=143;)ct[2*Nt+1]=8,Nt++,Yt[8]++;for(;Nt<=255;)ct[2*Nt+1]=9,Nt++,Yt[9]++;for(;Nt<=279;)ct[2*Nt+1]=7,Nt++,Yt[7]++;for(;Nt<=287;)ct[2*Nt+1]=8,Nt++,Yt[8]++;for(gt(ct,q+1,Yt),Nt=0;Nt<rt;Nt++)At[2*Nt+1]=5,At[2*Nt]=et(Nt,5);xt=new Mt(ct,V,Q+1,q,J),Pt=new Mt(At,ht,0,rt,J),Ft=new Mt(new Array(0),vt,0,it,ot)}function Et(Nt){var Xt;for(Xt=0;Xt<q;Xt++)Nt.dyn_ltree[2*Xt]=0;for(Xt=0;Xt<rt;Xt++)Nt.dyn_dtree[2*Xt]=0;for(Xt=0;Xt<it;Xt++)Nt.bl_tree[2*Xt]=0;Nt.dyn_ltree[2*nt]=1,Nt.opt_len=Nt.static_len=0,Nt.last_lit=Nt.matches=0}function zt(Nt){Nt.bi_valid>8?Ot(Nt,Nt.bi_buf):Nt.bi_valid>0&&(Nt.pending_buf[Nt.pending++]=Nt.bi_buf),Nt.bi_buf=0,Nt.bi_valid=0}function K(Nt,Xt,Ut,Qt){zt(Nt),Ot(Nt,Ut),Ot(Nt,~Ut),w.arraySet(Nt.pending_buf,Nt.window,Xt,Ut,Nt.pending),Nt.pending+=Ut}function ft(Nt,Xt,Ut,Qt){var St=2*Xt,Yt=2*Ut;return Nt[St]<Nt[Yt]||Nt[St]===Nt[Yt]&&Qt[Xt]<=Qt[Ut]}function bt(Nt,Xt,Ut){for(var Qt=Nt.heap[Ut],St=Ut<<1;St<=Nt.heap_len&&(St<Nt.heap_len&&ft(Xt,Nt.heap[St+1],Nt.heap[St],Nt.depth)&&St++,!ft(Xt,Qt,Nt.heap[St],Nt.depth));)Nt.heap[Ut]=Nt.heap[St],Ut=St,St<<=1;Nt.heap[Ut]=Qt}function wt(Nt,Xt,Ut){var Qt,St,Yt,ue,dt=0;if(Nt.last_lit!==0)do Qt=Nt.pending_buf[Nt.d_buf+2*dt]<<8|Nt.pending_buf[Nt.d_buf+2*dt+1],St=Nt.pending_buf[Nt.l_buf+dt],dt++,Qt===0?Tt(Nt,St,Xt):(Tt(Nt,(Yt=yt[St])+Q+1,Xt),(ue=V[Yt])!==0&&Zt(Nt,St-=Ct[Yt],ue),Tt(Nt,Yt=$t(--Qt),Ut),(ue=ht[Yt])!==0&&Zt(Nt,Qt-=Rt[Yt],ue));while(dt<Nt.last_lit);Tt(Nt,nt,Xt)}function Lt(Nt,Xt){var Ut,Qt,St,Yt=Xt.dyn_tree,ue=Xt.stat_desc.static_tree,dt=Xt.stat_desc.has_stree,qt=Xt.stat_desc.elems,Gt=-1;for(Nt.heap_len=0,Nt.heap_max=X,Ut=0;Ut<qt;Ut++)Yt[2*Ut]!==0?(Nt.heap[++Nt.heap_len]=Gt=Ut,Nt.depth[Ut]=0):Yt[2*Ut+1]=0;for(;Nt.heap_len<2;)Yt[2*(St=Nt.heap[++Nt.heap_len]=Gt<2?++Gt:0)]=1,Nt.depth[St]=0,Nt.opt_len--,dt&&(Nt.static_len-=ue[2*St+1]);for(Xt.max_code=Gt,Ut=Nt.heap_len>>1;Ut>=1;Ut--)bt(Nt,Yt,Ut);St=qt;do Ut=Nt.heap[1],Nt.heap[1]=Nt.heap[Nt.heap_len--],bt(Nt,Yt,1),Qt=Nt.heap[1],Nt.heap[--Nt.heap_max]=Ut,Nt.heap[--Nt.heap_max]=Qt,Yt[2*St]=Yt[2*Ut]+Yt[2*Qt],Nt.depth[St]=(Nt.depth[Ut]>=Nt.depth[Qt]?Nt.depth[Ut]:Nt.depth[Qt])+1,Yt[2*Ut+1]=Yt[2*Qt+1]=St,Nt.heap[1]=St++,bt(Nt,Yt,1);while(Nt.heap_len>=2);Nt.heap[--Nt.heap_max]=Nt.heap[1],mt(Nt,Xt),gt(Yt,Gt,Nt.bl_count)}function jt(Nt,Xt,Ut){var Qt,St,Yt=-1,ue=Xt[1],dt=0,qt=7,Gt=4;for(ue===0&&(qt=138,Gt=3),Xt[2*(Ut+1)+1]=65535,Qt=0;Qt<=Ut;Qt++)St=ue,ue=Xt[2*(Qt+1)+1],++dt<qt&&St===ue||(dt<Gt?Nt.bl_tree[2*St]+=dt:St!==0?(St!==Yt&&Nt.bl_tree[2*St]++,Nt.bl_tree[2*lt]++):dt<=10?Nt.bl_tree[2*at]++:Nt.bl_tree[2*ut]++,dt=0,Yt=St,ue===0?(qt=138,Gt=3):St===ue?(qt=6,Gt=3):(qt=7,Gt=4))}function Kt(Nt,Xt,Ut){var Qt,St,Yt=-1,ue=Xt[1],dt=0,qt=7,Gt=4;for(ue===0&&(qt=138,Gt=3),Qt=0;Qt<=Ut;Qt++)if(St=ue,ue=Xt[2*(Qt+1)+1],!(++dt<qt&&St===ue)){if(dt<Gt)do Tt(Nt,St,Nt.bl_tree);while(--dt!=0);else St!==0?(St!==Yt&&(Tt(Nt,St,Nt.bl_tree),dt--),Tt(Nt,lt,Nt.bl_tree),Zt(Nt,dt-3,2)):dt<=10?(Tt(Nt,at,Nt.bl_tree),Zt(Nt,dt-3,3)):(Tt(Nt,ut,Nt.bl_tree),Zt(Nt,dt-11,7));dt=0,Yt=St,ue===0?(qt=138,Gt=3):St===ue?(qt=6,Gt=3):(qt=7,Gt=4)}}function te(Nt){var Xt;for(jt(Nt,Nt.dyn_ltree,Nt.l_desc.max_code),jt(Nt,Nt.dyn_dtree,Nt.d_desc.max_code),Lt(Nt,Nt.bl_desc),Xt=it-1;Xt>=3&&Nt.bl_tree[2*pt[Xt]+1]===0;Xt--);return Nt.opt_len+=3*(Xt+1)+5+5+4,Xt}function Vt(Nt,Xt,Ut,Qt){var St;for(Zt(Nt,Xt-257,5),Zt(Nt,Ut-1,5),Zt(Nt,Qt-4,4),St=0;St<Qt;St++)Zt(Nt,Nt.bl_tree[2*pt[St]+1],3);Kt(Nt,Nt.dyn_ltree,Xt-1),Kt(Nt,Nt.dyn_dtree,Ut-1)}function ee(Nt){var Xt,Ut=4093624447;for(Xt=0;Xt<=31;Xt++,Ut>>>=1)if(1&Ut&&Nt.dyn_ltree[2*Xt]!==0)return P;if(Nt.dyn_ltree[18]!==0||Nt.dyn_ltree[20]!==0||Nt.dyn_ltree[26]!==0)return F;for(Xt=32;Xt<Q;Xt++)if(Nt.dyn_ltree[2*Xt]!==0)return F;return P}D(Rt);var Jt=!1;function oe(Nt){Jt||(_t(),Jt=!0),Nt.l_desc=new Bt(Nt.dyn_ltree,xt),Nt.d_desc=new Bt(Nt.dyn_dtree,Pt),Nt.bl_desc=new Bt(Nt.bl_tree,Ft),Nt.bi_buf=0,Nt.bi_valid=0,Et(Nt)}function ne(Nt,Xt,Ut,Qt){Zt(Nt,(U<<1)+(Qt?1:0),3),K(Nt,Xt,Ut)}function ae(Nt){Zt(Nt,Z<<1,3),Tt(Nt,nt,ct),It(Nt)}function fe(Nt,Xt,Ut,Qt){var St,Yt,ue=0;Nt.level>0?(Nt.strm.data_type===$&&(Nt.strm.data_type=ee(Nt)),Lt(Nt,Nt.l_desc),Lt(Nt,Nt.d_desc),ue=te(Nt),St=Nt.opt_len+3+7>>>3,(Yt=Nt.static_len+3+7>>>3)<=St&&(St=Yt)):St=Yt=Ut+5,Ut+4<=St&&Xt!==-1?ne(Nt,Xt,Ut,Qt):Nt.strategy===I||Yt===St?(Zt(Nt,(Z<<1)+(Qt?1:0),3),wt(Nt,ct,At)):(Zt(Nt,(j<<1)+(Qt?1:0),3),Vt(Nt,Nt.l_desc.max_code+1,Nt.d_desc.max_code+1,ue+1),wt(Nt,Nt.dyn_ltree,Nt.dyn_dtree)),Et(Nt),Qt&&zt(Nt)}function ie(Nt,Xt,Ut){return Nt.pending_buf[Nt.d_buf+2*Nt.last_lit]=Xt>>>8&255,Nt.pending_buf[Nt.d_buf+2*Nt.last_lit+1]=255&Xt,Nt.pending_buf[Nt.l_buf+Nt.last_lit]=255&Ut,Nt.last_lit++,Xt===0?Nt.dyn_ltree[2*Ut]++:(Nt.matches++,Xt--,Nt.dyn_ltree[2*(yt[Ut]+Q+1)]++,Nt.dyn_dtree[2*$t(Xt)]++),Nt.last_lit===Nt.lit_bufsize-1}g._tr_init=oe,g._tr_stored_block=ne,g._tr_flush_block=fe,g._tr_tally=ie,g._tr_align=ae},{"../utils/common":52}],62:[function(d,m,g){function w(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}m.exports=w},{}],63:[function(d,m,g){var w,I,P=m.exports={};function F(){throw new Error("setTimeout has not been defined")}function $(){throw new Error("clearTimeout has not been defined")}function D(it){if(w===setTimeout)return setTimeout(it,0);if((w===F||!w)&&setTimeout)return w=setTimeout,setTimeout(it,0);try{return w(it,0)}catch{try{return w.call(null,it,0)}catch{return w.call(this,it,0)}}}function U(it){if(I===clearTimeout)return clearTimeout(it);if((I===$||!I)&&clearTimeout)return I=clearTimeout,clearTimeout(it);try{return I(it)}catch{try{return I.call(null,it)}catch{return I.call(this,it)}}}(function(){try{w=typeof setTimeout=="function"?setTimeout:F}catch{w=F}try{I=typeof clearTimeout=="function"?clearTimeout:$}catch{I=$}})();var Z,j=[],G=!1,H=-1;function W(){G&&Z&&(G=!1,Z.length?j=Z.concat(j):H=-1,j.length&&Q())}function Q(){if(!G){var it=D(W);G=!0;for(var X=j.length;X;){for(Z=j,j=[];++H<X;)Z&&Z[H].run();H=-1,X=j.length}Z=null,G=!1,U(it)}}function q(it,X){this.fun=it,this.array=X}function rt(){}P.nextTick=function(it){var X=new Array(arguments.length-1);if(arguments.length>1)for(var J=1;J<arguments.length;J++)X[J-1]=arguments[J];j.push(new q(it,X)),j.length!==1||G||D(Q)},q.prototype.run=function(){this.fun.apply(null,this.array)},P.title="browser",P.browser=!0,P.env={},P.argv=[],P.version="",P.versions={},P.on=rt,P.addListener=rt,P.once=rt,P.off=rt,P.removeListener=rt,P.removeAllListeners=rt,P.emit=rt,P.prependListener=rt,P.prependOnceListener=rt,P.listeners=function(it){return[]},P.binding=function(it){throw new Error("process.binding is not supported")},P.cwd=function(){return"/"},P.chdir=function(it){throw new Error("process.chdir is not supported")},P.umask=function(){return 0}},{}],64:[function(d,m,g){/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var w=d("buffer"),I=w.Buffer;function P($,D){for(var U in $)D[U]=$[U]}function F($,D,U){return I($,D,U)}I.from&&I.alloc&&I.allocUnsafe&&I.allocUnsafeSlow?m.exports=w:(P(w,g),g.Buffer=F),F.prototype=Object.create(I.prototype),P(I,F),F.from=function($,D,U){if(typeof $=="number")throw new TypeError("Argument must not be a number");return I($,D,U)},F.alloc=function($,D,U){if(typeof $!="number")throw new TypeError("Argument must be a number");var Z=I($);return D!==void 0?typeof U=="string"?Z.fill(D,U):Z.fill(D):Z.fill(0),Z},F.allocUnsafe=function($){if(typeof $!="number")throw new TypeError("Argument must be a number");return I($)},F.allocUnsafeSlow=function($){if(typeof $!="number")throw new TypeError("Argument must be a number");return w.SlowBuffer($)}},{buffer:32}],65:[function(d,m,g){m.exports=I;var w=d("events").EventEmitter;function I(){w.call(this)}d("inherits")(I,w),I.Readable=d("readable-stream/lib/_stream_readable.js"),I.Writable=d("readable-stream/lib/_stream_writable.js"),I.Duplex=d("readable-stream/lib/_stream_duplex.js"),I.Transform=d("readable-stream/lib/_stream_transform.js"),I.PassThrough=d("readable-stream/lib/_stream_passthrough.js"),I.finished=d("readable-stream/lib/internal/streams/end-of-stream.js"),I.pipeline=d("readable-stream/lib/internal/streams/pipeline.js"),I.Stream=I,I.prototype.pipe=function(P,F){var $=this;function D(Q){P.writable&&P.write(Q)===!1&&$.pause&&$.pause()}function U(){$.readable&&$.resume&&$.resume()}$.on("data",D),P.on("drain",U),P._isStdio||F&&F.end===!1||($.on("end",j),$.on("close",G));var Z=!1;function j(){Z||(Z=!0,P.end())}function G(){Z||(Z=!0,typeof P.destroy=="function"&&P.destroy())}function H(Q){if(W(),w.listenerCount(this,"error")===0)throw Q}function W(){$.removeListener("data",D),P.removeListener("drain",U),$.removeListener("end",j),$.removeListener("close",G),$.removeListener("error",H),P.removeListener("error",H),$.removeListener("end",W),$.removeListener("close",W),P.removeListener("close",W)}return $.on("error",H),P.on("error",H),$.on("end",W),$.on("close",W),P.on("close",W),P.emit("pipe",$),P}},{events:35,inherits:46,"readable-stream/lib/_stream_duplex.js":67,"readable-stream/lib/_stream_passthrough.js":68,"readable-stream/lib/_stream_readable.js":69,"readable-stream/lib/_stream_transform.js":70,"readable-stream/lib/_stream_writable.js":71,"readable-stream/lib/internal/streams/end-of-stream.js":75,"readable-stream/lib/internal/streams/pipeline.js":77}],66:[function(d,m,g){function w(Z,j){Z.prototype=Object.create(j.prototype),Z.prototype.constructor=Z,Z.__proto__=j}var I={};function P(Z,j,G){function H(Q,q,rt){return typeof j=="string"?j:j(Q,q,rt)}G||(G=Error);var W=function(Q){function q(rt,it,X){return Q.call(this,H(rt,it,X))||this}return w(q,Q),q}(G);W.prototype.name=G.name,W.prototype.code=Z,I[Z]=W}function F(Z,j){if(Array.isArray(Z)){var G=Z.length;return Z=Z.map(function(H){return String(H)}),G>2?"one of ".concat(j," ").concat(Z.slice(0,G-1).join(", "),", or ")+Z[G-1]:G===2?"one of ".concat(j," ").concat(Z[0]," or ").concat(Z[1]):"of ".concat(j," ").concat(Z[0])}return"of ".concat(j," ").concat(String(Z))}function $(Z,j,G){return Z.substr(0,j.length)===j}function D(Z,j,G){return(G===void 0||G>Z.length)&&(G=Z.length),Z.substring(G-j.length,G)===j}function U(Z,j,G){return typeof G!="number"&&(G=0),!(G+j.length>Z.length)&&Z.indexOf(j,G)!==-1}P("ERR_INVALID_OPT_VALUE",function(Z,j){return'The value "'+j+'" is invalid for option "'+Z+'"'},TypeError),P("ERR_INVALID_ARG_TYPE",function(Z,j,G){var H,W;if(typeof j=="string"&&$(j,"not ")?(H="must not be",j=j.replace(/^not /,"")):H="must be",D(Z," argument"))W="The ".concat(Z," ").concat(H," ").concat(F(j,"type"));else{var Q=U(Z,".")?"property":"argument";W='The "'.concat(Z,'" ').concat(Q," ").concat(H," ").concat(F(j,"type"))}return W+=". Received type ".concat(typeof G)},TypeError),P("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),P("ERR_METHOD_NOT_IMPLEMENTED",function(Z){return"The "+Z+" method is not implemented"}),P("ERR_STREAM_PREMATURE_CLOSE","Premature close"),P("ERR_STREAM_DESTROYED",function(Z){return"Cannot call "+Z+" after a stream was destroyed"}),P("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),P("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),P("ERR_STREAM_WRITE_AFTER_END","write after end"),P("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),P("ERR_UNKNOWN_ENCODING",function(Z){return"Unknown encoding: "+Z},TypeError),P("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),m.exports.codes=I},{}],67:[function(d,m,g){(function(w){(function(){var I=Object.keys||function(H){var W=[];for(var Q in H)W.push(Q);return W};m.exports=Z;var P=d("./_stream_readable"),F=d("./_stream_writable");d("inherits")(Z,P);for(var $=I(F.prototype),D=0;D<$.length;D++){var U=$[D];Z.prototype[U]||(Z.prototype[U]=F.prototype[U])}function Z(H){if(!(this instanceof Z))return new Z(H);P.call(this,H),F.call(this,H),this.allowHalfOpen=!0,H&&(H.readable===!1&&(this.readable=!1),H.writable===!1&&(this.writable=!1),H.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",j)))}function j(){this._writableState.ended||w.nextTick(G,this)}function G(H){H.end()}Object.defineProperty(Z.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(Z.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Z.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(Z.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(H){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=H,this._writableState.destroyed=H)}})}).call(this)}).call(this,d("_process"))},{"./_stream_readable":69,"./_stream_writable":71,_process:63,inherits:46}],68:[function(d,m,g){m.exports=I;var w=d("./_stream_transform");function I(P){if(!(this instanceof I))return new I(P);w.call(this,P)}d("inherits")(I,w),I.prototype._transform=function(P,F,$){$(null,P)}},{"./_stream_transform":70,inherits:46}],69:[function(d,m,g){(function(w,I){(function(){var P;m.exports=vt,vt.ReadableState=ht,d("events").EventEmitter;var F=function(_t,Et){return _t.listeners(Et).length},$=d("./internal/streams/stream"),D=d("buffer").Buffer,U=I.Uint8Array||function(){};function Z(_t){return D.from(_t)}function j(_t){return D.isBuffer(_t)||_t instanceof U}var G,H=d("util");G=H&&H.debuglog?H.debuglog("stream"):function(){};var W,Q,q,rt=d("./internal/streams/buffer_list"),it=d("./internal/streams/destroy"),X=d("./internal/streams/state").getHighWaterMark,J=d("../errors").codes,tt=J.ERR_INVALID_ARG_TYPE,ot=J.ERR_STREAM_PUSH_AFTER_EOF,nt=J.ERR_METHOD_NOT_IMPLEMENTED,lt=J.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;d("inherits")(vt,$);var at=it.errorOrDestroy,ut=["error","close","destroy","pause","resume"];function V(_t,Et,zt){if(typeof _t.prependListener=="function")return _t.prependListener(Et,zt);_t._events&&_t._events[Et]?Array.isArray(_t._events[Et])?_t._events[Et].unshift(zt):_t._events[Et]=[zt,_t._events[Et]]:_t.on(Et,zt)}function ht(_t,Et,zt){P=P||d("./_stream_duplex"),_t=_t||{},typeof zt!="boolean"&&(zt=Et instanceof P),this.objectMode=!!_t.objectMode,zt&&(this.objectMode=this.objectMode||!!_t.readableObjectMode),this.highWaterMark=X(this,_t,"readableHighWaterMark",zt),this.buffer=new rt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=_t.emitClose!==!1,this.autoDestroy=!!_t.autoDestroy,this.destroyed=!1,this.defaultEncoding=_t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,_t.encoding&&(W||(W=d("string_decoder/").StringDecoder),this.decoder=new W(_t.encoding),this.encoding=_t.encoding)}function vt(_t){if(P=P||d("./_stream_duplex"),!(this instanceof vt))return new vt(_t);var Et=this instanceof P;this._readableState=new ht(_t,this,Et),this.readable=!0,_t&&(typeof _t.read=="function"&&(this._read=_t.read),typeof _t.destroy=="function"&&(this._destroy=_t.destroy)),$.call(this)}function pt(_t,Et,zt,K,ft){G("readableAddChunk",Et);var bt,wt=_t._readableState;if(Et===null)wt.reading=!1,Ct(_t,wt);else if(ft||(bt=ct(wt,Et)),bt)at(_t,bt);else if(wt.objectMode||Et&&Et.length>0)if(typeof Et=="string"||wt.objectMode||Object.getPrototypeOf(Et)===D.prototype||(Et=Z(Et)),K)wt.endEmitted?at(_t,new lt):st(_t,wt,Et,!0);else if(wt.ended)at(_t,new ot);else{if(wt.destroyed)return!1;wt.reading=!1,wt.decoder&&!zt?(Et=wt.decoder.write(Et),wt.objectMode||Et.length!==0?st(_t,wt,Et,!1):Ft(_t,wt)):st(_t,wt,Et,!1)}else K||(wt.reading=!1,Ft(_t,wt));return!wt.ended&&(wt.length<wt.highWaterMark||wt.length===0)}function st(_t,Et,zt,K){Et.flowing&&Et.length===0&&!Et.sync?(Et.awaitDrain=0,_t.emit("data",zt)):(Et.length+=Et.objectMode?1:zt.length,K?Et.buffer.unshift(zt):Et.buffer.push(zt),Et.needReadable&&xt(_t)),Ft(_t,Et)}function ct(_t,Et){var zt;return j(Et)||typeof Et=="string"||Et===void 0||_t.objectMode||(zt=new tt("chunk",["string","Buffer","Uint8Array"],Et)),zt}Object.defineProperty(vt.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(_t){this._readableState&&(this._readableState.destroyed=_t)}}),vt.prototype.destroy=it.destroy,vt.prototype._undestroy=it.undestroy,vt.prototype._destroy=function(_t,Et){Et(_t)},vt.prototype.push=function(_t,Et){var zt,K=this._readableState;return K.objectMode?zt=!0:typeof _t=="string"&&((Et=Et||K.defaultEncoding)!==K.encoding&&(_t=D.from(_t,Et),Et=""),zt=!0),pt(this,_t,Et,!1,zt)},vt.prototype.unshift=function(_t){return pt(this,_t,null,!0,!1)},vt.prototype.isPaused=function(){return this._readableState.flowing===!1},vt.prototype.setEncoding=function(_t){W||(W=d("string_decoder/").StringDecoder);var Et=new W(_t);this._readableState.decoder=Et,this._readableState.encoding=this._readableState.decoder.encoding;for(var zt=this._readableState.buffer.head,K="";zt!==null;)K+=Et.write(zt.data),zt=zt.next;return this._readableState.buffer.clear(),K!==""&&this._readableState.buffer.push(K),this._readableState.length=K.length,this};var At=1073741824;function kt(_t){return _t>=At?_t=At:(_t--,_t|=_t>>>1,_t|=_t>>>2,_t|=_t>>>4,_t|=_t>>>8,_t|=_t>>>16,_t++),_t}function yt(_t,Et){return _t<=0||Et.length===0&&Et.ended?0:Et.objectMode?1:_t!=_t?Et.flowing&&Et.length?Et.buffer.head.data.length:Et.length:(_t>Et.highWaterMark&&(Et.highWaterMark=kt(_t)),_t<=Et.length?_t:Et.ended?Et.length:(Et.needReadable=!0,0))}function Ct(_t,Et){if(G("onEofChunk"),!Et.ended){if(Et.decoder){var zt=Et.decoder.end();zt&&zt.length&&(Et.buffer.push(zt),Et.length+=Et.objectMode?1:zt.length)}Et.ended=!0,Et.sync?xt(_t):(Et.needReadable=!1,Et.emittedReadable||(Et.emittedReadable=!0,Pt(_t)))}}function xt(_t){var Et=_t._readableState;G("emitReadable",Et.needReadable,Et.emittedReadable),Et.needReadable=!1,Et.emittedReadable||(G("emitReadable",Et.flowing),Et.emittedReadable=!0,w.nextTick(Pt,_t))}function Pt(_t){var Et=_t._readableState;G("emitReadable_",Et.destroyed,Et.length,Et.ended),Et.destroyed||!Et.length&&!Et.ended||(_t.emit("readable"),Et.emittedReadable=!1),Et.needReadable=!Et.flowing&&!Et.ended&&Et.length<=Et.highWaterMark,Tt(_t)}function Ft(_t,Et){Et.readingMore||(Et.readingMore=!0,w.nextTick(Rt,_t,Et))}function Rt(_t,Et){for(;!Et.reading&&!Et.ended&&(Et.length<Et.highWaterMark||Et.flowing&&Et.length===0);){var zt=Et.length;if(G("maybeReadMore read 0"),_t.read(0),zt===Et.length)break}Et.readingMore=!1}function Mt(_t){return function(){var Et=_t._readableState;G("pipeOnDrain",Et.awaitDrain),Et.awaitDrain&&Et.awaitDrain--,Et.awaitDrain===0&&F(_t,"data")&&(Et.flowing=!0,Tt(_t))}}function Bt(_t){var Et=_t._readableState;Et.readableListening=_t.listenerCount("readable")>0,Et.resumeScheduled&&!Et.paused?Et.flowing=!0:_t.listenerCount("data")>0&&_t.resume()}function $t(_t){G("readable nexttick read 0"),_t.read(0)}function Ot(_t,Et){Et.resumeScheduled||(Et.resumeScheduled=!0,w.nextTick(Zt,_t,Et))}function Zt(_t,Et){G("resume",Et.reading),Et.reading||_t.read(0),Et.resumeScheduled=!1,_t.emit("resume"),Tt(_t),Et.flowing&&!Et.reading&&_t.read(0)}function Tt(_t){var Et=_t._readableState;for(G("flow",Et.flowing);Et.flowing&&_t.read()!==null;);}function et(_t,Et){return Et.length===0?null:(Et.objectMode?zt=Et.buffer.shift():!_t||_t>=Et.length?(zt=Et.decoder?Et.buffer.join(""):Et.buffer.length===1?Et.buffer.first():Et.buffer.concat(Et.length),Et.buffer.clear()):zt=Et.buffer.consume(_t,Et.decoder),zt);var zt}function It(_t){var Et=_t._readableState;G("endReadable",Et.endEmitted),Et.endEmitted||(Et.ended=!0,w.nextTick(mt,Et,_t))}function mt(_t,Et){if(G("endReadableNT",_t.endEmitted,_t.length),!_t.endEmitted&&_t.length===0&&(_t.endEmitted=!0,Et.readable=!1,Et.emit("end"),_t.autoDestroy)){var zt=Et._writableState;(!zt||zt.autoDestroy&&zt.finished)&&Et.destroy()}}function gt(_t,Et){for(var zt=0,K=_t.length;zt<K;zt++)if(_t[zt]===Et)return zt;return-1}vt.prototype.read=function(_t){G("read",_t),_t=parseInt(_t,10);var Et=this._readableState,zt=_t;if(_t!==0&&(Et.emittedReadable=!1),_t===0&&Et.needReadable&&((Et.highWaterMark!==0?Et.length>=Et.highWaterMark:Et.length>0)||Et.ended))return G("read: emitReadable",Et.length,Et.ended),Et.length===0&&Et.ended?It(this):xt(this),null;if((_t=yt(_t,Et))===0&&Et.ended)return Et.length===0&&It(this),null;var K,ft=Et.needReadable;return G("need readable",ft),(Et.length===0||Et.length-_t<Et.highWaterMark)&&G("length less than watermark",ft=!0),Et.ended||Et.reading?G("reading or ended",ft=!1):ft&&(G("do read"),Et.reading=!0,Et.sync=!0,Et.length===0&&(Et.needReadable=!0),this._read(Et.highWaterMark),Et.sync=!1,Et.reading||(_t=yt(zt,Et))),(K=_t>0?et(_t,Et):null)===null?(Et.needReadable=Et.length<=Et.highWaterMark,_t=0):(Et.length-=_t,Et.awaitDrain=0),Et.length===0&&(Et.ended||(Et.needReadable=!0),zt!==_t&&Et.ended&&It(this)),K!==null&&this.emit("data",K),K},vt.prototype._read=function(_t){at(this,new nt("_read()"))},vt.prototype.pipe=function(_t,Et){var zt=this,K=this._readableState;switch(K.pipesCount){case 0:K.pipes=_t;break;case 1:K.pipes=[K.pipes,_t];break;default:K.pipes.push(_t)}K.pipesCount+=1,G("pipe count=%d opts=%j",K.pipesCount,Et);var ft=Et&&Et.end===!1||_t===w.stdout||_t===w.stderr?oe:wt;function bt(ne,ae){G("onunpipe"),ne===zt&&ae&&ae.hasUnpiped===!1&&(ae.hasUnpiped=!0,Kt())}function wt(){G("onend"),_t.end()}K.endEmitted?w.nextTick(ft):zt.once("end",ft),_t.on("unpipe",bt);var Lt=Mt(zt);_t.on("drain",Lt);var jt=!1;function Kt(){G("cleanup"),_t.removeListener("close",ee),_t.removeListener("finish",Jt),_t.removeListener("drain",Lt),_t.removeListener("error",Vt),_t.removeListener("unpipe",bt),zt.removeListener("end",wt),zt.removeListener("end",oe),zt.removeListener("data",te),jt=!0,!K.awaitDrain||_t._writableState&&!_t._writableState.needDrain||Lt()}function te(ne){G("ondata");var ae=_t.write(ne);G("dest.write",ae),ae===!1&&((K.pipesCount===1&&K.pipes===_t||K.pipesCount>1&&gt(K.pipes,_t)!==-1)&&!jt&&(G("false write response, pause",K.awaitDrain),K.awaitDrain++),zt.pause())}function Vt(ne){G("onerror",ne),oe(),_t.removeListener("error",Vt),F(_t,"error")===0&&at(_t,ne)}function ee(){_t.removeListener("finish",Jt),oe()}function Jt(){G("onfinish"),_t.removeListener("close",ee),oe()}function oe(){G("unpipe"),zt.unpipe(_t)}return zt.on("data",te),V(_t,"error",Vt),_t.once("close",ee),_t.once("finish",Jt),_t.emit("pipe",zt),K.flowing||(G("pipe resume"),zt.resume()),_t},vt.prototype.unpipe=function(_t){var Et=this._readableState,zt={hasUnpiped:!1};if(Et.pipesCount===0)return this;if(Et.pipesCount===1)return _t&&_t!==Et.pipes||(_t||(_t=Et.pipes),Et.pipes=null,Et.pipesCount=0,Et.flowing=!1,_t&&_t.emit("unpipe",this,zt)),this;if(!_t){var K=Et.pipes,ft=Et.pipesCount;Et.pipes=null,Et.pipesCount=0,Et.flowing=!1;for(var bt=0;bt<ft;bt++)K[bt].emit("unpipe",this,{hasUnpiped:!1});return this}var wt=gt(Et.pipes,_t);return wt===-1||(Et.pipes.splice(wt,1),Et.pipesCount-=1,Et.pipesCount===1&&(Et.pipes=Et.pipes[0]),_t.emit("unpipe",this,zt)),this},vt.prototype.on=function(_t,Et){var zt=$.prototype.on.call(this,_t,Et),K=this._readableState;return _t==="data"?(K.readableListening=this.listenerCount("readable")>0,K.flowing!==!1&&this.resume()):_t==="readable"&&(K.endEmitted||K.readableListening||(K.readableListening=K.needReadable=!0,K.flowing=!1,K.emittedReadable=!1,G("on readable",K.length,K.reading),K.length?xt(this):K.reading||w.nextTick($t,this))),zt},vt.prototype.addListener=vt.prototype.on,vt.prototype.removeListener=function(_t,Et){var zt=$.prototype.removeListener.call(this,_t,Et);return _t==="readable"&&w.nextTick(Bt,this),zt},vt.prototype.removeAllListeners=function(_t){var Et=$.prototype.removeAllListeners.apply(this,arguments);return _t!=="readable"&&_t!==void 0||w.nextTick(Bt,this),Et},vt.prototype.resume=function(){var _t=this._readableState;return _t.flowing||(G("resume"),_t.flowing=!_t.readableListening,Ot(this,_t)),_t.paused=!1,this},vt.prototype.pause=function(){return G("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(G("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},vt.prototype.wrap=function(_t){var Et=this,zt=this._readableState,K=!1;for(var ft in _t.on("end",function(){if(G("wrapped end"),zt.decoder&&!zt.ended){var wt=zt.decoder.end();wt&&wt.length&&Et.push(wt)}Et.push(null)}),_t.on("data",function(wt){G("wrapped data"),zt.decoder&&(wt=zt.decoder.write(wt)),zt.objectMode&&wt==null||(zt.objectMode||wt&&wt.length)&&(Et.push(wt)||(K=!0,_t.pause()))}),_t)this[ft]===void 0&&typeof _t[ft]=="function"&&(this[ft]=function(wt){return function(){return _t[wt].apply(_t,arguments)}}(ft));for(var bt=0;bt<ut.length;bt++)_t.on(ut[bt],this.emit.bind(this,ut[bt]));return this._read=function(wt){G("wrapped _read",wt),K&&(K=!1,_t.resume())},this},typeof Symbol=="function"&&(vt.prototype[Symbol.asyncIterator]=function(){return Q===void 0&&(Q=d("./internal/streams/async_iterator")),Q(this)}),Object.defineProperty(vt.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(vt.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(vt.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(_t){this._readableState&&(this._readableState.flowing=_t)}}),vt._fromList=et,Object.defineProperty(vt.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(vt.from=function(_t,Et){return q===void 0&&(q=d("./internal/streams/from")),q(vt,_t,Et)})}).call(this)}).call(this,d("_process"),commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":66,"./_stream_duplex":67,"./internal/streams/async_iterator":72,"./internal/streams/buffer_list":73,"./internal/streams/destroy":74,"./internal/streams/from":76,"./internal/streams/state":78,"./internal/streams/stream":79,_process:63,buffer:32,events:35,inherits:46,"string_decoder/":80,util:29}],70:[function(d,m,g){m.exports=Z;var w=d("../errors").codes,I=w.ERR_METHOD_NOT_IMPLEMENTED,P=w.ERR_MULTIPLE_CALLBACK,F=w.ERR_TRANSFORM_ALREADY_TRANSFORMING,$=w.ERR_TRANSFORM_WITH_LENGTH_0,D=d("./_stream_duplex");function U(H,W){var Q=this._transformState;Q.transforming=!1;var q=Q.writecb;if(q===null)return this.emit("error",new P);Q.writechunk=null,Q.writecb=null,W!=null&&this.push(W),q(H);var rt=this._readableState;rt.reading=!1,(rt.needReadable||rt.length<rt.highWaterMark)&&this._read(rt.highWaterMark)}function Z(H){if(!(this instanceof Z))return new Z(H);D.call(this,H),this._transformState={afterTransform:U.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,H&&(typeof H.transform=="function"&&(this._transform=H.transform),typeof H.flush=="function"&&(this._flush=H.flush)),this.on("prefinish",j)}function j(){var H=this;typeof this._flush!="function"||this._readableState.destroyed?G(this,null,null):this._flush(function(W,Q){G(H,W,Q)})}function G(H,W,Q){if(W)return H.emit("error",W);if(Q!=null&&H.push(Q),H._writableState.length)throw new $;if(H._transformState.transforming)throw new F;return H.push(null)}d("inherits")(Z,D),Z.prototype.push=function(H,W){return this._transformState.needTransform=!1,D.prototype.push.call(this,H,W)},Z.prototype._transform=function(H,W,Q){Q(new I("_transform()"))},Z.prototype._write=function(H,W,Q){var q=this._transformState;if(q.writecb=Q,q.writechunk=H,q.writeencoding=W,!q.transforming){var rt=this._readableState;(q.needTransform||rt.needReadable||rt.length<rt.highWaterMark)&&this._read(rt.highWaterMark)}},Z.prototype._read=function(H){var W=this._transformState;W.writechunk===null||W.transforming?W.needTransform=!0:(W.transforming=!0,this._transform(W.writechunk,W.writeencoding,W.afterTransform))},Z.prototype._destroy=function(H,W){D.prototype._destroy.call(this,H,function(Q){W(Q)})}},{"../errors":66,"./_stream_duplex":67,inherits:46}],71:[function(d,m,g){(function(w,I){(function(){function P(Tt){var et=this;this.next=null,this.entry=null,this.finish=function(){Zt(et,Tt)}}var F;m.exports=ht,ht.WritableState=V;var $={deprecate:d("util-deprecate")},D=d("./internal/streams/stream"),U=d("buffer").Buffer,Z=I.Uint8Array||function(){};function j(Tt){return U.from(Tt)}function G(Tt){return U.isBuffer(Tt)||Tt instanceof Z}var H,W=d("./internal/streams/destroy"),Q=d("./internal/streams/state").getHighWaterMark,q=d("../errors").codes,rt=q.ERR_INVALID_ARG_TYPE,it=q.ERR_METHOD_NOT_IMPLEMENTED,X=q.ERR_MULTIPLE_CALLBACK,J=q.ERR_STREAM_CANNOT_PIPE,tt=q.ERR_STREAM_DESTROYED,ot=q.ERR_STREAM_NULL_VALUES,nt=q.ERR_STREAM_WRITE_AFTER_END,lt=q.ERR_UNKNOWN_ENCODING,at=W.errorOrDestroy;function ut(){}function V(Tt,et,It){F=F||d("./_stream_duplex"),Tt=Tt||{},typeof It!="boolean"&&(It=et instanceof F),this.objectMode=!!Tt.objectMode,It&&(this.objectMode=this.objectMode||!!Tt.writableObjectMode),this.highWaterMark=Q(this,Tt,"writableHighWaterMark",It),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var mt=Tt.decodeStrings===!1;this.decodeStrings=!mt,this.defaultEncoding=Tt.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(gt){Ct(et,gt)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=Tt.emitClose!==!1,this.autoDestroy=!!Tt.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new P(this)}function ht(Tt){var et=this instanceof(F=F||d("./_stream_duplex"));if(!et&&!H.call(ht,this))return new ht(Tt);this._writableState=new V(Tt,this,et),this.writable=!0,Tt&&(typeof Tt.write=="function"&&(this._write=Tt.write),typeof Tt.writev=="function"&&(this._writev=Tt.writev),typeof Tt.destroy=="function"&&(this._destroy=Tt.destroy),typeof Tt.final=="function"&&(this._final=Tt.final)),D.call(this)}function vt(Tt,et){var It=new nt;at(Tt,It),w.nextTick(et,It)}function pt(Tt,et,It,mt){var gt;return It===null?gt=new ot:typeof It=="string"||et.objectMode||(gt=new rt("chunk",["string","Buffer"],It)),!gt||(at(Tt,gt),w.nextTick(mt,gt),!1)}function st(Tt,et,It){return Tt.objectMode||Tt.decodeStrings===!1||typeof et!="string"||(et=U.from(et,It)),et}function ct(Tt,et,It,mt,gt,_t){if(!It){var Et=st(et,mt,gt);mt!==Et&&(It=!0,gt="buffer",mt=Et)}var zt=et.objectMode?1:mt.length;et.length+=zt;var K=et.length<et.highWaterMark;if(K||(et.needDrain=!0),et.writing||et.corked){var ft=et.lastBufferedRequest;et.lastBufferedRequest={chunk:mt,encoding:gt,isBuf:It,callback:_t,next:null},ft?ft.next=et.lastBufferedRequest:et.bufferedRequest=et.lastBufferedRequest,et.bufferedRequestCount+=1}else At(Tt,et,!1,zt,mt,gt,_t);return K}function At(Tt,et,It,mt,gt,_t,Et){et.writelen=mt,et.writecb=Et,et.writing=!0,et.sync=!0,et.destroyed?et.onwrite(new tt("write")):It?Tt._writev(gt,et.onwrite):Tt._write(gt,_t,et.onwrite),et.sync=!1}function kt(Tt,et,It,mt,gt){--et.pendingcb,It?(w.nextTick(gt,mt),w.nextTick($t,Tt,et),Tt._writableState.errorEmitted=!0,at(Tt,mt)):(gt(mt),Tt._writableState.errorEmitted=!0,at(Tt,mt),$t(Tt,et))}function yt(Tt){Tt.writing=!1,Tt.writecb=null,Tt.length-=Tt.writelen,Tt.writelen=0}function Ct(Tt,et){var It=Tt._writableState,mt=It.sync,gt=It.writecb;if(typeof gt!="function")throw new X;if(yt(It),et)kt(Tt,It,mt,et,gt);else{var _t=Rt(It)||Tt.destroyed;_t||It.corked||It.bufferProcessing||!It.bufferedRequest||Ft(Tt,It),mt?w.nextTick(xt,Tt,It,_t,gt):xt(Tt,It,_t,gt)}}function xt(Tt,et,It,mt){It||Pt(Tt,et),et.pendingcb--,mt(),$t(Tt,et)}function Pt(Tt,et){et.length===0&&et.needDrain&&(et.needDrain=!1,Tt.emit("drain"))}function Ft(Tt,et){et.bufferProcessing=!0;var It=et.bufferedRequest;if(Tt._writev&&It&&It.next){var mt=et.bufferedRequestCount,gt=new Array(mt),_t=et.corkedRequestsFree;_t.entry=It;for(var Et=0,zt=!0;It;)gt[Et]=It,It.isBuf||(zt=!1),It=It.next,Et+=1;gt.allBuffers=zt,At(Tt,et,!0,et.length,gt,"",_t.finish),et.pendingcb++,et.lastBufferedRequest=null,_t.next?(et.corkedRequestsFree=_t.next,_t.next=null):et.corkedRequestsFree=new P(et),et.bufferedRequestCount=0}else{for(;It;){var K=It.chunk,ft=It.encoding,bt=It.callback;if(At(Tt,et,!1,et.objectMode?1:K.length,K,ft,bt),It=It.next,et.bufferedRequestCount--,et.writing)break}It===null&&(et.lastBufferedRequest=null)}et.bufferedRequest=It,et.bufferProcessing=!1}function Rt(Tt){return Tt.ending&&Tt.length===0&&Tt.bufferedRequest===null&&!Tt.finished&&!Tt.writing}function Mt(Tt,et){Tt._final(function(It){et.pendingcb--,It&&at(Tt,It),et.prefinished=!0,Tt.emit("prefinish"),$t(Tt,et)})}function Bt(Tt,et){et.prefinished||et.finalCalled||(typeof Tt._final!="function"||et.destroyed?(et.prefinished=!0,Tt.emit("prefinish")):(et.pendingcb++,et.finalCalled=!0,w.nextTick(Mt,Tt,et)))}function $t(Tt,et){var It=Rt(et);if(It&&(Bt(Tt,et),et.pendingcb===0&&(et.finished=!0,Tt.emit("finish"),et.autoDestroy))){var mt=Tt._readableState;(!mt||mt.autoDestroy&&mt.endEmitted)&&Tt.destroy()}return It}function Ot(Tt,et,It){et.ending=!0,$t(Tt,et),It&&(et.finished?w.nextTick(It):Tt.once("finish",It)),et.ended=!0,Tt.writable=!1}function Zt(Tt,et,It){var mt=Tt.entry;for(Tt.entry=null;mt;){var gt=mt.callback;et.pendingcb--,gt(It),mt=mt.next}et.corkedRequestsFree.next=Tt}d("inherits")(ht,D),V.prototype.getBuffer=function(){for(var Tt=this.bufferedRequest,et=[];Tt;)et.push(Tt),Tt=Tt.next;return et},function(){try{Object.defineProperty(V.prototype,"buffer",{get:$.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(H=Function.prototype[Symbol.hasInstance],Object.defineProperty(ht,Symbol.hasInstance,{value:function(Tt){return!!H.call(this,Tt)||this===ht&&Tt&&Tt._writableState instanceof V}})):H=function(Tt){return Tt instanceof this},ht.prototype.pipe=function(){at(this,new J)},ht.prototype.write=function(Tt,et,It){var mt=this._writableState,gt=!1,_t=!mt.objectMode&&G(Tt);return _t&&!U.isBuffer(Tt)&&(Tt=j(Tt)),typeof et=="function"&&(It=et,et=null),_t?et="buffer":et||(et=mt.defaultEncoding),typeof It!="function"&&(It=ut),mt.ending?vt(this,It):(_t||pt(this,mt,Tt,It))&&(mt.pendingcb++,gt=ct(this,mt,_t,Tt,et,It)),gt},ht.prototype.cork=function(){this._writableState.corked++},ht.prototype.uncork=function(){var Tt=this._writableState;Tt.corked&&(Tt.corked--,Tt.writing||Tt.corked||Tt.bufferProcessing||!Tt.bufferedRequest||Ft(this,Tt))},ht.prototype.setDefaultEncoding=function(Tt){if(typeof Tt=="string"&&(Tt=Tt.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Tt+"").toLowerCase())>-1))throw new lt(Tt);return this._writableState.defaultEncoding=Tt,this},Object.defineProperty(ht.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(ht.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),ht.prototype._write=function(Tt,et,It){It(new it("_write()"))},ht.prototype._writev=null,ht.prototype.end=function(Tt,et,It){var mt=this._writableState;return typeof Tt=="function"?(It=Tt,Tt=null,et=null):typeof et=="function"&&(It=et,et=null),Tt!=null&&this.write(Tt,et),mt.corked&&(mt.corked=1,this.uncork()),mt.ending||Ot(this,mt,It),this},Object.defineProperty(ht.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(ht.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(Tt){this._writableState&&(this._writableState.destroyed=Tt)}}),ht.prototype.destroy=W.destroy,ht.prototype._undestroy=W.undestroy,ht.prototype._destroy=function(Tt,et){et(Tt)}}).call(this)}).call(this,d("_process"),commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":66,"./_stream_duplex":67,"./internal/streams/destroy":74,"./internal/streams/state":78,"./internal/streams/stream":79,_process:63,buffer:32,inherits:46,"util-deprecate":81}],72:[function(d,m,g){(function(w){(function(){var I;function P(tt,ot,nt){return ot in tt?Object.defineProperty(tt,ot,{value:nt,enumerable:!0,configurable:!0,writable:!0}):tt[ot]=nt,tt}var F=d("./end-of-stream"),$=Symbol("lastResolve"),D=Symbol("lastReject"),U=Symbol("error"),Z=Symbol("ended"),j=Symbol("lastPromise"),G=Symbol("handlePromise"),H=Symbol("stream");function W(tt,ot){return{value:tt,done:ot}}function Q(tt){var ot=tt[$];if(ot!==null){var nt=tt[H].read();nt!==null&&(tt[j]=null,tt[$]=null,tt[D]=null,ot(W(nt,!1)))}}function q(tt){w.nextTick(Q,tt)}function rt(tt,ot){return function(nt,lt){tt.then(function(){ot[Z]?nt(W(void 0,!0)):ot[G](nt,lt)},lt)}}var it=Object.getPrototypeOf(function(){}),X=Object.setPrototypeOf((I={get stream(){return this[H]},next:function(){var tt=this,ot=this[U];if(ot!==null)return Promise.reject(ot);if(this[Z])return Promise.resolve(W(void 0,!0));if(this[H].destroyed)return new Promise(function(ut,V){w.nextTick(function(){tt[U]?V(tt[U]):ut(W(void 0,!0))})});var nt,lt=this[j];if(lt)nt=new Promise(rt(lt,this));else{var at=this[H].read();if(at!==null)return Promise.resolve(W(at,!1));nt=new Promise(this[G])}return this[j]=nt,nt}},P(I,Symbol.asyncIterator,function(){return this}),P(I,"return",function(){var tt=this;return new Promise(function(ot,nt){tt[H].destroy(null,function(lt){lt?nt(lt):ot(W(void 0,!0))})})}),I),it),J=function(tt){var ot,nt=Object.create(X,(P(ot={},H,{value:tt,writable:!0}),P(ot,$,{value:null,writable:!0}),P(ot,D,{value:null,writable:!0}),P(ot,U,{value:null,writable:!0}),P(ot,Z,{value:tt._readableState.endEmitted,writable:!0}),P(ot,G,{value:function(lt,at){var ut=nt[H].read();ut?(nt[j]=null,nt[$]=null,nt[D]=null,lt(W(ut,!1))):(nt[$]=lt,nt[D]=at)},writable:!0}),ot));return nt[j]=null,F(tt,function(lt){if(lt&&lt.code!=="ERR_STREAM_PREMATURE_CLOSE"){var at=nt[D];return at!==null&&(nt[j]=null,nt[$]=null,nt[D]=null,at(lt)),void(nt[U]=lt)}var ut=nt[$];ut!==null&&(nt[j]=null,nt[$]=null,nt[D]=null,ut(W(void 0,!0))),nt[Z]=!0}),tt.on("readable",q.bind(null,nt)),nt};m.exports=J}).call(this)}).call(this,d("_process"))},{"./end-of-stream":75,_process:63}],73:[function(d,m,g){function w(H,W){var Q=Object.keys(H);if(Object.getOwnPropertySymbols){var q=Object.getOwnPropertySymbols(H);W&&(q=q.filter(function(rt){return Object.getOwnPropertyDescriptor(H,rt).enumerable})),Q.push.apply(Q,q)}return Q}function I(H){for(var W=1;W<arguments.length;W++){var Q=arguments[W]!=null?arguments[W]:{};W%2?w(Object(Q),!0).forEach(function(q){P(H,q,Q[q])}):Object.getOwnPropertyDescriptors?Object.defineProperties(H,Object.getOwnPropertyDescriptors(Q)):w(Object(Q)).forEach(function(q){Object.defineProperty(H,q,Object.getOwnPropertyDescriptor(Q,q))})}return H}function P(H,W,Q){return W in H?Object.defineProperty(H,W,{value:Q,enumerable:!0,configurable:!0,writable:!0}):H[W]=Q,H}function F(H,W){if(!(H instanceof W))throw new TypeError("Cannot call a class as a function")}function $(H,W){for(var Q=0;Q<W.length;Q++){var q=W[Q];q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(H,q.key,q)}}function D(H,W,Q){return W&&$(H.prototype,W),H}var U=d("buffer").Buffer,Z=d("util").inspect,j=Z&&Z.custom||"inspect";function G(H,W,Q){U.prototype.copy.call(H,W,Q)}m.exports=function(){function H(){F(this,H),this.head=null,this.tail=null,this.length=0}return D(H,[{key:"push",value:function(W){var Q={data:W,next:null};this.length>0?this.tail.next=Q:this.head=Q,this.tail=Q,++this.length}},{key:"unshift",value:function(W){var Q={data:W,next:this.head};this.length===0&&(this.tail=Q),this.head=Q,++this.length}},{key:"shift",value:function(){if(this.length!==0){var W=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,W}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(W){if(this.length===0)return"";for(var Q=this.head,q=""+Q.data;Q=Q.next;)q+=W+Q.data;return q}},{key:"concat",value:function(W){if(this.length===0)return U.alloc(0);for(var Q=U.allocUnsafe(W>>>0),q=this.head,rt=0;q;)G(q.data,Q,rt),rt+=q.data.length,q=q.next;return Q}},{key:"consume",value:function(W,Q){var q;return W<this.head.data.length?(q=this.head.data.slice(0,W),this.head.data=this.head.data.slice(W)):q=W===this.head.data.length?this.shift():Q?this._getString(W):this._getBuffer(W),q}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(W){var Q=this.head,q=1,rt=Q.data;for(W-=rt.length;Q=Q.next;){var it=Q.data,X=W>it.length?it.length:W;if(X===it.length?rt+=it:rt+=it.slice(0,W),(W-=X)==0){X===it.length?(++q,Q.next?this.head=Q.next:this.head=this.tail=null):(this.head=Q,Q.data=it.slice(X));break}++q}return this.length-=q,rt}},{key:"_getBuffer",value:function(W){var Q=U.allocUnsafe(W),q=this.head,rt=1;for(q.data.copy(Q),W-=q.data.length;q=q.next;){var it=q.data,X=W>it.length?it.length:W;if(it.copy(Q,Q.length-W,0,X),(W-=X)==0){X===it.length?(++rt,q.next?this.head=q.next:this.head=this.tail=null):(this.head=q,q.data=it.slice(X));break}++rt}return this.length-=rt,Q}},{key:j,value:function(W,Q){return Z(this,I({},Q,{depth:0,customInspect:!1}))}}]),H}()},{buffer:32,util:29}],74:[function(d,m,g){(function(w){(function(){function I(Z,j){var G=this,H=this._readableState&&this._readableState.destroyed,W=this._writableState&&this._writableState.destroyed;return H||W?(j?j(Z):Z&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,w.nextTick(D,this,Z)):w.nextTick(D,this,Z)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(Z||null,function(Q){!j&&Q?G._writableState?G._writableState.errorEmitted?w.nextTick(F,G):(G._writableState.errorEmitted=!0,w.nextTick(P,G,Q)):w.nextTick(P,G,Q):j?(w.nextTick(F,G),j(Q)):w.nextTick(F,G)}),this)}function P(Z,j){D(Z,j),F(Z)}function F(Z){Z._writableState&&!Z._writableState.emitClose||Z._readableState&&!Z._readableState.emitClose||Z.emit("close")}function $(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function D(Z,j){Z.emit("error",j)}function U(Z,j){var G=Z._readableState,H=Z._writableState;G&&G.autoDestroy||H&&H.autoDestroy?Z.destroy(j):Z.emit("error",j)}m.exports={destroy:I,undestroy:$,errorOrDestroy:U}}).call(this)}).call(this,d("_process"))},{_process:63}],75:[function(d,m,g){var w=d("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function I(D){var U=!1;return function(){if(!U){U=!0;for(var Z=arguments.length,j=new Array(Z),G=0;G<Z;G++)j[G]=arguments[G];D.apply(this,j)}}}function P(){}function F(D){return D.setHeader&&typeof D.abort=="function"}function $(D,U,Z){if(typeof U=="function")return $(D,null,U);U||(U={}),Z=I(Z||P);var j=U.readable||U.readable!==!1&&D.readable,G=U.writable||U.writable!==!1&&D.writable,H=function(){D.writable||Q()},W=D._writableState&&D._writableState.finished,Q=function(){G=!1,W=!0,j||Z.call(D)},q=D._readableState&&D._readableState.endEmitted,rt=function(){j=!1,q=!0,G||Z.call(D)},it=function(tt){Z.call(D,tt)},X=function(){var tt;return j&&!q?(D._readableState&&D._readableState.ended||(tt=new w),Z.call(D,tt)):G&&!W?(D._writableState&&D._writableState.ended||(tt=new w),Z.call(D,tt)):void 0},J=function(){D.req.on("finish",Q)};return F(D)?(D.on("complete",Q),D.on("abort",X),D.req?J():D.on("request",J)):G&&!D._writableState&&(D.on("end",H),D.on("close",H)),D.on("end",rt),D.on("finish",Q),U.error!==!1&&D.on("error",it),D.on("close",X),function(){D.removeListener("complete",Q),D.removeListener("abort",X),D.removeListener("request",J),D.req&&D.req.removeListener("finish",Q),D.removeListener("end",H),D.removeListener("close",H),D.removeListener("finish",Q),D.removeListener("end",rt),D.removeListener("error",it),D.removeListener("close",X)}}m.exports=$},{"../../../errors":66}],76:[function(d,m,g){m.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],77:[function(d,m,g){var w;function I(Q){var q=!1;return function(){q||(q=!0,Q.apply(void 0,arguments))}}var P=d("../../../errors").codes,F=P.ERR_MISSING_ARGS,$=P.ERR_STREAM_DESTROYED;function D(Q){if(Q)throw Q}function U(Q){return Q.setHeader&&typeof Q.abort=="function"}function Z(Q,q,rt,it){it=I(it);var X=!1;Q.on("close",function(){X=!0}),w===void 0&&(w=d("./end-of-stream")),w(Q,{readable:q,writable:rt},function(tt){if(tt)return it(tt);X=!0,it()});var J=!1;return function(tt){if(!X&&!J)return J=!0,U(Q)?Q.abort():typeof Q.destroy=="function"?Q.destroy():void it(tt||new $("pipe"))}}function j(Q){Q()}function G(Q,q){return Q.pipe(q)}function H(Q){return Q.length?typeof Q[Q.length-1]!="function"?D:Q.pop():D}function W(){for(var Q=arguments.length,q=new Array(Q),rt=0;rt<Q;rt++)q[rt]=arguments[rt];var it,X=H(q);if(Array.isArray(q[0])&&(q=q[0]),q.length<2)throw new F("streams");var J=q.map(function(tt,ot){var nt=ot<q.length-1;return Z(tt,nt,ot>0,function(lt){it||(it=lt),lt&&J.forEach(j),nt||(J.forEach(j),X(it))})});return q.reduce(G)}m.exports=W},{"../../../errors":66,"./end-of-stream":75}],78:[function(d,m,g){var w=d("../../../errors").codes.ERR_INVALID_OPT_VALUE;function I(F,$,D){return F.highWaterMark!=null?F.highWaterMark:$?F[D]:null}function P(F,$,D,U){var Z=I($,U,D);if(Z!=null){if(!isFinite(Z)||Math.floor(Z)!==Z||Z<0)throw new w(U?D:"highWaterMark",Z);return Math.floor(Z)}return F.objectMode?16:16384}m.exports={getHighWaterMark:P}},{"../../../errors":66}],79:[function(d,m,g){m.exports=d("events").EventEmitter},{events:35}],80:[function(d,m,g){var w=d("safe-buffer").Buffer,I=w.isEncoding||function(J){switch((J=""+J)&&J.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function P(J){if(!J)return"utf8";for(var tt;;)switch(J){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return J;default:if(tt)return;J=(""+J).toLowerCase(),tt=!0}}function F(J){var tt=P(J);if(typeof tt!="string"&&(w.isEncoding===I||!I(J)))throw new Error("Unknown encoding: "+J);return tt||J}function $(J){var tt;switch(this.encoding=F(J),this.encoding){case"utf16le":this.text=W,this.end=Q,tt=4;break;case"utf8":this.fillLast=j,tt=4;break;case"base64":this.text=q,this.end=rt,tt=3;break;default:return this.write=it,void(this.end=X)}this.lastNeed=0,this.lastTotal=0,this.lastChar=w.allocUnsafe(tt)}function D(J){return J<=127?0:J>>5==6?2:J>>4==14?3:J>>3==30?4:J>>6==2?-1:-2}function U(J,tt,ot){var nt=tt.length-1;if(nt<ot)return 0;var lt=D(tt[nt]);return lt>=0?(lt>0&&(J.lastNeed=lt-1),lt):--nt<ot||lt===-2?0:(lt=D(tt[nt]))>=0?(lt>0&&(J.lastNeed=lt-2),lt):--nt<ot||lt===-2?0:(lt=D(tt[nt]))>=0?(lt>0&&(lt===2?lt=0:J.lastNeed=lt-3),lt):0}function Z(J,tt,ot){if((192&tt[0])!=128)return J.lastNeed=0,"�";if(J.lastNeed>1&&tt.length>1){if((192&tt[1])!=128)return J.lastNeed=1,"�";if(J.lastNeed>2&&tt.length>2&&(192&tt[2])!=128)return J.lastNeed=2,"�"}}function j(J){var tt=this.lastTotal-this.lastNeed,ot=Z(this,J);return ot!==void 0?ot:this.lastNeed<=J.length?(J.copy(this.lastChar,tt,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(J.copy(this.lastChar,tt,0,J.length),void(this.lastNeed-=J.length))}function G(J,tt){var ot=U(this,J,tt);if(!this.lastNeed)return J.toString("utf8",tt);this.lastTotal=ot;var nt=J.length-(ot-this.lastNeed);return J.copy(this.lastChar,0,nt),J.toString("utf8",tt,nt)}function H(J){var tt=J&&J.length?this.write(J):"";return this.lastNeed?tt+"�":tt}function W(J,tt){if((J.length-tt)%2==0){var ot=J.toString("utf16le",tt);if(ot){var nt=ot.charCodeAt(ot.length-1);if(nt>=55296&&nt<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=J[J.length-2],this.lastChar[1]=J[J.length-1],ot.slice(0,-1)}return ot}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=J[J.length-1],J.toString("utf16le",tt,J.length-1)}function Q(J){var tt=J&&J.length?this.write(J):"";if(this.lastNeed){var ot=this.lastTotal-this.lastNeed;return tt+this.lastChar.toString("utf16le",0,ot)}return tt}function q(J,tt){var ot=(J.length-tt)%3;return ot===0?J.toString("base64",tt):(this.lastNeed=3-ot,this.lastTotal=3,ot===1?this.lastChar[0]=J[J.length-1]:(this.lastChar[0]=J[J.length-2],this.lastChar[1]=J[J.length-1]),J.toString("base64",tt,J.length-ot))}function rt(J){var tt=J&&J.length?this.write(J):"";return this.lastNeed?tt+this.lastChar.toString("base64",0,3-this.lastNeed):tt}function it(J){return J.toString(this.encoding)}function X(J){return J&&J.length?this.write(J):""}g.StringDecoder=$,$.prototype.write=function(J){if(J.length===0)return"";var tt,ot;if(this.lastNeed){if((tt=this.fillLast(J))===void 0)return"";ot=this.lastNeed,this.lastNeed=0}else ot=0;return ot<J.length?tt?tt+this.text(J,ot):this.text(J,ot):tt||""},$.prototype.end=H,$.prototype.text=G,$.prototype.fillLast=function(J){if(this.lastNeed<=J.length)return J.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);J.copy(this.lastChar,this.lastTotal-this.lastNeed,0,J.length),this.lastNeed-=J.length}},{"safe-buffer":64}],81:[function(d,m,g){(function(w){(function(){function I(F,$){if(P("noDeprecation"))return F;var D=!1;function U(){if(!D){if(P("throwDeprecation"))throw new Error($);P("traceDeprecation")?console.trace($):console.warn($),D=!0}return F.apply(this,arguments)}return U}function P(F){try{if(!w.localStorage)return!1}catch{return!1}var $=w.localStorage[F];return $!=null&&String($).toLowerCase()==="true"}m.exports=I}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{}],82:[function(d,m,g){arguments[4][25][0].apply(g,arguments)},{dup:25}],83:[function(d,m,g){var w=d("is-arguments"),I=d("is-generator-function"),P=d("which-typed-array"),F=d("is-typed-array");function $(wt){return wt.call.bind(wt)}var D=typeof BigInt<"u",U=typeof Symbol<"u",Z=$(Object.prototype.toString),j=$(Number.prototype.valueOf),G=$(String.prototype.valueOf),H=$(Boolean.prototype.valueOf);if(D)var W=$(BigInt.prototype.valueOf);if(U)var Q=$(Symbol.prototype.valueOf);function q(wt,Lt){if(typeof wt!="object")return!1;try{return Lt(wt),!0}catch{return!1}}function rt(wt){return typeof Promise<"u"&&wt instanceof Promise||wt!==null&&typeof wt=="object"&&typeof wt.then=="function"&&typeof wt.catch=="function"}function it(wt){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(wt):F(wt)||Mt(wt)}function X(wt){return P(wt)==="Uint8Array"}function J(wt){return P(wt)==="Uint8ClampedArray"}function tt(wt){return P(wt)==="Uint16Array"}function ot(wt){return P(wt)==="Uint32Array"}function nt(wt){return P(wt)==="Int8Array"}function lt(wt){return P(wt)==="Int16Array"}function at(wt){return P(wt)==="Int32Array"}function ut(wt){return P(wt)==="Float32Array"}function V(wt){return P(wt)==="Float64Array"}function ht(wt){return P(wt)==="BigInt64Array"}function vt(wt){return P(wt)==="BigUint64Array"}function pt(wt){return Z(wt)==="[object Map]"}function st(wt){return typeof Map<"u"&&(pt.working?pt(wt):wt instanceof Map)}function ct(wt){return Z(wt)==="[object Set]"}function At(wt){return typeof Set<"u"&&(ct.working?ct(wt):wt instanceof Set)}function kt(wt){return Z(wt)==="[object WeakMap]"}function yt(wt){return typeof WeakMap<"u"&&(kt.working?kt(wt):wt instanceof WeakMap)}function Ct(wt){return Z(wt)==="[object WeakSet]"}function xt(wt){return Ct(wt)}function Pt(wt){return Z(wt)==="[object ArrayBuffer]"}function Ft(wt){return typeof ArrayBuffer<"u"&&(Pt.working?Pt(wt):wt instanceof ArrayBuffer)}function Rt(wt){return Z(wt)==="[object DataView]"}function Mt(wt){return typeof DataView<"u"&&(Rt.working?Rt(wt):wt instanceof DataView)}g.isArgumentsObject=w,g.isGeneratorFunction=I,g.isTypedArray=F,g.isPromise=rt,g.isArrayBufferView=it,g.isUint8Array=X,g.isUint8ClampedArray=J,g.isUint16Array=tt,g.isUint32Array=ot,g.isInt8Array=nt,g.isInt16Array=lt,g.isInt32Array=at,g.isFloat32Array=ut,g.isFloat64Array=V,g.isBigInt64Array=ht,g.isBigUint64Array=vt,pt.working=typeof Map<"u"&&pt(new Map),g.isMap=st,ct.working=typeof Set<"u"&&ct(new Set),g.isSet=At,kt.working=typeof WeakMap<"u"&&kt(new WeakMap),g.isWeakMap=yt,Ct.working=typeof WeakSet<"u"&&Ct(new WeakSet),g.isWeakSet=xt,Pt.working=typeof ArrayBuffer<"u"&&Pt(new ArrayBuffer),g.isArrayBuffer=Ft,Rt.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&Rt(new DataView(new ArrayBuffer(1),0,1)),g.isDataView=Mt;var Bt=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function $t(wt){return Z(wt)==="[object SharedArrayBuffer]"}function Ot(wt){return Bt!==void 0&&($t.working===void 0&&($t.working=$t(new Bt)),$t.working?$t(wt):wt instanceof Bt)}function Zt(wt){return Z(wt)==="[object AsyncFunction]"}function Tt(wt){return Z(wt)==="[object Map Iterator]"}function et(wt){return Z(wt)==="[object Set Iterator]"}function It(wt){return Z(wt)==="[object Generator]"}function mt(wt){return Z(wt)==="[object WebAssembly.Module]"}function gt(wt){return q(wt,j)}function _t(wt){return q(wt,G)}function Et(wt){return q(wt,H)}function zt(wt){return D&&q(wt,W)}function K(wt){return U&&q(wt,Q)}function ft(wt){return gt(wt)||_t(wt)||Et(wt)||zt(wt)||K(wt)}function bt(wt){return typeof Uint8Array<"u"&&(Ft(wt)||Ot(wt))}g.isSharedArrayBuffer=Ot,g.isAsyncFunction=Zt,g.isMapIterator=Tt,g.isSetIterator=et,g.isGeneratorObject=It,g.isWebAssemblyCompiledModule=mt,g.isNumberObject=gt,g.isStringObject=_t,g.isBooleanObject=Et,g.isBigIntObject=zt,g.isSymbolObject=K,g.isBoxedPrimitive=ft,g.isAnyArrayBuffer=bt,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(wt){Object.defineProperty(g,wt,{enumerable:!1,value:function(){throw new Error(wt+" is not supported in userland")}})})},{"is-arguments":47,"is-generator-function":49,"is-typed-array":50,"which-typed-array":85}],84:[function(d,m,g){(function(w){(function(){var I=Object.getOwnPropertyDescriptors||function(Mt){for(var Bt=Object.keys(Mt),$t={},Ot=0;Ot<Bt.length;Ot++)$t[Bt[Ot]]=Object.getOwnPropertyDescriptor(Mt,Bt[Ot]);return $t},P=/%[sdj%]/g;g.format=function(Mt){if(!lt(Mt)){for(var Bt=[],$t=0;$t<arguments.length;$t++)Bt.push(U(arguments[$t]));return Bt.join(" ")}$t=1;for(var Ot=arguments,Zt=Ot.length,Tt=String(Mt).replace(P,function(It){if(It==="%%")return"%";if($t>=Zt)return It;switch(It){case"%s":return String(Ot[$t++]);case"%d":return Number(Ot[$t++]);case"%j":try{return JSON.stringify(Ot[$t++])}catch{return"[Circular]"}default:return It}}),et=Ot[$t];$t<Zt;et=Ot[++$t])tt(et)||!ht(et)?Tt+=" "+et:Tt+=" "+U(et);return Tt},g.deprecate=function(Mt,Bt){if(w!==void 0&&w.noDeprecation===!0)return Mt;if(w===void 0)return function(){return g.deprecate(Mt,Bt).apply(this,arguments)};var $t=!1;function Ot(){if(!$t){if(w.throwDeprecation)throw new Error(Bt);w.traceDeprecation?console.trace(Bt):console.error(Bt),$t=!0}return Mt.apply(this,arguments)}return Ot};var F={},$=/^$/;if(w.env.NODE_DEBUG){var D=w.env.NODE_DEBUG;D=D.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),$=new RegExp("^"+D+"$","i")}function U(Mt,Bt){var $t={seen:[],stylize:j};return arguments.length>=3&&($t.depth=arguments[2]),arguments.length>=4&&($t.colors=arguments[3]),J(Bt)?$t.showHidden=Bt:Bt&&g._extend($t,Bt),ut($t.showHidden)&&($t.showHidden=!1),ut($t.depth)&&($t.depth=2),ut($t.colors)&&($t.colors=!1),ut($t.customInspect)&&($t.customInspect=!0),$t.colors&&($t.stylize=Z),H($t,Mt,$t.depth)}function Z(Mt,Bt){var $t=U.styles[Bt];return $t?"\x1B["+U.colors[$t][0]+"m"+Mt+"\x1B["+U.colors[$t][1]+"m":Mt}function j(Mt,Bt){return Mt}function G(Mt){var Bt={};return Mt.forEach(function($t,Ot){Bt[$t]=!0}),Bt}function H(Mt,Bt,$t){if(Mt.customInspect&&Bt&&st(Bt.inspect)&&Bt.inspect!==g.inspect&&(!Bt.constructor||Bt.constructor.prototype!==Bt)){var Ot=Bt.inspect($t,Mt);return lt(Ot)||(Ot=H(Mt,Ot,$t)),Ot}var Zt=W(Mt,Bt);if(Zt)return Zt;var Tt=Object.keys(Bt),et=G(Tt);if(Mt.showHidden&&(Tt=Object.getOwnPropertyNames(Bt)),pt(Bt)&&(Tt.indexOf("message")>=0||Tt.indexOf("description")>=0))return Q(Bt);if(Tt.length===0){if(st(Bt)){var It=Bt.name?": "+Bt.name:"";return Mt.stylize("[Function"+It+"]","special")}if(V(Bt))return Mt.stylize(RegExp.prototype.toString.call(Bt),"regexp");if(vt(Bt))return Mt.stylize(Date.prototype.toString.call(Bt),"date");if(pt(Bt))return Q(Bt)}var mt,gt="",_t=!1,Et=["{","}"];return X(Bt)&&(_t=!0,Et=["[","]"]),st(Bt)&&(gt=" [Function"+(Bt.name?": "+Bt.name:"")+"]"),V(Bt)&&(gt=" "+RegExp.prototype.toString.call(Bt)),vt(Bt)&&(gt=" "+Date.prototype.toUTCString.call(Bt)),pt(Bt)&&(gt=" "+Q(Bt)),Tt.length!==0||_t&&Bt.length!=0?$t<0?V(Bt)?Mt.stylize(RegExp.prototype.toString.call(Bt),"regexp"):Mt.stylize("[Object]","special"):(Mt.seen.push(Bt),mt=_t?q(Mt,Bt,$t,et,Tt):Tt.map(function(zt){return rt(Mt,Bt,$t,et,zt,_t)}),Mt.seen.pop(),it(mt,gt,Et)):Et[0]+gt+Et[1]}function W(Mt,Bt){if(ut(Bt))return Mt.stylize("undefined","undefined");if(lt(Bt)){var $t="'"+JSON.stringify(Bt).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Mt.stylize($t,"string")}return nt(Bt)?Mt.stylize(""+Bt,"number"):J(Bt)?Mt.stylize(""+Bt,"boolean"):tt(Bt)?Mt.stylize("null","null"):void 0}function Q(Mt){return"["+Error.prototype.toString.call(Mt)+"]"}function q(Mt,Bt,$t,Ot,Zt){for(var Tt=[],et=0,It=Bt.length;et<It;++et)xt(Bt,String(et))?Tt.push(rt(Mt,Bt,$t,Ot,String(et),!0)):Tt.push("");return Zt.forEach(function(mt){mt.match(/^\d+$/)||Tt.push(rt(Mt,Bt,$t,Ot,mt,!0))}),Tt}function rt(Mt,Bt,$t,Ot,Zt,Tt){var et,It,mt;if((mt=Object.getOwnPropertyDescriptor(Bt,Zt)||{value:Bt[Zt]}).get?It=mt.set?Mt.stylize("[Getter/Setter]","special"):Mt.stylize("[Getter]","special"):mt.set&&(It=Mt.stylize("[Setter]","special")),xt(Ot,Zt)||(et="["+Zt+"]"),It||(Mt.seen.indexOf(mt.value)<0?(It=tt($t)?H(Mt,mt.value,null):H(Mt,mt.value,$t-1)).indexOf(`
`)>-1&&(It=Tt?It.split(`
`).map(function(gt){return"  "+gt}).join(`
`).slice(2):`
`+It.split(`
`).map(function(gt){return"   "+gt}).join(`
`)):It=Mt.stylize("[Circular]","special")),ut(et)){if(Tt&&Zt.match(/^\d+$/))return It;(et=JSON.stringify(""+Zt)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(et=et.slice(1,-1),et=Mt.stylize(et,"name")):(et=et.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),et=Mt.stylize(et,"string"))}return et+": "+It}function it(Mt,Bt,$t){return Mt.reduce(function(Ot,Zt){return Zt.indexOf(`
`),Ot+Zt.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?$t[0]+(Bt===""?"":Bt+`
 `)+" "+Mt.join(`,
  `)+" "+$t[1]:$t[0]+Bt+" "+Mt.join(", ")+" "+$t[1]}function X(Mt){return Array.isArray(Mt)}function J(Mt){return typeof Mt=="boolean"}function tt(Mt){return Mt===null}function ot(Mt){return Mt==null}function nt(Mt){return typeof Mt=="number"}function lt(Mt){return typeof Mt=="string"}function at(Mt){return typeof Mt=="symbol"}function ut(Mt){return Mt===void 0}function V(Mt){return ht(Mt)&&At(Mt)==="[object RegExp]"}function ht(Mt){return typeof Mt=="object"&&Mt!==null}function vt(Mt){return ht(Mt)&&At(Mt)==="[object Date]"}function pt(Mt){return ht(Mt)&&(At(Mt)==="[object Error]"||Mt instanceof Error)}function st(Mt){return typeof Mt=="function"}function ct(Mt){return Mt===null||typeof Mt=="boolean"||typeof Mt=="number"||typeof Mt=="string"||typeof Mt=="symbol"||Mt===void 0}function At(Mt){return Object.prototype.toString.call(Mt)}function kt(Mt){return Mt<10?"0"+Mt.toString(10):Mt.toString(10)}g.debuglog=function(Mt){if(Mt=Mt.toUpperCase(),!F[Mt])if($.test(Mt)){var Bt=w.pid;F[Mt]=function(){var $t=g.format.apply(g,arguments);console.error("%s %d: %s",Mt,Bt,$t)}}else F[Mt]=function(){};return F[Mt]},g.inspect=U,U.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},U.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},g.types=d("./support/types"),g.isArray=X,g.isBoolean=J,g.isNull=tt,g.isNullOrUndefined=ot,g.isNumber=nt,g.isString=lt,g.isSymbol=at,g.isUndefined=ut,g.isRegExp=V,g.types.isRegExp=V,g.isObject=ht,g.isDate=vt,g.types.isDate=vt,g.isError=pt,g.types.isNativeError=pt,g.isFunction=st,g.isPrimitive=ct,g.isBuffer=d("./support/isBuffer");var yt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Ct(){var Mt=new Date,Bt=[kt(Mt.getHours()),kt(Mt.getMinutes()),kt(Mt.getSeconds())].join(":");return[Mt.getDate(),yt[Mt.getMonth()],Bt].join(" ")}function xt(Mt,Bt){return Object.prototype.hasOwnProperty.call(Mt,Bt)}g.log=function(){console.log("%s - %s",Ct(),g.format.apply(g,arguments))},g.inherits=d("inherits"),g._extend=function(Mt,Bt){if(!Bt||!ht(Bt))return Mt;for(var $t=Object.keys(Bt),Ot=$t.length;Ot--;)Mt[$t[Ot]]=Bt[$t[Ot]];return Mt};var Pt=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;function Ft(Mt,Bt){if(!Mt){var $t=new Error("Promise was rejected with a falsy value");$t.reason=Mt,Mt=$t}return Bt(Mt)}function Rt(Mt){if(typeof Mt!="function")throw new TypeError('The "original" argument must be of type Function');function Bt(){for(var $t=[],Ot=0;Ot<arguments.length;Ot++)$t.push(arguments[Ot]);var Zt=$t.pop();if(typeof Zt!="function")throw new TypeError("The last argument must be of type Function");var Tt=this,et=function(){return Zt.apply(Tt,arguments)};Mt.apply(this,$t).then(function(It){w.nextTick(et.bind(null,null,It))},function(It){w.nextTick(Ft.bind(null,It,et))})}return Object.setPrototypeOf(Bt,Object.getPrototypeOf(Mt)),Object.defineProperties(Bt,I(Mt)),Bt}g.promisify=function(Mt){if(typeof Mt!="function")throw new TypeError('The "original" argument must be of type Function');if(Pt&&Mt[Pt]){var Bt;if(typeof(Bt=Mt[Pt])!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(Bt,Pt,{value:Bt,enumerable:!1,writable:!1,configurable:!0}),Bt}function Bt(){for(var $t,Ot,Zt=new Promise(function(It,mt){$t=It,Ot=mt}),Tt=[],et=0;et<arguments.length;et++)Tt.push(arguments[et]);Tt.push(function(It,mt){It?Ot(It):$t(mt)});try{Mt.apply(this,Tt)}catch(It){Ot(It)}return Zt}return Object.setPrototypeOf(Bt,Object.getPrototypeOf(Mt)),Pt&&Object.defineProperty(Bt,Pt,{value:Bt,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(Bt,I(Mt))},g.promisify.custom=Pt,g.callbackify=Rt}).call(this)}).call(this,d("_process"))},{"./support/isBuffer":82,"./support/types":83,_process:63,inherits:46}],85:[function(d,m,g){(function(w){(function(){var I=d("for-each"),P=d("available-typed-arrays"),F=d("call-bind/callBound"),$=d("gopd"),D=F("Object.prototype.toString"),U=d("has-tostringtag/shams")(),Z=typeof globalThis>"u"?w:globalThis,j=P(),G=F("String.prototype.slice"),H={},W=Object.getPrototypeOf;U&&$&&W&&I(j,function(rt){if(typeof Z[rt]=="function"){var it=new Z[rt];if(Symbol.toStringTag in it){var X=W(it),J=$(X,Symbol.toStringTag);if(!J){var tt=W(X);J=$(tt,Symbol.toStringTag)}H[rt]=J.get}}});var Q=function(rt){var it=!1;return I(H,function(X,J){if(!it)try{var tt=X.call(rt);tt===J&&(it=tt)}catch{}}),it},q=d("is-typed-array");m.exports=function(rt){return!!q(rt)&&(U&&Symbol.toStringTag in rt?Q(rt):G(D(rt),8,-1))}}).call(this)}).call(this,commonjsGlobal!==void 0?commonjsGlobal:typeof self<"u"?self:typeof window<"u"?window:{})},{"available-typed-arrays":27,"call-bind/callBound":33,"for-each":36,gopd:40,"has-tostringtag/shams":43,"is-typed-array":50}]},{},[20])(20);var browserExports=browser$1.exports,PNGFilterType,PNGFilterType2,PNGColorType,PNGColorType2;function png(){return{mime:"image/png",hasAlpha:!0,encode:(d,{deflateLevel:m=9,deflateStrategy:g=3,filterType:w=PNGFilterType.AUTO,colorType:I,inputHasAlpha:P=!0,...F}={})=>{const $=new browserExports.PNG({width:d.width,height:d.height});return $.data=d.data,browserExports.PNG.sync.write($,{...F,deflateLevel:m,deflateStrategy:g,filterType:w,colorType:I!==void 0?I:P?PNGColorType.COLOR_ALPHA:PNGColorType.COLOR,inputHasAlpha:P})},decode:(d,m)=>{const g=browserExports.PNG.sync.read(d,m);return{data:g.data,width:g.width,height:g.height}}}}PNGFilterType2=PNGFilterType||(PNGFilterType={}),PNGFilterType2[PNGFilterType2.AUTO=-1]="AUTO",PNGFilterType2[PNGFilterType2.NONE=0]="NONE",PNGFilterType2[PNGFilterType2.SUB=1]="SUB",PNGFilterType2[PNGFilterType2.UP=2]="UP",PNGFilterType2[PNGFilterType2.AVERAGE=3]="AVERAGE",PNGFilterType2[PNGFilterType2.PATH=4]="PATH",PNGColorType2=PNGColorType||(PNGColorType={}),PNGColorType2[PNGColorType2.GRAYSCALE=0]="GRAYSCALE",PNGColorType2[PNGColorType2.COLOR=2]="COLOR",PNGColorType2[PNGColorType2.GRAYSCALE_ALPHA=4]="GRAYSCALE_ALPHA",PNGColorType2[PNGColorType2.COLOR_ALPHA=6]="COLOR_ALPHA";var UTIF={exports:{}},common={},hasRequiredCommon;function requireCommon(){return hasRequiredCommon||(hasRequiredCommon=1,function(d){var m=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function g(P,F){return Object.prototype.hasOwnProperty.call(P,F)}d.assign=function(P){for(var F=Array.prototype.slice.call(arguments,1);F.length;){var $=F.shift();if($){if(typeof $!="object")throw new TypeError($+"must be non-object");for(var D in $)g($,D)&&(P[D]=$[D])}}return P},d.shrinkBuf=function(P,F){return P.length===F?P:P.subarray?P.subarray(0,F):(P.length=F,P)};var w={arraySet:function(P,F,$,D,U){if(F.subarray&&P.subarray)P.set(F.subarray($,$+D),U);else for(var Z=0;Z<D;Z++)P[U+Z]=F[$+Z]},flattenChunks:function(P){var F,$,D,U,Z,j;for(D=0,F=0,$=P.length;F<$;F++)D+=P[F].length;for(j=new Uint8Array(D),U=0,F=0,$=P.length;F<$;F++)Z=P[F],j.set(Z,U),U+=Z.length;return j}},I={arraySet:function(P,F,$,D,U){for(var Z=0;Z<D;Z++)P[U+Z]=F[$+Z]},flattenChunks:function(P){return[].concat.apply([],P)}};d.setTyped=function(P){P?(d.Buf8=Uint8Array,d.Buf16=Uint16Array,d.Buf32=Int32Array,d.assign(d,w)):(d.Buf8=Array,d.Buf16=Array,d.Buf32=Array,d.assign(d,I))},d.setTyped(m)}(common)),common}var deflate$1={},deflate={},trees={},hasRequiredTrees,adler32_1,hasRequiredAdler32,crc32_1,hasRequiredCrc32,messages,hasRequiredMessages,hasRequiredDeflate$1;function requireTrees(){if(hasRequiredTrees)return trees;hasRequiredTrees=1;var d=requireCommon(),m=0,g=1;function w(mt){for(var gt=mt.length;--gt>=0;)mt[gt]=0}var I=0,P=29,F=256,$=F+1+P,D=30,U=19,Z=2*$+1,j=15,G=16,H=7,W=256,Q=16,q=17,rt=18,it=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],X=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],J=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],tt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ot=new Array(2*($+2));w(ot);var nt=new Array(2*D);w(nt);var lt=new Array(512);w(lt);var at=new Array(256);w(at);var ut=new Array(P);w(ut);var V,ht,vt,pt=new Array(D);function st(mt,gt,_t,Et,zt){this.static_tree=mt,this.extra_bits=gt,this.extra_base=_t,this.elems=Et,this.max_length=zt,this.has_stree=mt&&mt.length}function ct(mt,gt){this.dyn_tree=mt,this.max_code=0,this.stat_desc=gt}function At(mt){return mt<256?lt[mt]:lt[256+(mt>>>7)]}function kt(mt,gt){mt.pending_buf[mt.pending++]=255&gt,mt.pending_buf[mt.pending++]=gt>>>8&255}function yt(mt,gt,_t){mt.bi_valid>G-_t?(mt.bi_buf|=gt<<mt.bi_valid&65535,kt(mt,mt.bi_buf),mt.bi_buf=gt>>G-mt.bi_valid,mt.bi_valid+=_t-G):(mt.bi_buf|=gt<<mt.bi_valid&65535,mt.bi_valid+=_t)}function Ct(mt,gt,_t){yt(mt,_t[2*gt],_t[2*gt+1])}function xt(mt,gt){var _t=0;do _t|=1&mt,mt>>>=1,_t<<=1;while(--gt>0);return _t>>>1}function Pt(mt,gt,_t){var Et,zt,K=new Array(j+1),ft=0;for(Et=1;Et<=j;Et++)K[Et]=ft=ft+_t[Et-1]<<1;for(zt=0;zt<=gt;zt++){var bt=mt[2*zt+1];bt!==0&&(mt[2*zt]=xt(K[bt]++,bt))}}function Ft(mt){var gt;for(gt=0;gt<$;gt++)mt.dyn_ltree[2*gt]=0;for(gt=0;gt<D;gt++)mt.dyn_dtree[2*gt]=0;for(gt=0;gt<U;gt++)mt.bl_tree[2*gt]=0;mt.dyn_ltree[2*W]=1,mt.opt_len=mt.static_len=0,mt.last_lit=mt.matches=0}function Rt(mt){mt.bi_valid>8?kt(mt,mt.bi_buf):mt.bi_valid>0&&(mt.pending_buf[mt.pending++]=mt.bi_buf),mt.bi_buf=0,mt.bi_valid=0}function Mt(mt,gt,_t,Et){var zt=2*gt,K=2*_t;return mt[zt]<mt[K]||mt[zt]===mt[K]&&Et[gt]<=Et[_t]}function Bt(mt,gt,_t){for(var Et=mt.heap[_t],zt=_t<<1;zt<=mt.heap_len&&(zt<mt.heap_len&&Mt(gt,mt.heap[zt+1],mt.heap[zt],mt.depth)&&zt++,!Mt(gt,Et,mt.heap[zt],mt.depth));)mt.heap[_t]=mt.heap[zt],_t=zt,zt<<=1;mt.heap[_t]=Et}function $t(mt,gt,_t){var Et,zt,K,ft,bt=0;if(mt.last_lit!==0)do Et=mt.pending_buf[mt.d_buf+2*bt]<<8|mt.pending_buf[mt.d_buf+2*bt+1],zt=mt.pending_buf[mt.l_buf+bt],bt++,Et===0?Ct(mt,zt,gt):(Ct(mt,(K=at[zt])+F+1,gt),(ft=it[K])!==0&&yt(mt,zt-=ut[K],ft),Ct(mt,K=At(--Et),_t),(ft=X[K])!==0&&yt(mt,Et-=pt[K],ft));while(bt<mt.last_lit);Ct(mt,W,gt)}function Ot(mt,gt){var _t,Et,zt,K=gt.dyn_tree,ft=gt.stat_desc.static_tree,bt=gt.stat_desc.has_stree,wt=gt.stat_desc.elems,Lt=-1;for(mt.heap_len=0,mt.heap_max=Z,_t=0;_t<wt;_t++)K[2*_t]!==0?(mt.heap[++mt.heap_len]=Lt=_t,mt.depth[_t]=0):K[2*_t+1]=0;for(;mt.heap_len<2;)K[2*(zt=mt.heap[++mt.heap_len]=Lt<2?++Lt:0)]=1,mt.depth[zt]=0,mt.opt_len--,bt&&(mt.static_len-=ft[2*zt+1]);for(gt.max_code=Lt,_t=mt.heap_len>>1;_t>=1;_t--)Bt(mt,K,_t);zt=wt;do _t=mt.heap[1],mt.heap[1]=mt.heap[mt.heap_len--],Bt(mt,K,1),Et=mt.heap[1],mt.heap[--mt.heap_max]=_t,mt.heap[--mt.heap_max]=Et,K[2*zt]=K[2*_t]+K[2*Et],mt.depth[zt]=(mt.depth[_t]>=mt.depth[Et]?mt.depth[_t]:mt.depth[Et])+1,K[2*_t+1]=K[2*Et+1]=zt,mt.heap[1]=zt++,Bt(mt,K,1);while(mt.heap_len>=2);mt.heap[--mt.heap_max]=mt.heap[1],function(jt,Kt){var te,Vt,ee,Jt,oe,ne,ae=Kt.dyn_tree,fe=Kt.max_code,ie=Kt.stat_desc.static_tree,Nt=Kt.stat_desc.has_stree,Xt=Kt.stat_desc.extra_bits,Ut=Kt.stat_desc.extra_base,Qt=Kt.stat_desc.max_length,St=0;for(Jt=0;Jt<=j;Jt++)jt.bl_count[Jt]=0;for(ae[2*jt.heap[jt.heap_max]+1]=0,te=jt.heap_max+1;te<Z;te++)(Jt=ae[2*ae[2*(Vt=jt.heap[te])+1]+1]+1)>Qt&&(Jt=Qt,St++),ae[2*Vt+1]=Jt,Vt>fe||(jt.bl_count[Jt]++,oe=0,Vt>=Ut&&(oe=Xt[Vt-Ut]),ne=ae[2*Vt],jt.opt_len+=ne*(Jt+oe),Nt&&(jt.static_len+=ne*(ie[2*Vt+1]+oe)));if(St!==0){do{for(Jt=Qt-1;jt.bl_count[Jt]===0;)Jt--;jt.bl_count[Jt]--,jt.bl_count[Jt+1]+=2,jt.bl_count[Qt]--,St-=2}while(St>0);for(Jt=Qt;Jt!==0;Jt--)for(Vt=jt.bl_count[Jt];Vt!==0;)(ee=jt.heap[--te])>fe||(ae[2*ee+1]!==Jt&&(jt.opt_len+=(Jt-ae[2*ee+1])*ae[2*ee],ae[2*ee+1]=Jt),Vt--)}}(mt,gt),Pt(K,Lt,mt.bl_count)}function Zt(mt,gt,_t){var Et,zt,K=-1,ft=gt[1],bt=0,wt=7,Lt=4;for(ft===0&&(wt=138,Lt=3),gt[2*(_t+1)+1]=65535,Et=0;Et<=_t;Et++)zt=ft,ft=gt[2*(Et+1)+1],++bt<wt&&zt===ft||(bt<Lt?mt.bl_tree[2*zt]+=bt:zt!==0?(zt!==K&&mt.bl_tree[2*zt]++,mt.bl_tree[2*Q]++):bt<=10?mt.bl_tree[2*q]++:mt.bl_tree[2*rt]++,bt=0,K=zt,ft===0?(wt=138,Lt=3):zt===ft?(wt=6,Lt=3):(wt=7,Lt=4))}function Tt(mt,gt,_t){var Et,zt,K=-1,ft=gt[1],bt=0,wt=7,Lt=4;for(ft===0&&(wt=138,Lt=3),Et=0;Et<=_t;Et++)if(zt=ft,ft=gt[2*(Et+1)+1],!(++bt<wt&&zt===ft)){if(bt<Lt)do Ct(mt,zt,mt.bl_tree);while(--bt!=0);else zt!==0?(zt!==K&&(Ct(mt,zt,mt.bl_tree),bt--),Ct(mt,Q,mt.bl_tree),yt(mt,bt-3,2)):bt<=10?(Ct(mt,q,mt.bl_tree),yt(mt,bt-3,3)):(Ct(mt,rt,mt.bl_tree),yt(mt,bt-11,7));bt=0,K=zt,ft===0?(wt=138,Lt=3):zt===ft?(wt=6,Lt=3):(wt=7,Lt=4)}}w(pt);var et=!1;function It(mt,gt,_t,Et){yt(mt,(I<<1)+(Et?1:0),3),function(zt,K,ft,bt){Rt(zt),kt(zt,ft),kt(zt,~ft),d.arraySet(zt.pending_buf,zt.window,K,ft,zt.pending),zt.pending+=ft}(mt,gt,_t)}return trees._tr_init=function(mt){et||(function(){var gt,_t,Et,zt,K,ft=new Array(j+1);for(Et=0,zt=0;zt<P-1;zt++)for(ut[zt]=Et,gt=0;gt<1<<it[zt];gt++)at[Et++]=zt;for(at[Et-1]=zt,K=0,zt=0;zt<16;zt++)for(pt[zt]=K,gt=0;gt<1<<X[zt];gt++)lt[K++]=zt;for(K>>=7;zt<D;zt++)for(pt[zt]=K<<7,gt=0;gt<1<<X[zt]-7;gt++)lt[256+K++]=zt;for(_t=0;_t<=j;_t++)ft[_t]=0;for(gt=0;gt<=143;)ot[2*gt+1]=8,gt++,ft[8]++;for(;gt<=255;)ot[2*gt+1]=9,gt++,ft[9]++;for(;gt<=279;)ot[2*gt+1]=7,gt++,ft[7]++;for(;gt<=287;)ot[2*gt+1]=8,gt++,ft[8]++;for(Pt(ot,$+1,ft),gt=0;gt<D;gt++)nt[2*gt+1]=5,nt[2*gt]=xt(gt,5);V=new st(ot,it,F+1,$,j),ht=new st(nt,X,0,D,j),vt=new st(new Array(0),J,0,U,H)}(),et=!0),mt.l_desc=new ct(mt.dyn_ltree,V),mt.d_desc=new ct(mt.dyn_dtree,ht),mt.bl_desc=new ct(mt.bl_tree,vt),mt.bi_buf=0,mt.bi_valid=0,Ft(mt)},trees._tr_stored_block=It,trees._tr_flush_block=function(mt,gt,_t,Et){var zt,K,ft=0;mt.level>0?(mt.strm.data_type===2&&(mt.strm.data_type=function(bt){var wt,Lt=4093624447;for(wt=0;wt<=31;wt++,Lt>>>=1)if(1&Lt&&bt.dyn_ltree[2*wt]!==0)return m;if(bt.dyn_ltree[18]!==0||bt.dyn_ltree[20]!==0||bt.dyn_ltree[26]!==0)return g;for(wt=32;wt<F;wt++)if(bt.dyn_ltree[2*wt]!==0)return g;return m}(mt)),Ot(mt,mt.l_desc),Ot(mt,mt.d_desc),ft=function(bt){var wt;for(Zt(bt,bt.dyn_ltree,bt.l_desc.max_code),Zt(bt,bt.dyn_dtree,bt.d_desc.max_code),Ot(bt,bt.bl_desc),wt=U-1;wt>=3&&bt.bl_tree[2*tt[wt]+1]===0;wt--);return bt.opt_len+=3*(wt+1)+5+5+4,wt}(mt),zt=mt.opt_len+3+7>>>3,(K=mt.static_len+3+7>>>3)<=zt&&(zt=K)):zt=K=_t+5,_t+4<=zt&&gt!==-1?It(mt,gt,_t,Et):mt.strategy===4||K===zt?(yt(mt,2+(Et?1:0),3),$t(mt,ot,nt)):(yt(mt,4+(Et?1:0),3),function(bt,wt,Lt,jt){var Kt;for(yt(bt,wt-257,5),yt(bt,Lt-1,5),yt(bt,jt-4,4),Kt=0;Kt<jt;Kt++)yt(bt,bt.bl_tree[2*tt[Kt]+1],3);Tt(bt,bt.dyn_ltree,wt-1),Tt(bt,bt.dyn_dtree,Lt-1)}(mt,mt.l_desc.max_code+1,mt.d_desc.max_code+1,ft+1),$t(mt,mt.dyn_ltree,mt.dyn_dtree)),Ft(mt),Et&&Rt(mt)},trees._tr_tally=function(mt,gt,_t){return mt.pending_buf[mt.d_buf+2*mt.last_lit]=gt>>>8&255,mt.pending_buf[mt.d_buf+2*mt.last_lit+1]=255&gt,mt.pending_buf[mt.l_buf+mt.last_lit]=255&_t,mt.last_lit++,gt===0?mt.dyn_ltree[2*_t]++:(mt.matches++,gt--,mt.dyn_ltree[2*(at[_t]+F+1)]++,mt.dyn_dtree[2*At(gt)]++),mt.last_lit===mt.lit_bufsize-1},trees._tr_align=function(mt){yt(mt,2,3),Ct(mt,W,ot),function(gt){gt.bi_valid===16?(kt(gt,gt.bi_buf),gt.bi_buf=0,gt.bi_valid=0):gt.bi_valid>=8&&(gt.pending_buf[gt.pending++]=255&gt.bi_buf,gt.bi_buf>>=8,gt.bi_valid-=8)}(mt)},trees}function requireAdler32(){return hasRequiredAdler32||(hasRequiredAdler32=1,adler32_1=function(d,m,g,w){for(var I=65535&d,P=d>>>16&65535,F=0;g!==0;){g-=F=g>2e3?2e3:g;do P=P+(I=I+m[w++]|0)|0;while(--F);I%=65521,P%=65521}return I|P<<16}),adler32_1}function requireCrc32(){if(hasRequiredCrc32)return crc32_1;hasRequiredCrc32=1;var d=function(){for(var m,g=[],w=0;w<256;w++){m=w;for(var I=0;I<8;I++)m=1&m?3988292384^m>>>1:m>>>1;g[w]=m}return g}();return crc32_1=function(m,g,w,I){var P=d,F=I+w;m^=-1;for(var $=I;$<F;$++)m=m>>>8^P[255&(m^g[$])];return~m},crc32_1}function requireMessages(){return hasRequiredMessages?messages:(hasRequiredMessages=1,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"})}function requireDeflate$1(){if(hasRequiredDeflate$1)return deflate;hasRequiredDeflate$1=1;var d,m=requireCommon(),g=requireTrees(),w=requireAdler32(),I=requireCrc32(),P=requireMessages(),F=0,$=4,D=0,U=-2,Z=-1,j=4,G=2,H=8,W=9,Q=286,q=30,rt=19,it=2*Q+1,X=15,J=3,tt=258,ot=tt+J+1,nt=42,lt=103,at=113,ut=666,V=1,ht=2,vt=3,pt=4;function st(et,It){return et.msg=P[It],It}function ct(et){return(et<<1)-(et>4?9:0)}function At(et){for(var It=et.length;--It>=0;)et[It]=0}function kt(et){var It=et.state,mt=It.pending;mt>et.avail_out&&(mt=et.avail_out),mt!==0&&(m.arraySet(et.output,It.pending_buf,It.pending_out,mt,et.next_out),et.next_out+=mt,It.pending_out+=mt,et.total_out+=mt,et.avail_out-=mt,It.pending-=mt,It.pending===0&&(It.pending_out=0))}function yt(et,It){g._tr_flush_block(et,et.block_start>=0?et.block_start:-1,et.strstart-et.block_start,It),et.block_start=et.strstart,kt(et.strm)}function Ct(et,It){et.pending_buf[et.pending++]=It}function xt(et,It){et.pending_buf[et.pending++]=It>>>8&255,et.pending_buf[et.pending++]=255&It}function Pt(et,It){var mt,gt,_t=et.max_chain_length,Et=et.strstart,zt=et.prev_length,K=et.nice_match,ft=et.strstart>et.w_size-ot?et.strstart-(et.w_size-ot):0,bt=et.window,wt=et.w_mask,Lt=et.prev,jt=et.strstart+tt,Kt=bt[Et+zt-1],te=bt[Et+zt];et.prev_length>=et.good_match&&(_t>>=2),K>et.lookahead&&(K=et.lookahead);do if(bt[(mt=It)+zt]===te&&bt[mt+zt-1]===Kt&&bt[mt]===bt[Et]&&bt[++mt]===bt[Et+1]){Et+=2,mt++;do;while(bt[++Et]===bt[++mt]&&bt[++Et]===bt[++mt]&&bt[++Et]===bt[++mt]&&bt[++Et]===bt[++mt]&&bt[++Et]===bt[++mt]&&bt[++Et]===bt[++mt]&&bt[++Et]===bt[++mt]&&bt[++Et]===bt[++mt]&&Et<jt);if(gt=tt-(jt-Et),Et=jt-tt,gt>zt){if(et.match_start=It,zt=gt,gt>=K)break;Kt=bt[Et+zt-1],te=bt[Et+zt]}}while((It=Lt[It&wt])>ft&&--_t!=0);return zt<=et.lookahead?zt:et.lookahead}function Ft(et){var It,mt,gt,_t,Et,zt,K,ft,bt,wt,Lt=et.w_size;do{if(_t=et.window_size-et.lookahead-et.strstart,et.strstart>=Lt+(Lt-ot)){m.arraySet(et.window,et.window,Lt,Lt,0),et.match_start-=Lt,et.strstart-=Lt,et.block_start-=Lt,It=mt=et.hash_size;do gt=et.head[--It],et.head[It]=gt>=Lt?gt-Lt:0;while(--mt);It=mt=Lt;do gt=et.prev[--It],et.prev[It]=gt>=Lt?gt-Lt:0;while(--mt);_t+=Lt}if(et.strm.avail_in===0)break;if(zt=et.strm,K=et.window,ft=et.strstart+et.lookahead,bt=_t,wt=void 0,(wt=zt.avail_in)>bt&&(wt=bt),mt=wt===0?0:(zt.avail_in-=wt,m.arraySet(K,zt.input,zt.next_in,wt,ft),zt.state.wrap===1?zt.adler=w(zt.adler,K,wt,ft):zt.state.wrap===2&&(zt.adler=I(zt.adler,K,wt,ft)),zt.next_in+=wt,zt.total_in+=wt,wt),et.lookahead+=mt,et.lookahead+et.insert>=J)for(Et=et.strstart-et.insert,et.ins_h=et.window[Et],et.ins_h=(et.ins_h<<et.hash_shift^et.window[Et+1])&et.hash_mask;et.insert&&(et.ins_h=(et.ins_h<<et.hash_shift^et.window[Et+J-1])&et.hash_mask,et.prev[Et&et.w_mask]=et.head[et.ins_h],et.head[et.ins_h]=Et,Et++,et.insert--,!(et.lookahead+et.insert<J)););}while(et.lookahead<ot&&et.strm.avail_in!==0)}function Rt(et,It){for(var mt,gt;;){if(et.lookahead<ot){if(Ft(et),et.lookahead<ot&&It===F)return V;if(et.lookahead===0)break}if(mt=0,et.lookahead>=J&&(et.ins_h=(et.ins_h<<et.hash_shift^et.window[et.strstart+J-1])&et.hash_mask,mt=et.prev[et.strstart&et.w_mask]=et.head[et.ins_h],et.head[et.ins_h]=et.strstart),mt!==0&&et.strstart-mt<=et.w_size-ot&&(et.match_length=Pt(et,mt)),et.match_length>=J)if(gt=g._tr_tally(et,et.strstart-et.match_start,et.match_length-J),et.lookahead-=et.match_length,et.match_length<=et.max_lazy_match&&et.lookahead>=J){et.match_length--;do et.strstart++,et.ins_h=(et.ins_h<<et.hash_shift^et.window[et.strstart+J-1])&et.hash_mask,mt=et.prev[et.strstart&et.w_mask]=et.head[et.ins_h],et.head[et.ins_h]=et.strstart;while(--et.match_length!=0);et.strstart++}else et.strstart+=et.match_length,et.match_length=0,et.ins_h=et.window[et.strstart],et.ins_h=(et.ins_h<<et.hash_shift^et.window[et.strstart+1])&et.hash_mask;else gt=g._tr_tally(et,0,et.window[et.strstart]),et.lookahead--,et.strstart++;if(gt&&(yt(et,!1),et.strm.avail_out===0))return V}return et.insert=et.strstart<J-1?et.strstart:J-1,It===$?(yt(et,!0),et.strm.avail_out===0?vt:pt):et.last_lit&&(yt(et,!1),et.strm.avail_out===0)?V:ht}function Mt(et,It){for(var mt,gt,_t;;){if(et.lookahead<ot){if(Ft(et),et.lookahead<ot&&It===F)return V;if(et.lookahead===0)break}if(mt=0,et.lookahead>=J&&(et.ins_h=(et.ins_h<<et.hash_shift^et.window[et.strstart+J-1])&et.hash_mask,mt=et.prev[et.strstart&et.w_mask]=et.head[et.ins_h],et.head[et.ins_h]=et.strstart),et.prev_length=et.match_length,et.prev_match=et.match_start,et.match_length=J-1,mt!==0&&et.prev_length<et.max_lazy_match&&et.strstart-mt<=et.w_size-ot&&(et.match_length=Pt(et,mt),et.match_length<=5&&(et.strategy===1||et.match_length===J&&et.strstart-et.match_start>4096)&&(et.match_length=J-1)),et.prev_length>=J&&et.match_length<=et.prev_length){_t=et.strstart+et.lookahead-J,gt=g._tr_tally(et,et.strstart-1-et.prev_match,et.prev_length-J),et.lookahead-=et.prev_length-1,et.prev_length-=2;do++et.strstart<=_t&&(et.ins_h=(et.ins_h<<et.hash_shift^et.window[et.strstart+J-1])&et.hash_mask,mt=et.prev[et.strstart&et.w_mask]=et.head[et.ins_h],et.head[et.ins_h]=et.strstart);while(--et.prev_length!=0);if(et.match_available=0,et.match_length=J-1,et.strstart++,gt&&(yt(et,!1),et.strm.avail_out===0))return V}else if(et.match_available){if((gt=g._tr_tally(et,0,et.window[et.strstart-1]))&&yt(et,!1),et.strstart++,et.lookahead--,et.strm.avail_out===0)return V}else et.match_available=1,et.strstart++,et.lookahead--}return et.match_available&&(gt=g._tr_tally(et,0,et.window[et.strstart-1]),et.match_available=0),et.insert=et.strstart<J-1?et.strstart:J-1,It===$?(yt(et,!0),et.strm.avail_out===0?vt:pt):et.last_lit&&(yt(et,!1),et.strm.avail_out===0)?V:ht}function Bt(et,It,mt,gt,_t){this.good_length=et,this.max_lazy=It,this.nice_length=mt,this.max_chain=gt,this.func=_t}function $t(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=H,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new m.Buf16(2*it),this.dyn_dtree=new m.Buf16(2*(2*q+1)),this.bl_tree=new m.Buf16(2*(2*rt+1)),At(this.dyn_ltree),At(this.dyn_dtree),At(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new m.Buf16(X+1),this.heap=new m.Buf16(2*Q+1),At(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new m.Buf16(2*Q+1),At(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Ot(et){var It;return et&&et.state?(et.total_in=et.total_out=0,et.data_type=G,(It=et.state).pending=0,It.pending_out=0,It.wrap<0&&(It.wrap=-It.wrap),It.status=It.wrap?nt:at,et.adler=It.wrap===2?0:1,It.last_flush=F,g._tr_init(It),D):st(et,U)}function Zt(et){var It=Ot(et);return It===D&&function(mt){mt.window_size=2*mt.w_size,At(mt.head),mt.max_lazy_match=d[mt.level].max_lazy,mt.good_match=d[mt.level].good_length,mt.nice_match=d[mt.level].nice_length,mt.max_chain_length=d[mt.level].max_chain,mt.strstart=0,mt.block_start=0,mt.lookahead=0,mt.insert=0,mt.match_length=mt.prev_length=J-1,mt.match_available=0,mt.ins_h=0}(et.state),It}function Tt(et,It,mt,gt,_t,Et){if(!et)return U;var zt=1;if(It===Z&&(It=6),gt<0?(zt=0,gt=-gt):gt>15&&(zt=2,gt-=16),_t<1||_t>W||mt!==H||gt<8||gt>15||It<0||It>9||Et<0||Et>j)return st(et,U);gt===8&&(gt=9);var K=new $t;return et.state=K,K.strm=et,K.wrap=zt,K.gzhead=null,K.w_bits=gt,K.w_size=1<<K.w_bits,K.w_mask=K.w_size-1,K.hash_bits=_t+7,K.hash_size=1<<K.hash_bits,K.hash_mask=K.hash_size-1,K.hash_shift=~~((K.hash_bits+J-1)/J),K.window=new m.Buf8(2*K.w_size),K.head=new m.Buf16(K.hash_size),K.prev=new m.Buf16(K.w_size),K.lit_bufsize=1<<_t+6,K.pending_buf_size=4*K.lit_bufsize,K.pending_buf=new m.Buf8(K.pending_buf_size),K.d_buf=1*K.lit_bufsize,K.l_buf=3*K.lit_bufsize,K.level=It,K.strategy=Et,K.method=mt,Zt(et)}return d=[new Bt(0,0,0,0,function(et,It){var mt=65535;for(mt>et.pending_buf_size-5&&(mt=et.pending_buf_size-5);;){if(et.lookahead<=1){if(Ft(et),et.lookahead===0&&It===F)return V;if(et.lookahead===0)break}et.strstart+=et.lookahead,et.lookahead=0;var gt=et.block_start+mt;if((et.strstart===0||et.strstart>=gt)&&(et.lookahead=et.strstart-gt,et.strstart=gt,yt(et,!1),et.strm.avail_out===0)||et.strstart-et.block_start>=et.w_size-ot&&(yt(et,!1),et.strm.avail_out===0))return V}return et.insert=0,It===$?(yt(et,!0),et.strm.avail_out===0?vt:pt):(et.strstart>et.block_start&&(yt(et,!1),et.strm.avail_out),V)}),new Bt(4,4,8,4,Rt),new Bt(4,5,16,8,Rt),new Bt(4,6,32,32,Rt),new Bt(4,4,16,16,Mt),new Bt(8,16,32,32,Mt),new Bt(8,16,128,128,Mt),new Bt(8,32,128,256,Mt),new Bt(32,128,258,1024,Mt),new Bt(32,258,258,4096,Mt)],deflate.deflateInit=function(et,It){return Tt(et,It,H,15,8,0)},deflate.deflateInit2=Tt,deflate.deflateReset=Zt,deflate.deflateResetKeep=Ot,deflate.deflateSetHeader=function(et,It){return et&&et.state?et.state.wrap!==2?U:(et.state.gzhead=It,D):U},deflate.deflate=function(et,It){var mt,gt,_t,Et;if(!et||!et.state||It>5||It<0)return et?st(et,U):U;if(gt=et.state,!et.output||!et.input&&et.avail_in!==0||gt.status===ut&&It!==$)return st(et,et.avail_out===0?-5:U);if(gt.strm=et,mt=gt.last_flush,gt.last_flush=It,gt.status===nt)if(gt.wrap===2)et.adler=0,Ct(gt,31),Ct(gt,139),Ct(gt,8),gt.gzhead?(Ct(gt,(gt.gzhead.text?1:0)+(gt.gzhead.hcrc?2:0)+(gt.gzhead.extra?4:0)+(gt.gzhead.name?8:0)+(gt.gzhead.comment?16:0)),Ct(gt,255&gt.gzhead.time),Ct(gt,gt.gzhead.time>>8&255),Ct(gt,gt.gzhead.time>>16&255),Ct(gt,gt.gzhead.time>>24&255),Ct(gt,gt.level===9?2:gt.strategy>=2||gt.level<2?4:0),Ct(gt,255&gt.gzhead.os),gt.gzhead.extra&&gt.gzhead.extra.length&&(Ct(gt,255&gt.gzhead.extra.length),Ct(gt,gt.gzhead.extra.length>>8&255)),gt.gzhead.hcrc&&(et.adler=I(et.adler,gt.pending_buf,gt.pending,0)),gt.gzindex=0,gt.status=69):(Ct(gt,0),Ct(gt,0),Ct(gt,0),Ct(gt,0),Ct(gt,0),Ct(gt,gt.level===9?2:gt.strategy>=2||gt.level<2?4:0),Ct(gt,3),gt.status=at);else{var zt=H+(gt.w_bits-8<<4)<<8;zt|=(gt.strategy>=2||gt.level<2?0:gt.level<6?1:gt.level===6?2:3)<<6,gt.strstart!==0&&(zt|=32),zt+=31-zt%31,gt.status=at,xt(gt,zt),gt.strstart!==0&&(xt(gt,et.adler>>>16),xt(gt,65535&et.adler)),et.adler=1}if(gt.status===69)if(gt.gzhead.extra){for(_t=gt.pending;gt.gzindex<(65535&gt.gzhead.extra.length)&&(gt.pending!==gt.pending_buf_size||(gt.gzhead.hcrc&&gt.pending>_t&&(et.adler=I(et.adler,gt.pending_buf,gt.pending-_t,_t)),kt(et),_t=gt.pending,gt.pending!==gt.pending_buf_size));)Ct(gt,255&gt.gzhead.extra[gt.gzindex]),gt.gzindex++;gt.gzhead.hcrc&&gt.pending>_t&&(et.adler=I(et.adler,gt.pending_buf,gt.pending-_t,_t)),gt.gzindex===gt.gzhead.extra.length&&(gt.gzindex=0,gt.status=73)}else gt.status=73;if(gt.status===73)if(gt.gzhead.name){_t=gt.pending;do{if(gt.pending===gt.pending_buf_size&&(gt.gzhead.hcrc&&gt.pending>_t&&(et.adler=I(et.adler,gt.pending_buf,gt.pending-_t,_t)),kt(et),_t=gt.pending,gt.pending===gt.pending_buf_size)){Et=1;break}Et=gt.gzindex<gt.gzhead.name.length?255&gt.gzhead.name.charCodeAt(gt.gzindex++):0,Ct(gt,Et)}while(Et!==0);gt.gzhead.hcrc&&gt.pending>_t&&(et.adler=I(et.adler,gt.pending_buf,gt.pending-_t,_t)),Et===0&&(gt.gzindex=0,gt.status=91)}else gt.status=91;if(gt.status===91)if(gt.gzhead.comment){_t=gt.pending;do{if(gt.pending===gt.pending_buf_size&&(gt.gzhead.hcrc&&gt.pending>_t&&(et.adler=I(et.adler,gt.pending_buf,gt.pending-_t,_t)),kt(et),_t=gt.pending,gt.pending===gt.pending_buf_size)){Et=1;break}Et=gt.gzindex<gt.gzhead.comment.length?255&gt.gzhead.comment.charCodeAt(gt.gzindex++):0,Ct(gt,Et)}while(Et!==0);gt.gzhead.hcrc&&gt.pending>_t&&(et.adler=I(et.adler,gt.pending_buf,gt.pending-_t,_t)),Et===0&&(gt.status=lt)}else gt.status=lt;if(gt.status===lt&&(gt.gzhead.hcrc?(gt.pending+2>gt.pending_buf_size&&kt(et),gt.pending+2<=gt.pending_buf_size&&(Ct(gt,255&et.adler),Ct(gt,et.adler>>8&255),et.adler=0,gt.status=at)):gt.status=at),gt.pending!==0){if(kt(et),et.avail_out===0)return gt.last_flush=-1,D}else if(et.avail_in===0&&ct(It)<=ct(mt)&&It!==$)return st(et,-5);if(gt.status===ut&&et.avail_in!==0)return st(et,-5);if(et.avail_in!==0||gt.lookahead!==0||It!==F&&gt.status!==ut){var K=gt.strategy===2?function(ft,bt){for(var wt;;){if(ft.lookahead===0&&(Ft(ft),ft.lookahead===0)){if(bt===F)return V;break}if(ft.match_length=0,wt=g._tr_tally(ft,0,ft.window[ft.strstart]),ft.lookahead--,ft.strstart++,wt&&(yt(ft,!1),ft.strm.avail_out===0))return V}return ft.insert=0,bt===$?(yt(ft,!0),ft.strm.avail_out===0?vt:pt):ft.last_lit&&(yt(ft,!1),ft.strm.avail_out===0)?V:ht}(gt,It):gt.strategy===3?function(ft,bt){for(var wt,Lt,jt,Kt,te=ft.window;;){if(ft.lookahead<=tt){if(Ft(ft),ft.lookahead<=tt&&bt===F)return V;if(ft.lookahead===0)break}if(ft.match_length=0,ft.lookahead>=J&&ft.strstart>0&&(Lt=te[jt=ft.strstart-1])===te[++jt]&&Lt===te[++jt]&&Lt===te[++jt]){Kt=ft.strstart+tt;do;while(Lt===te[++jt]&&Lt===te[++jt]&&Lt===te[++jt]&&Lt===te[++jt]&&Lt===te[++jt]&&Lt===te[++jt]&&Lt===te[++jt]&&Lt===te[++jt]&&jt<Kt);ft.match_length=tt-(Kt-jt),ft.match_length>ft.lookahead&&(ft.match_length=ft.lookahead)}if(ft.match_length>=J?(wt=g._tr_tally(ft,1,ft.match_length-J),ft.lookahead-=ft.match_length,ft.strstart+=ft.match_length,ft.match_length=0):(wt=g._tr_tally(ft,0,ft.window[ft.strstart]),ft.lookahead--,ft.strstart++),wt&&(yt(ft,!1),ft.strm.avail_out===0))return V}return ft.insert=0,bt===$?(yt(ft,!0),ft.strm.avail_out===0?vt:pt):ft.last_lit&&(yt(ft,!1),ft.strm.avail_out===0)?V:ht}(gt,It):d[gt.level].func(gt,It);if(K!==vt&&K!==pt||(gt.status=ut),K===V||K===vt)return et.avail_out===0&&(gt.last_flush=-1),D;if(K===ht&&(It===1?g._tr_align(gt):It!==5&&(g._tr_stored_block(gt,0,0,!1),It===3&&(At(gt.head),gt.lookahead===0&&(gt.strstart=0,gt.block_start=0,gt.insert=0))),kt(et),et.avail_out===0))return gt.last_flush=-1,D}return It!==$?D:gt.wrap<=0?1:(gt.wrap===2?(Ct(gt,255&et.adler),Ct(gt,et.adler>>8&255),Ct(gt,et.adler>>16&255),Ct(gt,et.adler>>24&255),Ct(gt,255&et.total_in),Ct(gt,et.total_in>>8&255),Ct(gt,et.total_in>>16&255),Ct(gt,et.total_in>>24&255)):(xt(gt,et.adler>>>16),xt(gt,65535&et.adler)),kt(et),gt.wrap>0&&(gt.wrap=-gt.wrap),gt.pending!==0?D:1)},deflate.deflateEnd=function(et){var It;return et&&et.state?(It=et.state.status)!==nt&&It!==69&&It!==73&&It!==91&&It!==lt&&It!==at&&It!==ut?st(et,U):(et.state=null,It===at?st(et,-3):D):U},deflate.deflateSetDictionary=function(et,It){var mt,gt,_t,Et,zt,K,ft,bt,wt=It.length;if(!et||!et.state||(Et=(mt=et.state).wrap)===2||Et===1&&mt.status!==nt||mt.lookahead)return U;for(Et===1&&(et.adler=w(et.adler,It,wt,0)),mt.wrap=0,wt>=mt.w_size&&(Et===0&&(At(mt.head),mt.strstart=0,mt.block_start=0,mt.insert=0),bt=new m.Buf8(mt.w_size),m.arraySet(bt,It,wt-mt.w_size,mt.w_size,0),It=bt,wt=mt.w_size),zt=et.avail_in,K=et.next_in,ft=et.input,et.avail_in=wt,et.next_in=0,et.input=It,Ft(mt);mt.lookahead>=J;){gt=mt.strstart,_t=mt.lookahead-(J-1);do mt.ins_h=(mt.ins_h<<mt.hash_shift^mt.window[gt+J-1])&mt.hash_mask,mt.prev[gt&mt.w_mask]=mt.head[mt.ins_h],mt.head[mt.ins_h]=gt,gt++;while(--_t);mt.strstart=gt,mt.lookahead=J-1,Ft(mt)}return mt.strstart+=mt.lookahead,mt.block_start=mt.strstart,mt.insert=mt.lookahead,mt.lookahead=0,mt.match_length=mt.prev_length=J-1,mt.match_available=0,et.next_in=K,et.input=ft,et.avail_in=zt,mt.wrap=Et,D},deflate.deflateInfo="pako deflate (from Nodeca project)",deflate}var strings={},hasRequiredStrings,zstream,hasRequiredZstream,hasRequiredDeflate;function requireStrings(){if(hasRequiredStrings)return strings;hasRequiredStrings=1;var d=requireCommon(),m=!0,g=!0;try{String.fromCharCode.apply(null,[0])}catch{m=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{g=!1}for(var w=new d.Buf8(256),I=0;I<256;I++)w[I]=I>=252?6:I>=248?5:I>=240?4:I>=224?3:I>=192?2:1;function P(F,$){if($<65534&&(F.subarray&&g||!F.subarray&&m))return String.fromCharCode.apply(null,d.shrinkBuf(F,$));for(var D="",U=0;U<$;U++)D+=String.fromCharCode(F[U]);return D}return w[254]=w[254]=1,strings.string2buf=function(F){var $,D,U,Z,j,G=F.length,H=0;for(Z=0;Z<G;Z++)(64512&(D=F.charCodeAt(Z)))==55296&&Z+1<G&&(64512&(U=F.charCodeAt(Z+1)))==56320&&(D=65536+(D-55296<<10)+(U-56320),Z++),H+=D<128?1:D<2048?2:D<65536?3:4;for($=new d.Buf8(H),j=0,Z=0;j<H;Z++)(64512&(D=F.charCodeAt(Z)))==55296&&Z+1<G&&(64512&(U=F.charCodeAt(Z+1)))==56320&&(D=65536+(D-55296<<10)+(U-56320),Z++),D<128?$[j++]=D:D<2048?($[j++]=192|D>>>6,$[j++]=128|63&D):D<65536?($[j++]=224|D>>>12,$[j++]=128|D>>>6&63,$[j++]=128|63&D):($[j++]=240|D>>>18,$[j++]=128|D>>>12&63,$[j++]=128|D>>>6&63,$[j++]=128|63&D);return $},strings.buf2binstring=function(F){return P(F,F.length)},strings.binstring2buf=function(F){for(var $=new d.Buf8(F.length),D=0,U=$.length;D<U;D++)$[D]=F.charCodeAt(D);return $},strings.buf2string=function(F,$){var D,U,Z,j,G=$||F.length,H=new Array(2*G);for(U=0,D=0;D<G;)if((Z=F[D++])<128)H[U++]=Z;else if((j=w[Z])>4)H[U++]=65533,D+=j-1;else{for(Z&=j===2?31:j===3?15:7;j>1&&D<G;)Z=Z<<6|63&F[D++],j--;j>1?H[U++]=65533:Z<65536?H[U++]=Z:(Z-=65536,H[U++]=55296|Z>>10&1023,H[U++]=56320|1023&Z)}return P(H,U)},strings.utf8border=function(F,$){var D;for(($=$||F.length)>F.length&&($=F.length),D=$-1;D>=0&&(192&F[D])==128;)D--;return D<0||D===0?$:D+w[F[D]]>$?D:$},strings}function requireZstream(){return hasRequiredZstream?zstream:(hasRequiredZstream=1,zstream=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0})}function requireDeflate(){if(hasRequiredDeflate)return deflate$1;hasRequiredDeflate=1;var d=requireDeflate$1(),m=requireCommon(),g=requireStrings(),w=requireMessages(),I=requireZstream(),P=Object.prototype.toString,F=0,$=-1,D=0,U=8;function Z(G){if(!(this instanceof Z))return new Z(G);this.options=m.assign({level:$,method:U,chunkSize:16384,windowBits:15,memLevel:8,strategy:D,to:""},G||{});var H=this.options;H.raw&&H.windowBits>0?H.windowBits=-H.windowBits:H.gzip&&H.windowBits>0&&H.windowBits<16&&(H.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new I,this.strm.avail_out=0;var W=d.deflateInit2(this.strm,H.level,H.method,H.windowBits,H.memLevel,H.strategy);if(W!==F)throw new Error(w[W]);if(H.header&&d.deflateSetHeader(this.strm,H.header),H.dictionary){var Q;if(Q=typeof H.dictionary=="string"?g.string2buf(H.dictionary):P.call(H.dictionary)==="[object ArrayBuffer]"?new Uint8Array(H.dictionary):H.dictionary,(W=d.deflateSetDictionary(this.strm,Q))!==F)throw new Error(w[W]);this._dict_set=!0}}function j(G,H){var W=new Z(H);if(W.push(G,!0),W.err)throw W.msg||w[W.err];return W.result}return Z.prototype.push=function(G,H){var W,Q,q=this.strm,rt=this.options.chunkSize;if(this.ended)return!1;Q=H===~~H?H:H===!0?4:0,typeof G=="string"?q.input=g.string2buf(G):P.call(G)==="[object ArrayBuffer]"?q.input=new Uint8Array(G):q.input=G,q.next_in=0,q.avail_in=q.input.length;do{if(q.avail_out===0&&(q.output=new m.Buf8(rt),q.next_out=0,q.avail_out=rt),(W=d.deflate(q,Q))!==1&&W!==F)return this.onEnd(W),this.ended=!0,!1;q.avail_out!==0&&(q.avail_in!==0||Q!==4&&Q!==2)||(this.options.to==="string"?this.onData(g.buf2binstring(m.shrinkBuf(q.output,q.next_out))):this.onData(m.shrinkBuf(q.output,q.next_out)))}while((q.avail_in>0||q.avail_out===0)&&W!==1);return Q===4?(W=d.deflateEnd(this.strm),this.onEnd(W),this.ended=!0,W===F):Q!==2||(this.onEnd(F),q.avail_out=0,!0)},Z.prototype.onData=function(G){this.chunks.push(G)},Z.prototype.onEnd=function(G){G===F&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=m.flattenChunks(this.chunks)),this.chunks=[],this.err=G,this.msg=this.strm.msg},deflate$1.Deflate=Z,deflate$1.deflate=j,deflate$1.deflateRaw=function(G,H){return(H=H||{}).raw=!0,j(G,H)},deflate$1.gzip=function(G,H){return(H=H||{}).gzip=!0,j(G,H)},deflate$1}var inflate$1={},inflate={},inffast,hasRequiredInffast,inftrees,hasRequiredInftrees,hasRequiredInflate$1,constants,hasRequiredConstants,gzheader,hasRequiredGzheader,hasRequiredInflate,pako_1,hasRequiredPako;function requireInffast(){return hasRequiredInffast?inffast:(hasRequiredInffast=1,inffast=function(d,m){var g,w,I,P,F,$,D,U,Z,j,G,H,W,Q,q,rt,it,X,J,tt,ot,nt,lt,at,ut;g=d.state,w=d.next_in,at=d.input,I=w+(d.avail_in-5),P=d.next_out,ut=d.output,F=P-(m-d.avail_out),$=P+(d.avail_out-257),D=g.dmax,U=g.wsize,Z=g.whave,j=g.wnext,G=g.window,H=g.hold,W=g.bits,Q=g.lencode,q=g.distcode,rt=(1<<g.lenbits)-1,it=(1<<g.distbits)-1;t:do{W<15&&(H+=at[w++]<<W,W+=8,H+=at[w++]<<W,W+=8),X=Q[H&rt];e:for(;;){if(H>>>=J=X>>>24,W-=J,(J=X>>>16&255)===0)ut[P++]=65535&X;else{if(!(16&J)){if(64&J){if(32&J){g.mode=12;break t}d.msg="invalid literal/length code",g.mode=30;break t}X=Q[(65535&X)+(H&(1<<J)-1)];continue e}for(tt=65535&X,(J&=15)&&(W<J&&(H+=at[w++]<<W,W+=8),tt+=H&(1<<J)-1,H>>>=J,W-=J),W<15&&(H+=at[w++]<<W,W+=8,H+=at[w++]<<W,W+=8),X=q[H&it];;){if(H>>>=J=X>>>24,W-=J,16&(J=X>>>16&255)){if(ot=65535&X,W<(J&=15)&&(H+=at[w++]<<W,(W+=8)<J&&(H+=at[w++]<<W,W+=8)),(ot+=H&(1<<J)-1)>D){d.msg="invalid distance too far back",g.mode=30;break t}if(H>>>=J,W-=J,ot>(J=P-F)){if((J=ot-J)>Z&&g.sane){d.msg="invalid distance too far back",g.mode=30;break t}if(nt=0,lt=G,j===0){if(nt+=U-J,J<tt){tt-=J;do ut[P++]=G[nt++];while(--J);nt=P-ot,lt=ut}}else if(j<J){if(nt+=U+j-J,(J-=j)<tt){tt-=J;do ut[P++]=G[nt++];while(--J);if(nt=0,j<tt){tt-=J=j;do ut[P++]=G[nt++];while(--J);nt=P-ot,lt=ut}}}else if(nt+=j-J,J<tt){tt-=J;do ut[P++]=G[nt++];while(--J);nt=P-ot,lt=ut}for(;tt>2;)ut[P++]=lt[nt++],ut[P++]=lt[nt++],ut[P++]=lt[nt++],tt-=3;tt&&(ut[P++]=lt[nt++],tt>1&&(ut[P++]=lt[nt++]))}else{nt=P-ot;do ut[P++]=ut[nt++],ut[P++]=ut[nt++],ut[P++]=ut[nt++],tt-=3;while(tt>2);tt&&(ut[P++]=ut[nt++],tt>1&&(ut[P++]=ut[nt++]))}break}if(64&J){d.msg="invalid distance code",g.mode=30;break t}X=q[(65535&X)+(H&(1<<J)-1)]}}break}}while(w<I&&P<$);w-=tt=W>>3,H&=(1<<(W-=tt<<3))-1,d.next_in=w,d.next_out=P,d.avail_in=w<I?I-w+5:5-(w-I),d.avail_out=P<$?$-P+257:257-(P-$),g.hold=H,g.bits=W},inffast)}function requireInftrees(){if(hasRequiredInftrees)return inftrees;hasRequiredInftrees=1;var d=requireCommon(),m=15,g=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],w=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],I=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],P=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return inftrees=function(F,$,D,U,Z,j,G,H){var W,Q,q,rt,it,X,J,tt,ot,nt=H.bits,lt=0,at=0,ut=0,V=0,ht=0,vt=0,pt=0,st=0,ct=0,At=0,kt=null,yt=0,Ct=new d.Buf16(16),xt=new d.Buf16(16),Pt=null,Ft=0;for(lt=0;lt<=m;lt++)Ct[lt]=0;for(at=0;at<U;at++)Ct[$[D+at]]++;for(ht=nt,V=m;V>=1&&Ct[V]===0;V--);if(ht>V&&(ht=V),V===0)return Z[j++]=20971520,Z[j++]=20971520,H.bits=1,0;for(ut=1;ut<V&&Ct[ut]===0;ut++);for(ht<ut&&(ht=ut),st=1,lt=1;lt<=m;lt++)if(st<<=1,(st-=Ct[lt])<0)return-1;if(st>0&&(F===0||V!==1))return-1;for(xt[1]=0,lt=1;lt<m;lt++)xt[lt+1]=xt[lt]+Ct[lt];for(at=0;at<U;at++)$[D+at]!==0&&(G[xt[$[D+at]]++]=at);if(F===0?(kt=Pt=G,X=19):F===1?(kt=g,yt-=257,Pt=w,Ft-=257,X=256):(kt=I,Pt=P,X=-1),At=0,at=0,lt=ut,it=j,vt=ht,pt=0,q=-1,rt=(ct=1<<ht)-1,F===1&&ct>852||F===2&&ct>592)return 1;for(;;){J=lt-pt,G[at]<X?(tt=0,ot=G[at]):G[at]>X?(tt=Pt[Ft+G[at]],ot=kt[yt+G[at]]):(tt=96,ot=0),W=1<<lt-pt,ut=Q=1<<vt;do Z[it+(At>>pt)+(Q-=W)]=J<<24|tt<<16|ot;while(Q!==0);for(W=1<<lt-1;At&W;)W>>=1;if(W!==0?(At&=W-1,At+=W):At=0,at++,--Ct[lt]==0){if(lt===V)break;lt=$[D+G[at]]}if(lt>ht&&(At&rt)!==q){for(pt===0&&(pt=ht),it+=ut,st=1<<(vt=lt-pt);vt+pt<V&&!((st-=Ct[vt+pt])<=0);)vt++,st<<=1;if(ct+=1<<vt,F===1&&ct>852||F===2&&ct>592)return 1;Z[q=At&rt]=ht<<24|vt<<16|it-j}}return At!==0&&(Z[it+At]=lt-pt<<24|64<<16),H.bits=ht,0}}function requireInflate$1(){if(hasRequiredInflate$1)return inflate;hasRequiredInflate$1=1;var d=requireCommon(),m=requireAdler32(),g=requireCrc32(),w=requireInffast(),I=requireInftrees(),P=1,F=2,$=0,D=-2,U=1,Z=12,j=30,G=852,H=592;function W(at){return(at>>>24&255)+(at>>>8&65280)+((65280&at)<<8)+((255&at)<<24)}function Q(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new d.Buf16(320),this.work=new d.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function q(at){var ut;return at&&at.state?(ut=at.state,at.total_in=at.total_out=ut.total=0,at.msg="",ut.wrap&&(at.adler=1&ut.wrap),ut.mode=U,ut.last=0,ut.havedict=0,ut.dmax=32768,ut.head=null,ut.hold=0,ut.bits=0,ut.lencode=ut.lendyn=new d.Buf32(G),ut.distcode=ut.distdyn=new d.Buf32(H),ut.sane=1,ut.back=-1,$):D}function rt(at){var ut;return at&&at.state?((ut=at.state).wsize=0,ut.whave=0,ut.wnext=0,q(at)):D}function it(at,ut){var V,ht;return at&&at.state?(ht=at.state,ut<0?(V=0,ut=-ut):(V=1+(ut>>4),ut<48&&(ut&=15)),ut&&(ut<8||ut>15)?D:(ht.window!==null&&ht.wbits!==ut&&(ht.window=null),ht.wrap=V,ht.wbits=ut,rt(at))):D}function X(at,ut){var V,ht;return at?(ht=new Q,at.state=ht,ht.window=null,(V=it(at,ut))!==$&&(at.state=null),V):D}var J,tt,ot=!0;function nt(at){if(ot){var ut;for(J=new d.Buf32(512),tt=new d.Buf32(32),ut=0;ut<144;)at.lens[ut++]=8;for(;ut<256;)at.lens[ut++]=9;for(;ut<280;)at.lens[ut++]=7;for(;ut<288;)at.lens[ut++]=8;for(I(P,at.lens,0,288,J,0,at.work,{bits:9}),ut=0;ut<32;)at.lens[ut++]=5;I(F,at.lens,0,32,tt,0,at.work,{bits:5}),ot=!1}at.lencode=J,at.lenbits=9,at.distcode=tt,at.distbits=5}function lt(at,ut,V,ht){var vt,pt=at.state;return pt.window===null&&(pt.wsize=1<<pt.wbits,pt.wnext=0,pt.whave=0,pt.window=new d.Buf8(pt.wsize)),ht>=pt.wsize?(d.arraySet(pt.window,ut,V-pt.wsize,pt.wsize,0),pt.wnext=0,pt.whave=pt.wsize):((vt=pt.wsize-pt.wnext)>ht&&(vt=ht),d.arraySet(pt.window,ut,V-ht,vt,pt.wnext),(ht-=vt)?(d.arraySet(pt.window,ut,V-ht,ht,0),pt.wnext=ht,pt.whave=pt.wsize):(pt.wnext+=vt,pt.wnext===pt.wsize&&(pt.wnext=0),pt.whave<pt.wsize&&(pt.whave+=vt))),0}return inflate.inflateReset=rt,inflate.inflateReset2=it,inflate.inflateResetKeep=q,inflate.inflateInit=function(at){return X(at,15)},inflate.inflateInit2=X,inflate.inflate=function(at,ut){var V,ht,vt,pt,st,ct,At,kt,yt,Ct,xt,Pt,Ft,Rt,Mt,Bt,$t,Ot,Zt,Tt,et,It,mt,gt,_t=0,Et=new d.Buf8(4),zt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!at||!at.state||!at.output||!at.input&&at.avail_in!==0)return D;(V=at.state).mode===Z&&(V.mode=13),st=at.next_out,vt=at.output,At=at.avail_out,pt=at.next_in,ht=at.input,ct=at.avail_in,kt=V.hold,yt=V.bits,Ct=ct,xt=At,It=$;t:for(;;)switch(V.mode){case U:if(V.wrap===0){V.mode=13;break}for(;yt<16;){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}if(2&V.wrap&&kt===35615){V.check=0,Et[0]=255&kt,Et[1]=kt>>>8&255,V.check=g(V.check,Et,2,0),kt=0,yt=0,V.mode=2;break}if(V.flags=0,V.head&&(V.head.done=!1),!(1&V.wrap)||(((255&kt)<<8)+(kt>>8))%31){at.msg="incorrect header check",V.mode=j;break}if((15&kt)!=8){at.msg="unknown compression method",V.mode=j;break}if(yt-=4,et=8+(15&(kt>>>=4)),V.wbits===0)V.wbits=et;else if(et>V.wbits){at.msg="invalid window size",V.mode=j;break}V.dmax=1<<et,at.adler=V.check=1,V.mode=512&kt?10:Z,kt=0,yt=0;break;case 2:for(;yt<16;){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}if(V.flags=kt,(255&V.flags)!=8){at.msg="unknown compression method",V.mode=j;break}if(57344&V.flags){at.msg="unknown header flags set",V.mode=j;break}V.head&&(V.head.text=kt>>8&1),512&V.flags&&(Et[0]=255&kt,Et[1]=kt>>>8&255,V.check=g(V.check,Et,2,0)),kt=0,yt=0,V.mode=3;case 3:for(;yt<32;){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}V.head&&(V.head.time=kt),512&V.flags&&(Et[0]=255&kt,Et[1]=kt>>>8&255,Et[2]=kt>>>16&255,Et[3]=kt>>>24&255,V.check=g(V.check,Et,4,0)),kt=0,yt=0,V.mode=4;case 4:for(;yt<16;){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}V.head&&(V.head.xflags=255&kt,V.head.os=kt>>8),512&V.flags&&(Et[0]=255&kt,Et[1]=kt>>>8&255,V.check=g(V.check,Et,2,0)),kt=0,yt=0,V.mode=5;case 5:if(1024&V.flags){for(;yt<16;){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}V.length=kt,V.head&&(V.head.extra_len=kt),512&V.flags&&(Et[0]=255&kt,Et[1]=kt>>>8&255,V.check=g(V.check,Et,2,0)),kt=0,yt=0}else V.head&&(V.head.extra=null);V.mode=6;case 6:if(1024&V.flags&&((Pt=V.length)>ct&&(Pt=ct),Pt&&(V.head&&(et=V.head.extra_len-V.length,V.head.extra||(V.head.extra=new Array(V.head.extra_len)),d.arraySet(V.head.extra,ht,pt,Pt,et)),512&V.flags&&(V.check=g(V.check,ht,Pt,pt)),ct-=Pt,pt+=Pt,V.length-=Pt),V.length))break t;V.length=0,V.mode=7;case 7:if(2048&V.flags){if(ct===0)break t;Pt=0;do et=ht[pt+Pt++],V.head&&et&&V.length<65536&&(V.head.name+=String.fromCharCode(et));while(et&&Pt<ct);if(512&V.flags&&(V.check=g(V.check,ht,Pt,pt)),ct-=Pt,pt+=Pt,et)break t}else V.head&&(V.head.name=null);V.length=0,V.mode=8;case 8:if(4096&V.flags){if(ct===0)break t;Pt=0;do et=ht[pt+Pt++],V.head&&et&&V.length<65536&&(V.head.comment+=String.fromCharCode(et));while(et&&Pt<ct);if(512&V.flags&&(V.check=g(V.check,ht,Pt,pt)),ct-=Pt,pt+=Pt,et)break t}else V.head&&(V.head.comment=null);V.mode=9;case 9:if(512&V.flags){for(;yt<16;){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}if(kt!==(65535&V.check)){at.msg="header crc mismatch",V.mode=j;break}kt=0,yt=0}V.head&&(V.head.hcrc=V.flags>>9&1,V.head.done=!0),at.adler=V.check=0,V.mode=Z;break;case 10:for(;yt<32;){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}at.adler=V.check=W(kt),kt=0,yt=0,V.mode=11;case 11:if(V.havedict===0)return at.next_out=st,at.avail_out=At,at.next_in=pt,at.avail_in=ct,V.hold=kt,V.bits=yt,2;at.adler=V.check=1,V.mode=Z;case Z:if(ut===5||ut===6)break t;case 13:if(V.last){kt>>>=7&yt,yt-=7&yt,V.mode=27;break}for(;yt<3;){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}switch(V.last=1&kt,yt-=1,3&(kt>>>=1)){case 0:V.mode=14;break;case 1:if(nt(V),V.mode=20,ut===6){kt>>>=2,yt-=2;break t}break;case 2:V.mode=17;break;case 3:at.msg="invalid block type",V.mode=j}kt>>>=2,yt-=2;break;case 14:for(kt>>>=7&yt,yt-=7&yt;yt<32;){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}if((65535&kt)!=(kt>>>16^65535)){at.msg="invalid stored block lengths",V.mode=j;break}if(V.length=65535&kt,kt=0,yt=0,V.mode=15,ut===6)break t;case 15:V.mode=16;case 16:if(Pt=V.length){if(Pt>ct&&(Pt=ct),Pt>At&&(Pt=At),Pt===0)break t;d.arraySet(vt,ht,pt,Pt,st),ct-=Pt,pt+=Pt,At-=Pt,st+=Pt,V.length-=Pt;break}V.mode=Z;break;case 17:for(;yt<14;){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}if(V.nlen=257+(31&kt),kt>>>=5,yt-=5,V.ndist=1+(31&kt),kt>>>=5,yt-=5,V.ncode=4+(15&kt),kt>>>=4,yt-=4,V.nlen>286||V.ndist>30){at.msg="too many length or distance symbols",V.mode=j;break}V.have=0,V.mode=18;case 18:for(;V.have<V.ncode;){for(;yt<3;){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}V.lens[zt[V.have++]]=7&kt,kt>>>=3,yt-=3}for(;V.have<19;)V.lens[zt[V.have++]]=0;if(V.lencode=V.lendyn,V.lenbits=7,mt={bits:V.lenbits},It=I(0,V.lens,0,19,V.lencode,0,V.work,mt),V.lenbits=mt.bits,It){at.msg="invalid code lengths set",V.mode=j;break}V.have=0,V.mode=19;case 19:for(;V.have<V.nlen+V.ndist;){for(;Bt=(_t=V.lencode[kt&(1<<V.lenbits)-1])>>>16&255,$t=65535&_t,!((Mt=_t>>>24)<=yt);){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}if($t<16)kt>>>=Mt,yt-=Mt,V.lens[V.have++]=$t;else{if($t===16){for(gt=Mt+2;yt<gt;){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}if(kt>>>=Mt,yt-=Mt,V.have===0){at.msg="invalid bit length repeat",V.mode=j;break}et=V.lens[V.have-1],Pt=3+(3&kt),kt>>>=2,yt-=2}else if($t===17){for(gt=Mt+3;yt<gt;){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}yt-=Mt,et=0,Pt=3+(7&(kt>>>=Mt)),kt>>>=3,yt-=3}else{for(gt=Mt+7;yt<gt;){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}yt-=Mt,et=0,Pt=11+(127&(kt>>>=Mt)),kt>>>=7,yt-=7}if(V.have+Pt>V.nlen+V.ndist){at.msg="invalid bit length repeat",V.mode=j;break}for(;Pt--;)V.lens[V.have++]=et}}if(V.mode===j)break;if(V.lens[256]===0){at.msg="invalid code -- missing end-of-block",V.mode=j;break}if(V.lenbits=9,mt={bits:V.lenbits},It=I(P,V.lens,0,V.nlen,V.lencode,0,V.work,mt),V.lenbits=mt.bits,It){at.msg="invalid literal/lengths set",V.mode=j;break}if(V.distbits=6,V.distcode=V.distdyn,mt={bits:V.distbits},It=I(F,V.lens,V.nlen,V.ndist,V.distcode,0,V.work,mt),V.distbits=mt.bits,It){at.msg="invalid distances set",V.mode=j;break}if(V.mode=20,ut===6)break t;case 20:V.mode=21;case 21:if(ct>=6&&At>=258){at.next_out=st,at.avail_out=At,at.next_in=pt,at.avail_in=ct,V.hold=kt,V.bits=yt,w(at,xt),st=at.next_out,vt=at.output,At=at.avail_out,pt=at.next_in,ht=at.input,ct=at.avail_in,kt=V.hold,yt=V.bits,V.mode===Z&&(V.back=-1);break}for(V.back=0;Bt=(_t=V.lencode[kt&(1<<V.lenbits)-1])>>>16&255,$t=65535&_t,!((Mt=_t>>>24)<=yt);){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}if(Bt&&!(240&Bt)){for(Ot=Mt,Zt=Bt,Tt=$t;Bt=(_t=V.lencode[Tt+((kt&(1<<Ot+Zt)-1)>>Ot)])>>>16&255,$t=65535&_t,!(Ot+(Mt=_t>>>24)<=yt);){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}kt>>>=Ot,yt-=Ot,V.back+=Ot}if(kt>>>=Mt,yt-=Mt,V.back+=Mt,V.length=$t,Bt===0){V.mode=26;break}if(32&Bt){V.back=-1,V.mode=Z;break}if(64&Bt){at.msg="invalid literal/length code",V.mode=j;break}V.extra=15&Bt,V.mode=22;case 22:if(V.extra){for(gt=V.extra;yt<gt;){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}V.length+=kt&(1<<V.extra)-1,kt>>>=V.extra,yt-=V.extra,V.back+=V.extra}V.was=V.length,V.mode=23;case 23:for(;Bt=(_t=V.distcode[kt&(1<<V.distbits)-1])>>>16&255,$t=65535&_t,!((Mt=_t>>>24)<=yt);){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}if(!(240&Bt)){for(Ot=Mt,Zt=Bt,Tt=$t;Bt=(_t=V.distcode[Tt+((kt&(1<<Ot+Zt)-1)>>Ot)])>>>16&255,$t=65535&_t,!(Ot+(Mt=_t>>>24)<=yt);){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}kt>>>=Ot,yt-=Ot,V.back+=Ot}if(kt>>>=Mt,yt-=Mt,V.back+=Mt,64&Bt){at.msg="invalid distance code",V.mode=j;break}V.offset=$t,V.extra=15&Bt,V.mode=24;case 24:if(V.extra){for(gt=V.extra;yt<gt;){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}V.offset+=kt&(1<<V.extra)-1,kt>>>=V.extra,yt-=V.extra,V.back+=V.extra}if(V.offset>V.dmax){at.msg="invalid distance too far back",V.mode=j;break}V.mode=25;case 25:if(At===0)break t;if(Pt=xt-At,V.offset>Pt){if((Pt=V.offset-Pt)>V.whave&&V.sane){at.msg="invalid distance too far back",V.mode=j;break}Pt>V.wnext?(Pt-=V.wnext,Ft=V.wsize-Pt):Ft=V.wnext-Pt,Pt>V.length&&(Pt=V.length),Rt=V.window}else Rt=vt,Ft=st-V.offset,Pt=V.length;Pt>At&&(Pt=At),At-=Pt,V.length-=Pt;do vt[st++]=Rt[Ft++];while(--Pt);V.length===0&&(V.mode=21);break;case 26:if(At===0)break t;vt[st++]=V.length,At--,V.mode=21;break;case 27:if(V.wrap){for(;yt<32;){if(ct===0)break t;ct--,kt|=ht[pt++]<<yt,yt+=8}if(xt-=At,at.total_out+=xt,V.total+=xt,xt&&(at.adler=V.check=V.flags?g(V.check,vt,xt,st-xt):m(V.check,vt,xt,st-xt)),xt=At,(V.flags?kt:W(kt))!==V.check){at.msg="incorrect data check",V.mode=j;break}kt=0,yt=0}V.mode=28;case 28:if(V.wrap&&V.flags){for(;yt<32;){if(ct===0)break t;ct--,kt+=ht[pt++]<<yt,yt+=8}if(kt!==(4294967295&V.total)){at.msg="incorrect length check",V.mode=j;break}kt=0,yt=0}V.mode=29;case 29:It=1;break t;case j:It=-3;break t;case 31:return-4;default:return D}return at.next_out=st,at.avail_out=At,at.next_in=pt,at.avail_in=ct,V.hold=kt,V.bits=yt,(V.wsize||xt!==at.avail_out&&V.mode<j&&(V.mode<27||ut!==4))&&lt(at,at.output,at.next_out,xt-at.avail_out),Ct-=at.avail_in,xt-=at.avail_out,at.total_in+=Ct,at.total_out+=xt,V.total+=xt,V.wrap&&xt&&(at.adler=V.check=V.flags?g(V.check,vt,xt,at.next_out-xt):m(V.check,vt,xt,at.next_out-xt)),at.data_type=V.bits+(V.last?64:0)+(V.mode===Z?128:0)+(V.mode===20||V.mode===15?256:0),(Ct===0&&xt===0||ut===4)&&It===$&&(It=-5),It},inflate.inflateEnd=function(at){if(!at||!at.state)return D;var ut=at.state;return ut.window&&(ut.window=null),at.state=null,$},inflate.inflateGetHeader=function(at,ut){var V;return at&&at.state&&2&(V=at.state).wrap?(V.head=ut,ut.done=!1,$):D},inflate.inflateSetDictionary=function(at,ut){var V,ht=ut.length;return at&&at.state?(V=at.state).wrap!==0&&V.mode!==11?D:V.mode===11&&m(1,ut,ht,0)!==V.check?-3:lt(at,ut,ht,ht)?(V.mode=31,-4):(V.havedict=1,$):D},inflate.inflateInfo="pako inflate (from Nodeca project)",inflate}function requireConstants(){return hasRequiredConstants?constants:(hasRequiredConstants=1,constants={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8})}function requireGzheader(){return hasRequiredGzheader?gzheader:(hasRequiredGzheader=1,gzheader=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1})}function requireInflate(){if(hasRequiredInflate)return inflate$1;hasRequiredInflate=1;var d=requireInflate$1(),m=requireCommon(),g=requireStrings(),w=requireConstants(),I=requireMessages(),P=requireZstream(),F=requireGzheader(),$=Object.prototype.toString;function D(Z){if(!(this instanceof D))return new D(Z);this.options=m.assign({chunkSize:16384,windowBits:0,to:""},Z||{});var j=this.options;j.raw&&j.windowBits>=0&&j.windowBits<16&&(j.windowBits=-j.windowBits,j.windowBits===0&&(j.windowBits=-15)),!(j.windowBits>=0&&j.windowBits<16)||Z&&Z.windowBits||(j.windowBits+=32),j.windowBits>15&&j.windowBits<48&&(15&j.windowBits||(j.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new P,this.strm.avail_out=0;var G=d.inflateInit2(this.strm,j.windowBits);if(G!==w.Z_OK)throw new Error(I[G]);if(this.header=new F,d.inflateGetHeader(this.strm,this.header),j.dictionary&&(typeof j.dictionary=="string"?j.dictionary=g.string2buf(j.dictionary):$.call(j.dictionary)==="[object ArrayBuffer]"&&(j.dictionary=new Uint8Array(j.dictionary)),j.raw&&(G=d.inflateSetDictionary(this.strm,j.dictionary))!==w.Z_OK))throw new Error(I[G])}function U(Z,j){var G=new D(j);if(G.push(Z,!0),G.err)throw G.msg||I[G.err];return G.result}return D.prototype.push=function(Z,j){var G,H,W,Q,q,rt=this.strm,it=this.options.chunkSize,X=this.options.dictionary,J=!1;if(this.ended)return!1;H=j===~~j?j:j===!0?w.Z_FINISH:w.Z_NO_FLUSH,typeof Z=="string"?rt.input=g.binstring2buf(Z):$.call(Z)==="[object ArrayBuffer]"?rt.input=new Uint8Array(Z):rt.input=Z,rt.next_in=0,rt.avail_in=rt.input.length;do{if(rt.avail_out===0&&(rt.output=new m.Buf8(it),rt.next_out=0,rt.avail_out=it),(G=d.inflate(rt,w.Z_NO_FLUSH))===w.Z_NEED_DICT&&X&&(G=d.inflateSetDictionary(this.strm,X)),G===w.Z_BUF_ERROR&&J===!0&&(G=w.Z_OK,J=!1),G!==w.Z_STREAM_END&&G!==w.Z_OK)return this.onEnd(G),this.ended=!0,!1;rt.next_out&&(rt.avail_out!==0&&G!==w.Z_STREAM_END&&(rt.avail_in!==0||H!==w.Z_FINISH&&H!==w.Z_SYNC_FLUSH)||(this.options.to==="string"?(W=g.utf8border(rt.output,rt.next_out),Q=rt.next_out-W,q=g.buf2string(rt.output,W),rt.next_out=Q,rt.avail_out=it-Q,Q&&m.arraySet(rt.output,rt.output,W,Q,0),this.onData(q)):this.onData(m.shrinkBuf(rt.output,rt.next_out)))),rt.avail_in===0&&rt.avail_out===0&&(J=!0)}while((rt.avail_in>0||rt.avail_out===0)&&G!==w.Z_STREAM_END);return G===w.Z_STREAM_END&&(H=w.Z_FINISH),H===w.Z_FINISH?(G=d.inflateEnd(this.strm),this.onEnd(G),this.ended=!0,G===w.Z_OK):H!==w.Z_SYNC_FLUSH||(this.onEnd(w.Z_OK),rt.avail_out=0,!0)},D.prototype.onData=function(Z){this.chunks.push(Z)},D.prototype.onEnd=function(Z){Z===w.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=m.flattenChunks(this.chunks)),this.chunks=[],this.err=Z,this.msg=this.strm.msg},inflate$1.Inflate=D,inflate$1.inflate=U,inflate$1.inflateRaw=function(Z,j){return(j=j||{}).raw=!0,U(Z,j)},inflate$1.ungzip=U,inflate$1}function requirePako(){if(hasRequiredPako)return pako_1;hasRequiredPako=1;var d={};return(0,requireCommon().assign)(d,requireDeflate(),requireInflate(),requireConstants()),pako_1=d}(function(d){(function(){var m={};function g(){typeof process<"u"||console.log.apply(console,arguments)}d.exports=m,function(w,I){(function(){var P=function(){function D(U){this.message="JPEG error: "+U}return D.prototype=new Error,D.prototype.name="JpegError",D.constructor=D,D}(),F=function(){var D=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),U=4017,Z=799,j=3406,G=2276,H=1567,W=3784,Q=5793,q=2896;function rt(lt){lt==null&&(lt={}),lt.w==null&&(lt.w=-1),this.V=lt.n,this.N=lt.w}function it(lt,at){for(var ut,V,ht,vt=0,pt=[],st=16;st>0&&!lt[st-1];)st--;pt.push({children:[],index:0});var ct=pt[0];for(ut=0;ut<st;ut++){for(V=0;V<lt[ut];V++){for((ct=pt.pop()).children[ct.index]=at[vt];ct.index>0;)ct=pt.pop();for(ct.index++,pt.push(ct);pt.length<=ut;)pt.push(ht={children:[],index:0}),ct.children[ct.index]=ht.children,ct=ht;vt++}ut+1<st&&(pt.push(ht={children:[],index:0}),ct.children[ct.index]=ht.children,ct=ht)}return pt[0].children}function X(lt,at,ut){return 64*((lt.P+1)*at+ut)}function J(lt,at,ut,V,ht,vt,pt,st,ct,At){At==null&&(At=!1);var kt,yt,Ct,xt,Pt,Ft,Rt,Mt,Bt,$t,Ot,Zt=ut.m,Tt=ut.Z,et=at,It=0,mt=0,gt=0,_t=0,Et=0,zt=0;function K(){if(mt>0)return mt--,It>>mt&1;if((It=lt[at++])===255){var Vt=lt[at++];if(Vt){if(Vt===220&&At){var ee=$(lt,at+=2);if(at+=2,ee>0&&ee!==ut.s)throw new DNLMarkerError("Found DNL marker (0xFFDC) while parsing scan data",ee)}else if(Vt===217){if(At){var Jt=8*Et;if(Jt>0&&Jt<ut.s/10)throw new DNLMarkerError("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",Jt)}throw new EOIMarkerError("Found EOI marker (0xFFD9) while parsing scan data")}throw new P("unexpected marker")}}return mt=7,It>>>7}function ft(Vt){for(var ee=Vt;;){switch(typeof(ee=ee[K()])){case"number":return ee;case"object":continue}throw new P("invalid huffman sequence")}}function bt(Vt){for(var ee=0;Vt>0;)ee=ee<<1|K(),Vt--;return ee}function wt(Vt){if(Vt===1)return K()===1?1:-1;var ee=bt(Vt);return ee>=1<<Vt-1?ee:ee+(-1<<Vt)+1}function Lt(Vt,ee,Jt,oe,ne){var ae=Jt%Zt;Et=(Jt/Zt|0)*Vt.A+oe;var fe=ae*Vt.h+ne;ee(Vt,X(Vt,Et,fe))}function jt(Vt,ee,Jt){Et=Jt/Vt.P|0;var oe=Jt%Vt.P;ee(Vt,X(Vt,Et,oe))}var Kt=V.length;for(Rt=Tt?vt===0?st===0?function(Vt,ee){var Jt=ft(Vt.J),oe=Jt===0?0:wt(Jt)<<ct;Vt.D[ee]=Vt.Q+=oe}:function(Vt,ee){Vt.D[ee]|=K()<<ct}:st===0?function(Vt,ee){if(gt>0)gt--;else for(var Jt=vt,oe=pt;Jt<=oe;){var ne=ft(Vt.i),ae=15&ne,fe=ne>>4;if(ae!==0){var ie=D[Jt+=fe];Vt.D[ee+ie]=wt(ae)*(1<<ct),Jt++}else{if(fe<15){gt=bt(fe)+(1<<fe)-1;break}Jt+=16}}}:function(Vt,ee){for(var Jt,oe,ne=vt,ae=pt,fe=0;ne<=ae;){var ie=ee+D[ne],Nt=Vt.D[ie]<0?-1:1;switch(_t){case 0:if(fe=(oe=ft(Vt.i))>>4,(Jt=15&oe)==0)fe<15?(gt=bt(fe)+(1<<fe),_t=4):(fe=16,_t=1);else{if(Jt!==1)throw new P("invalid ACn encoding");kt=wt(Jt),_t=fe?2:3}continue;case 1:case 2:Vt.D[ie]?Vt.D[ie]+=Nt*(K()<<ct):--fe==0&&(_t=_t===2?3:0);break;case 3:Vt.D[ie]?Vt.D[ie]+=Nt*(K()<<ct):(Vt.D[ie]=kt<<ct,_t=0);break;case 4:Vt.D[ie]&&(Vt.D[ie]+=Nt*(K()<<ct))}ne++}_t===4&&--gt==0&&(_t=0)}:function(Vt,ee){var Jt=ft(Vt.J),oe=Jt===0?0:wt(Jt),ne=1;for(Vt.D[ee]=Vt.Q+=oe;ne<64;){var ae=ft(Vt.i),fe=15&ae,ie=ae>>4;if(fe!==0){var Nt=D[ne+=ie];Vt.D[ee+Nt]=wt(fe),ne++}else{if(ie<15)break;ne+=16}}},Bt=Kt===1?V[0].P*V[0].c:Zt*ut.R;zt<=Bt;){var te=ht?Math.min(Bt-zt,ht):Bt;if(te>0){for(Ct=0;Ct<Kt;Ct++)V[Ct].Q=0;if(gt=0,Kt===1)for(yt=V[0],Ft=0;Ft<te;Ft++)jt(yt,Rt,zt),zt++;else for(Ft=0;Ft<te;Ft++){for(Ct=0;Ct<Kt;Ct++)for($t=(yt=V[Ct]).h,Ot=yt.A,xt=0;xt<Ot;xt++)for(Pt=0;Pt<$t;Pt++)Lt(yt,Rt,zt,xt,Pt);zt++}}if(mt=0,!(Mt=nt(lt,at))||(Mt.u&&(at=Mt.offset),!(Mt.M>=65488&&Mt.M<=65495)))break;at+=2}return at-et}function tt(lt,at,ut){var V,ht,vt,pt,st,ct,At,kt,yt,Ct,xt,Pt,Ft,Rt,Mt,Bt,$t,Ot=lt.$,Zt=lt.D;if(!Ot)throw new P("missing required Quantization Table.");for(var Tt=0;Tt<64;Tt+=8)yt=Zt[at+Tt],Ct=Zt[at+Tt+1],xt=Zt[at+Tt+2],Pt=Zt[at+Tt+3],Ft=Zt[at+Tt+4],Rt=Zt[at+Tt+5],Mt=Zt[at+Tt+6],Bt=Zt[at+Tt+7],yt*=Ot[Tt],Ct|xt|Pt|Ft|Rt|Mt|Bt?(Ct*=Ot[Tt+1],xt*=Ot[Tt+2],Pt*=Ot[Tt+3],Ft*=Ot[Tt+4],Rt*=Ot[Tt+5],Mt*=Ot[Tt+6],Bt*=Ot[Tt+7],ht=(V=(V=Q*yt+128>>8)+(ht=Q*Ft+128>>8)+1>>1)-ht,$t=(vt=xt)*W+(pt=Mt)*H+128>>8,vt=vt*H-pt*W+128>>8,At=(st=(st=q*(Ct-Bt)+128>>8)+(At=Rt<<4)+1>>1)-At,ct=(kt=(kt=q*(Ct+Bt)+128>>8)+(ct=Pt<<4)+1>>1)-ct,pt=(V=V+(pt=$t)+1>>1)-pt,vt=(ht=ht+vt+1>>1)-vt,$t=st*G+kt*j+2048>>12,st=st*j-kt*G+2048>>12,kt=$t,$t=ct*Z+At*U+2048>>12,ct=ct*U-At*Z+2048>>12,At=$t,ut[Tt]=V+kt,ut[Tt+7]=V-kt,ut[Tt+1]=ht+At,ut[Tt+6]=ht-At,ut[Tt+2]=vt+ct,ut[Tt+5]=vt-ct,ut[Tt+3]=pt+st,ut[Tt+4]=pt-st):($t=Q*yt+512>>10,ut[Tt]=$t,ut[Tt+1]=$t,ut[Tt+2]=$t,ut[Tt+3]=$t,ut[Tt+4]=$t,ut[Tt+5]=$t,ut[Tt+6]=$t,ut[Tt+7]=$t);for(var et=0;et<8;++et)yt=ut[et],(Ct=ut[et+8])|(xt=ut[et+16])|(Pt=ut[et+24])|(Ft=ut[et+32])|(Rt=ut[et+40])|(Mt=ut[et+48])|(Bt=ut[et+56])?(ht=(V=4112+((V=Q*yt+2048>>12)+(ht=Q*Ft+2048>>12)+1>>1))-ht,$t=(vt=xt)*W+(pt=Mt)*H+2048>>12,vt=vt*H-pt*W+2048>>12,pt=$t,At=(st=(st=q*(Ct-Bt)+2048>>12)+(At=Rt)+1>>1)-At,ct=(kt=(kt=q*(Ct+Bt)+2048>>12)+(ct=Pt)+1>>1)-ct,$t=st*G+kt*j+2048>>12,st=st*j-kt*G+2048>>12,kt=$t,$t=ct*Z+At*U+2048>>12,ct=ct*U-At*Z+2048>>12,(yt=(V=V+pt+1>>1)+kt)<16?yt=0:yt>=4080?yt=255:yt>>=4,(Ct=(ht=ht+vt+1>>1)+(At=$t))<16?Ct=0:Ct>=4080?Ct=255:Ct>>=4,(xt=(vt=ht-vt)+ct)<16?xt=0:xt>=4080?xt=255:xt>>=4,(Pt=(pt=V-pt)+st)<16?Pt=0:Pt>=4080?Pt=255:Pt>>=4,(Ft=pt-st)<16?Ft=0:Ft>=4080?Ft=255:Ft>>=4,(Rt=vt-ct)<16?Rt=0:Rt>=4080?Rt=255:Rt>>=4,(Mt=ht-At)<16?Mt=0:Mt>=4080?Mt=255:Mt>>=4,(Bt=V-kt)<16?Bt=0:Bt>=4080?Bt=255:Bt>>=4,Zt[at+et]=yt,Zt[at+et+8]=Ct,Zt[at+et+16]=xt,Zt[at+et+24]=Pt,Zt[at+et+32]=Ft,Zt[at+et+40]=Rt,Zt[at+et+48]=Mt,Zt[at+et+56]=Bt):($t=($t=Q*yt+8192>>14)<-2040?0:$t>=2024?255:$t+2056>>4,Zt[at+et]=$t,Zt[at+et+8]=$t,Zt[at+et+16]=$t,Zt[at+et+24]=$t,Zt[at+et+32]=$t,Zt[at+et+40]=$t,Zt[at+et+48]=$t,Zt[at+et+56]=$t)}function ot(lt,at){for(var ut=at.P,V=at.c,ht=new Int16Array(64),vt=0;vt<V;vt++)for(var pt=0;pt<ut;pt++)tt(at,X(at,vt,pt),ht);return at.D}function nt(lt,at,ut){ut==null&&(ut=at);var V=lt.length-1,ht=ut<at?ut:at;if(at>=V)return null;var vt=$(lt,at);if(vt>=65472&&vt<=65534)return{u:null,M:vt,offset:at};for(var pt=$(lt,ht);!(pt>=65472&&pt<=65534);){if(++ht>=V)return null;pt=$(lt,ht)}return{u:vt.toString(16),M:pt,offset:ht}}return rt.prototype={parse(lt,at){at==null&&(at={});var ut,V,ht=at.F,vt=0,pt=null,st=null,ct=0;function At(){var Ut=$(lt,vt),Qt=(vt+=2)+Ut-2,St=nt(lt,Qt,vt);St&&St.u&&(Qt=St.offset);var Yt=lt.subarray(vt,Qt);return vt+=Yt.length,Yt}function kt(Ut){for(var Qt=Math.ceil(Ut.o/8/Ut.X),St=Math.ceil(Ut.s/8/Ut.B),Yt=0;Yt<Ut.W.length;Yt++){jt=Ut.W[Yt];var ue=Math.ceil(Math.ceil(Ut.o/8)*jt.h/Ut.X),dt=Math.ceil(Math.ceil(Ut.s/8)*jt.A/Ut.B),qt=Qt*jt.h,Gt=64*(St*jt.A)*(qt+1);jt.D=new Int16Array(Gt),jt.P=ue,jt.c=dt}Ut.m=Qt,Ut.R=St}var yt=[],Ct=[],xt=[],Pt=$(lt,vt);if(vt+=2,Pt!==65496)throw new P("SOI not found");Pt=$(lt,vt),vt+=2;t:for(;Pt!==65497;){var Ft,Rt,Mt;switch(Pt){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var Bt=At();Pt===65504&&Bt[0]===74&&Bt[1]===70&&Bt[2]===73&&Bt[3]===70&&Bt[4]===0&&(pt={version:{d:Bt[5],T:Bt[6]},K:Bt[7],j:Bt[8]<<8|Bt[9],H:Bt[10]<<8|Bt[11],S:Bt[12],I:Bt[13],C:Bt.subarray(14,14+3*Bt[12]*Bt[13])}),Pt===65518&&Bt[0]===65&&Bt[1]===100&&Bt[2]===111&&Bt[3]===98&&Bt[4]===101&&(st={version:Bt[5]<<8|Bt[6],k:Bt[7]<<8|Bt[8],q:Bt[9]<<8|Bt[10],a:Bt[11]});break;case 65499:for(var $t=$(lt,vt)+(vt+=2)-2;vt<$t;){var Ot=lt[vt++],Zt=new Uint16Array(64);if(Ot>>4){if(Ot>>4!=1)throw new P("DQT - invalid table spec");for(Rt=0;Rt<64;Rt++)Zt[D[Rt]]=$(lt,vt),vt+=2}else for(Rt=0;Rt<64;Rt++)Zt[D[Rt]]=lt[vt++];yt[15&Ot]=Zt}break;case 65472:case 65473:case 65474:if(ut)throw new P("Only single frame JPEGs supported");vt+=2,(ut={}).G=Pt===65473,ut.Z=Pt===65474,ut.precision=lt[vt++];var Tt,et=$(lt,vt),It=0,mt=0;vt+=2,ut.s=ht||et,ut.o=$(lt,vt),vt+=2,ut.W=[],ut._={};var gt=lt[vt++];for(Ft=0;Ft<gt;Ft++){Tt=lt[vt];var _t=lt[vt+1]>>4,Et=15&lt[vt+1];It<_t&&(It=_t),mt<Et&&(mt=Et);var zt=lt[vt+2];Mt=ut.W.push({h:_t,A:Et,L:zt,$:null}),ut._[Tt]=Mt-1,vt+=3}ut.X=It,ut.B=mt,kt(ut);break;case 65476:var K=$(lt,vt);for(vt+=2,Ft=2;Ft<K;){var ft=lt[vt++],bt=new Uint8Array(16),wt=0;for(Rt=0;Rt<16;Rt++,vt++)wt+=bt[Rt]=lt[vt];var Lt=new Uint8Array(wt);for(Rt=0;Rt<wt;Rt++,vt++)Lt[Rt]=lt[vt];Ft+=17+wt,(ft>>4?Ct:xt)[15&ft]=it(bt,Lt)}break;case 65501:V=$(lt,vt+=2),vt+=2;break;case 65498:var jt,Kt=++ct==1&&!ht;vt+=2;var te=lt[vt++],Vt=[];for(Ft=0;Ft<te;Ft++){var ee=lt[vt++],Jt=ut._[ee];(jt=ut.W[Jt]).index=ee;var oe=lt[vt++];jt.J=xt[oe>>4],jt.i=Ct[15&oe],Vt.push(jt)}var ne=lt[vt++],ae=lt[vt++],fe=lt[vt++];try{var ie=J(lt,vt,ut,Vt,V,ne,ae,fe>>4,15&fe,Kt);vt+=ie}catch(Ut){if(Ut instanceof DNLMarkerError)return this.parse(lt,{F:Ut.s});if(Ut instanceof EOIMarkerError)break t;throw Ut}break;case 65500:vt+=4;break;case 65535:lt[vt]!==255&&vt--;break;default:var Nt=nt(lt,vt-2,vt-3);if(Nt&&Nt.u){vt=Nt.offset;break}if(vt>=lt.length-1)break t;throw new P("JpegImage.parse - unknown marker: "+Pt.toString(16))}Pt=$(lt,vt),vt+=2}for(this.width=ut.o,this.height=ut.s,this.g=pt,this.b=st,this.W=[],Ft=0;Ft<ut.W.length;Ft++){var Xt=yt[(jt=ut.W[Ft]).L];Xt&&(jt.$=Xt),this.W.push({index:jt.index,e:ot(0,jt),l:jt.h/ut.X,t:jt.A/ut.B,P:jt.P,c:jt.c})}this.p=this.W.length},Y(lt,at,ut){ut==null&&(ut=!1);var V,ht,vt,pt,st,ct,At,kt,yt,Ct,xt,Pt,Ft=this.width/lt,Rt=this.height/at,Mt=0,Bt=this.W.length,$t=lt*at*Bt,Ot=new Uint8ClampedArray($t),Zt=new Uint32Array(lt),Tt=4294967288;for(At=0;At<Bt;At++){if(ht=(V=this.W[At]).l*Ft,vt=V.t*Rt,Mt=At,xt=V.e,pt=V.P+1<<3,ht!==Pt){for(st=0;st<lt;st++)kt=0|st*ht,Zt[st]=(kt&Tt)<<3|7&kt;Pt=ht}for(ct=0;ct<at;ct++)for(Ct=pt*((kt=0|ct*vt)&Tt)|(7&kt)<<3,st=0;st<lt;st++)Ot[Mt]=xt[Ct+Zt[st]],Mt+=Bt}var et=this.V;if(ut||Bt!==4||et||(et=new Int32Array([-256,255,-256,255,-256,255,-256,255])),et)for(At=0;At<$t;)for(kt=0,yt=0;kt<Bt;kt++,At++,yt+=2)Ot[At]=(Ot[At]*et[yt]>>8)+et[yt+1];return Ot},get f(){return this.b?!!this.b.a:this.p===3?this.N!==0&&(this.W[0].index!==82||this.W[1].index!==71||this.W[2].index!==66):this.N===1},z:function(lt){for(var at,ut,V,ht=0,vt=lt.length;ht<vt;ht+=3)at=lt[ht],ut=lt[ht+1],V=lt[ht+2],lt[ht]=at-179.456+1.402*V,lt[ht+1]=at+135.459-.344*ut-.714*V,lt[ht+2]=at-226.816+1.772*ut;return lt},O:function(lt){for(var at,ut,V,ht,vt=0,pt=0,st=lt.length;pt<st;pt+=4)at=lt[pt],ut=lt[pt+1],V=lt[pt+2],ht=lt[pt+3],lt[vt++]=ut*(-660635669420364e-19*ut+.000437130475926232*V-54080610064599e-18*at+.00048449797120281*ht-.154362151871126)-122.67195406894+V*(-.000957964378445773*V+.000817076911346625*at-.00477271405408747*ht+1.53380253221734)+at*(.000961250184130688*at-.00266257332283933*ht+.48357088451265)+ht*(-.000336197177618394*ht+.484791561490776),lt[vt++]=107.268039397724+ut*(219927104525741e-19*ut-.000640992018297945*V+.000659397001245577*at+.000426105652938837*ht-.176491792462875)+V*(-.000778269941513683*V+.00130872261408275*at+.000770482631801132*ht-.151051492775562)+at*(.00126935368114843*at-.00265090189010898*ht+.25802910206845)+ht*(-.000318913117588328*ht-.213742400323665),lt[vt++]=ut*(-.000570115196973677*ut-263409051004589e-19*V+.0020741088115012*at-.00288260236853442*ht+.814272968359295)-20.810012546947+V*(-153496057440975e-19*V-.000132689043961446*at+.000560833691242812*ht-.195152027534049)+at*(.00174418132927582*at-.00255243321439347*ht+.116935020465145)+ht*(-.000343531996510555*ht+.24165260232407);return lt.subarray(0,vt)},r:function(lt){for(var at,ut,V,ht=0,vt=lt.length;ht<vt;ht+=4)at=lt[ht],ut=lt[ht+1],V=lt[ht+2],lt[ht]=434.456-at-1.402*V,lt[ht+1]=119.541-at+.344*ut+.714*V,lt[ht+2]=481.816-at-1.772*ut;return lt},U:function(lt){for(var at,ut,V,ht,vt=0,pt=0,st=lt.length;pt<st;pt+=4)at=lt[pt],ut=lt[pt+1],V=lt[pt+2],ht=lt[pt+3],lt[vt++]=255+at*(-6747147073602441e-20*at+.0008379262121013727*ut+.0002894718188643294*V+.003264231057537806*ht-1.1185611867203937)+ut*(26374107616089405e-21*ut-8626949158638572e-20*V-.0002748769067499491*ht-.02155688794978967)+V*(-3878099212869363e-20*V-.0003267808279485286*ht+.0686742238595345)-ht*(.0003361971776183937*ht+.7430659151342254),lt[vt++]=255+at*(.00013596372813588848*at+.000924537132573585*ut+.00010567359618683593*V+.0004791864687436512*ht-.3109689587515875)+ut*(-.00023545346108370344*ut+.0002702845253534714*V+.0020200308977307156*ht-.7488052167015494)+V*(6834815998235662e-20*V+.00015168452363460973*ht-.09751927774728933)-ht*(.0003189131175883281*ht+.7364883807733168),lt[vt++]=255+at*(13598650411385307e-21*at+.00012423956175490851*ut+.0004751985097583589*V-36729317476630422e-22*ht-.05562186980264034)+ut*(.00016141380598724676*ut+.0009692239130725186*V+.0007782692450036253*ht-.44015232367526463)+V*(5068882914068769e-22*V+.0017778369011375071*ht-.7591454649749609)-ht*(.0003435319965105553*ht+.7063770186160144);return lt.subarray(0,vt)},getData:function(lt){var at=lt.width,ut=lt.height,V=lt.forceRGB,ht=lt.isSourcePDF;if(this.p>4)throw new P("Unsupported color mode");var vt=this.Y(at,ut,ht);if(this.p===1&&V){for(var pt=vt.length,st=new Uint8ClampedArray(3*pt),ct=0,At=0;At<pt;At++){var kt=vt[At];st[ct++]=kt,st[ct++]=kt,st[ct++]=kt}return st}if(this.p===3&&this.f)return this.z(vt);if(this.p===4){if(this.f)return V?this.O(vt):this.r(vt);if(V)return this.U(vt)}return vt}},rt}();function $(D,U){return D[U]<<8|D[U+1]}w.JpegDecoder=F})(),w.encodeImage=function(P,F,$,D){var U={t256:[F],t257:[$],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[$],t279:[F*$*4],t282:[[72,1]],t283:[[72,1]],t284:[1],t286:[[0,1]],t287:[[0,1]],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(D)for(var Z in D)U[Z]=D[Z];var j=new Uint8Array(w.encode([U])),G=new Uint8Array(P),H=new Uint8Array(1e3+F*$*4);for(Z=0;Z<j.length;Z++)H[Z]=j[Z];for(Z=0;Z<G.length;Z++)H[1e3+Z]=G[Z];return H.buffer},w.encode=function(P){var F=new Uint8Array(2e4),$=4,D=w._binBE;F[0]=F[1]=77,D.writeUshort(F,2,42);var U=8;D.writeUint(F,$,U),$+=4;for(var Z=0;Z<P.length;Z++){var j=w._writeIFD(D,w._types.basic,F,U,P[Z]);U=j[1],Z<P.length-1&&(3&U&&(U+=4-(3&U)),D.writeUint(F,j[0],U))}return F.slice(0,U).buffer},w.decode=function(P,F){F==null&&(F={parseMN:!0,debug:!1});var $=new Uint8Array(P),D=0,U=w._binBE.readASCII($,D,2);D+=2;var Z=U=="II"?w._binLE:w._binBE;Z.readUshort($,D),D+=2;var j=Z.readUint($,D);D+=4;for(var G=[];;){var H=Z.readUshort($,j),W=Z.readUshort($,j+4);if(H!=0&&(W<1||13<W)){g("error in TIFF");break}if(w._readIFD(Z,$,j,G,0,F),(j=Z.readUint($,j+2+12*H))==0)break}return G},w.decodeImage=function(P,F,$){if(!F.data){var D=new Uint8Array(P),U=w._binBE.readASCII(D,0,2);if(F.t256!=null){F.isLE=U=="II",F.width=F.t256[0],F.height=F.t257[0];var Z=F.t259?F.t259[0]:1,j=F.t266?F.t266[0]:1;F.t284&&F.t284[0]==2&&g("PlanarConfiguration 2 should not be used!"),Z==7&&F.t258&&F.t258.length>3&&(F.t258=F.t258.slice(0,3));var G=F.t277?F.t277[0]:1,H=(F.t258?F.t258[0]:1)*G;Z==1&&F.t279!=null&&F.t278&&F.t262[0]==32803&&(H=Math.round(8*F.t279[0]/(F.width*F.t278[0]))),F.t50885&&F.t50885[0]==4&&(H=3*F.t258[0]);var W=8*Math.ceil(F.width*H/8),Q=F.t273;(Q==null||F.t322)&&(Q=F.t324);var q=F.t279;Z==1&&Q.length==1&&(q=[F.height*(W>>>3)]),(q==null||F.t322)&&(q=F.t325);var rt=new Uint8Array(F.height*(W>>>3)),it=0;if(F.t322!=null){var X=F.t322[0],J=F.t323[0],tt=Math.floor((F.width+X-1)/X),ot=Math.floor((F.height+J-1)/J),nt=new Uint8Array(0|Math.ceil(X*J*H/8));console.log("====",tt,ot);for(var lt=0;lt<ot;lt++)for(var at=0;at<tt;at++){var ut=lt*tt+at;nt.fill(0),w.decode._decompress(F,$,D,Q[ut],q[ut],Z,nt,0,j,X,J),Z==6?rt=nt:w._copyTile(nt,0|Math.ceil(X*H/8),J,rt,0|Math.ceil(F.width*H/8),F.height,0|Math.ceil(at*X*H/8),lt*J)}it=8*rt.length}else{if(Q==null)return;var V=F.t278?F.t278[0]:F.height;for(V=Math.min(V,F.height),ut=0;ut<Q.length;ut++)w.decode._decompress(F,$,D,Q[ut],q[ut],Z,rt,0|Math.ceil(it/8),j,F.width,V),it+=W*V;it=Math.min(it,8*rt.length)}F.data=new Uint8Array(rt.buffer,0,0|Math.ceil(it/8))}}},w.decode._decompress=function(P,F,$,D,U,Z,j,G,H,W,Q){if(P.t271&&P.t271[0]=="Panasonic"&&P.t45&&P.t45[0]==6&&(Z=34316),Z==1)for(var q=0;q<U;q++)j[G+q]=$[D+q];else if(Z==2)w.decode._decodeG2($,D,U,j,G,W,H);else if(Z==3)w.decode._decodeG3($,D,U,j,G,W,H,!!P.t292&&!(1&~P.t292[0]));else if(Z==4)w.decode._decodeG4($,D,U,j,G,W,H);else if(Z==5)w.decode._decodeLZW($,D,U,j,G,8);else if(Z==6)w.decode._decodeOldJPEG(P,$,D,U,j,G);else if(Z==7||Z==34892)w.decode._decodeNewJPEG(P,$,D,U,j,G);else if(Z==8||Z==32946){var rt=new Uint8Array($.buffer,D+2,U-6),it=I.inflateRaw(rt);G+it.length<=j.length&&j.set(it,G)}else Z==9?w.decode._decodeVC5($,D,U,j,G,P.t33422):Z==32767?w.decode._decodeARW(P,$,D,U,j,G):Z==32773?w.decode._decodePackBits($,D,U,j,G):Z==32809?w.decode._decodeThunder($,D,U,j,G):Z==34316?w.decode._decodePanasonic(P,$,D,U,j,G):Z==34713?w.decode._decodeNikon(P,F,$,D,U,j,G):Z==34676?w.decode._decodeLogLuv32(P,$,D,U,j,G):g("Unknown compression",Z);var X=P.t258?Math.min(32,P.t258[0]):1,J=P.t277?P.t277[0]:1,tt=X*J>>>3,ot=Math.ceil(X*J*W/8);if(X==16&&!P.isLE&&P.t33422==null)for(var nt=0;nt<Q;nt++)for(var lt=G+nt*ot,at=1;at<ot;at+=2){var ut=j[lt+at];j[lt+at]=j[lt+at-1],j[lt+at-1]=ut}if(P.t317&&P.t317[0]==2)for(nt=0;nt<Q;nt++){var V=G+nt*ot;if(X==16)for(q=tt;q<ot;q+=2){var ht=(j[V+q+1]<<8|j[V+q])+(j[V+q-tt+1]<<8|j[V+q-tt]);j[V+q]=255&ht,j[V+q+1]=ht>>>8&255}else if(J==3)for(q=3;q<ot;q+=3)j[V+q]=j[V+q]+j[V+q-3]&255,j[V+q+1]=j[V+q+1]+j[V+q-2]&255,j[V+q+2]=j[V+q+2]+j[V+q-1]&255;else for(q=tt;q<ot;q++)j[V+q]=j[V+q]+j[V+q-tt]&255}},w.decode._decodePanasonic=function(P,F,$,D,U,Z){var j,G,H,W,Q,q,rt,it,X=F.buffer,J=P.t2[0],tt=P.t3[0],ot=P.t10[0],nt=P.t45[0],lt=0,at=0,ut=0,V=0,ht=nt==6?new Uint32Array(18):new Uint8Array(16),vt=[0,0],pt=[0,0],st=0,ct=new Uint8Array(16384),At=new Uint16Array(U.buffer);function kt(zt){if(ut==0){var K=new Uint8Array(X,$+at+8184,8200),ft=new Uint8Array(X,$+at,8184);ct.set(K),ct.set(ft,K.length),at+=16384}if(nt!=5)return(ct[V=(ut=ut-zt&131071)>>3^16368]|ct[V+1]<<8)>>(7&ut)&~(-1<<zt);for(j=0;j<16;j++)ht[j]=ct[ut++],ut&=16383}function yt(zt){return ct[ut+15-zt]}function Ct(){vt[0]=0,vt[1]=0,pt[0]=0,pt[1]=0}if(nt==7)throw nt;if(nt==6){var xt=ot==12,Pt=xt?function(){ht[0]=yt(0)<<4|yt(1)>>4,ht[1]=4095&((15&yt(1))<<8|yt(2)),ht[2]=yt(3)>>6&3,ht[3]=(63&yt(3))<<2|yt(4)>>6,ht[4]=(63&yt(4))<<2|yt(5)>>6,ht[5]=(63&yt(5))<<2|yt(6)>>6,ht[6]=yt(6)>>4&3,ht[7]=(15&yt(6))<<4|yt(7)>>4,ht[8]=(15&yt(7))<<4|yt(8)>>4,ht[9]=(15&yt(8))<<4|yt(9)>>4,ht[10]=yt(9)>>2&3,ht[11]=(3&yt(9))<<6|yt(10)>>2,ht[12]=(3&yt(10))<<6|yt(11)>>2,ht[13]=(3&yt(11))<<6|yt(12)>>2,ht[14]=3&yt(12),ht[15]=yt(13),ht[16]=yt(14),ht[17]=yt(15),ut+=16,V=0}:function(){ht[0]=yt(0)<<6|yt(1)>>2,ht[1]=16383&((3&yt(1))<<12|yt(2)<<4|yt(3)>>4),ht[2]=yt(3)>>2&3,ht[3]=(3&yt(3))<<8|yt(4),ht[4]=yt(5)<<2|yt(6)>>6,ht[5]=(63&yt(6))<<4|yt(7)>>4,ht[6]=yt(7)>>2&3,ht[7]=(3&yt(7))<<8|yt(8),ht[8]=yt(9)<<2&1020|yt(10)>>6,ht[9]=1023&(yt(10)<<4|yt(11)>>4),ht[10]=yt(11)>>2&3,ht[11]=(3&yt(11))<<8|yt(12),ht[12]=1023&(yt(13)<<2&1020|yt(14)>>6),ht[13]=1023&(yt(14)<<4|yt(15)>>4),ut+=16,V=0},Ft=xt?14:11,Rt=xt?128:512,Mt=xt?2048:8192,Bt=xt?16383:65535,$t=xt?4095:16383,Ot=J/Ft,Zt=16*Ot,Tt=xt?18:14;for(q=0;q<tt-15;q+=16){var et=Math.min(16,tt-q),It=Zt*et;for(ct=new Uint8Array(X,$+lt,It),ut=0,lt+=It,it=0,rt=0;it<et;it++,rt=0){st=(q+it)*J;for(var mt=0;mt<Ot;mt++)for(Pt(),Ct(),H=0,Q=0,j=0;j<Ft;j++){if(W=1&j,j%3==2){var gt=V<Tt?ht[V++]:0;gt==3&&(gt=4),Q=Rt<<gt,H=1<<gt}var _t=V<Tt?ht[V++]:0;vt[W]?(_t*=H,Q<Mt&&pt[W]>Q&&(_t+=pt[W]-Q),pt[W]=_t):(vt[W]=_t,_t?pt[W]=_t:_t=pt[W]),At[st+rt++]=_t-15<=Bt?_t-15&Bt:_t+2147483633>>31&$t}}}}else if(nt==5){var Et=ot==12?10:9;for(q=0;q<tt;q++)for(rt=0;rt<J;rt+=Et)kt(0),ot==12?(At[st++]=((15&ht[1])<<8)+ht[0],At[st++]=16*ht[2]+(ht[1]>>4),At[st++]=((15&ht[4])<<8)+ht[3],At[st++]=16*ht[5]+(ht[4]>>4),At[st++]=((15&ht[7])<<8)+ht[6],At[st++]=16*ht[8]+(ht[7]>>4),At[st++]=((15&ht[10])<<8)+ht[9],At[st++]=16*ht[11]+(ht[10]>>4),At[st++]=((15&ht[13])<<8)+ht[12],At[st++]=16*ht[14]+(ht[13]>>4)):ot==14&&(At[st++]=ht[0]+((63&ht[1])<<8),At[st++]=(ht[1]>>6)+4*ht[2]+((15&ht[3])<<10),At[st++]=(ht[3]>>4)+16*ht[4]+((3&ht[5])<<12),At[st++]=((252&ht[5])>>2)+(ht[6]<<6),At[st++]=ht[7]+((63&ht[8])<<8),At[st++]=(ht[8]>>6)+4*ht[9]+((15&ht[10])<<10),At[st++]=(ht[10]>>4)+16*ht[11]+((3&ht[12])<<12),At[st++]=((252&ht[12])>>2)+(ht[13]<<6),At[st++]=ht[14]+((63&ht[15])<<8))}else{if(nt!=4)throw nt;for(q=0;q<tt;q++)for(rt=0;rt<J;rt++)W=1&(j=rt%14),j==0&&Ct(),j%3==2&&(H=4>>3-kt(2)),pt[W]?(G=kt(8))!=0&&(vt[W]-=128<<H,(vt[W]<0||H==4)&&(vt[W]&=~(-1<<H)),vt[W]+=G<<H):(pt[W]=kt(8),(pt[W]||j>11)&&(vt[W]=pt[W]<<4|kt(4))),At[st++]=vt[1&rt]}},w.decode._decodeVC5=function(){var P,F,$,D=[1,0,1,0,2,2,1,1,3,7,1,2,5,25,1,3,6,48,1,4,6,54,1,5,7,111,1,8,7,99,1,6,7,105,12,0,7,107,1,7,8,209,20,0,8,212,1,9,8,220,1,10,9,393,1,11,9,394,32,0,9,416,1,12,9,427,1,13,10,887,1,18,10,784,1,14,10,790,1,15,10,835,60,0,10,852,1,16,10,885,1,17,11,1571,1,19,11,1668,1,20,11,1669,100,0,11,1707,1,21,11,1772,1,22,12,3547,1,29,12,3164,1,24,12,3166,1,25,12,3140,1,23,12,3413,1,26,12,3537,1,27,12,3539,1,28,13,7093,1,35,13,6283,1,30,13,6331,1,31,13,6335,180,0,13,6824,1,32,13,7072,1,33,13,7077,320,0,13,7076,1,34,14,12565,1,36,14,12661,1,37,14,12669,1,38,14,13651,1,39,14,14184,1,40,15,28295,1,46,15,28371,1,47,15,25320,1,42,15,25336,1,43,15,25128,1,41,15,27300,1,44,15,28293,1,45,16,50259,1,48,16,50643,1,49,16,50675,1,50,16,56740,1,53,16,56584,1,51,16,56588,1,52,17,113483,1,61,17,113482,1,60,17,101285,1,55,17,101349,1,56,17,109205,1,57,17,109207,1,58,17,100516,1,54,17,113171,1,59,18,202568,1,62,18,202696,1,63,18,218408,1,64,18,218412,1,65,18,226340,1,66,18,226356,1,67,18,226358,1,68,19,402068,1,69,19,405138,1,70,19,405394,1,71,19,436818,1,72,19,436826,1,73,19,452714,1,75,19,452718,1,76,19,452682,1,74,20,804138,1,77,20,810279,1,78,20,810790,1,79,20,873638,1,80,20,873654,1,81,20,905366,1,82,20,905430,1,83,20,905438,1,84,21,1608278,1,85,21,1620557,1,86,21,1621582,1,87,21,1621583,1,88,21,1747310,1,89,21,1810734,1,90,21,1810735,1,91,21,1810863,1,92,21,1810879,1,93,22,3621725,1,99,22,3621757,1,100,22,3241112,1,94,22,3494556,1,95,22,3494557,1,96,22,3494622,1,97,22,3494623,1,98,23,6482227,1,102,23,6433117,1,101,23,6989117,1,103,23,6989119,1,105,23,6989118,1,104,23,7243449,1,106,23,7243512,1,107,24,13978233,1,111,24,12964453,1,109,24,12866232,1,108,24,14486897,1,113,24,13978232,1,110,24,14486896,1,112,24,14487026,1,114,24,14487027,1,115,25,25732598,1,225,25,25732597,1,189,25,25732596,1,188,25,25732595,1,203,25,25732594,1,202,25,25732593,1,197,25,25732592,1,207,25,25732591,1,169,25,25732590,1,223,25,25732589,1,159,25,25732522,1,235,25,25732579,1,152,25,25732575,1,192,25,25732489,1,179,25,25732573,1,201,25,25732472,1,172,25,25732576,1,149,25,25732488,1,178,25,25732566,1,120,25,25732571,1,219,25,25732577,1,150,25,25732487,1,127,25,25732506,1,211,25,25732548,1,125,25,25732588,1,158,25,25732486,1,247,25,25732467,1,238,25,25732508,1,163,25,25732552,1,228,25,25732603,1,183,25,25732513,1,217,25,25732587,1,168,25,25732520,1,122,25,25732484,1,128,25,25732562,1,249,25,25732505,1,187,25,25732504,1,186,25,25732483,1,136,25,25928905,1,181,25,25732560,1,255,25,25732500,1,230,25,25732482,1,135,25,25732555,1,233,25,25732568,1,222,25,25732583,1,145,25,25732481,1,134,25,25732586,1,167,25,25732521,1,248,25,25732518,1,209,25,25732480,1,243,25,25732512,1,216,25,25732509,1,164,25,25732547,1,140,25,25732479,1,157,25,25732544,1,239,25,25732574,1,191,25,25732564,1,251,25,25732478,1,156,25,25732546,1,139,25,25732498,1,242,25,25732557,1,133,25,25732477,1,162,25,25732515,1,213,25,25732584,1,165,25,25732514,1,212,25,25732476,1,227,25,25732494,1,198,25,25732531,1,236,25,25732530,1,234,25,25732529,1,117,25,25732528,1,215,25,25732527,1,124,25,25732526,1,123,25,25732525,1,254,25,25732524,1,253,25,25732523,1,148,25,25732570,1,218,25,25732580,1,146,25,25732581,1,147,25,25732569,1,224,25,25732533,1,143,25,25732540,1,184,25,25732541,1,185,25,25732585,1,166,25,25732556,1,132,25,25732485,1,129,25,25732563,1,250,25,25732578,1,151,25,25732501,1,119,25,25732502,1,193,25,25732536,1,176,25,25732496,1,245,25,25732553,1,229,25,25732516,1,206,25,25732582,1,144,25,25732517,1,208,25,25732558,1,137,25,25732543,1,241,25,25732466,1,237,25,25732507,1,190,25,25732542,1,240,25,25732551,1,131,25,25732554,1,232,25,25732565,1,252,25,25732475,1,171,25,25732493,1,205,25,25732492,1,204,25,25732491,1,118,25,25732490,1,214,25,25928904,1,180,25,25732549,1,126,25,25732602,1,182,25,25732539,1,175,25,25732545,1,141,25,25732559,1,138,25,25732537,1,177,25,25732534,1,153,25,25732503,1,194,25,25732606,1,160,25,25732567,1,121,25,25732538,1,174,25,25732497,1,246,25,25732550,1,130,25,25732572,1,200,25,25732474,1,170,25,25732511,1,221,25,25732601,1,196,25,25732532,1,142,25,25732519,1,210,25,25732495,1,199,25,25732605,1,155,25,25732535,1,154,25,25732499,1,244,25,25732510,1,220,25,25732600,1,195,25,25732607,1,161,25,25732604,1,231,25,25732473,1,173,25,25732599,1,226,26,51465122,1,116,26,51465123,0,1],U=[3,3,3,3,2,2,2,1,1,1];function Z(it){var X=it[1],J=it[0][X>>>3]>>>7-(7&X)&1;return it[1]++,J}function j(it,X){if(P==null){P={};for(var J=0;J<D.length;J+=4)P[D[J+1]]=D.slice(J,J+4)}for(var tt=Z(it),ot=P[tt];ot==null;)tt=tt<<1|Z(it),ot=P[tt];var nt=ot[3];nt!=0&&(nt=Z(it)==0?nt:-nt),X[0]=ot[2],X[1]=nt}function G(it,X){for(var J=0;J<X;J++)1&~it||it++,it>>>=1;return it}function H(it,X){return it>>X}function W(it,X,J,tt,ot,nt){X[J]=H(H(11*it[ot]-4*it[ot+nt]+it[ot+nt+nt]+4,3)+it[tt],1),X[J+nt]=H(H(5*it[ot]+4*it[ot+nt]-it[ot+nt+nt]+4,3)-it[tt],1)}function Q(it,X,J,tt,ot,nt){var lt=it[ot-nt]-it[ot+nt],at=it[ot],ut=it[tt];X[J]=H(H(lt+4,3)+at+ut,1),X[J+nt]=H(H(4-lt,3)+at-ut,1)}function q(it,X,J,tt,ot,nt){X[J]=H(H(5*it[ot]+4*it[ot-nt]-it[ot-nt-nt]+4,3)+it[tt],1),X[J+nt]=H(H(11*it[ot]-4*it[ot-nt]+it[ot-nt-nt]+4,3)-it[tt],1)}function rt(it){return it=$[it=it<0?0:it>4095?4095:it]>>>2}return function(it,X,J,tt,ot,nt){tt=new Uint16Array(tt.buffer);var lt,at,ut,V,ht,vt,pt,st,ct=Date.now(),At=w._binBE,kt=X+J;X+=4;for(var yt=nt[0]==1;X<kt;){var Ct=At.readShort(it,X),xt=At.readUshort(it,X+2);if(X+=4,Ct==12)Ot=xt;else if(Ct==20)lt=xt;else if(Ct==21)at=xt;else if(Ct==48)ut=xt;else if(Ct==53)V=xt;else if(Ct!=35){if(Ct==62)ht=xt;else if(Ct!=101){if(Ct==109)vt=xt;else if(Ct!=84){if(Ct!=106){if(Ct!=107){if(Ct!=108){if(Ct!=102){if(Ct==104)Jt=xt;else if(Ct!=105){var Pt=Ct<0?-Ct:Ct,Ft=65280&Pt,Rt=0;if(24576&Pt&&(8192&Pt?(Rt=65535&xt,Rt+=(255&Pt)<<16):Rt=65535&xt),24576&~Pt){if(Pt==16388)X+=4*Rt;else if(Ft!=8192&&Ft!=8448&&Ft!=9216)throw Pt.toString(16)}else{if(pt==null){pt=[];for(var Mt=0;Mt<4;Mt++)pt[Mt]=new Int16Array((lt>>>1)*(at>>>1));for(st=new Int16Array((lt>>>1)*(at>>>1)),F=new Int16Array(1024),Mt=0;Mt<1024;Mt++){var Bt=Mt-512,$t=Math.abs(Bt),Ot=Math.floor(768*$t*$t*$t/16581375)+$t;F[Mt]=Math.sign(Bt)*Ot}for($=new Uint16Array(4096),Mt=0;Mt<4096;Mt++){var Zt=Mt,Tt=65535*(Math.pow(113,Zt/4095)-1)/112;$[Mt]=Math.min(Tt,65535)}}var et=pt[ht],It=G(lt,1+U[ut]),mt=G(at,1+U[ut]);if(ut==0)for(var gt=0;gt<mt;gt++)for(var _t=0;_t<It;_t++){var Et=X+2*(gt*It+_t);et[gt*(lt>>>1)+_t]=it[Et]<<8|it[Et+1]}else{var zt=[it,8*X],K=[],ft=0,bt=It*mt,wt=[0,0],Lt=0;for(xt=0;ft<bt;)for(j(zt,wt),Lt=wt[0],xt=wt[1];Lt>0;)K[ft++]=xt,Lt--;var jt=(ut-1)%3,Kt=jt!=1?It:0,te=jt!=0?mt:0;for(gt=0;gt<mt;gt++){var Vt=(gt+te)*(lt>>>1)+Kt,ee=gt*It;for(_t=0;_t<It;_t++)et[Vt+_t]=F[K[ee+_t]+512]*V}if(jt==2){var Jt=lt>>>1,oe=2*It,ne=2*mt;for(gt=0;gt<mt;gt++)for(_t=0;_t<oe;_t++){Mt=2*gt*Jt+_t;var ae=mt*Jt+(ie=gt*Jt+_t);gt==0?W(et,st,Mt,ae,ie,Jt):gt==mt-1?q(et,st,Mt,ae,ie,Jt):Q(et,st,Mt,ae,ie,Jt)}var fe=et;for(et=st,st=fe,gt=0;gt<ne;gt++)for(_t=0;_t<It;_t++){var ie;Mt=gt*Jt+2*_t,ae=It+(ie=gt*Jt+_t),_t==0?W(et,st,Mt,ae,ie,1):_t==It-1?q(et,st,Mt,ae,ie,1):Q(et,st,Mt,ae,ie,1)}fe=et,et=st,st=fe;for(var Nt=[],Xt=2-~~((ut-1)/3),Ut=0;Ut<3;Ut++)Nt[Ut]=vt>>14-2*Ut&3;var Qt=Nt[Xt];if(Qt!=0)for(gt=0;gt<ne;gt++)for(_t=0;_t<oe;_t++)et[Mt=gt*Jt+_t]=et[Mt]<<Qt}}if(ut==9&&ht==3){var St=pt[0],Yt=pt[1],ue=pt[2],dt=pt[3];for(gt=0;gt<at;gt+=2)for(_t=0;_t<lt;_t+=2){var qt=gt*lt+_t,Gt=St[Et=(gt>>>1)*(lt>>>1)+(_t>>>1)],Dt=Yt[Et]-2048,Ht=ue[Et]-2048,Wt=dt[Et]-2048,le=(Dt<<1)+Gt,re=(Ht<<1)+Gt,se=Gt+Wt,ce=Gt-Wt;yt?(tt[qt]=rt(se),tt[qt+1]=rt(re),tt[qt+lt]=rt(le),tt[qt+lt+1]=rt(ce)):(tt[qt]=rt(le),tt[qt+1]=rt(se),tt[qt+lt]=rt(ce),tt[qt+lt+1]=rt(re))}}X+=4*Rt}}}}}}}}}}console.log(Date.now()-ct)}}(),w.decode._decodeLogLuv32=function(P,F,$,D,U,Z){for(var j=P.width,G=4*j,H=0,W=new Uint8Array(G);H<D;){for(var Q=0;Q<G;){var q=F[$+H];if(H++,q<128){for(var rt=0;rt<q;rt++)W[Q+rt]=F[$+H+rt];Q+=q,H+=q}else{for(q-=126,rt=0;rt<q;rt++)W[Q+rt]=F[$+H];Q+=q,H++}}for(var it=0;it<j;it++)U[Z+0]=W[it],U[Z+1]=W[it+j],U[Z+2]=W[it+2*j],U[Z+4]=W[it+3*j],Z+=6}},w.decode._ljpeg_diff=function(P,F,$){var D,U,Z=w.decode._getbithuff;return D=Z(P,F,$[0],$),(U=Z(P,F,D,0))&1<<D-1||(U-=(1<<D)-1),U},w.decode._decodeARW=function(P,F,$,D,U,Z){var j=P.t256[0],G=P.t257[0],H=P.t258[0],W=P.isLE?w._binLE:w._binBE;if(j*G==D||j*G*1.5==D)if(j*G*1.5!=D){var Q,q,rt,it,X,J,tt,ot,nt=new Uint16Array(16),lt=new Uint8Array(j+1);for(ct=0;ct<G;ct++){for(var at=0;at<j;at++)lt[at]=F[$++];for(ot=0,st=0;st<j-30;ot+=16){for(q=2047&(Q=W.readUint(lt,ot)),rt=2047&Q>>>11,it=15&Q>>>22,X=15&Q>>>26,J=0;J<4&&128<<J<=q-rt;J++);for(tt=30,ut=0;ut<16;ut++)ut==it?nt[ut]=q:ut==X?nt[ut]=rt:(nt[ut]=((W.readUshort(lt,ot+(tt>>3))>>>(7&tt)&127)<<J)+rt,nt[ut]>2047&&(nt[ut]=2047),tt+=7);for(ut=0;ut<16;ut++,st+=2)Rt=nt[ut]<<1,w.decode._putsF(U,(ct*j+st)*H,Rt<<16-H);st-=1&st?1:31}}}else for(var ut=0;ut<D;ut+=3){var V=F[$+ut+0],ht=F[$+ut+1],vt=F[$+ut+2];U[Z+ut]=ht<<4|V>>>4,U[Z+ut+1]=V<<4|vt>>>4,U[Z+ut+2]=vt<<4|ht>>>4}else{G+=8;var pt,st,ct,At=[$,0,0,0],kt=new Uint16Array(32770),yt=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],Ct=0,xt=w.decode._ljpeg_diff;for(kt[0]=15,pt=ut=0;ut<18;ut++)for(var Pt=32768>>>(yt[ut]>>>8),Ft=0;Ft<Pt;Ft++)kt[++pt]=yt[ut];for(st=j;st--;)for(ct=0;ct<G+1;ct+=2)if(ct==G&&(ct=1),Ct+=xt(F,At,kt),ct<G){var Rt=4095&Ct;w.decode._putsF(U,(ct*j+st)*H,Rt<<16-H)}}},w.decode._decodeNikon=function(P,F,$,D,U,Z,j){var G=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],H=P.t256[0],W=P.t257[0],Q=P.t258[0],q=0,rt=0,it=w.decode._make_decoder,X=w.decode._getbithuff,J=F[0].exifIFD.makerNote,tt=J.t150?J.t150:J.t140,ot=0,nt=tt[ot++],lt=tt[ot++];nt!=73&&lt!=88||(ot+=2110),nt==70&&(q=2),Q==14&&(q+=3);for(var at=[[0,0],[0,0]],ut=P.isLE?w._binLE:w._binBE,V=0;V<2;V++)for(var ht=0;ht<2;ht++)at[V][ht]=ut.readShort(tt,ot),ot+=2;var vt,pt,st,ct,At,kt=1<<Q&32767,yt=0,Ct=ut.readShort(tt,ot);ot+=2,Ct>1&&(yt=Math.floor(kt/(Ct-1))),nt==68&&lt==32&&yt>0&&(rt=ut.readShort(tt,562));var xt=[0,0],Pt=it(G[q]),Ft=[D,0,0,0];for(vt=0;vt<W;vt++)for(rt&&vt==rt&&(Pt=it(G[q+1])),pt=0;pt<H;pt++){V=X($,Ft,Pt[0],Pt),(At=1+(X($,Ft,(st=15&V)-(ct=V>>>4),0)<<1)<<ct>>>1)&1<<st-1||(At-=(1<<st)-(ct==0?1:0)),pt<2?xt[pt]=at[1&vt][pt]+=At:xt[1&pt]+=At;var Rt=Math.min(Math.max(xt[1&pt],0),(1<<Q)-1),Mt=(vt*H+pt)*Q;w.decode._putsF(Z,Mt,Rt<<16-Q)}},w.decode._putsF=function(P,F,$){$<<=8-(7&F);var D=F>>>3;P[D]|=$>>>16,P[D+1]|=$>>>8,P[D+2]|=$},w.decode._getbithuff=function(P,F,$,D){var U;w.decode._get_byte;var Z=F[0],j=F[1],G=F[2],H=F[3];if($==0||G<0)return 0;for(;!H&&G<$&&(U=P[Z++])!=-1&&!(H=0);)j=(j<<8)+U,G+=8;if(U=j<<32-G>>>32-$,D?(G-=D[U+1]>>>8,U=255&D[U+1]):G-=$,G<0)throw"e";return F[0]=Z,F[1]=j,F[2]=G,F[3]=H,U},w.decode._make_decoder=function(P){var F,$,D,U,Z,j=[];for(F=16;F!=0&&!P[F];F--);var G=17;for(j[0]=F,D=$=1;$<=F;$++)for(U=0;U<P[$];U++,++G)for(Z=0;Z<1<<F-$;Z++)D<=1<<F&&(j[D++]=$<<8|P[G]);return j},w.decode._decodeNewJPEG=function(P,F,$,D,U,Z){D=Math.min(D,F.length-$);var j=P.t347,G=j?j.length:0,H=new Uint8Array(G+D);if(j){for(var W=0,Q=0;Q<G-1&&(j[Q]!=255||j[Q+1]!=217);Q++)H[W++]=j[Q];var q=F[$],rt=F[$+1];for(q==255&&rt==216||(H[W++]=q,H[W++]=rt),Q=2;Q<D;Q++)H[W++]=F[$+Q]}else for(Q=0;Q<D;Q++)H[Q]=F[$+Q];if(P.t262[0]==32803||P.t259[0]==7&&P.t262[0]==34892){var it=P.t258[0],X=w.LosslessJpegDecode(H),J=X.length;if(it==16)if(P.isLE)for(Q=0;Q<J;Q++)U[Z+(Q<<1)]=255&X[Q],U[Z+(Q<<1)+1]=X[Q]>>>8;else for(Q=0;Q<J;Q++)U[Z+(Q<<1)]=X[Q]>>>8,U[Z+(Q<<1)+1]=255&X[Q];else if(it==14||it==12||it==10){var tt=16-it;for(Q=0;Q<J;Q++)w.decode._putsF(U,Q*it,X[Q]<<tt)}else{if(it!=8)throw new Error("unsupported bit depth "+it);for(Q=0;Q<J;Q++)U[Z+Q]=X[Q]}}else{var ot=new w.JpegDecoder;ot.parse(H);var nt=ot.getData({width:ot.width,height:ot.height,forceRGB:!0,isSourcePDF:!1});for(Q=0;Q<nt.length;Q++)U[Z+Q]=nt[Q]}P.t262[0]==6&&(P.t262[0]=2)},w.decode._decodeOldJPEGInit=function(P,F,$,D){var U,Z,j,G,H,W=216,Q=0,q=0,rt=!1,it=P.t513,X=it?it[0]:0,J=P.t514,tt=J?J[0]:0,ot=P.t324||P.t273||it,nt=P.t530,lt=0,at=0,ut=P.t277?P.t277[0]:1,V=P.t515;if(ot&&(q=ot[0],rt=ot.length>1),!rt){if(F[$]==255&&F[$+1]==W)return{jpegOffset:$};if(it!=null&&(F[$+X]==255&&F[$+X+1]==W?Q=$+X:g("JPEGInterchangeFormat does not point to SOI"),J==null?g("JPEGInterchangeFormatLength field is missing"):(X>=q||X+tt<=q)&&g("JPEGInterchangeFormatLength field value is invalid"),Q!=null))return{jpegOffset:Q}}if(nt!=null&&(lt=nt[0],at=nt[1]),it!=null&&J!=null)if(tt>=2&&X+tt<=q){for(U=F[$+X+tt-2]==255&&F[$+X+tt-1]==W?new Uint8Array(tt-2):new Uint8Array(tt),j=0;j<U.length;j++)U[j]=F[$+X+j];g("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else g("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(U==null){var ht=0,vt=[];vt[ht++]=255,vt[ht++]=W;var pt=P.t519;if(pt==null)throw new Error("JPEGQTables tag is missing");for(j=0;j<pt.length;j++)for(vt[ht++]=255,vt[ht++]=219,vt[ht++]=0,vt[ht++]=67,vt[ht++]=j,G=0;G<64;G++)vt[ht++]=F[$+pt[j]+G];for(H=0;H<2;H++){var st=P[H==0?"t520":"t521"];if(st==null)throw new Error((H==0?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(j=0;j<st.length;j++){vt[ht++]=255,vt[ht++]=196;var ct=19;for(G=0;G<16;G++)ct+=F[$+st[j]+G];for(vt[ht++]=ct>>>8,vt[ht++]=255&ct,vt[ht++]=j|H<<4,G=0;G<16;G++)vt[ht++]=F[$+st[j]+G];for(G=0;G<ct;G++)vt[ht++]=F[$+st[j]+16+G]}}if(vt[ht++]=255,vt[ht++]=192,vt[ht++]=0,vt[ht++]=8+3*ut,vt[ht++]=8,vt[ht++]=P.height>>>8&255,vt[ht++]=255&P.height,vt[ht++]=P.width>>>8&255,vt[ht++]=255&P.width,vt[ht++]=ut,ut==1)vt[ht++]=1,vt[ht++]=17,vt[ht++]=0;else for(j=0;j<3;j++)vt[ht++]=j+1,vt[ht++]=j!=0?17:(15&lt)<<4|15&at,vt[ht++]=j;V!=null&&V[0]!=0&&(vt[ht++]=255,vt[ht++]=221,vt[ht++]=0,vt[ht++]=4,vt[ht++]=V[0]>>>8&255,vt[ht++]=255&V[0]),U=new Uint8Array(vt)}var At=-1;for(j=0;j<U.length-1;){if(U[j]==255&&U[j+1]==192){At=j;break}j++}if(At==-1){var kt=new Uint8Array(U.length+10+3*ut);kt.set(U);var yt=U.length;if(At=U.length,(U=kt)[yt++]=255,U[yt++]=192,U[yt++]=0,U[yt++]=8+3*ut,U[yt++]=8,U[yt++]=P.height>>>8&255,U[yt++]=255&P.height,U[yt++]=P.width>>>8&255,U[yt++]=255&P.width,U[yt++]=ut,ut==1)U[yt++]=1,U[yt++]=17,U[yt++]=0;else for(j=0;j<3;j++)U[yt++]=j+1,U[yt++]=j!=0?17:(15&lt)<<4|15&at,U[yt++]=j}if(F[q]==255&&F[q+1]==218){var Ct=F[q+2]<<8|F[q+3];for((Z=new Uint8Array(Ct+2))[0]=F[q],Z[1]=F[q+1],Z[2]=F[q+2],Z[3]=F[q+3],j=0;j<Ct-2;j++)Z[j+4]=F[q+j+4]}else{var xt=0;if((Z=new Uint8Array(8+2*ut))[xt++]=255,Z[xt++]=218,Z[xt++]=0,Z[xt++]=6+2*ut,Z[xt++]=ut,ut==1)Z[xt++]=1,Z[xt++]=0;else for(j=0;j<3;j++)Z[xt++]=j+1,Z[xt++]=j<<4|j;Z[xt++]=0,Z[xt++]=63,Z[xt++]=0}return{jpegOffset:$,tables:U,sosMarker:Z,sofPosition:At}},w.decode._decodeOldJPEG=function(P,F,$,D,U,Z){var j,G,H,W,Q=w.decode._decodeOldJPEGInit(P,F,$,D);if(Q.jpegOffset!=null)for(j=$+D-Q.jpegOffset,H=new Uint8Array(j),it=0;it<j;it++)H[it]=F[Q.jpegOffset+it];else{for(G=Q.tables.length,(H=new Uint8Array(G+Q.sosMarker.length+D+2)).set(Q.tables),W=G,H[Q.sofPosition+5]=P.height>>>8&255,H[Q.sofPosition+6]=255&P.height,H[Q.sofPosition+7]=P.width>>>8&255,H[Q.sofPosition+8]=255&P.width,F[$]==255&&F[$+1]==SOS||(H.set(Q.sosMarker,W),W+=sosMarker.length),it=0;it<D;it++)H[W++]=F[$+it];H[W++]=255,H[W++]=EOI}var q=new w.JpegDecoder;q.parse(H);for(var rt=q.getData({width:q.width,height:q.height,forceRGB:!0,isSourcePDF:!1}),it=0;it<rt.length;it++)U[Z+it]=rt[it];P.t262&&P.t262[0]==6&&(P.t262[0]=2)},w.decode._decodePackBits=function(P,F,$,D,U){for(var Z=new Int8Array(P.buffer),j=new Int8Array(D.buffer),G=F+$;F<G;){var H=Z[F];if(F++,H>=0&&H<128)for(var W=0;W<H+1;W++)j[U]=Z[F],U++,F++;if(H>=-127&&H<0){for(W=0;W<1-H;W++)j[U]=Z[F],U++;F++}}return U},w.decode._decodeThunder=function(P,F,$,D,U){for(var Z=[0,1,0,-1],j=[0,1,2,3,0,-3,-2,-1],G=F+$,H=2*U,W=0;F<G;){var Q=P[F],q=Q>>>6,rt=63&Q;if(F++,q==3&&(W=15&rt,D[H>>>1]|=W<<4*(1-H&1),H++),q==0)for(var it=0;it<rt;it++)D[H>>>1]|=W<<4*(1-H&1),H++;if(q==2)for(it=0;it<2;it++)(X=rt>>>3*(1-it)&7)!=4&&(W+=j[X],D[H>>>1]|=W<<4*(1-H&1),H++);if(q==1)for(it=0;it<3;it++){var X;(X=rt>>>2*(2-it)&3)!=2&&(W+=Z[X],D[H>>>1]|=W<<4*(1-H&1),H++)}}},w.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},w.decode._lens=function(){var P=function(H,W,Q,q){for(var rt=0;rt<W.length;rt++)H[W[rt]]=Q+rt*q},F="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",$="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",D="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",U="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",Z="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";F=F.split(","),$=$.split(","),D=D.split(","),U=U.split(","),Z=Z.split(",");var j={},G={};return P(j,F,0,1),P(j,D,64,64),P(j,Z,1792,64),P(G,$,0,1),P(G,U,64,64),P(G,Z,1792,64),[j,G]}(),w.decode._decodeG4=function(P,F,$,D,U,Z,j){for(var G=w.decode,H=F<<3,W=0,Q="",q=[],rt=[],it=0;it<Z;it++)rt.push(0);rt=G._makeDiff(rt);for(var X=0,J=0,tt=0,ot=0,nt=0,lt=0,at="",ut=0,V=8*Math.ceil(Z/8);H>>>3<F+$;){tt=G._findDiff(rt,X+(X==0?0:1),1-nt),ot=G._findDiff(rt,tt,nt);var ht=0;if(j==1&&(ht=P[H>>>3]>>>7-(7&H)&1),j==2&&(ht=P[H>>>3]>>>(7&H)&1),H++,Q+=ht,at=="H"){if(G._lens[nt][Q]!=null){var vt=G._lens[nt][Q];Q="",W+=vt,vt<64&&(G._addNtimes(q,W,nt),X+=W,nt=1-nt,W=0,--ut==0&&(at=""))}}else Q=="0001"&&(Q="",G._addNtimes(q,ot-X,nt),X=ot),Q=="001"&&(Q="",at="H",ut=2),G._dmap[Q]!=null&&(J=tt+G._dmap[Q],G._addNtimes(q,J-X,nt),X=J,Q="",nt=1-nt);q.length==Z&&at==""&&(G._writeBits(q,D,8*U+lt*V),nt=0,lt++,X=0,rt=G._makeDiff(q),q=[])}},w.decode._findDiff=function(P,F,$){for(var D=0;D<P.length;D+=2)if(P[D]>=F&&P[D+1]==$)return P[D]},w.decode._makeDiff=function(P){var F=[];P[0]==1&&F.push(0,1);for(var $=1;$<P.length;$++)P[$-1]!=P[$]&&F.push($,P[$]);return F.push(P.length,0,P.length,1),F},w.decode._decodeG2=function(P,F,$,D,U,Z,j){for(var G=w.decode,H=F<<3,W=0,Q="",q=[],rt=0,it=0,X=8*Math.ceil(Z/8);H>>>3<F+$;){var J=0;j==1&&(J=P[H>>>3]>>>7-(7&H)&1),j==2&&(J=P[H>>>3]>>>(7&H)&1),H++,Q+=J,(W=G._lens[rt][Q])!=null&&(G._addNtimes(q,W,rt),Q="",W<64&&(rt=1-rt),q.length==Z&&(G._writeBits(q,D,8*U+it*X),q=[],it++,rt=0,7&H&&(H+=8-(7&H)),W>=64&&(H+=8)))}},w.decode._decodeG3=function(P,F,$,D,U,Z,j,G){for(var H=w.decode,W=F<<3,Q=0,q="",rt=[],it=[],X=0;X<Z;X++)rt.push(0);for(var J=0,tt=0,ot=0,nt=0,lt=0,at=-1,ut="",V=0,ht=!0,vt=8*Math.ceil(Z/8);W>>>3<F+$;){ot=H._findDiff(it,J+(J==0?0:1),1-lt),nt=H._findDiff(it,ot,lt);var pt=0;if(j==1&&(pt=P[W>>>3]>>>7-(7&W)&1),j==2&&(pt=P[W>>>3]>>>(7&W)&1),W++,q+=pt,ht){if(H._lens[lt][q]!=null){var st=H._lens[lt][q];q="",Q+=st,st<64&&(H._addNtimes(rt,Q,lt),lt=1-lt,Q=0)}}else ut=="H"?H._lens[lt][q]!=null&&(st=H._lens[lt][q],q="",Q+=st,st<64&&(H._addNtimes(rt,Q,lt),J+=Q,lt=1-lt,Q=0,--V==0&&(ut=""))):(q=="0001"&&(q="",H._addNtimes(rt,nt-J,lt),J=nt),q=="001"&&(q="",ut="H",V=2),H._dmap[q]!=null&&(tt=ot+H._dmap[q],H._addNtimes(rt,tt-J,lt),J=tt,q="",lt=1-lt));q.endsWith("000000000001")&&(at>=0&&H._writeBits(rt,D,8*U+at*vt),G&&(j==1&&(ht=(P[W>>>3]>>>7-(7&W)&1)==1),j==2&&(ht=(P[W>>>3]>>>(7&W)&1)==1),W++),q="",lt=0,at++,J=0,it=H._makeDiff(rt),rt=[])}rt.length==Z&&H._writeBits(rt,D,8*U+at*vt)},w.decode._addNtimes=function(P,F,$){for(var D=0;D<F;D++)P.push($)},w.decode._writeBits=function(P,F,$){for(var D=0;D<P.length;D++)F[$+D>>>3]|=P[D]<<7-($+D&7)},w.decode._decodeLZW=w.decode._decodeLZW=function(){var P,F,$,D,U=0,Z=0,j=0,G=0,H=function(){var X=P>>>3,J=(F[X]<<16|F[X+1]<<8|F[X+2])>>>24-(7&P)-Z&(1<<Z)-1;return P+=Z,J},W=new Uint32Array(16384),Q=0,q=function(X){Z=X+1,U=G+1},rt=function(X){for(var J=X<<2,tt=W[J+2],ot=D+tt-1;J!=65535;)$[ot--]=W[J],J=W[J+1];D+=tt},it=function(X,J){var tt=U<<2,ot=X<<2;W[tt]=W[3+(J<<2)],W[tt+1]=ot,W[tt+2]=W[ot+2]+1,W[tt+3]=W[ot+3],++U+1==1<<Z&&Z!=12&&Z++};return function(X,J,tt,ot,nt,lt){P=J<<3,F=X,$=ot,D=nt;var at=J+tt<<3,ut=0,V=0;for(function(ht){if(ht!=Q){Q=ht,G=1+(j=1<<ht);for(var vt=0;vt<G+1;vt++)W[4*vt]=W[4*vt+3]=vt,W[4*vt+1]=65535,W[4*vt+2]=1}}(lt),q(lt);P<at&&(ut=H())!=G;){if(ut==j){if(q(lt),(ut=H())==G)break;rt(ut)}else ut<U?(rt(ut),it(V,ut)):(it(V,V),rt(U-1));V=ut}return D}}(),w.tags={},w._types=function(){var P=new Array(250);return P.fill(0),{basic:{main:P=P.concat([0,0,0,0,4,3,3,3,3,3,0,0,3,0,0,0,3,0,0,2,2,2,2,4,3,0,0,3,4,4,3,3,5,5,3,2,5,5,0,0,0,0,4,4,0,0,3,3,0,0,0,0,0,0,0,2,2,0,0,0,0,0,0,0,0,2,2,3,5,5,3,0,3,3,4,4,4,3,4,0,0,0,0,0,0,0,0,0,3,3,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rest:{33432:2,33434:5,33437:5,34665:4,34850:3,34853:4,34855:3,34864:3,34866:4,36864:7,36867:2,36868:2,37121:7,37377:10,37378:5,37380:10,37381:5,37383:3,37384:3,37385:3,37386:5,37510:7,37520:2,37521:2,37522:2,40960:7,40961:3,40962:4,40963:4,40965:4,41486:5,41487:5,41488:3,41985:3,41986:3,41987:3,41988:5,41989:3,41990:3,41993:3,41994:3,41995:7,41996:3,42032:2,42033:2,42034:5,42036:2,42037:2,59932:7}},gps:{main:[1,2,5,2,5,1,5,5,0,9],rest:{18:2,29:2}}}}(),w._readIFD=function(P,F,$,D,U,Z){var j=P.readUshort(F,$);$+=2;var G={};Z.debug&&g("   ".repeat(U),D.length-1,">>>----------------");for(var H=0;H<j;H++){var W=P.readUshort(F,$);$+=2;var Q=P.readUshort(F,$);$+=2;var q=P.readUint(F,$);$+=4;var rt=P.readUint(F,$);$+=4;var it=[];if(Q==1||Q==7){var X=q<5?$-4:rt;X+q>F.buffer.byteLength&&(q=F.buffer.byteLength-X),it=new Uint8Array(F.buffer,X,q)}if(Q==2){var J=q<5?$-4:rt,tt=F[J],ot=Math.max(0,Math.min(q-1,F.length-J));tt<128||ot==0?it.push(P.readASCII(F,J,ot)):it=new Uint8Array(F.buffer,J,ot)}if(Q==3)for(var nt=0;nt<q;nt++)it.push(P.readUshort(F,(q<3?$-4:rt)+2*nt));if(Q==4||Q==13)for(nt=0;nt<q;nt++)it.push(P.readUint(F,(q<2?$-4:rt)+4*nt));if(Q==5||Q==10){var lt=Q==5?P.readUint:P.readInt;for(nt=0;nt<q;nt++)it.push([lt(F,rt+8*nt),lt(F,rt+8*nt+4)])}if(Q==8)for(nt=0;nt<q;nt++)it.push(P.readShort(F,(q<3?$-4:rt)+2*nt));if(Q==9)for(nt=0;nt<q;nt++)it.push(P.readInt(F,(q<2?$-4:rt)+4*nt));if(Q==11)for(nt=0;nt<q;nt++)it.push(P.readFloat(F,rt+4*nt));if(Q==12)for(nt=0;nt<q;nt++)it.push(P.readDouble(F,rt+8*nt));if(q==0||it.length!=0){if(Z.debug&&g("   ".repeat(U),W,Q,w.tags[W],it),G["t"+W]=it,!(W==330&&G.t272&&G.t272[0]=="DSLR-A100")){if(W==330||W==34665||W==34853||W==50740&&P.readUshort(F,P.readUint(it,0))<300||W==61440){var at=W==50740?[P.readUint(it,0)]:it,ut=[];for(nt=0;nt<at.length;nt++)w._readIFD(P,F,at[nt],ut,U+1,Z);W==330&&(G.subIFD=ut),W==34665&&(G.exifIFD=ut[0]),W==34853&&(G.gpsiIFD=ut[0]),W==50740&&(G.dngPrvt=ut[0]),W==61440&&(G.fujiIFD=ut[0])}}if(W==37500&&Z.parseMN){var V=it;if(P.readASCII(V,0,5)=="Nikon")G.makerNote=w.decode(V.slice(10).buffer)[0];else if(P.readASCII(V,0,5)=="OLYMP"||P.readASCII(V,0,9)=="OM SYSTEM"){var ht=[8208,8224,8240,8256,8272],vt=[];w._readIFD(P,V,V[1]==77?16:V[5]==85?12:8,vt,U+1,Z);var pt=G.makerNote=vt.pop();for(nt=0;nt<ht.length;nt++){var st="t"+ht[nt];pt[st]!=null&&(w._readIFD(P,V,pt[st][0],vt,U+1,Z),pt[st]=vt.pop())}pt.t12288&&(w._readIFD(P,pt.t12288,0,vt,U+1,Z),pt.t12288=vt.pop())}else P.readUshort(F,rt)<300&&P.readUshort(F,rt+4)<=12&&(vt=[],w._readIFD(P,F,rt,vt,U+1,Z),G.makerNote=vt[0])}}else if(g(W,"unknown TIFF tag type: ",Q,"num:",q),H==0)return}return D.push(G),Z.debug&&g("   ".repeat(U),"<<<---------------"),$},w._writeIFD=function(P,F,$,D,U){var Z=Object.keys(U),j=Z.length;U.exifIFD&&j--,U.gpsiIFD&&j--,P.writeUshort($,D,j);for(var G=(D+=2)+12*j+4,H=0;H<Z.length;H++){var W=Z[H];if(W!="t34665"&&W!="t34853"){W=="exifIFD"&&(W="t34665"),W=="gpsiIFD"&&(W="t34853");var Q=parseInt(W.slice(1)),q=F.main[Q];if(q==null&&(q=F.rest[Q]),q==null||q==0)throw new Error("unknown type of tag: "+Q);var rt=U[W];Q==34665&&(rt=[G],G=w._writeIFD(P,F,$,G,U.exifIFD)[1]),Q==34853&&(rt=[G],G=w._writeIFD(P,w._types.gps,$,G,U.gpsiIFD)[1]),q==2&&(rt=rt[0]+"\0");var it=rt.length;P.writeUshort($,D,Q),D+=2,P.writeUshort($,D,q),D+=2,P.writeUint($,D,it);var X=[-1,1,1,2,4,8,0,1,0,4,8,0,8][q]*it,J=D+=4;if(X>4&&(P.writeUint($,D,G),J=G),q==1||q==7)for(var tt=0;tt<it;tt++)$[J+tt]=rt[tt];else if(q==2)P.writeASCII($,J,rt);else if(q==3)for(tt=0;tt<it;tt++)P.writeUshort($,J+2*tt,rt[tt]);else if(q==4)for(tt=0;tt<it;tt++)P.writeUint($,J+4*tt,rt[tt]);else if(q==5||q==10){var ot=q==5?P.writeUint:P.writeInt;for(tt=0;tt<it;tt++){var nt=rt[tt],lt=nt[0],at=nt[1];if(lt==null)throw"e";ot($,J+8*tt,lt),ot($,J+8*tt+4,at)}}else if(q==9)for(tt=0;tt<it;tt++)P.writeInt($,J+4*tt,rt[tt]);else{if(q!=12)throw q;for(tt=0;tt<it;tt++)P.writeDouble($,J+8*tt,rt[tt])}X>4&&(G+=X+=1&X),D+=4}}return[D,G]},w.toRGBA8=function(P,F){function $(Kt){return Kt<.0031308?12.92*Kt:1.055*Math.pow(Kt,1/2.4)-.055}var D=P.width,U=P.height,Z=D*U,j=P.data,G=new Uint8Array(4*Z),H=P.t262?P.t262[0]:2,W=P.t258?Math.min(32,P.t258[0]):1;P.t262==null&&W==1&&(H=0);var Q=P.t277?P.t277[0]:P.t258?P.t258.length:[1,1,3,1,1,4,3][H],q=P.t339?P.t339[0]:null;if(H==1&&W==32&&q!=3)throw"e";var rt=Math.ceil(Q*W*D/8);if(H==0){F=1/256;for(var it=0;it<U;it++){var X=it*rt,J=it*D;if(W==1)for(var tt=0;tt<D;tt++){var ot=J+tt<<2,nt=j[X+(tt>>3)]>>7-(7&tt)&1;G[ot]=G[ot+1]=G[ot+2]=255*(1-nt),G[ot+3]=255}if(W==4)for(tt=0;tt<D;tt++)ot=J+tt<<2,nt=j[X+(tt>>1)]>>4-4*(1&tt)&15,G[ot]=G[ot+1]=G[ot+2]=17*(15-nt),G[ot+3]=255;if(W==8)for(tt=0;tt<D;tt++)ot=J+tt<<2,nt=j[X+tt],G[ot]=G[ot+1]=G[ot+2]=255-nt,G[ot+3]=255;if(W==16)for(tt=0;tt<D;tt++)ot=J+tt<<2,nt=j[(at=X+2*tt)+1]<<8|j[at],G[ot]=G[ot+1]=G[ot+2]=Math.min(255,255-~~(nt*F)),G[ot+3]=255}}else if(H==1){F==null&&(F=1/256);var lt=3&j.length?null:new Float32Array(j.buffer);for(it=0;it<U;it++){if(X=it*rt,J=it*D,W==1)for(tt=0;tt<D;tt++)ot=J+tt<<2,nt=j[X+(tt>>3)]>>7-(7&tt)&1,G[ot]=G[ot+1]=G[ot+2]=255*nt,G[ot+3]=255;if(W==2)for(tt=0;tt<D;tt++)ot=J+tt<<2,nt=j[X+(tt>>2)]>>6-2*(3&tt)&3,G[ot]=G[ot+1]=G[ot+2]=85*nt,G[ot+3]=255;if(W==8)for(tt=0;tt<D;tt++)ot=J+tt<<2,nt=j[X+tt*Q],G[ot]=G[ot+1]=G[ot+2]=nt,G[ot+3]=255;if(W==16)for(tt=0;tt<D;tt++)ot=J+tt<<2,nt=j[(at=X+2*tt)+1]<<8|j[at],G[ot]=G[ot+1]=G[ot+2]=Math.min(255,~~(nt*F)),G[ot+3]=255;if(W==32)for(tt=0;tt<D;tt++){var at;ot=J+tt<<2,nt=lt[at=(X>>>2)+tt],G[ot]=G[ot+1]=G[ot+2]=~~(.5+255*nt),G[ot+3]=255}}}else if(H==2)if(W==8){if(Q==1)for(tt=0;tt<Z;tt++)G[4*tt]=G[4*tt+1]=G[4*tt+2]=j[tt],G[4*tt+3]=255;if(Q==3)for(tt=0;tt<Z;tt++){var ut=3*tt;G[ot=tt<<2]=j[ut],G[ot+1]=j[ut+1],G[ot+2]=j[ut+2],G[ot+3]=255}if(Q>=4)for(tt=0;tt<Z;tt++)ut=tt*Q,G[ot=tt<<2]=j[ut],G[ot+1]=j[ut+1],G[ot+2]=j[ut+2],G[ot+3]=j[ut+3]}else if(W==16){if(Q==4)for(tt=0;tt<Z;tt++)ut=8*tt+1,G[ot=tt<<2]=j[ut],G[ot+1]=j[ut+2],G[ot+2]=j[ut+4],G[ot+3]=j[ut+6];if(Q==3)for(tt=0;tt<Z;tt++)ut=6*tt+1,G[ot=tt<<2]=j[ut],G[ot+1]=j[ut+2],G[ot+2]=j[ut+4],G[ot+3]=255}else{if(W!=32)throw W;var V=new Float32Array(j.buffer),ht=0;for(tt=0;tt<V.length;tt++)ht=Math.min(ht,V[tt]);if(ht<0)for(tt=0;tt<j.length;tt+=4){var vt=j[tt];j[tt]=j[tt+3],j[tt+3]=vt,vt=j[tt+1],j[tt+1]=j[tt+2],j[tt+2]=vt}var pt=[];for(tt=0;tt<65536;tt++)pt.push($(tt/65535));for(tt=0;tt<V.length;tt++){var st=Math.max(0,Math.min(1,V[tt]));V[tt]=pt[~~(.5+65535*st)]}if(Q==3)for(tt=0;tt<Z;tt++)ut=3*tt,G[ot=tt<<2]=~~(.5+255*V[ut]),G[ot+1]=~~(.5+255*V[ut+1]),G[ot+2]=~~(.5+255*V[ut+2]),G[ot+3]=255;else{if(Q!=4)throw Q;for(tt=0;tt<Z;tt++)ut=4*tt,G[ot=tt<<2]=~~(.5+255*V[ut]),G[ot+1]=~~(.5+255*V[ut+1]),G[ot+2]=~~(.5+255*V[ut+2]),G[ot+3]=~~(.5+255*V[ut+3])}}else if(H==3){var ct=P.t320,At=1<<W,kt=W==8&&Q>1&&P.t338&&P.t338[0]!=0;for(it=0;it<U;it++)for(var yt=0;yt<D;yt++){ot=(tt=it*D+yt)<<2;var Ct=0,xt=it*rt;if(W==1)Ct=j[xt+(yt>>>3)]>>>7-(7&yt)&1;else if(W==2)Ct=j[xt+(yt>>>2)]>>>6-2*(3&yt)&3;else if(W==4)Ct=j[xt+(yt>>>1)]>>>4-4*(1&yt)&15;else{if(W!=8)throw W;Ct=j[xt+yt*Q]}G[ot]=ct[Ct]>>8,G[ot+1]=ct[At+Ct]>>8,G[ot+2]=ct[At+At+Ct]>>8,G[ot+3]=kt?j[xt+yt*Q+1]:255}}else if(H==5){var Pt=Q>4?1:0;for(tt=0;tt<Z;tt++){ot=tt<<2;var Ft=tt*Q;if(window.UDOC){var Rt=j[Ft],Mt=j[Ft+1],Bt=j[Ft+2],$t=j[Ft+3],Ot=UDOC.C.cmykToRgb([Rt*(1/255),Mt*(1/255),Bt*(1/255),$t*(1/255)]);G[ot]=~~(.5+255*Ot[0]),G[ot+1]=~~(.5+255*Ot[1]),G[ot+2]=~~(.5+255*Ot[2])}else Rt=255-j[Ft],Mt=255-j[Ft+1],Bt=255-j[Ft+2],$t=(255-j[Ft+3])*(1/255),G[ot]=~~(Rt*$t+.5),G[ot+1]=~~(Mt*$t+.5),G[ot+2]=~~(Bt*$t+.5);G[ot+3]=255*(1-Pt)+j[Ft+4]*Pt}}else if(H==6&&P.t278){var Zt=P.t278[0];for(it=0;it<U;it+=Zt){tt=it*D;for(var Tt=Zt*D,et=0;et<Tt;et++){ot=4*(tt+et),Bt=j[(Ft=3*tt+4*(et>>>1))+(1&et)];var It=j[Ft+2]-128,mt=j[Ft+3]-128,gt=Bt+((mt>>2)+(mt>>3)+(mt>>5)),_t=Bt-((It>>2)+(It>>4)+(It>>5))-((mt>>1)+(mt>>3)+(mt>>4)+(mt>>5)),Et=Bt+(It+(It>>1)+(It>>2)+(It>>6));G[ot]=Math.max(0,Math.min(255,gt)),G[ot+1]=Math.max(0,Math.min(255,_t)),G[ot+2]=Math.max(0,Math.min(255,Et)),G[ot+3]=255}}}else if(H==32845)for(it=0;it<U;it++)for(yt=0;yt<D;yt++){ot=4*(it*D+yt);var zt=j[(Ft=6*(it*D+yt))+1]<<8|j[Ft],K=(zt=Math.pow(2,(zt+.5)/256-64),(j[Ft+3]+.5)/410),ft=(j[Ft+5]+.5)/410,bt=9*K/(6*K-16*ft+12),wt=4*ft/(6*K-16*ft+12),Lt=bt*zt/wt,jt=(1-bt-wt)*zt/wt;gt=2.69*Lt-1.276*(Bt=zt)-.414*jt,_t=-1.022*Lt+1.978*Bt+.044*jt,Et=.061*Lt-.224*Bt+1.163*jt,G[ot]=255*$(Math.min(gt,1)),G[ot+1]=255*$(Math.min(_t,1)),G[ot+2]=255*$(Math.min(Et,1)),G[ot+3]=255}else g("Unknown Photometric interpretation: "+H);return G},w.replaceIMG=function(P){P==null&&(P=document.getElementsByTagName("img"));for(var F=["tif","tiff","dng","cr2","nef"],$=0;$<P.length;$++){var D=P[$],U=D.getAttribute("src");if(U!=null){var Z=U.split(".").pop().toLowerCase();if(F.indexOf(Z)!=-1){var j=new XMLHttpRequest;w._xhrs.push(j),w._imgs.push(D),j.open("GET",U),j.responseType="arraybuffer",j.onload=w._imgLoaded,j.send()}}}},w._xhrs=[],w._imgs=[],w._imgLoaded=function(P){var F=w._xhrs.indexOf(P.target),$=w._imgs[F];w._xhrs.splice(F,1),w._imgs.splice(F,1),$.setAttribute("src",w.bufferToURI(P.target.response))},w.bufferToURI=function(P){var F=w.decode(P),$=F,D=0,U=$[0];F[0].subIFD&&($=$.concat(F[0].subIFD));for(var Z=0;Z<$.length;Z++){var j=$[Z];if(!(j.t258==null||j.t258.length<3)){var G=j.t256*j.t257;G>D&&(D=G,U=j)}}w.decodeImage(P,U,F);var H=w.toRGBA8(U),W=U.width,Q=U.height,q=document.createElement("canvas");q.width=W,q.height=Q;var rt=q.getContext("2d"),it=new ImageData(new Uint8ClampedArray(H.buffer),W,Q);return rt.putImageData(it,0,0),q.toDataURL()},w._binBE={nextZero:function(P,F){for(;P[F]!=0;)F++;return F},readUshort:function(P,F){return P[F]<<8|P[F+1]},readShort:function(P,F){var $=w._binBE.ui8;return $[0]=P[F+1],$[1]=P[F+0],w._binBE.i16[0]},readInt:function(P,F){var $=w._binBE.ui8;return $[0]=P[F+3],$[1]=P[F+2],$[2]=P[F+1],$[3]=P[F+0],w._binBE.i32[0]},readUint:function(P,F){var $=w._binBE.ui8;return $[0]=P[F+3],$[1]=P[F+2],$[2]=P[F+1],$[3]=P[F+0],w._binBE.ui32[0]},readASCII:function(P,F,$){for(var D="",U=0;U<$;U++)D+=String.fromCharCode(P[F+U]);return D},readFloat:function(P,F){for(var $=w._binBE.ui8,D=0;D<4;D++)$[D]=P[F+3-D];return w._binBE.fl32[0]},readDouble:function(P,F){for(var $=w._binBE.ui8,D=0;D<8;D++)$[D]=P[F+7-D];return w._binBE.fl64[0]},writeUshort:function(P,F,$){P[F]=$>>8&255,P[F+1]=255&$},writeInt:function(P,F,$){var D=w._binBE.ui8;w._binBE.i32[0]=$,P[F+3]=D[0],P[F+2]=D[1],P[F+1]=D[2],P[F+0]=D[3]},writeUint:function(P,F,$){P[F]=$>>24&255,P[F+1]=$>>16&255,P[F+2]=$>>8&255,P[F+3]=255&$},writeASCII:function(P,F,$){for(var D=0;D<$.length;D++)P[F+D]=$.charCodeAt(D)},writeDouble:function(P,F,$){w._binBE.fl64[0]=$;for(var D=0;D<8;D++)P[F+D]=w._binBE.ui8[7-D]}},w._binBE.ui8=new Uint8Array(8),w._binBE.i16=new Int16Array(w._binBE.ui8.buffer),w._binBE.i32=new Int32Array(w._binBE.ui8.buffer),w._binBE.ui32=new Uint32Array(w._binBE.ui8.buffer),w._binBE.fl32=new Float32Array(w._binBE.ui8.buffer),w._binBE.fl64=new Float64Array(w._binBE.ui8.buffer),w._binLE={nextZero:w._binBE.nextZero,readUshort:function(P,F){return P[F+1]<<8|P[F]},readShort:function(P,F){var $=w._binBE.ui8;return $[0]=P[F+0],$[1]=P[F+1],w._binBE.i16[0]},readInt:function(P,F){var $=w._binBE.ui8;return $[0]=P[F+0],$[1]=P[F+1],$[2]=P[F+2],$[3]=P[F+3],w._binBE.i32[0]},readUint:function(P,F){var $=w._binBE.ui8;return $[0]=P[F+0],$[1]=P[F+1],$[2]=P[F+2],$[3]=P[F+3],w._binBE.ui32[0]},readASCII:w._binBE.readASCII,readFloat:function(P,F){for(var $=w._binBE.ui8,D=0;D<4;D++)$[D]=P[F+D];return w._binBE.fl32[0]},readDouble:function(P,F){for(var $=w._binBE.ui8,D=0;D<8;D++)$[D]=P[F+D];return w._binBE.fl64[0]},writeUshort:function(P,F,$){P[F]=255&$,P[F+1]=$>>8&255},writeInt:function(P,F,$){var D=w._binBE.ui8;w._binBE.i32[0]=$,P[F+0]=D[0],P[F+1]=D[1],P[F+2]=D[2],P[F+3]=D[3]},writeUint:function(P,F,$){P[F]=$>>>0&255,P[F+1]=$>>>8&255,P[F+2]=$>>>16&255,P[F+3]=$>>>24&255},writeASCII:w._binBE.writeASCII},w._copyTile=function(P,F,$,D,U,Z,j,G){for(var H=Math.min(F,U-j),W=Math.min($,Z-G),Q=0;Q<W;Q++)for(var q=(G+Q)*U+j,rt=Q*F,it=0;it<H;it++)D[q+it]=P[rt+it]},w.LosslessJpegDecode=function(){var P,F;function $(){return P[F++]}function D(){return P[F++]<<8|P[F++]}function U(X){for(var J=$(),tt=[0,0,0,255],ot=[],nt=0;nt<16;nt++)ot[nt]=$();for(nt=0;nt<16;nt++)for(var lt=0;lt<ot[nt];lt++)tt[Z(tt,0,nt+1,1)+3]=$();var at=new Uint8Array(256);for(X[J]=[new Uint8Array(tt),at],nt=0;nt<256;nt++){for(var ut=8,V=nt,ht=0;tt[ht+3]==255&&ut!=0;)ht=tt[ht+(V>>--ut&1)];at[nt]=ht}}function Z(X,J,tt,ot){if(X[J+3]!=255)return 0;if(tt==0)return J;for(var nt=0;nt<2;nt++){X[J+nt]==0&&(X[J+nt]=X.length,X.push(0,0,ot,255));var lt=Z(X,X[J+nt],tt-1,ot+1);if(lt!=0)return lt}return 0}function j(X){for(var J=X.b,tt=X.f;J<25&&X.a<X.d;){var ot=X.data[X.a++];ot!=255||X.c||X.a++,tt=tt<<8|ot,J+=8}if(J<0)throw"e";X.b=J,X.f=tt}function G(X,J){return J.b<X&&j(J),J.f>>(J.b-=X)&65535>>16-X}function H(X,J){var tt=X[0],ot=0,nt=255;J.b<16&&j(J);var lt=J.f>>J.b-8&255;for(nt=tt[(ot=X[1][lt])+3],J.b-=tt[ot+2];nt==255;)nt=tt[(ot=tt[ot+(J.f>>--J.b&1)])+3];return nt}function W(X,J){return X<32768>>16-J&&(X+=1-(1<<J)),X}function Q(X,J){var tt=H(X,J);return tt==0?0:tt==16?-32768:W(G(tt,J),tt)}function q(X,J,tt,ot,nt,lt){for(var at=0,ut=0;ut<lt;ut++){for(var V=ut*J,ht=0;ht<J;ht+=nt){at++;for(var vt=0;vt<nt;vt++)X[V+ht+vt]=Q(ot[vt],tt)}if(tt.e!=0&&at%tt.e==0&&ut!=0){for(var pt=tt.a,st=tt.data;st[pt]!=255||!(208<=st[pt+1]&&st[pt+1]<=215);)pt--;tt.a=pt+2,tt.f=0,tt.b=0}}}function rt(X,J){return W(G(X,J),X)}function it(X,J,tt,ot,nt,lt,at,ut){for(var V=tt*at,ht=nt;ht<lt;ht++)X[ht]+=1<<ut-1;for(var vt=at;vt<V;vt+=at)for(ht=nt;ht<lt;ht++)X[vt+ht]+=X[vt+ht-at];for(var pt=1;pt<ot;pt++){var st=pt*V;for(ht=nt;ht<lt;ht++)X[st+ht]+=X[st+ht-V];for(vt=at;vt<V;vt+=at)for(ht=nt;ht<lt;ht++){var ct=st+vt+ht,At=ct-V,kt=X[ct-at],yt=0;if(J==0)yt=0;else if(J==1)yt=kt;else if(J==2)yt=X[At];else if(J==3)yt=X[At-at];else if(J==4)yt=kt+(X[At]-X[At-at]);else if(J==5)yt=kt+(X[At]-X[At-at]>>>1);else if(J==6)yt=X[At]+(kt-X[At-at]>>>1);else{if(J!=7)throw J;yt=kt+X[At]>>>1}X[ct]+=yt}}}return function(X){if(P=X,F=0,D()!=65496)throw"e";for(var J=[],tt=0,ot=0,nt=0,lt=[],at=[],ut=[],V=0,ht=0,vt=0;;){var pt=D();if(pt!=65535){var st=D();if(pt==65475){ot=$(),ht=D(),vt=D(),V=$();for(var ct=0;ct<V;ct++){var At=$(),kt=$();if($()!=0)throw"e";J[At]=[ct,kt>>4,15&kt]}}else if(pt==65476)for(var yt=F+st-2;F<yt;)U(at);else{if(pt==65498){for(F++,ct=0;ct<V;ct++){var Ct=J[$()];ut[Ct[0]]=at[$()>>>4],lt[Ct[0]]=Ct.slice(1)}tt=$(),F+=2;break}pt==65501?nt=D():F+=st-2}}else F--}var xt=new(ot>8?Uint16Array:Uint8Array)(ht*vt*V),Pt={b:0,f:0,c:tt==8,a:F,data:P,d:P.length,e:nt};if(Pt.c)(function(Lt,jt,Kt,te,Vt){for(var ee=P.length-F,Jt=0;Jt<ee;Jt+=4){var oe=P[F+Jt];P[F+Jt]=P[F+Jt+3],P[F+Jt+3]=oe,oe=P[F+Jt+1],P[F+Jt+1]=P[F+Jt+2],P[F+Jt+2]=oe}for(var ne=0;ne<Vt;ne++)for(var ae=32768,fe=32768,ie=0;ie<jt;ie+=2){var Nt=H(te,Kt),Xt=H(te,Kt);Nt!=0&&(ae+=rt(Nt,Kt)),Xt!=0&&(fe+=rt(Xt,Kt)),Lt[ne*jt+ie]=65535&ae,Lt[ne*jt+ie+1]=65535&fe}})(xt,vt*V,Pt,ut[0],ht);else{var Ft=[],Rt=0,Mt=0;for(ct=0;ct<V;ct++){var Bt=lt[ct];(Et=Bt[0])>Rt&&(Rt=Et),(_t=Bt[1])>Mt&&(Mt=_t),Ft.push(Et*_t)}if(Rt!=1||Mt!=1){if(V!=3||Ft[1]!=1||Ft[2]!=1||Rt!=2||Mt!=1&&Mt!=2)throw"e";var $t=[],Ot=0;for(ct=0;ct<V;ct++){for(var Zt=0;Zt<Ft[ct];Zt++)$t.push(ut[ct]);Ot+=Ft[ct]}var Tt=vt/Rt,et=ht/Mt,It=Tt*et;q(xt,Tt*Ot,Pt,$t,Ot,et),it(xt,tt,Tt,et,Ot-2,Ot,Ot,ot);var mt=new Uint16Array(It*Ft[0]);if(Rt==2&&Mt==2){for(ct=0;ct<It;ct++)mt[4*ct]=xt[6*ct],mt[4*ct+1]=xt[6*ct+1],mt[4*ct+2]=xt[6*ct+2],mt[4*ct+3]=xt[6*ct+3];for(it(mt,tt,4*Tt,et,0,1,1,ot),ct=0;ct<It;ct++)xt[6*ct]=mt[4*ct],xt[6*ct+1]=mt[4*ct+1],xt[6*ct+2]=mt[4*ct+2],xt[6*ct+3]=mt[4*ct+3]}if(Rt==2&&Mt==1){for(ct=0;ct<It;ct++)mt[2*ct]=xt[4*ct],mt[2*ct+1]=xt[4*ct+1];for(it(mt,tt,2*Tt,et,0,1,1,ot),ct=0;ct<It;ct++)xt[4*ct]=mt[2*ct],xt[4*ct+1]=mt[2*ct+1]}for(var gt=xt.slice(0),_t=0;_t<ht;_t++)if(Mt==2)for(var Et=0;Et<vt;Et++){var zt=((_t>>>1)*Tt+(Et>>>1))*Ot,K=2*(1&_t)+(1&Et);xt[ft=(_t*vt+Et)*V]=gt[zt+K],xt[ft+1]=gt[zt+4],xt[ft+2]=gt[zt+5]}else for(Et=0;Et<vt;Et++){var ft;zt=(_t*Tt+(Et>>>1))*Ot,K=1&Et,xt[ft=(_t*vt+Et)*V]=gt[zt+K],xt[ft+1]=gt[zt+2],xt[ft+2]=gt[zt+3]}}else if(q(xt,vt*V,Pt,ut,V,ht),nt==0)it(xt,tt,vt,ht,0,V,V,ot);else{var bt=Math.floor(nt/vt);for(_t=0;_t<ht;_t+=bt){var wt=xt.slice(_t*vt*V,(_t+bt)*vt*V);it(wt,tt,vt,bt,0,V,V,ot),xt.set(wt,_t*vt*V)}}}return xt}}(),function(){var P=2,F=4,$=5,D=6,U=7,Z=12,j=13,G=14,H=15,W=17;function Q(lt){var at={c:new Int8Array(2<<lt.u)};return function(ut,V,ht){var vt=[V,3*V+18,5*V+67,7*V+276,ht];ut.o=V,ut.w=(vt[4]+2*V)/(2*V+1)+1|0,ut.v=Math.ceil(Math.log2(ut.w)),ut.t=9,function(pt,st){for(var ct=-st[4],At=0;ct<=st[4];At++,ct++)pt[At]=ct<=-276?-4:ct<=-67?-3:ct<=-18?-2:ct<-0?-1:ct<=st[0]?0:ct<st[1]?1:ct<st[2]?2:ct<st[3]?3:4}(ut.c,vt)}(at,0,lt.g),at}function q(lt){for(var at=[[],[],[]],ut=Math.max(2,lt.w+32>>>6),V=0;V<3;V++)for(var ht=0;ht<41;ht++)at[V][ht]=[ut,1];return at}function rt(lt,at){var ut=0,V=8-lt.a;if(lt.j,lt.a,at){if(at>=V)do ut<<=V,at-=V,ut|=lt[lt.j]&(1<<V)-1,lt.j++,V=8;while(at>=8);at&&(ut<<=at,V-=at,ut|=lt[lt.j]>>>V&(1<<at)-1),lt.a=8-V}return ut}function it(lt,at,ut,V,ht,vt,pt,st){st==null&&(st=0);var ct,At,kt,yt,Ct,xt,Pt=vt+1,Ft=Pt%2,Rt=0,Mt=V[ht],Bt=V[ht-1],$t=V[ht-2][Pt],Ot=Bt[Pt-1],Zt=Bt[Pt],Tt=Bt[Pt+1],et=Mt[Pt-1],It=Mt[Pt+1],mt=Math.abs;if(Ft&&(kt=mt(Tt-Zt),yt=mt($t-Zt),Ct=mt(Ot-Zt)),Ft){if(xt=(xt=kt>Ct&&yt<kt?$t+Ot:kt<Ct&&yt<Ct?$t+Tt:Tt+Ot)+2*Zt>>>2,st)return void(Mt[Pt]=xt);ct=at.t*at.c[lt.g+Zt-$t]+at.c[lt.g+Ot-Zt]}else xt=Zt>Ot&&Zt>Tt||Zt<Ot&&Zt<Tt?It+et+2*Zt>>>2:et+It>>>1,ct=at.t*at.c[lt.g+Zt-Ot]+at.c[lt.g+Ot-et];At=mt(ct);var gt=function(Et){for(var zt=-1,K=0;!K;zt++)K=Et[Et.j]>>>7-Et.a&1,Et.a++,Et.a&=7,Et.a||Et.j++;return zt}(ut);if(gt<lt.n-at.v-1){var _t=function(Et,zt){var K=0;if(zt<Et)for(;K<=14&&zt<<++K<Et;);return K}(pt[At][0],pt[At][1]);Rt=rt(ut,_t)+(gt<<_t)}else Rt=rt(ut,at.v)+1;Rt=1&Rt?-1-(Rt>>>1):Rt>>>1,pt[At][0]+=mt(Rt),pt[At][1]==lt.f&&(pt[At][0]>>>=1,pt[At][1]>>>=1),pt[At][1]++,xt=ct<0?xt-Rt:xt+Rt,lt.i&&(xt<0?xt+=at.w:xt>lt.g&&(xt-=at.w)),Mt[Pt]=xt>=0?Math.min(xt,lt.g):0}function X(lt,at,ut){for(var V=lt[0].length,ht=at;ht<=ut;ht++)lt[ht][0]=lt[ht-1][1],lt[ht][V-1]=lt[ht-1][V-2]}function J(lt){X(lt,U,Z),X(lt,P,F),X(lt,H,W)}function tt(lt,at,ut,V,ht,vt,pt,st,ct,At,kt,yt,Ct){for(var xt=0,Pt=1,Ft=ht<j&&ht>F;Pt<lt.m;)xt<lt.m&&(it(lt,at,ut,V,ht,xt,pt[ct],lt.h&&(Ft&&At||!Ft&&(kt||(xt&yt)==Ct))),it(lt,at,ut,V,vt,xt,pt[ct],lt.h&&(!Ft&&At||Ft&&(kt||(xt&yt)==Ct))),xt+=2),xt>8&&(it(lt,at,ut,V,ht,Pt,st[ct]),it(lt,at,ut,V,vt,Pt,st[ct]),Pt+=2);J(V)}function ot(lt,at,ut,V,ht,vt){tt(lt,at,ut,V,P,U,ht,vt,0,0,1,0,8),tt(lt,at,ut,V,8,H,ht,vt,1,0,1,0,8),tt(lt,at,ut,V,3,9,ht,vt,2,1,0,3,0),tt(lt,at,ut,V,10,16,ht,vt,0,0,0,3,2),tt(lt,at,ut,V,F,11,ht,vt,1,0,0,3,2),tt(lt,at,ut,V,Z,W,ht,vt,2,1,0,3,0)}function nt(lt,at,ut,V,ht,vt){var pt=vt.length,st=lt.l;ht+1==lt.s&&(st=lt.e-ht*lt.l);for(var ct=6*lt.e*V+ht*lt.l,At=0;At<6;At++){for(var kt=0;kt<st;kt++){var yt,Ct=vt[At%pt][kt%pt];yt=Ct==0?P+(At>>>1):Ct==2?H+(At>>>1):U+At;var xt=lt.h?(2*kt/3&2147483646|kt%3&1)+(kt%3>>>1):kt>>>1;at[ct+kt]=ut[yt][xt+1]}ct+=lt.e}}w._decompressRAF=function(lt,at){var ut=function(Pt){var Ft=w._binBE.readUshort,Rt={b:Ft(Pt,0),i:Pt[2],C:Pt[3],u:Pt[4],q:Ft(Pt,5),k:Ft(Pt,7),e:Ft(Pt,9),l:Ft(Pt,11),s:Pt[13],d:Ft(Pt,14)};if(Rt.b!=18771||Rt.i>1||Rt.q<6||Rt.q%6||Rt.e<768||Rt.e%24||Rt.l!=768||Rt.k<Rt.l||Rt.k%Rt.l||Rt.k-Rt.e>=Rt.l||Rt.s>16||Rt.s!=Rt.k/Rt.l||Rt.s!=Math.ceil(Rt.e/Rt.l)||Rt.d!=Rt.q/6||Rt.u!=12&&Rt.u!=14&&Rt.u!=16||Rt.C!=16&&Rt.C!=0)throw"Invalid data";if(Rt.i==0)throw"Not implemented. We need this file!";return Rt.h=Rt.C==16,Rt.m=0|(Rt.h?2*Rt.l/3:Rt.l>>>1),Rt.A=Rt.m+2,Rt.f=64,Rt.g=(1<<Rt.u)-1,Rt.n=4*Rt.u,Rt}(lt),V=function(Pt,Ft){var Rt=new Array(Ft.s),Mt=4*Ft.s,Bt=16+Mt;12&Mt&&(Bt+=16-(12&Mt));for(var $t=0,Ot=16;$t<Ft.s;Ot+=4){var Zt=w._binBE.readUint(Pt,Ot);Rt[$t]=Pt.slice(Bt,Bt+Zt),Rt[$t].j=0,Rt[$t].a=0,Bt+=Zt,$t++}if(Bt!=Pt.length)throw"Invalid data";return Rt}(lt,ut),ht=Q(ut),vt=new Int16Array(ut.e*ut.q);at==null&&(at=ut.h?[[1,1,0,1,1,2],[1,1,2,1,1,0],[2,0,1,0,2,1],[1,1,2,1,1,0],[1,1,0,1,1,2],[0,2,1,2,0,1]]:[[0,1],[3,2]]);for(var pt=[[0,3],[1,F],[$,11],[D,Z],[j,16],[G,W]],st=[],ct=0;ct<18;ct++)st[ct]=new Uint16Array(ut.A);for(var At=0;At<ut.s;At++){var kt=q(ht),yt=q(ht);for(ct=0;ct<18;ct++)for(var Ct=0;Ct<ut.A;Ct++)st[ct][Ct]=0;for(var xt=0;xt<ut.d;xt++){for(ot(ut,ht,V[At],st,kt,yt),ct=0;ct<6;ct++)for(Ct=0;Ct<ut.A;Ct++)st[pt[ct][0]][Ct]=st[pt[ct][1]][Ct];for(nt(ut,vt,st,xt,At,at),ct=P;ct<18;ct++)if([$,D,j,G].indexOf(ct)==-1)for(Ct=0;Ct<ut.A;Ct++)st[ct][Ct]=0;J(st)}}return vt}}()}(m,typeof commonjsRequire=="function"?requirePako():self.pako)})()})(UTIF);var UTIFExports=UTIF.exports,utif=getDefaultExportFromCjs(UTIFExports),util$1,objectUtil;function getDimensionValue(d){return typeof d=="number"?d:d instanceof Uint8Array?d[0]:typeof d[0]=="string"?parseInt(d[0]):d[0]}function tiff(){return{mime:"image/tiff",encode:d=>{const m=utif.encodeImage(d.data,d.width,d.height);return Buffer.from(m)},decode:d=>{const m=utif.decode(d),g=m[0];if(!g)throw new Error("No page found in TIFF");if(!g.t256)throw new Error("No image width found in TIFF");if(!g.t257)throw new Error("No image height found in TIFF");m.forEach(I=>{utif.decodeImage(d,I)});const w=utif.toRGBA8(g);return{data:Buffer.from(w),width:getDimensionValue(g.t256),height:getDimensionValue(g.t257)}}}}(function(d){d.assertEqual=m=>m,d.assertIs=function(m){},d.assertNever=function(m){throw new Error},d.arrayToEnum=m=>{const g={};for(const w of m)g[w]=w;return g},d.getValidEnumValues=m=>{const g=d.objectKeys(m).filter(I=>typeof m[m[I]]!="number"),w={};for(const I of g)w[I]=m[I];return d.objectValues(w)},d.objectValues=m=>d.objectKeys(m).map(function(g){return m[g]}),d.objectKeys=typeof Object.keys=="function"?m=>Object.keys(m):m=>{const g=[];for(const w in m)Object.prototype.hasOwnProperty.call(m,w)&&g.push(w);return g},d.find=(m,g)=>{for(const w of m)if(g(w))return w},d.isInteger=typeof Number.isInteger=="function"?m=>Number.isInteger(m):m=>typeof m=="number"&&isFinite(m)&&Math.floor(m)===m,d.joinValues=function(m,g=" | "){return m.map(w=>typeof w=="string"?`'${w}'`:w).join(g)},d.jsonStringifyReplacer=(m,g)=>typeof g=="bigint"?g.toString():g})(util$1||(util$1={})),function(d){d.mergeShapes=(m,g)=>({...m,...g})}(objectUtil||(objectUtil={}));const ZodParsedType=util$1.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),getParsedType=d=>{switch(typeof d){case"undefined":return ZodParsedType.undefined;case"string":return ZodParsedType.string;case"number":return isNaN(d)?ZodParsedType.nan:ZodParsedType.number;case"boolean":return ZodParsedType.boolean;case"function":return ZodParsedType.function;case"bigint":return ZodParsedType.bigint;case"symbol":return ZodParsedType.symbol;case"object":return Array.isArray(d)?ZodParsedType.array:d===null?ZodParsedType.null:d.then&&typeof d.then=="function"&&d.catch&&typeof d.catch=="function"?ZodParsedType.promise:typeof Map<"u"&&d instanceof Map?ZodParsedType.map:typeof Set<"u"&&d instanceof Set?ZodParsedType.set:typeof Date<"u"&&d instanceof Date?ZodParsedType.date:ZodParsedType.object;default:return ZodParsedType.unknown}},ZodIssueCode=util$1.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),quotelessJson=d=>JSON.stringify(d,null,2).replace(/"([^"]+)":/g,"$1:");class ZodError extends Error{constructor(m){super(),this.issues=[],this.addIssue=w=>{this.issues=[...this.issues,w]},this.addIssues=(w=[])=>{this.issues=[...this.issues,...w]};const g=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,g):this.__proto__=g,this.name="ZodError",this.issues=m}get errors(){return this.issues}format(m){const g=m||function(P){return P.message},w={_errors:[]},I=P=>{for(const F of P.issues)if(F.code==="invalid_union")F.unionErrors.map(I);else if(F.code==="invalid_return_type")I(F.returnTypeError);else if(F.code==="invalid_arguments")I(F.argumentsError);else if(F.path.length===0)w._errors.push(g(F));else{let $=w,D=0;for(;D<F.path.length;){const U=F.path[D];D===F.path.length-1?($[U]=$[U]||{_errors:[]},$[U]._errors.push(g(F))):$[U]=$[U]||{_errors:[]},$=$[U],D++}}};return I(this),w}static assert(m){if(!(m instanceof ZodError))throw new Error(`Not a ZodError: ${m}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,util$1.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(m=g=>g.message){const g={},w=[];for(const I of this.issues)I.path.length>0?(g[I.path[0]]=g[I.path[0]]||[],g[I.path[0]].push(m(I))):w.push(m(I));return{formErrors:w,fieldErrors:g}}get formErrors(){return this.flatten()}}ZodError.create=d=>new ZodError(d);const errorMap=(d,m)=>{let g;switch(d.code){case ZodIssueCode.invalid_type:g=d.received===ZodParsedType.undefined?"Required":`Expected ${d.expected}, received ${d.received}`;break;case ZodIssueCode.invalid_literal:g=`Invalid literal value, expected ${JSON.stringify(d.expected,util$1.jsonStringifyReplacer)}`;break;case ZodIssueCode.unrecognized_keys:g=`Unrecognized key(s) in object: ${util$1.joinValues(d.keys,", ")}`;break;case ZodIssueCode.invalid_union:g="Invalid input";break;case ZodIssueCode.invalid_union_discriminator:g=`Invalid discriminator value. Expected ${util$1.joinValues(d.options)}`;break;case ZodIssueCode.invalid_enum_value:g=`Invalid enum value. Expected ${util$1.joinValues(d.options)}, received '${d.received}'`;break;case ZodIssueCode.invalid_arguments:g="Invalid function arguments";break;case ZodIssueCode.invalid_return_type:g="Invalid function return type";break;case ZodIssueCode.invalid_date:g="Invalid date";break;case ZodIssueCode.invalid_string:typeof d.validation=="object"?"includes"in d.validation?(g=`Invalid input: must include "${d.validation.includes}"`,typeof d.validation.position=="number"&&(g=`${g} at one or more positions greater than or equal to ${d.validation.position}`)):"startsWith"in d.validation?g=`Invalid input: must start with "${d.validation.startsWith}"`:"endsWith"in d.validation?g=`Invalid input: must end with "${d.validation.endsWith}"`:util$1.assertNever(d.validation):g=d.validation!=="regex"?`Invalid ${d.validation}`:"Invalid";break;case ZodIssueCode.too_small:g=d.type==="array"?`Array must contain ${d.exact?"exactly":d.inclusive?"at least":"more than"} ${d.minimum} element(s)`:d.type==="string"?`String must contain ${d.exact?"exactly":d.inclusive?"at least":"over"} ${d.minimum} character(s)`:d.type==="number"?`Number must be ${d.exact?"exactly equal to ":d.inclusive?"greater than or equal to ":"greater than "}${d.minimum}`:d.type==="date"?`Date must be ${d.exact?"exactly equal to ":d.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(d.minimum))}`:"Invalid input";break;case ZodIssueCode.too_big:g=d.type==="array"?`Array must contain ${d.exact?"exactly":d.inclusive?"at most":"less than"} ${d.maximum} element(s)`:d.type==="string"?`String must contain ${d.exact?"exactly":d.inclusive?"at most":"under"} ${d.maximum} character(s)`:d.type==="number"?`Number must be ${d.exact?"exactly":d.inclusive?"less than or equal to":"less than"} ${d.maximum}`:d.type==="bigint"?`BigInt must be ${d.exact?"exactly":d.inclusive?"less than or equal to":"less than"} ${d.maximum}`:d.type==="date"?`Date must be ${d.exact?"exactly":d.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(d.maximum))}`:"Invalid input";break;case ZodIssueCode.custom:g="Invalid input";break;case ZodIssueCode.invalid_intersection_types:g="Intersection results could not be merged";break;case ZodIssueCode.not_multiple_of:g=`Number must be a multiple of ${d.multipleOf}`;break;case ZodIssueCode.not_finite:g="Number must be finite";break;default:g=m.defaultError,util$1.assertNever(d)}return{message:g}};let overrideErrorMap=errorMap;function setErrorMap(d){overrideErrorMap=d}function getErrorMap(){return overrideErrorMap}const makeIssue=d=>{const{data:m,path:g,errorMaps:w,issueData:I}=d,P=[...g,...I.path||[]],F={...I,path:P};if(I.message!==void 0)return{...I,path:P,message:I.message};let $="";const D=w.filter(U=>!!U).slice().reverse();for(const U of D)$=U(F,{data:m,defaultError:$}).message;return{...I,path:P,message:$}},EMPTY_PATH=[];function addIssueToContext(d,m){const g=getErrorMap(),w=makeIssue({issueData:m,data:d.data,path:d.path,errorMaps:[d.common.contextualErrorMap,d.schemaErrorMap,g,g===errorMap?void 0:errorMap].filter(I=>!!I)});d.common.issues.push(w)}class ParseStatus{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(m,g){const w=[];for(const I of g){if(I.status==="aborted")return INVALID;I.status==="dirty"&&m.dirty(),w.push(I.value)}return{status:m.value,value:w}}static async mergeObjectAsync(m,g){const w=[];for(const I of g){const P=await I.key,F=await I.value;w.push({key:P,value:F})}return ParseStatus.mergeObjectSync(m,w)}static mergeObjectSync(m,g){const w={};for(const I of g){const{key:P,value:F}=I;if(P.status==="aborted"||F.status==="aborted")return INVALID;P.status==="dirty"&&m.dirty(),F.status==="dirty"&&m.dirty(),P.value==="__proto__"||F.value===void 0&&!I.alwaysSet||(w[P.value]=F.value)}return{status:m.value,value:w}}}const INVALID=Object.freeze({status:"aborted"}),DIRTY=d=>({status:"dirty",value:d}),OK=d=>({status:"valid",value:d}),isAborted=d=>d.status==="aborted",isDirty=d=>d.status==="dirty",isValid=d=>d.status==="valid",isAsync=d=>typeof Promise<"u"&&d instanceof Promise;function __classPrivateFieldGet(d,m,g,w){if(typeof m=="function"?d!==m||!0:!m.has(d))throw new TypeError("Cannot read private member from an object whose class did not declare it");return m.get(d)}function __classPrivateFieldSet(d,m,g,w,I){if(typeof m=="function"?d!==m||!0:!m.has(d))throw new TypeError("Cannot write private member to an object whose class did not declare it");return m.set(d,g),g}var errorUtil,_ZodEnum_cache,_ZodNativeEnum_cache;typeof SuppressedError=="function"&&SuppressedError,function(d){d.errToObj=m=>typeof m=="string"?{message:m}:m||{},d.toString=m=>typeof m=="string"?m:m==null?void 0:m.message}(errorUtil||(errorUtil={}));class ParseInputLazyPath{constructor(m,g,w,I){this._cachedPath=[],this.parent=m,this.data=g,this._path=w,this._key=I}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const handleResult=(d,m)=>{if(isValid(m))return{success:!0,data:m.value};if(!d.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const g=new ZodError(d.common.issues);return this._error=g,this._error}}};function processCreateParams(d){if(!d)return{};const{errorMap:m,invalid_type_error:g,required_error:w,description:I}=d;if(m&&(g||w))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return m?{errorMap:m,description:I}:{errorMap:(P,F)=>{var $,D;const{message:U}=d;return P.code==="invalid_enum_value"?{message:U??F.defaultError}:F.data===void 0?{message:($=U??w)!==null&&$!==void 0?$:F.defaultError}:P.code!=="invalid_type"?{message:F.defaultError}:{message:(D=U??g)!==null&&D!==void 0?D:F.defaultError}},description:I}}class ZodType{constructor(m){this.spa=this.safeParseAsync,this._def=m,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(m){return getParsedType(m.data)}_getOrReturnCtx(m,g){return g||{common:m.parent.common,data:m.data,parsedType:getParsedType(m.data),schemaErrorMap:this._def.errorMap,path:m.path,parent:m.parent}}_processInputParams(m){return{status:new ParseStatus,ctx:{common:m.parent.common,data:m.data,parsedType:getParsedType(m.data),schemaErrorMap:this._def.errorMap,path:m.path,parent:m.parent}}}_parseSync(m){const g=this._parse(m);if(isAsync(g))throw new Error("Synchronous parse encountered promise.");return g}_parseAsync(m){const g=this._parse(m);return Promise.resolve(g)}parse(m,g){const w=this.safeParse(m,g);if(w.success)return w.data;throw w.error}safeParse(m,g){var w;const I={common:{issues:[],async:(w=g==null?void 0:g.async)!==null&&w!==void 0&&w,contextualErrorMap:g==null?void 0:g.errorMap},path:(g==null?void 0:g.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:m,parsedType:getParsedType(m)},P=this._parseSync({data:m,path:I.path,parent:I});return handleResult(I,P)}async parseAsync(m,g){const w=await this.safeParseAsync(m,g);if(w.success)return w.data;throw w.error}async safeParseAsync(m,g){const w={common:{issues:[],contextualErrorMap:g==null?void 0:g.errorMap,async:!0},path:(g==null?void 0:g.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:m,parsedType:getParsedType(m)},I=this._parse({data:m,path:w.path,parent:w}),P=await(isAsync(I)?I:Promise.resolve(I));return handleResult(w,P)}refine(m,g){const w=I=>typeof g=="string"||g===void 0?{message:g}:typeof g=="function"?g(I):g;return this._refinement((I,P)=>{const F=m(I),$=()=>P.addIssue({code:ZodIssueCode.custom,...w(I)});return typeof Promise<"u"&&F instanceof Promise?F.then(D=>!!D||($(),!1)):!!F||($(),!1)})}refinement(m,g){return this._refinement((w,I)=>!!m(w)||(I.addIssue(typeof g=="function"?g(w,I):g),!1))}_refinement(m){return new ZodEffects({schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"refinement",refinement:m}})}superRefine(m){return this._refinement(m)}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this,this._def)}promise(){return ZodPromise.create(this,this._def)}or(m){return ZodUnion.create([this,m],this._def)}and(m){return ZodIntersection.create(this,m,this._def)}transform(m){return new ZodEffects({...processCreateParams(this._def),schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"transform",transform:m}})}default(m){const g=typeof m=="function"?m:()=>m;return new ZodDefault({...processCreateParams(this._def),innerType:this,defaultValue:g,typeName:ZodFirstPartyTypeKind.ZodDefault})}brand(){return new ZodBranded({typeName:ZodFirstPartyTypeKind.ZodBranded,type:this,...processCreateParams(this._def)})}catch(m){const g=typeof m=="function"?m:()=>m;return new ZodCatch({...processCreateParams(this._def),innerType:this,catchValue:g,typeName:ZodFirstPartyTypeKind.ZodCatch})}describe(m){return new this.constructor({...this._def,description:m})}pipe(m){return ZodPipeline.create(this,m)}readonly(){return ZodReadonly.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const cuidRegex=/^c[^\s-]{8,}$/i,cuid2Regex=/^[0-9a-z]+$/,ulidRegex=/^[0-9A-HJKMNP-TV-Z]{26}$/,uuidRegex=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,nanoidRegex=/^[a-z0-9_-]{21}$/i,durationRegex=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,emailRegex=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,_emojiRegex="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let emojiRegex;const ipv4Regex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6Regex=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64Regex=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,dateRegexSource="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dateRegex=new RegExp(`^${dateRegexSource}$`);function timeRegexSource(d){let m="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return d.precision?m=`${m}\\.\\d{${d.precision}}`:d.precision==null&&(m=`${m}(\\.\\d+)?`),m}function timeRegex(d){return new RegExp(`^${timeRegexSource(d)}$`)}function datetimeRegex(d){let m=`${dateRegexSource}T${timeRegexSource(d)}`;const g=[];return g.push(d.local?"Z?":"Z"),d.offset&&g.push("([+-]\\d{2}:?\\d{2})"),m=`${m}(${g.join("|")})`,new RegExp(`^${m}$`)}function isValidIP(d,m){return!(m!=="v4"&&m||!ipv4Regex.test(d))||!(m!=="v6"&&m||!ipv6Regex.test(d))}class ZodString extends ZodType{_parse(m){if(this._def.coerce&&(m.data=String(m.data)),this._getType(m)!==ZodParsedType.string){const I=this._getOrReturnCtx(m);return addIssueToContext(I,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.string,received:I.parsedType}),INVALID}const g=new ParseStatus;let w;for(const I of this._def.checks)if(I.kind==="min")m.data.length<I.value&&(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.too_small,minimum:I.value,type:"string",inclusive:!0,exact:!1,message:I.message}),g.dirty());else if(I.kind==="max")m.data.length>I.value&&(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.too_big,maximum:I.value,type:"string",inclusive:!0,exact:!1,message:I.message}),g.dirty());else if(I.kind==="length"){const P=m.data.length>I.value,F=m.data.length<I.value;(P||F)&&(w=this._getOrReturnCtx(m,w),P?addIssueToContext(w,{code:ZodIssueCode.too_big,maximum:I.value,type:"string",inclusive:!0,exact:!0,message:I.message}):F&&addIssueToContext(w,{code:ZodIssueCode.too_small,minimum:I.value,type:"string",inclusive:!0,exact:!0,message:I.message}),g.dirty())}else if(I.kind==="email")emailRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"email",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="emoji")emojiRegex||(emojiRegex=new RegExp(_emojiRegex,"u")),emojiRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"emoji",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="uuid")uuidRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"uuid",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="nanoid")nanoidRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"nanoid",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="cuid")cuidRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"cuid",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="cuid2")cuid2Regex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"cuid2",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="ulid")ulidRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"ulid",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty());else if(I.kind==="url")try{new URL(m.data)}catch{w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"url",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty()}else I.kind==="regex"?(I.regex.lastIndex=0,I.regex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"regex",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty())):I.kind==="trim"?m.data=m.data.trim():I.kind==="includes"?m.data.includes(I.value,I.position)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:{includes:I.value,position:I.position},message:I.message}),g.dirty()):I.kind==="toLowerCase"?m.data=m.data.toLowerCase():I.kind==="toUpperCase"?m.data=m.data.toUpperCase():I.kind==="startsWith"?m.data.startsWith(I.value)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:{startsWith:I.value},message:I.message}),g.dirty()):I.kind==="endsWith"?m.data.endsWith(I.value)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:{endsWith:I.value},message:I.message}),g.dirty()):I.kind==="datetime"?datetimeRegex(I).test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:"datetime",message:I.message}),g.dirty()):I.kind==="date"?dateRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:"date",message:I.message}),g.dirty()):I.kind==="time"?timeRegex(I).test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.invalid_string,validation:"time",message:I.message}),g.dirty()):I.kind==="duration"?durationRegex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"duration",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty()):I.kind==="ip"?isValidIP(m.data,I.version)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"ip",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty()):I.kind==="base64"?base64Regex.test(m.data)||(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{validation:"base64",code:ZodIssueCode.invalid_string,message:I.message}),g.dirty()):util$1.assertNever(I);return{status:g.value,value:m.data}}_regex(m,g,w){return this.refinement(I=>m.test(I),{validation:g,code:ZodIssueCode.invalid_string,...errorUtil.errToObj(w)})}_addCheck(m){return new ZodString({...this._def,checks:[...this._def.checks,m]})}email(m){return this._addCheck({kind:"email",...errorUtil.errToObj(m)})}url(m){return this._addCheck({kind:"url",...errorUtil.errToObj(m)})}emoji(m){return this._addCheck({kind:"emoji",...errorUtil.errToObj(m)})}uuid(m){return this._addCheck({kind:"uuid",...errorUtil.errToObj(m)})}nanoid(m){return this._addCheck({kind:"nanoid",...errorUtil.errToObj(m)})}cuid(m){return this._addCheck({kind:"cuid",...errorUtil.errToObj(m)})}cuid2(m){return this._addCheck({kind:"cuid2",...errorUtil.errToObj(m)})}ulid(m){return this._addCheck({kind:"ulid",...errorUtil.errToObj(m)})}base64(m){return this._addCheck({kind:"base64",...errorUtil.errToObj(m)})}ip(m){return this._addCheck({kind:"ip",...errorUtil.errToObj(m)})}datetime(m){var g,w;return typeof m=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:m}):this._addCheck({kind:"datetime",precision:(m==null?void 0:m.precision)===void 0?null:m==null?void 0:m.precision,offset:(g=m==null?void 0:m.offset)!==null&&g!==void 0&&g,local:(w=m==null?void 0:m.local)!==null&&w!==void 0&&w,...errorUtil.errToObj(m==null?void 0:m.message)})}date(m){return this._addCheck({kind:"date",message:m})}time(m){return typeof m=="string"?this._addCheck({kind:"time",precision:null,message:m}):this._addCheck({kind:"time",precision:(m==null?void 0:m.precision)===void 0?null:m==null?void 0:m.precision,...errorUtil.errToObj(m==null?void 0:m.message)})}duration(m){return this._addCheck({kind:"duration",...errorUtil.errToObj(m)})}regex(m,g){return this._addCheck({kind:"regex",regex:m,...errorUtil.errToObj(g)})}includes(m,g){return this._addCheck({kind:"includes",value:m,position:g==null?void 0:g.position,...errorUtil.errToObj(g==null?void 0:g.message)})}startsWith(m,g){return this._addCheck({kind:"startsWith",value:m,...errorUtil.errToObj(g)})}endsWith(m,g){return this._addCheck({kind:"endsWith",value:m,...errorUtil.errToObj(g)})}min(m,g){return this._addCheck({kind:"min",value:m,...errorUtil.errToObj(g)})}max(m,g){return this._addCheck({kind:"max",value:m,...errorUtil.errToObj(g)})}length(m,g){return this._addCheck({kind:"length",value:m,...errorUtil.errToObj(g)})}nonempty(m){return this.min(1,errorUtil.errToObj(m))}trim(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(m=>m.kind==="datetime")}get isDate(){return!!this._def.checks.find(m=>m.kind==="date")}get isTime(){return!!this._def.checks.find(m=>m.kind==="time")}get isDuration(){return!!this._def.checks.find(m=>m.kind==="duration")}get isEmail(){return!!this._def.checks.find(m=>m.kind==="email")}get isURL(){return!!this._def.checks.find(m=>m.kind==="url")}get isEmoji(){return!!this._def.checks.find(m=>m.kind==="emoji")}get isUUID(){return!!this._def.checks.find(m=>m.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(m=>m.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(m=>m.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(m=>m.kind==="cuid2")}get isULID(){return!!this._def.checks.find(m=>m.kind==="ulid")}get isIP(){return!!this._def.checks.find(m=>m.kind==="ip")}get isBase64(){return!!this._def.checks.find(m=>m.kind==="base64")}get minLength(){let m=null;for(const g of this._def.checks)g.kind==="min"&&(m===null||g.value>m)&&(m=g.value);return m}get maxLength(){let m=null;for(const g of this._def.checks)g.kind==="max"&&(m===null||g.value<m)&&(m=g.value);return m}}function floatSafeRemainder(d,m){const g=(d.toString().split(".")[1]||"").length,w=(m.toString().split(".")[1]||"").length,I=g>w?g:w;return parseInt(d.toFixed(I).replace(".",""))%parseInt(m.toFixed(I).replace(".",""))/Math.pow(10,I)}ZodString.create=d=>{var m;return new ZodString({checks:[],typeName:ZodFirstPartyTypeKind.ZodString,coerce:(m=d==null?void 0:d.coerce)!==null&&m!==void 0&&m,...processCreateParams(d)})};class ZodNumber extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(m){if(this._def.coerce&&(m.data=Number(m.data)),this._getType(m)!==ZodParsedType.number){const I=this._getOrReturnCtx(m);return addIssueToContext(I,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.number,received:I.parsedType}),INVALID}let g;const w=new ParseStatus;for(const I of this._def.checks)I.kind==="int"?util$1.isInteger(m.data)||(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:"integer",received:"float",message:I.message}),w.dirty()):I.kind==="min"?(I.inclusive?m.data<I.value:m.data<=I.value)&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.too_small,minimum:I.value,type:"number",inclusive:I.inclusive,exact:!1,message:I.message}),w.dirty()):I.kind==="max"?(I.inclusive?m.data>I.value:m.data>=I.value)&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.too_big,maximum:I.value,type:"number",inclusive:I.inclusive,exact:!1,message:I.message}),w.dirty()):I.kind==="multipleOf"?floatSafeRemainder(m.data,I.value)!==0&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.not_multiple_of,multipleOf:I.value,message:I.message}),w.dirty()):I.kind==="finite"?Number.isFinite(m.data)||(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.not_finite,message:I.message}),w.dirty()):util$1.assertNever(I);return{status:w.value,value:m.data}}gte(m,g){return this.setLimit("min",m,!0,errorUtil.toString(g))}gt(m,g){return this.setLimit("min",m,!1,errorUtil.toString(g))}lte(m,g){return this.setLimit("max",m,!0,errorUtil.toString(g))}lt(m,g){return this.setLimit("max",m,!1,errorUtil.toString(g))}setLimit(m,g,w,I){return new ZodNumber({...this._def,checks:[...this._def.checks,{kind:m,value:g,inclusive:w,message:errorUtil.toString(I)}]})}_addCheck(m){return new ZodNumber({...this._def,checks:[...this._def.checks,m]})}int(m){return this._addCheck({kind:"int",message:errorUtil.toString(m)})}positive(m){return this._addCheck({kind:"min",value:0,inclusive:!1,message:errorUtil.toString(m)})}negative(m){return this._addCheck({kind:"max",value:0,inclusive:!1,message:errorUtil.toString(m)})}nonpositive(m){return this._addCheck({kind:"max",value:0,inclusive:!0,message:errorUtil.toString(m)})}nonnegative(m){return this._addCheck({kind:"min",value:0,inclusive:!0,message:errorUtil.toString(m)})}multipleOf(m,g){return this._addCheck({kind:"multipleOf",value:m,message:errorUtil.toString(g)})}finite(m){return this._addCheck({kind:"finite",message:errorUtil.toString(m)})}safe(m){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:errorUtil.toString(m)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:errorUtil.toString(m)})}get minValue(){let m=null;for(const g of this._def.checks)g.kind==="min"&&(m===null||g.value>m)&&(m=g.value);return m}get maxValue(){let m=null;for(const g of this._def.checks)g.kind==="max"&&(m===null||g.value<m)&&(m=g.value);return m}get isInt(){return!!this._def.checks.find(m=>m.kind==="int"||m.kind==="multipleOf"&&util$1.isInteger(m.value))}get isFinite(){let m=null,g=null;for(const w of this._def.checks){if(w.kind==="finite"||w.kind==="int"||w.kind==="multipleOf")return!0;w.kind==="min"?(g===null||w.value>g)&&(g=w.value):w.kind==="max"&&(m===null||w.value<m)&&(m=w.value)}return Number.isFinite(g)&&Number.isFinite(m)}}ZodNumber.create=d=>new ZodNumber({checks:[],typeName:ZodFirstPartyTypeKind.ZodNumber,coerce:(d==null?void 0:d.coerce)||!1,...processCreateParams(d)});class ZodBigInt extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(m){if(this._def.coerce&&(m.data=BigInt(m.data)),this._getType(m)!==ZodParsedType.bigint){const I=this._getOrReturnCtx(m);return addIssueToContext(I,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.bigint,received:I.parsedType}),INVALID}let g;const w=new ParseStatus;for(const I of this._def.checks)I.kind==="min"?(I.inclusive?m.data<I.value:m.data<=I.value)&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.too_small,type:"bigint",minimum:I.value,inclusive:I.inclusive,message:I.message}),w.dirty()):I.kind==="max"?(I.inclusive?m.data>I.value:m.data>=I.value)&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.too_big,type:"bigint",maximum:I.value,inclusive:I.inclusive,message:I.message}),w.dirty()):I.kind==="multipleOf"?m.data%I.value!==BigInt(0)&&(g=this._getOrReturnCtx(m,g),addIssueToContext(g,{code:ZodIssueCode.not_multiple_of,multipleOf:I.value,message:I.message}),w.dirty()):util$1.assertNever(I);return{status:w.value,value:m.data}}gte(m,g){return this.setLimit("min",m,!0,errorUtil.toString(g))}gt(m,g){return this.setLimit("min",m,!1,errorUtil.toString(g))}lte(m,g){return this.setLimit("max",m,!0,errorUtil.toString(g))}lt(m,g){return this.setLimit("max",m,!1,errorUtil.toString(g))}setLimit(m,g,w,I){return new ZodBigInt({...this._def,checks:[...this._def.checks,{kind:m,value:g,inclusive:w,message:errorUtil.toString(I)}]})}_addCheck(m){return new ZodBigInt({...this._def,checks:[...this._def.checks,m]})}positive(m){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:errorUtil.toString(m)})}negative(m){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:errorUtil.toString(m)})}nonpositive(m){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:errorUtil.toString(m)})}nonnegative(m){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:errorUtil.toString(m)})}multipleOf(m,g){return this._addCheck({kind:"multipleOf",value:m,message:errorUtil.toString(g)})}get minValue(){let m=null;for(const g of this._def.checks)g.kind==="min"&&(m===null||g.value>m)&&(m=g.value);return m}get maxValue(){let m=null;for(const g of this._def.checks)g.kind==="max"&&(m===null||g.value<m)&&(m=g.value);return m}}ZodBigInt.create=d=>{var m;return new ZodBigInt({checks:[],typeName:ZodFirstPartyTypeKind.ZodBigInt,coerce:(m=d==null?void 0:d.coerce)!==null&&m!==void 0&&m,...processCreateParams(d)})};class ZodBoolean extends ZodType{_parse(m){if(this._def.coerce&&(m.data=!!m.data),this._getType(m)!==ZodParsedType.boolean){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.boolean,received:g.parsedType}),INVALID}return OK(m.data)}}ZodBoolean.create=d=>new ZodBoolean({typeName:ZodFirstPartyTypeKind.ZodBoolean,coerce:(d==null?void 0:d.coerce)||!1,...processCreateParams(d)});class ZodDate extends ZodType{_parse(m){if(this._def.coerce&&(m.data=new Date(m.data)),this._getType(m)!==ZodParsedType.date){const I=this._getOrReturnCtx(m);return addIssueToContext(I,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.date,received:I.parsedType}),INVALID}if(isNaN(m.data.getTime()))return addIssueToContext(this._getOrReturnCtx(m),{code:ZodIssueCode.invalid_date}),INVALID;const g=new ParseStatus;let w;for(const I of this._def.checks)I.kind==="min"?m.data.getTime()<I.value&&(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.too_small,message:I.message,inclusive:!0,exact:!1,minimum:I.value,type:"date"}),g.dirty()):I.kind==="max"?m.data.getTime()>I.value&&(w=this._getOrReturnCtx(m,w),addIssueToContext(w,{code:ZodIssueCode.too_big,message:I.message,inclusive:!0,exact:!1,maximum:I.value,type:"date"}),g.dirty()):util$1.assertNever(I);return{status:g.value,value:new Date(m.data.getTime())}}_addCheck(m){return new ZodDate({...this._def,checks:[...this._def.checks,m]})}min(m,g){return this._addCheck({kind:"min",value:m.getTime(),message:errorUtil.toString(g)})}max(m,g){return this._addCheck({kind:"max",value:m.getTime(),message:errorUtil.toString(g)})}get minDate(){let m=null;for(const g of this._def.checks)g.kind==="min"&&(m===null||g.value>m)&&(m=g.value);return m!=null?new Date(m):null}get maxDate(){let m=null;for(const g of this._def.checks)g.kind==="max"&&(m===null||g.value<m)&&(m=g.value);return m!=null?new Date(m):null}}ZodDate.create=d=>new ZodDate({checks:[],coerce:(d==null?void 0:d.coerce)||!1,typeName:ZodFirstPartyTypeKind.ZodDate,...processCreateParams(d)});class ZodSymbol extends ZodType{_parse(m){if(this._getType(m)!==ZodParsedType.symbol){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.symbol,received:g.parsedType}),INVALID}return OK(m.data)}}ZodSymbol.create=d=>new ZodSymbol({typeName:ZodFirstPartyTypeKind.ZodSymbol,...processCreateParams(d)});class ZodUndefined extends ZodType{_parse(m){if(this._getType(m)!==ZodParsedType.undefined){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.undefined,received:g.parsedType}),INVALID}return OK(m.data)}}ZodUndefined.create=d=>new ZodUndefined({typeName:ZodFirstPartyTypeKind.ZodUndefined,...processCreateParams(d)});class ZodNull extends ZodType{_parse(m){if(this._getType(m)!==ZodParsedType.null){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.null,received:g.parsedType}),INVALID}return OK(m.data)}}ZodNull.create=d=>new ZodNull({typeName:ZodFirstPartyTypeKind.ZodNull,...processCreateParams(d)});class ZodAny extends ZodType{constructor(){super(...arguments),this._any=!0}_parse(m){return OK(m.data)}}ZodAny.create=d=>new ZodAny({typeName:ZodFirstPartyTypeKind.ZodAny,...processCreateParams(d)});class ZodUnknown extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse(m){return OK(m.data)}}ZodUnknown.create=d=>new ZodUnknown({typeName:ZodFirstPartyTypeKind.ZodUnknown,...processCreateParams(d)});class ZodNever extends ZodType{_parse(m){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.never,received:g.parsedType}),INVALID}}ZodNever.create=d=>new ZodNever({typeName:ZodFirstPartyTypeKind.ZodNever,...processCreateParams(d)});class ZodVoid extends ZodType{_parse(m){if(this._getType(m)!==ZodParsedType.undefined){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.void,received:g.parsedType}),INVALID}return OK(m.data)}}ZodVoid.create=d=>new ZodVoid({typeName:ZodFirstPartyTypeKind.ZodVoid,...processCreateParams(d)});class ZodArray extends ZodType{_parse(m){const{ctx:g,status:w}=this._processInputParams(m),I=this._def;if(g.parsedType!==ZodParsedType.array)return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:g.parsedType}),INVALID;if(I.exactLength!==null){const F=g.data.length>I.exactLength.value,$=g.data.length<I.exactLength.value;(F||$)&&(addIssueToContext(g,{code:F?ZodIssueCode.too_big:ZodIssueCode.too_small,minimum:$?I.exactLength.value:void 0,maximum:F?I.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:I.exactLength.message}),w.dirty())}if(I.minLength!==null&&g.data.length<I.minLength.value&&(addIssueToContext(g,{code:ZodIssueCode.too_small,minimum:I.minLength.value,type:"array",inclusive:!0,exact:!1,message:I.minLength.message}),w.dirty()),I.maxLength!==null&&g.data.length>I.maxLength.value&&(addIssueToContext(g,{code:ZodIssueCode.too_big,maximum:I.maxLength.value,type:"array",inclusive:!0,exact:!1,message:I.maxLength.message}),w.dirty()),g.common.async)return Promise.all([...g.data].map((F,$)=>I.type._parseAsync(new ParseInputLazyPath(g,F,g.path,$)))).then(F=>ParseStatus.mergeArray(w,F));const P=[...g.data].map((F,$)=>I.type._parseSync(new ParseInputLazyPath(g,F,g.path,$)));return ParseStatus.mergeArray(w,P)}get element(){return this._def.type}min(m,g){return new ZodArray({...this._def,minLength:{value:m,message:errorUtil.toString(g)}})}max(m,g){return new ZodArray({...this._def,maxLength:{value:m,message:errorUtil.toString(g)}})}length(m,g){return new ZodArray({...this._def,exactLength:{value:m,message:errorUtil.toString(g)}})}nonempty(m){return this.min(1,m)}}function deepPartialify(d){if(d instanceof ZodObject){const m={};for(const g in d.shape){const w=d.shape[g];m[g]=ZodOptional.create(deepPartialify(w))}return new ZodObject({...d._def,shape:()=>m})}return d instanceof ZodArray?new ZodArray({...d._def,type:deepPartialify(d.element)}):d instanceof ZodOptional?ZodOptional.create(deepPartialify(d.unwrap())):d instanceof ZodNullable?ZodNullable.create(deepPartialify(d.unwrap())):d instanceof ZodTuple?ZodTuple.create(d.items.map(m=>deepPartialify(m))):d}ZodArray.create=(d,m)=>new ZodArray({type:d,minLength:null,maxLength:null,exactLength:null,typeName:ZodFirstPartyTypeKind.ZodArray,...processCreateParams(m)});class ZodObject extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const m=this._def.shape(),g=util$1.objectKeys(m);return this._cached={shape:m,keys:g}}_parse(m){if(this._getType(m)!==ZodParsedType.object){const D=this._getOrReturnCtx(m);return addIssueToContext(D,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:D.parsedType}),INVALID}const{status:g,ctx:w}=this._processInputParams(m),{shape:I,keys:P}=this._getCached(),F=[];if(!(this._def.catchall instanceof ZodNever&&this._def.unknownKeys==="strip"))for(const D in w.data)P.includes(D)||F.push(D);const $=[];for(const D of P){const U=I[D],Z=w.data[D];$.push({key:{status:"valid",value:D},value:U._parse(new ParseInputLazyPath(w,Z,w.path,D)),alwaysSet:D in w.data})}if(this._def.catchall instanceof ZodNever){const D=this._def.unknownKeys;if(D==="passthrough")for(const U of F)$.push({key:{status:"valid",value:U},value:{status:"valid",value:w.data[U]}});else if(D==="strict")F.length>0&&(addIssueToContext(w,{code:ZodIssueCode.unrecognized_keys,keys:F}),g.dirty());else if(D!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const D=this._def.catchall;for(const U of F){const Z=w.data[U];$.push({key:{status:"valid",value:U},value:D._parse(new ParseInputLazyPath(w,Z,w.path,U)),alwaysSet:U in w.data})}}return w.common.async?Promise.resolve().then(async()=>{const D=[];for(const U of $){const Z=await U.key,j=await U.value;D.push({key:Z,value:j,alwaysSet:U.alwaysSet})}return D}).then(D=>ParseStatus.mergeObjectSync(g,D)):ParseStatus.mergeObjectSync(g,$)}get shape(){return this._def.shape()}strict(m){return errorUtil.errToObj,new ZodObject({...this._def,unknownKeys:"strict",...m!==void 0?{errorMap:(g,w)=>{var I,P,F,$;const D=(F=(P=(I=this._def).errorMap)===null||P===void 0?void 0:P.call(I,g,w).message)!==null&&F!==void 0?F:w.defaultError;return g.code==="unrecognized_keys"?{message:($=errorUtil.errToObj(m).message)!==null&&$!==void 0?$:D}:{message:D}}}:{}})}strip(){return new ZodObject({...this._def,unknownKeys:"strip"})}passthrough(){return new ZodObject({...this._def,unknownKeys:"passthrough"})}extend(m){return new ZodObject({...this._def,shape:()=>({...this._def.shape(),...m})})}merge(m){return new ZodObject({unknownKeys:m._def.unknownKeys,catchall:m._def.catchall,shape:()=>({...this._def.shape(),...m._def.shape()}),typeName:ZodFirstPartyTypeKind.ZodObject})}setKey(m,g){return this.augment({[m]:g})}catchall(m){return new ZodObject({...this._def,catchall:m})}pick(m){const g={};return util$1.objectKeys(m).forEach(w=>{m[w]&&this.shape[w]&&(g[w]=this.shape[w])}),new ZodObject({...this._def,shape:()=>g})}omit(m){const g={};return util$1.objectKeys(this.shape).forEach(w=>{m[w]||(g[w]=this.shape[w])}),new ZodObject({...this._def,shape:()=>g})}deepPartial(){return deepPartialify(this)}partial(m){const g={};return util$1.objectKeys(this.shape).forEach(w=>{const I=this.shape[w];m&&!m[w]?g[w]=I:g[w]=I.optional()}),new ZodObject({...this._def,shape:()=>g})}required(m){const g={};return util$1.objectKeys(this.shape).forEach(w=>{if(m&&!m[w])g[w]=this.shape[w];else{let I=this.shape[w];for(;I instanceof ZodOptional;)I=I._def.innerType;g[w]=I}}),new ZodObject({...this._def,shape:()=>g})}keyof(){return createZodEnum(util$1.objectKeys(this.shape))}}ZodObject.create=(d,m)=>new ZodObject({shape:()=>d,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(m)}),ZodObject.strictCreate=(d,m)=>new ZodObject({shape:()=>d,unknownKeys:"strict",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(m)}),ZodObject.lazycreate=(d,m)=>new ZodObject({shape:d,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(m)});class ZodUnion extends ZodType{_parse(m){const{ctx:g}=this._processInputParams(m),w=this._def.options;if(g.common.async)return Promise.all(w.map(async I=>{const P={...g,common:{...g.common,issues:[]},parent:null};return{result:await I._parseAsync({data:g.data,path:g.path,parent:P}),ctx:P}})).then(function(I){for(const F of I)if(F.result.status==="valid")return F.result;for(const F of I)if(F.result.status==="dirty")return g.common.issues.push(...F.ctx.common.issues),F.result;const P=I.map(F=>new ZodError(F.ctx.common.issues));return addIssueToContext(g,{code:ZodIssueCode.invalid_union,unionErrors:P}),INVALID});{let I;const P=[];for(const $ of w){const D={...g,common:{...g.common,issues:[]},parent:null},U=$._parseSync({data:g.data,path:g.path,parent:D});if(U.status==="valid")return U;U.status!=="dirty"||I||(I={result:U,ctx:D}),D.common.issues.length&&P.push(D.common.issues)}if(I)return g.common.issues.push(...I.ctx.common.issues),I.result;const F=P.map($=>new ZodError($));return addIssueToContext(g,{code:ZodIssueCode.invalid_union,unionErrors:F}),INVALID}}get options(){return this._def.options}}ZodUnion.create=(d,m)=>new ZodUnion({options:d,typeName:ZodFirstPartyTypeKind.ZodUnion,...processCreateParams(m)});const getDiscriminator=d=>d instanceof ZodLazy?getDiscriminator(d.schema):d instanceof ZodEffects?getDiscriminator(d.innerType()):d instanceof ZodLiteral?[d.value]:d instanceof ZodEnum?d.options:d instanceof ZodNativeEnum?util$1.objectValues(d.enum):d instanceof ZodDefault?getDiscriminator(d._def.innerType):d instanceof ZodUndefined?[void 0]:d instanceof ZodNull?[null]:d instanceof ZodOptional?[void 0,...getDiscriminator(d.unwrap())]:d instanceof ZodNullable?[null,...getDiscriminator(d.unwrap())]:d instanceof ZodBranded||d instanceof ZodReadonly?getDiscriminator(d.unwrap()):d instanceof ZodCatch?getDiscriminator(d._def.innerType):[];class ZodDiscriminatedUnion extends ZodType{_parse(m){const{ctx:g}=this._processInputParams(m);if(g.parsedType!==ZodParsedType.object)return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:g.parsedType}),INVALID;const w=this.discriminator,I=g.data[w],P=this.optionsMap.get(I);return P?g.common.async?P._parseAsync({data:g.data,path:g.path,parent:g}):P._parseSync({data:g.data,path:g.path,parent:g}):(addIssueToContext(g,{code:ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[w]}),INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(m,g,w){const I=new Map;for(const P of g){const F=getDiscriminator(P.shape[m]);if(!F.length)throw new Error(`A discriminator value for key \`${m}\` could not be extracted from all schema options`);for(const $ of F){if(I.has($))throw new Error(`Discriminator property ${String(m)} has duplicate value ${String($)}`);I.set($,P)}}return new ZodDiscriminatedUnion({typeName:ZodFirstPartyTypeKind.ZodDiscriminatedUnion,discriminator:m,options:g,optionsMap:I,...processCreateParams(w)})}}function mergeValues(d,m){const g=getParsedType(d),w=getParsedType(m);if(d===m)return{valid:!0,data:d};if(g===ZodParsedType.object&&w===ZodParsedType.object){const I=util$1.objectKeys(m),P=util$1.objectKeys(d).filter($=>I.indexOf($)!==-1),F={...d,...m};for(const $ of P){const D=mergeValues(d[$],m[$]);if(!D.valid)return{valid:!1};F[$]=D.data}return{valid:!0,data:F}}if(g===ZodParsedType.array&&w===ZodParsedType.array){if(d.length!==m.length)return{valid:!1};const I=[];for(let P=0;P<d.length;P++){const F=mergeValues(d[P],m[P]);if(!F.valid)return{valid:!1};I.push(F.data)}return{valid:!0,data:I}}return g===ZodParsedType.date&&w===ZodParsedType.date&&+d==+m?{valid:!0,data:d}:{valid:!1}}class ZodIntersection extends ZodType{_parse(m){const{status:g,ctx:w}=this._processInputParams(m),I=(P,F)=>{if(isAborted(P)||isAborted(F))return INVALID;const $=mergeValues(P.value,F.value);return $.valid?((isDirty(P)||isDirty(F))&&g.dirty(),{status:g.value,value:$.data}):(addIssueToContext(w,{code:ZodIssueCode.invalid_intersection_types}),INVALID)};return w.common.async?Promise.all([this._def.left._parseAsync({data:w.data,path:w.path,parent:w}),this._def.right._parseAsync({data:w.data,path:w.path,parent:w})]).then(([P,F])=>I(P,F)):I(this._def.left._parseSync({data:w.data,path:w.path,parent:w}),this._def.right._parseSync({data:w.data,path:w.path,parent:w}))}}ZodIntersection.create=(d,m,g)=>new ZodIntersection({left:d,right:m,typeName:ZodFirstPartyTypeKind.ZodIntersection,...processCreateParams(g)});class ZodTuple extends ZodType{_parse(m){const{status:g,ctx:w}=this._processInputParams(m);if(w.parsedType!==ZodParsedType.array)return addIssueToContext(w,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:w.parsedType}),INVALID;if(w.data.length<this._def.items.length)return addIssueToContext(w,{code:ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),INVALID;!this._def.rest&&w.data.length>this._def.items.length&&(addIssueToContext(w,{code:ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),g.dirty());const I=[...w.data].map((P,F)=>{const $=this._def.items[F]||this._def.rest;return $?$._parse(new ParseInputLazyPath(w,P,w.path,F)):null}).filter(P=>!!P);return w.common.async?Promise.all(I).then(P=>ParseStatus.mergeArray(g,P)):ParseStatus.mergeArray(g,I)}get items(){return this._def.items}rest(m){return new ZodTuple({...this._def,rest:m})}}ZodTuple.create=(d,m)=>{if(!Array.isArray(d))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:d,typeName:ZodFirstPartyTypeKind.ZodTuple,rest:null,...processCreateParams(m)})};class ZodRecord extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(m){const{status:g,ctx:w}=this._processInputParams(m);if(w.parsedType!==ZodParsedType.object)return addIssueToContext(w,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:w.parsedType}),INVALID;const I=[],P=this._def.keyType,F=this._def.valueType;for(const $ in w.data)I.push({key:P._parse(new ParseInputLazyPath(w,$,w.path,$)),value:F._parse(new ParseInputLazyPath(w,w.data[$],w.path,$)),alwaysSet:$ in w.data});return w.common.async?ParseStatus.mergeObjectAsync(g,I):ParseStatus.mergeObjectSync(g,I)}get element(){return this._def.valueType}static create(m,g,w){return new ZodRecord(g instanceof ZodType?{keyType:m,valueType:g,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(w)}:{keyType:ZodString.create(),valueType:m,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(g)})}}class ZodMap extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(m){const{status:g,ctx:w}=this._processInputParams(m);if(w.parsedType!==ZodParsedType.map)return addIssueToContext(w,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.map,received:w.parsedType}),INVALID;const I=this._def.keyType,P=this._def.valueType,F=[...w.data.entries()].map(([$,D],U)=>({key:I._parse(new ParseInputLazyPath(w,$,w.path,[U,"key"])),value:P._parse(new ParseInputLazyPath(w,D,w.path,[U,"value"]))}));if(w.common.async){const $=new Map;return Promise.resolve().then(async()=>{for(const D of F){const U=await D.key,Z=await D.value;if(U.status==="aborted"||Z.status==="aborted")return INVALID;U.status!=="dirty"&&Z.status!=="dirty"||g.dirty(),$.set(U.value,Z.value)}return{status:g.value,value:$}})}{const $=new Map;for(const D of F){const U=D.key,Z=D.value;if(U.status==="aborted"||Z.status==="aborted")return INVALID;U.status!=="dirty"&&Z.status!=="dirty"||g.dirty(),$.set(U.value,Z.value)}return{status:g.value,value:$}}}}ZodMap.create=(d,m,g)=>new ZodMap({valueType:m,keyType:d,typeName:ZodFirstPartyTypeKind.ZodMap,...processCreateParams(g)});class ZodSet extends ZodType{_parse(m){const{status:g,ctx:w}=this._processInputParams(m);if(w.parsedType!==ZodParsedType.set)return addIssueToContext(w,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.set,received:w.parsedType}),INVALID;const I=this._def;I.minSize!==null&&w.data.size<I.minSize.value&&(addIssueToContext(w,{code:ZodIssueCode.too_small,minimum:I.minSize.value,type:"set",inclusive:!0,exact:!1,message:I.minSize.message}),g.dirty()),I.maxSize!==null&&w.data.size>I.maxSize.value&&(addIssueToContext(w,{code:ZodIssueCode.too_big,maximum:I.maxSize.value,type:"set",inclusive:!0,exact:!1,message:I.maxSize.message}),g.dirty());const P=this._def.valueType;function F(D){const U=new Set;for(const Z of D){if(Z.status==="aborted")return INVALID;Z.status==="dirty"&&g.dirty(),U.add(Z.value)}return{status:g.value,value:U}}const $=[...w.data.values()].map((D,U)=>P._parse(new ParseInputLazyPath(w,D,w.path,U)));return w.common.async?Promise.all($).then(D=>F(D)):F($)}min(m,g){return new ZodSet({...this._def,minSize:{value:m,message:errorUtil.toString(g)}})}max(m,g){return new ZodSet({...this._def,maxSize:{value:m,message:errorUtil.toString(g)}})}size(m,g){return this.min(m,g).max(m,g)}nonempty(m){return this.min(1,m)}}ZodSet.create=(d,m)=>new ZodSet({valueType:d,minSize:null,maxSize:null,typeName:ZodFirstPartyTypeKind.ZodSet,...processCreateParams(m)});class ZodFunction extends ZodType{constructor(){super(...arguments),this.validate=this.implement}_parse(m){const{ctx:g}=this._processInputParams(m);if(g.parsedType!==ZodParsedType.function)return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.function,received:g.parsedType}),INVALID;function w($,D){return makeIssue({data:$,path:g.path,errorMaps:[g.common.contextualErrorMap,g.schemaErrorMap,getErrorMap(),errorMap].filter(U=>!!U),issueData:{code:ZodIssueCode.invalid_arguments,argumentsError:D}})}function I($,D){return makeIssue({data:$,path:g.path,errorMaps:[g.common.contextualErrorMap,g.schemaErrorMap,getErrorMap(),errorMap].filter(U=>!!U),issueData:{code:ZodIssueCode.invalid_return_type,returnTypeError:D}})}const P={errorMap:g.common.contextualErrorMap},F=g.data;if(this._def.returns instanceof ZodPromise){const $=this;return OK(async function(...D){const U=new ZodError([]),Z=await $._def.args.parseAsync(D,P).catch(H=>{throw U.addIssue(w(D,H)),U}),j=await Reflect.apply(F,this,Z);return await $._def.returns._def.type.parseAsync(j,P).catch(H=>{throw U.addIssue(I(j,H)),U})})}{const $=this;return OK(function(...D){const U=$._def.args.safeParse(D,P);if(!U.success)throw new ZodError([w(D,U.error)]);const Z=Reflect.apply(F,this,U.data),j=$._def.returns.safeParse(Z,P);if(!j.success)throw new ZodError([I(Z,j.error)]);return j.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...m){return new ZodFunction({...this._def,args:ZodTuple.create(m).rest(ZodUnknown.create())})}returns(m){return new ZodFunction({...this._def,returns:m})}implement(m){return this.parse(m)}strictImplement(m){return this.parse(m)}static create(m,g,w){return new ZodFunction({args:m||ZodTuple.create([]).rest(ZodUnknown.create()),returns:g||ZodUnknown.create(),typeName:ZodFirstPartyTypeKind.ZodFunction,...processCreateParams(w)})}}class ZodLazy extends ZodType{get schema(){return this._def.getter()}_parse(m){const{ctx:g}=this._processInputParams(m);return this._def.getter()._parse({data:g.data,path:g.path,parent:g})}}ZodLazy.create=(d,m)=>new ZodLazy({getter:d,typeName:ZodFirstPartyTypeKind.ZodLazy,...processCreateParams(m)});class ZodLiteral extends ZodType{_parse(m){if(m.data!==this._def.value){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{received:g.data,code:ZodIssueCode.invalid_literal,expected:this._def.value}),INVALID}return{status:"valid",value:m.data}}get value(){return this._def.value}}function createZodEnum(d,m){return new ZodEnum({values:d,typeName:ZodFirstPartyTypeKind.ZodEnum,...processCreateParams(m)})}ZodLiteral.create=(d,m)=>new ZodLiteral({value:d,typeName:ZodFirstPartyTypeKind.ZodLiteral,...processCreateParams(m)});class ZodEnum extends ZodType{constructor(){super(...arguments),_ZodEnum_cache.set(this,void 0)}_parse(m){if(typeof m.data!="string"){const g=this._getOrReturnCtx(m),w=this._def.values;return addIssueToContext(g,{expected:util$1.joinValues(w),received:g.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodEnum_cache)||__classPrivateFieldSet(this,_ZodEnum_cache,new Set(this._def.values)),!__classPrivateFieldGet(this,_ZodEnum_cache).has(m.data)){const g=this._getOrReturnCtx(m),w=this._def.values;return addIssueToContext(g,{received:g.data,code:ZodIssueCode.invalid_enum_value,options:w}),INVALID}return OK(m.data)}get options(){return this._def.values}get enum(){const m={};for(const g of this._def.values)m[g]=g;return m}get Values(){const m={};for(const g of this._def.values)m[g]=g;return m}get Enum(){const m={};for(const g of this._def.values)m[g]=g;return m}extract(m,g=this._def){return ZodEnum.create(m,{...this._def,...g})}exclude(m,g=this._def){return ZodEnum.create(this.options.filter(w=>!m.includes(w)),{...this._def,...g})}}_ZodEnum_cache=new WeakMap,ZodEnum.create=createZodEnum;class ZodNativeEnum extends ZodType{constructor(){super(...arguments),_ZodNativeEnum_cache.set(this,void 0)}_parse(m){const g=util$1.getValidEnumValues(this._def.values),w=this._getOrReturnCtx(m);if(w.parsedType!==ZodParsedType.string&&w.parsedType!==ZodParsedType.number){const I=util$1.objectValues(g);return addIssueToContext(w,{expected:util$1.joinValues(I),received:w.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodNativeEnum_cache)||__classPrivateFieldSet(this,_ZodNativeEnum_cache,new Set(util$1.getValidEnumValues(this._def.values))),!__classPrivateFieldGet(this,_ZodNativeEnum_cache).has(m.data)){const I=util$1.objectValues(g);return addIssueToContext(w,{received:w.data,code:ZodIssueCode.invalid_enum_value,options:I}),INVALID}return OK(m.data)}get enum(){return this._def.values}}_ZodNativeEnum_cache=new WeakMap,ZodNativeEnum.create=(d,m)=>new ZodNativeEnum({values:d,typeName:ZodFirstPartyTypeKind.ZodNativeEnum,...processCreateParams(m)});class ZodPromise extends ZodType{unwrap(){return this._def.type}_parse(m){const{ctx:g}=this._processInputParams(m);if(g.parsedType!==ZodParsedType.promise&&g.common.async===!1)return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.promise,received:g.parsedType}),INVALID;const w=g.parsedType===ZodParsedType.promise?g.data:Promise.resolve(g.data);return OK(w.then(I=>this._def.type.parseAsync(I,{path:g.path,errorMap:g.common.contextualErrorMap})))}}ZodPromise.create=(d,m)=>new ZodPromise({type:d,typeName:ZodFirstPartyTypeKind.ZodPromise,...processCreateParams(m)});class ZodEffects extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ZodFirstPartyTypeKind.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(m){const{status:g,ctx:w}=this._processInputParams(m),I=this._def.effect||null,P={addIssue:F=>{addIssueToContext(w,F),F.fatal?g.abort():g.dirty()},get path(){return w.path}};if(P.addIssue=P.addIssue.bind(P),I.type==="preprocess"){const F=I.transform(w.data,P);if(w.common.async)return Promise.resolve(F).then(async $=>{if(g.value==="aborted")return INVALID;const D=await this._def.schema._parseAsync({data:$,path:w.path,parent:w});return D.status==="aborted"?INVALID:D.status==="dirty"||g.value==="dirty"?DIRTY(D.value):D});{if(g.value==="aborted")return INVALID;const $=this._def.schema._parseSync({data:F,path:w.path,parent:w});return $.status==="aborted"?INVALID:$.status==="dirty"||g.value==="dirty"?DIRTY($.value):$}}if(I.type==="refinement"){const F=$=>{const D=I.refinement($,P);if(w.common.async)return Promise.resolve(D);if(D instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return $};if(w.common.async===!1){const $=this._def.schema._parseSync({data:w.data,path:w.path,parent:w});return $.status==="aborted"?INVALID:($.status==="dirty"&&g.dirty(),F($.value),{status:g.value,value:$.value})}return this._def.schema._parseAsync({data:w.data,path:w.path,parent:w}).then($=>$.status==="aborted"?INVALID:($.status==="dirty"&&g.dirty(),F($.value).then(()=>({status:g.value,value:$.value}))))}if(I.type==="transform"){if(w.common.async===!1){const F=this._def.schema._parseSync({data:w.data,path:w.path,parent:w});if(!isValid(F))return F;const $=I.transform(F.value,P);if($ instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:g.value,value:$}}return this._def.schema._parseAsync({data:w.data,path:w.path,parent:w}).then(F=>isValid(F)?Promise.resolve(I.transform(F.value,P)).then($=>({status:g.value,value:$})):F)}util$1.assertNever(I)}}ZodEffects.create=(d,m,g)=>new ZodEffects({schema:d,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:m,...processCreateParams(g)}),ZodEffects.createWithPreprocess=(d,m,g)=>new ZodEffects({schema:m,effect:{type:"preprocess",transform:d},typeName:ZodFirstPartyTypeKind.ZodEffects,...processCreateParams(g)});class ZodOptional extends ZodType{_parse(m){return this._getType(m)===ZodParsedType.undefined?OK(void 0):this._def.innerType._parse(m)}unwrap(){return this._def.innerType}}ZodOptional.create=(d,m)=>new ZodOptional({innerType:d,typeName:ZodFirstPartyTypeKind.ZodOptional,...processCreateParams(m)});class ZodNullable extends ZodType{_parse(m){return this._getType(m)===ZodParsedType.null?OK(null):this._def.innerType._parse(m)}unwrap(){return this._def.innerType}}ZodNullable.create=(d,m)=>new ZodNullable({innerType:d,typeName:ZodFirstPartyTypeKind.ZodNullable,...processCreateParams(m)});class ZodDefault extends ZodType{_parse(m){const{ctx:g}=this._processInputParams(m);let w=g.data;return g.parsedType===ZodParsedType.undefined&&(w=this._def.defaultValue()),this._def.innerType._parse({data:w,path:g.path,parent:g})}removeDefault(){return this._def.innerType}}ZodDefault.create=(d,m)=>new ZodDefault({innerType:d,typeName:ZodFirstPartyTypeKind.ZodDefault,defaultValue:typeof m.default=="function"?m.default:()=>m.default,...processCreateParams(m)});class ZodCatch extends ZodType{_parse(m){const{ctx:g}=this._processInputParams(m),w={...g,common:{...g.common,issues:[]}},I=this._def.innerType._parse({data:w.data,path:w.path,parent:{...w}});return isAsync(I)?I.then(P=>({status:"valid",value:P.status==="valid"?P.value:this._def.catchValue({get error(){return new ZodError(w.common.issues)},input:w.data})})):{status:"valid",value:I.status==="valid"?I.value:this._def.catchValue({get error(){return new ZodError(w.common.issues)},input:w.data})}}removeCatch(){return this._def.innerType}}ZodCatch.create=(d,m)=>new ZodCatch({innerType:d,typeName:ZodFirstPartyTypeKind.ZodCatch,catchValue:typeof m.catch=="function"?m.catch:()=>m.catch,...processCreateParams(m)});class ZodNaN extends ZodType{_parse(m){if(this._getType(m)!==ZodParsedType.nan){const g=this._getOrReturnCtx(m);return addIssueToContext(g,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.nan,received:g.parsedType}),INVALID}return{status:"valid",value:m.data}}}ZodNaN.create=d=>new ZodNaN({typeName:ZodFirstPartyTypeKind.ZodNaN,...processCreateParams(d)});const BRAND=Symbol("zod_brand");class ZodBranded extends ZodType{_parse(m){const{ctx:g}=this._processInputParams(m),w=g.data;return this._def.type._parse({data:w,path:g.path,parent:g})}unwrap(){return this._def.type}}class ZodPipeline extends ZodType{_parse(m){const{status:g,ctx:w}=this._processInputParams(m);if(w.common.async)return(async()=>{const I=await this._def.in._parseAsync({data:w.data,path:w.path,parent:w});return I.status==="aborted"?INVALID:I.status==="dirty"?(g.dirty(),DIRTY(I.value)):this._def.out._parseAsync({data:I.value,path:w.path,parent:w})})();{const I=this._def.in._parseSync({data:w.data,path:w.path,parent:w});return I.status==="aborted"?INVALID:I.status==="dirty"?(g.dirty(),{status:"dirty",value:I.value}):this._def.out._parseSync({data:I.value,path:w.path,parent:w})}}static create(m,g){return new ZodPipeline({in:m,out:g,typeName:ZodFirstPartyTypeKind.ZodPipeline})}}class ZodReadonly extends ZodType{_parse(m){const g=this._def.innerType._parse(m),w=I=>(isValid(I)&&(I.value=Object.freeze(I.value)),I);return isAsync(g)?g.then(I=>w(I)):w(g)}unwrap(){return this._def.innerType}}function custom(d,m={},g){return d?ZodAny.create().superRefine((w,I)=>{var P,F;if(!d(w)){const $=typeof m=="function"?m(w):typeof m=="string"?{message:m}:m,D=(F=(P=$.fatal)!==null&&P!==void 0?P:g)===null||F===void 0||F,U=typeof $=="string"?{message:$}:$;I.addIssue({code:"custom",...U,fatal:D})}}):ZodAny.create()}ZodReadonly.create=(d,m)=>new ZodReadonly({innerType:d,typeName:ZodFirstPartyTypeKind.ZodReadonly,...processCreateParams(m)});const late={object:ZodObject.lazycreate};var ZodFirstPartyTypeKind;(function(d){d.ZodString="ZodString",d.ZodNumber="ZodNumber",d.ZodNaN="ZodNaN",d.ZodBigInt="ZodBigInt",d.ZodBoolean="ZodBoolean",d.ZodDate="ZodDate",d.ZodSymbol="ZodSymbol",d.ZodUndefined="ZodUndefined",d.ZodNull="ZodNull",d.ZodAny="ZodAny",d.ZodUnknown="ZodUnknown",d.ZodNever="ZodNever",d.ZodVoid="ZodVoid",d.ZodArray="ZodArray",d.ZodObject="ZodObject",d.ZodUnion="ZodUnion",d.ZodDiscriminatedUnion="ZodDiscriminatedUnion",d.ZodIntersection="ZodIntersection",d.ZodTuple="ZodTuple",d.ZodRecord="ZodRecord",d.ZodMap="ZodMap",d.ZodSet="ZodSet",d.ZodFunction="ZodFunction",d.ZodLazy="ZodLazy",d.ZodLiteral="ZodLiteral",d.ZodEnum="ZodEnum",d.ZodEffects="ZodEffects",d.ZodNativeEnum="ZodNativeEnum",d.ZodOptional="ZodOptional",d.ZodNullable="ZodNullable",d.ZodDefault="ZodDefault",d.ZodCatch="ZodCatch",d.ZodPromise="ZodPromise",d.ZodBranded="ZodBranded",d.ZodPipeline="ZodPipeline",d.ZodReadonly="ZodReadonly"})(ZodFirstPartyTypeKind||(ZodFirstPartyTypeKind={}));const instanceOfType=(d,m={message:`Input not instance of ${d.name}`})=>custom(g=>g instanceof d,m),stringType=ZodString.create,numberType=ZodNumber.create,nanType=ZodNaN.create,bigIntType=ZodBigInt.create,booleanType=ZodBoolean.create,dateType=ZodDate.create,symbolType=ZodSymbol.create,undefinedType=ZodUndefined.create,nullType=ZodNull.create,anyType=ZodAny.create,unknownType=ZodUnknown.create,neverType=ZodNever.create,voidType=ZodVoid.create,arrayType=ZodArray.create,objectType=ZodObject.create,strictObjectType=ZodObject.strictCreate,unionType=ZodUnion.create,discriminatedUnionType=ZodDiscriminatedUnion.create,intersectionType=ZodIntersection.create,tupleType=ZodTuple.create,recordType=ZodRecord.create,mapType=ZodMap.create,setType=ZodSet.create,functionType=ZodFunction.create,lazyType=ZodLazy.create,literalType=ZodLiteral.create,enumType=ZodEnum.create,nativeEnumType=ZodNativeEnum.create,promiseType=ZodPromise.create,effectsType=ZodEffects.create,optionalType=ZodOptional.create,nullableType=ZodNullable.create,preprocessType=ZodEffects.createWithPreprocess,pipelineType=ZodPipeline.create,ostring=()=>stringType().optional(),onumber=()=>numberType().optional(),oboolean=()=>booleanType().optional(),coerce={string:d=>ZodString.create({...d,coerce:!0}),number:d=>ZodNumber.create({...d,coerce:!0}),boolean:d=>ZodBoolean.create({...d,coerce:!0}),bigint:d=>ZodBigInt.create({...d,coerce:!0}),date:d=>ZodDate.create({...d,coerce:!0})},NEVER=INVALID;var z=Object.freeze({__proto__:null,defaultErrorMap:errorMap,setErrorMap,getErrorMap,makeIssue,EMPTY_PATH,addIssueToContext,ParseStatus,INVALID,DIRTY,OK,isAborted,isDirty,isValid,isAsync,get util(){return util$1},get objectUtil(){return objectUtil},ZodParsedType,getParsedType,ZodType,datetimeRegex,ZodString,ZodNumber,ZodBigInt,ZodBoolean,ZodDate,ZodSymbol,ZodUndefined,ZodNull,ZodAny,ZodUnknown,ZodNever,ZodVoid,ZodArray,ZodObject,ZodUnion,ZodDiscriminatedUnion,ZodIntersection,ZodTuple,ZodRecord,ZodMap,ZodSet,ZodFunction,ZodLazy,ZodLiteral,ZodEnum,ZodNativeEnum,ZodPromise,ZodEffects,ZodTransformer:ZodEffects,ZodOptional,ZodNullable,ZodDefault,ZodCatch,ZodNaN,BRAND,ZodBranded,ZodPipeline,ZodReadonly,custom,Schema:ZodType,ZodSchema:ZodType,late,get ZodFirstPartyTypeKind(){return ZodFirstPartyTypeKind},coerce,any:anyType,array:arrayType,bigint:bigIntType,boolean:booleanType,date:dateType,discriminatedUnion:discriminatedUnionType,effect:effectsType,enum:enumType,function:functionType,instanceof:instanceOfType,intersection:intersectionType,lazy:lazyType,literal:literalType,map:mapType,nan:nanType,nativeEnum:nativeEnumType,never:neverType,null:nullType,nullable:nullableType,number:numberType,object:objectType,oboolean,onumber,optional:optionalType,ostring,pipeline:pipelineType,preprocess:preprocessType,promise:promiseType,record:recordType,set:setType,strictObject:strictObjectType,string:stringType,symbol:symbolType,transformer:effectsType,tuple:tupleType,undefined:undefinedType,union:unionType,unknown:unknownType,void:voidType,NEVER,ZodIssueCode,quotelessJson,ZodError}),Edge,Edge2;Edge2=Edge||(Edge={}),Edge2[Edge2.EXTEND=1]="EXTEND",Edge2[Edge2.WRAP=2]="WRAP",Edge2[Edge2.CROP=3]="CROP";const JimpClassSchema=z.object({bitmap:z.object({data:z.union([z.instanceof(Buffer),z.instanceof(Uint8Array)]),width:z.number(),height:z.number()})}),BlitOptionsSchemaComplex=z.object({src:JimpClassSchema,x:z.number().optional(),y:z.number().optional(),srcX:z.number().optional(),srcY:z.number().optional(),srcW:z.number().optional(),srcH:z.number().optional()}),BlitOptionsSchema=z.union([JimpClassSchema,BlitOptionsSchemaComplex]),methods$h={blit(d,m){const g=BlitOptionsSchema.parse(m);let{src:w,x:I=0,y:P=0,srcX:F=0,srcY:$=0,srcW:D=w.bitmap.width,srcH:U=w.bitmap.height}="bitmap"in g?{src:g}:g;if(!("bitmap"in w))throw new Error("The source must be a Jimp image");if(typeof I!="number"||typeof P!="number")throw new Error("x and y must be numbers");I=Math.round(I),P=Math.round(P),F=Math.round(F),$=Math.round($),D=Math.round(D),U=Math.round(U);const Z=d.bitmap.width,j=d.bitmap.height;return scan(w,F,$,D,U,function(G,H,W){const Q=I+G-F,q=P+H-$;if(Q>=0&&q>=0&&Z-Q>0&&j-q>0){const rt=d.getPixelIndex(Q,q),it={r:w.bitmap.data[W]||0,g:w.bitmap.data[W+1]||0,b:w.bitmap.data[W+2]||0,a:w.bitmap.data[W+3]||0},X={r:d.bitmap.data[rt]||0,g:d.bitmap.data[rt+1]||0,b:d.bitmap.data[rt+2]||0,a:d.bitmap.data[rt+3]||0};d.bitmap.data[rt]=(it.a*(it.r-X.r)-X.r+255>>8)+X.r,d.bitmap.data[rt+1]=(it.a*(it.g-X.g)-X.g+255>>8)+X.g,d.bitmap.data[rt+2]=(it.a*(it.b-X.b)-X.b+255>>8)+X.b,d.bitmap.data[rt+3]=limit255(X.a+it.a)}}),d}},mulTable=[1,57,41,21,203,34,97,73,227,91,149,62,105,45,39,137,241,107,3,173,39,71,65,238,219,101,187,87,81,151,141,133,249,117,221,209,197,187,177,169,5,153,73,139,133,127,243,233,223,107,103,99,191,23,177,171,165,159,77,149,9,139,135,131,253,245,119,231,224,109,211,103,25,195,189,23,45,175,171,83,81,79,155,151,147,9,141,137,67,131,129,251,123,30,235,115,113,221,217,53,13,51,50,49,193,189,185,91,179,175,43,169,83,163,5,79,155,19,75,147,145,143,35,69,17,67,33,65,255,251,247,243,239,59,29,229,113,111,219,27,213,105,207,51,201,199,49,193,191,47,93,183,181,179,11,87,43,85,167,165,163,161,159,157,155,77,19,75,37,73,145,143,141,35,138,137,135,67,33,131,129,255,63,250,247,61,121,239,237,117,29,229,227,225,111,55,109,216,213,211,209,207,205,203,201,199,197,195,193,48,190,47,93,185,183,181,179,178,176,175,173,171,85,21,167,165,41,163,161,5,79,157,78,154,153,19,75,149,74,147,73,144,143,71,141,140,139,137,17,135,134,133,66,131,65,129,1],shgTable=[0,9,10,10,14,12,14,14,16,15,16,15,16,15,15,17,18,17,12,18,16,17,17,19,19,18,19,18,18,19,19,19,20,19,20,20,20,20,20,20,15,20,19,20,20,20,21,21,21,20,20,20,21,18,21,21,21,21,20,21,17,21,21,21,22,22,21,22,22,21,22,21,19,22,22,19,20,22,22,21,21,21,22,22,22,18,22,22,21,22,22,23,22,20,23,22,22,23,23,21,19,21,21,21,23,23,23,22,23,23,21,23,22,23,18,22,23,20,22,23,23,23,21,22,20,22,21,22,24,24,24,24,24,22,21,24,23,23,24,21,24,23,24,22,24,24,22,24,24,22,23,24,24,24,20,23,22,23,24,24,24,24,24,24,24,23,21,23,22,23,24,24,24,22,24,24,24,23,22,24,24,25,23,25,25,23,24,25,25,24,22,25,25,25,24,23,24,25,25,25,25,25,25,25,25,25,25,25,25,23,25,23,24,25,25,25,25,25,25,25,25,25,24,22,25,25,23,25,25,20,24,25,24,25,25,22,24,25,24,25,24,25,25,24,25,25,25,25,22,25,25,25,24,25,24,25,18],methods$g={blur(d,m){if(typeof m!="number")throw new Error("r must be a number");if(m<1)throw new Error("r must be greater than 0");let g,w,I,P,F,$,D,U,Z,j,G,H,W;const Q=d.bitmap.width-1,q=d.bitmap.height-1,rt=m+1,it=mulTable[m],X=shgTable[m],J=[],tt=[],ot=[],nt=[],lt=[],at=[];let ut=2;for(;ut-- >0;){for(H=0,W=0,$=0;$<d.bitmap.height;$++){for(g=d.bitmap.data[W]*rt,w=d.bitmap.data[W+1]*rt,I=d.bitmap.data[W+2]*rt,P=d.bitmap.data[W+3]*rt,D=1;D<=m;D++)U=W+((D>Q?Q:D)<<2),g+=d.bitmap.data[U++],w+=d.bitmap.data[U++],I+=d.bitmap.data[U++],P+=d.bitmap.data[U];for(F=0;F<d.bitmap.width;F++)J[H]=g,tt[H]=w,ot[H]=I,nt[H]=P,$===0&&(lt[F]=((U=F+rt)<Q?U:Q)<<2,at[F]=(U=F-m)>0?U<<2:0),Z=W+lt[F],j=W+at[F],g+=d.bitmap.data[Z++]-d.bitmap.data[j++],w+=d.bitmap.data[Z++]-d.bitmap.data[j++],I+=d.bitmap.data[Z++]-d.bitmap.data[j++],P+=d.bitmap.data[Z]-d.bitmap.data[j++],H++;W+=d.bitmap.width<<2}for(F=0;F<d.bitmap.width;F++){for(G=F,g=J[G]*rt,w=tt[G]*rt,I=ot[G]*rt,P=nt[G]*rt,D=1;D<=m;D++)G+=D>q?0:d.bitmap.width,g+=J[G],w+=tt[G],I+=ot[G],P+=nt[G];for(H=F<<2,$=0;$<d.bitmap.height;$++)d.bitmap.data[H]=limit255(g*it>>>X),d.bitmap.data[H+1]=limit255(w*it>>>X),d.bitmap.data[H+2]=limit255(I*it>>>X),d.bitmap.data[H+3]=limit255(P*it>>>X),F===0&&(lt[$]=((U=$+rt)<q?U:q)*d.bitmap.width,at[$]=(U=$-m)>0?U*d.bitmap.width:0),Z=F+lt[$],j=F+at[$],g+=J[Z]-J[j],w+=tt[Z]-tt[j],I+=ot[Z]-ot[j],P+=nt[Z]-nt[j],H+=d.bitmap.width<<2}}return d},gaussian(d,m){if(typeof m!="number")throw new Error("r must be a number");if(m<1)throw new Error("r must be greater than 0");const g=Math.ceil(2.57*m),w=2*g+1,I=m*m*2,P=I*Math.PI,F=[];for(let $=0;$<w;$++){const D=[];for(let U=0;U<w;U++){const Z=(U-g)**2+($-g)**2;D[U]=Math.exp(-Z/I)/P}F.push(D)}for(let $=0;$<d.bitmap.height;$++)for(let D=0;D<d.bitmap.width;D++){let U=0,Z=0,j=0,G=0,H=0;for(let W=0;W<w;W++){for(let q=0;q<w;q++){const rt=Math.min(d.bitmap.width-1,Math.max(0,q+D-g)),it=Math.min(d.bitmap.height-1,Math.max(0,W+$-g)),X=F[W][q],J=it*d.bitmap.width+rt<<2;U+=d.bitmap.data[J]*X,Z+=d.bitmap.data[J+1]*X,j+=d.bitmap.data[J+2]*X,G+=d.bitmap.data[J+3]*X,H+=X}const Q=$*d.bitmap.width+D<<2;d.bitmap.data[Q]=Math.round(U/H),d.bitmap.data[Q+1]=Math.round(Z/H),d.bitmap.data[Q+2]=Math.round(j/H),d.bitmap.data[Q+3]=Math.round(G/H)}}return d}},CircleOptionsSchema=z.object({x:z.number().optional(),y:z.number().optional(),radius:z.number().min(0).optional()}),methods$f={circle(d,m={}){const g=CircleOptionsSchema.parse(m),w=g.radius||(d.bitmap.width>d.bitmap.height?d.bitmap.height:d.bitmap.width)/2,I=typeof g.x=="number"?g.x:d.bitmap.width/2,P=typeof g.y=="number"?g.y:d.bitmap.height/2;return d.scan((F,$,D)=>{const U=Math.sqrt(Math.pow(F-I,2)+Math.pow($-P,2));w-U<=0?d.bitmap.data[D+3]=0:w-U<1&&(d.bitmap.data[D+3]=255*(w-U))}),d}},ConvolutionMatrixSchema=z.array(z.number()).min(1).array(),ConvolutionComplexOptionsSchema=z.object({kernel:ConvolutionMatrixSchema,edgeHandling:z.nativeEnum(Edge).optional()}),ConvolutionOptionsSchema=z.union([ConvolutionMatrixSchema,ConvolutionComplexOptionsSchema]),ConvoluteComplexOptionsSchema=z.object({kernel:ConvolutionMatrixSchema,x:z.number().optional(),y:z.number().optional(),w:z.number().optional(),h:z.number().optional()}),ConvoluteOptionsSchema=z.union([ConvolutionMatrixSchema,ConvoluteComplexOptionsSchema]),PixelateSize=z.number().min(1).max(1/0),PixelateComplexOptionsSchema=z.object({size:PixelateSize,x:z.number().optional(),y:z.number().optional(),w:z.number().optional(),h:z.number().optional()}),PixelateOptionsSchema=z.union([PixelateSize,PixelateComplexOptionsSchema]);function applyKernel(d,m,g,w){const I=[0,0,0,0],P=(m.length-1)/2;for(let F=0;F<m.length;F+=1)for(let $=0;$<m[F].length;$+=1){const D=d.getPixelIndex(g+F-P,w+$-P);I[0]+=d.bitmap.data[D]*m[F][$],I[1]+=d.bitmap.data[D+1]*m[F][$],I[2]+=d.bitmap.data[D+2]*m[F][$],I[3]+=d.bitmap.data[D+3]*m[F][$]}return I}function mix(d,m,g=50){return{r:(m.r-d.r)*(g/100)+d.r,g:(m.g-d.g)*(g/100)+d.g,b:(m.b-d.b)*(g/100)+d.b}}const HueActionSchema=z.object({apply:z.literal("hue"),params:z.tuple([z.number().min(-360).max(360)])}),SpinActionSchema=z.object({apply:z.literal("spin"),params:z.tuple([z.number().min(-360).max(360)])}),LightenActionSchema=z.object({apply:z.literal("lighten"),params:z.tuple([z.number().min(0).max(100)]).optional()}),RGBColorSchema=z.object({r:z.number().min(0).max(255),g:z.number().min(0).max(255),b:z.number().min(0).max(255)}),MixActionSchema=z.object({apply:z.literal("mix"),params:z.union([z.tuple([RGBColorSchema]),z.tuple([RGBColorSchema,z.number().min(0).max(100)])])}),TintActionSchema=z.object({apply:z.literal("tint"),params:z.tuple([z.number().min(0).max(100)]).optional()}),ShadeActionSchema=z.object({apply:z.literal("shade"),params:z.tuple([z.number().min(0).max(100)]).optional()}),XorActionSchema=z.object({apply:z.literal("xor"),params:z.tuple([RGBColorSchema])}),RedActionSchema=z.object({apply:z.literal("red"),params:z.tuple([z.number().min(-255).max(255)])}),GreenActionSchema=z.object({apply:z.literal("green"),params:z.tuple([z.number().min(-255).max(255)])}),BlueActionSchema=z.object({apply:z.literal("blue"),params:z.tuple([z.number().min(-255).max(255)])}),BrightenActionSchema=z.object({apply:z.literal("brighten"),params:z.tuple([z.number().min(0).max(100)]).optional()}),DarkenActionSchema=z.object({apply:z.literal("darken"),params:z.tuple([z.number().min(0).max(100)]).optional()}),DesaturateActionSchema=z.object({apply:z.literal("desaturate"),params:z.tuple([z.number().min(0).max(100)]).optional()}),SaturateActionSchema=z.object({apply:z.literal("saturate"),params:z.tuple([z.number().min(0).max(100)]).optional()}),GrayscaleActionSchema=z.object({apply:z.literal("greyscale"),params:z.tuple([]).optional()}),ColorActionNameSchema=z.union([HueActionSchema,SpinActionSchema,LightenActionSchema,MixActionSchema,TintActionSchema,ShadeActionSchema,XorActionSchema,RedActionSchema,GreenActionSchema,BlueActionSchema,BrightenActionSchema,DarkenActionSchema,DesaturateActionSchema,SaturateActionSchema,GrayscaleActionSchema]);function histogram(d){const m={r:new Array(256).fill(0),g:new Array(256).fill(0),b:new Array(256).fill(0)};return d.scan((g,w,I)=>{m.r[d.bitmap.data[I+0]]++,m.g[d.bitmap.data[I+1]]++,m.b[d.bitmap.data[I+2]]++}),m}const normalizeValue=function(d,m,g){return 255*(d-m)/(g-m)},getBounds=function(d){return[d.findIndex(m=>m>0),255-d.slice().reverse().findIndex(m=>m>0)]},methods$e={normalize(d){const m=histogram(d),g={r:getBounds(m.r),g:getBounds(m.g),b:getBounds(m.b)};return d.scan((w,I,P)=>{const F=d.bitmap.data[P+0],$=d.bitmap.data[P+1],D=d.bitmap.data[P+2];d.bitmap.data[P+0]=normalizeValue(F,g.r[0],g.r[1]),d.bitmap.data[P+1]=normalizeValue($,g.g[0],g.g[1]),d.bitmap.data[P+2]=normalizeValue(D,g.b[0],g.b[1])}),d},invert:d=>(d.scan((m,g,w)=>{d.bitmap.data[w]=255-d.bitmap.data[w],d.bitmap.data[w+1]=255-d.bitmap.data[w+1],d.bitmap.data[w+2]=255-d.bitmap.data[w+2]}),d),brightness(d,m){if(typeof m!="number")throw new Error("val must be numbers");return d.scan((g,w,I)=>{d.bitmap.data[I]=limit255(d.bitmap.data[I]*m),d.bitmap.data[I+1]=limit255(d.bitmap.data[I+1]*m),d.bitmap.data[I+2]=limit255(d.bitmap.data[I+2]*m)}),d},contrast(d,m){if(typeof m!="number")throw new Error("val must be numbers");if(m<-1||m>1)throw new Error("val must be a number between -1 and +1");const g=(m+1)/(1-m);function w(I){return(I=Math.floor(g*(I-127)+127))<0?0:I>255?255:I}return d.scan((I,P,F)=>{d.bitmap.data[F]=w(d.bitmap.data[F]),d.bitmap.data[F+1]=w(d.bitmap.data[F+1]),d.bitmap.data[F+2]=w(d.bitmap.data[F+2])}),d},posterize(d,m){if(typeof m!="number")throw new Error("n must be numbers");return m<2&&(m=2),d.scan((g,w,I)=>{const P=d.bitmap.data[I],F=d.bitmap.data[I+1],$=d.bitmap.data[I+2];d.bitmap.data[I]=Math.floor(P/255*(m-1))/(m-1)*255,d.bitmap.data[I+1]=Math.floor(F/255*(m-1))/(m-1)*255,d.bitmap.data[I+2]=Math.floor($/255*(m-1))/(m-1)*255}),d},greyscale:d=>(d.scan((m,g,w)=>{const I=.2126*d.bitmap.data[w]+.7152*d.bitmap.data[w+1]+.0722*d.bitmap.data[w+2];d.bitmap.data[w]=I,d.bitmap.data[w+1]=I,d.bitmap.data[w+2]=I}),d),opacity(d,m){if(typeof m!="number")throw new Error("f must be a number");if(m<0||m>1)throw new Error("f must be a number from 0 to 1");return d.scan((g,w,I)=>{const P=d.bitmap.data[I+3]*m;d.bitmap.data[I+3]=P}),d},sepia:d=>(d.scan((m,g,w)=>{let I=d.bitmap.data[w],P=d.bitmap.data[w+1],F=d.bitmap.data[w+2];I=.393*I+.769*P+.189*F,P=.349*I+.686*P+.168*F,F=.272*I+.534*P+.131*F,d.bitmap.data[w]=I<255?I:255,d.bitmap.data[w+1]=P<255?P:255,d.bitmap.data[w+2]=F<255?F:255}),d),fade(d,m){if(typeof m!="number")throw new Error("f must be a number");if(m<0||m>1)throw new Error("f must be a number from 0 to 1");return this.opacity(d,1-m)},convolution(d,m){const g=ConvolutionOptionsSchema.parse(m),{kernel:w,edgeHandling:I=Edge.EXTEND}="kernel"in g?g:{kernel:g,edgeHandling:void 0};if(!w[0])throw new Error("kernel must be a matrix");const P=Buffer.from(d.bitmap.data),F=w.length,$=w[0].length,D=Math.floor(F/2),U=Math.floor($/2),Z=-D,j=-U;let G,H,W,Q,q,rt,it,X,J,tt;return d.scan((ot,nt,lt)=>{Q=0,W=0,H=0;for(let at=Z;at<=D;at++)for(let ut=j;ut<=U;ut++)X=ot+ut,J=nt+at,G=w[at+D][ut+U],tt=d.getPixelIndex(X,J,I),tt===-1?(it=0,rt=0,q=0):(q=d.bitmap.data[tt+0],rt=d.bitmap.data[tt+1],it=d.bitmap.data[tt+2]),H+=G*q,W+=G*rt,Q+=G*it;H<0&&(H=0),W<0&&(W=0),Q<0&&(Q=0),H>255&&(H=255),W>255&&(W=255),Q>255&&(Q=255),P[lt+0]=H,P[lt+1]=W,P[lt+2]=Q}),d.bitmap.data=P,d},opaque:d=>(d.scan((m,g,w)=>{d.bitmap.data[w+3]=255}),d),pixelate(d,m){const g=PixelateOptionsSchema.parse(m),{size:w,x:I=0,y:P=0,w:F=d.bitmap.width-I,h:$=d.bitmap.height-P}=typeof g=="number"?{size:g}:g,D=[[1/16,2/16,1/16],[2/16,.25,2/16],[1/16,2/16,1/16]],U=clone(d);return scan(U,I,P,F,$,(Z,j,G)=>{Z=w*Math.floor(Z/w),j=w*Math.floor(j/w);const H=applyKernel(U,D,Z,j);d.bitmap.data[G]=H[0],d.bitmap.data[G+1]=H[1],d.bitmap.data[G+2]=H[2],d.bitmap.data[G+3]=H[3]}),d},convolute(d,m){const g=ConvoluteOptionsSchema.parse(m),{kernel:w,x:I=0,y:P=0,w:F=d.bitmap.width-I,h:$=d.bitmap.height-P}="kernel"in g?g:{kernel:g},D=clone(d);return scan(D,I,P,F,$,(U,Z,j)=>{const G=applyKernel(D,w,U,Z);d.bitmap.data[j]=limit255(G[0]),d.bitmap.data[j+1]=limit255(G[1]),d.bitmap.data[j+2]=limit255(G[2]),d.bitmap.data[j+3]=limit255(G[3])}),d},color(d,m){if(!m||!Array.isArray(m))throw new Error("actions must be an array");return m.forEach(g=>ColorActionNameSchema.parse(g)),m=m.map(g=>(g.apply!=="xor"&&g.apply!=="mix"||(g.params[0]=tinycolor(g.params[0]).toRgb()),g)),d.scan((g,w,I)=>{let P={r:d.bitmap.data[I],g:d.bitmap.data[I+1],b:d.bitmap.data[I+2]};const F=($,D)=>limit255(P[$]+D);m.forEach($=>{var D,U;if($.apply==="mix")P=mix(P,$.params[0],$.params[1]);else if($.apply==="tint")P=mix(P,{r:255,g:255,b:255},(D=$.params)==null?void 0:D[0]);else if($.apply==="shade")P=mix(P,{r:0,g:0,b:0},(U=$.params)==null?void 0:U[0]);else if($.apply==="xor")P={r:P.r^$.params[0].r,g:P.g^$.params[0].g,b:P.b^$.params[0].b};else if($.apply==="red")P.r=F("r",$.params[0]);else if($.apply==="green")P.g=F("g",$.params[0]);else if($.apply==="blue")P.b=F("b",$.params[0]);else{$.apply==="hue"&&($.apply="spin");const Z=tinycolor(P),j=Z[$.apply].bind(Z);if(!j)throw new Error("action "+$.apply+" not supported");P=j(...$.params||[]).toRgb()}}),d.bitmap.data[I]=P.r,d.bitmap.data[I+1]=P.g,d.bitmap.data[I+2]=P.b}),d}};var lib$1={},ieee754={read:function(d,m,g,w,I){var P,F,$=8*I-w-1,D=(1<<$)-1,U=D>>1,Z=-7,j=g?I-1:0,G=g?-1:1,H=d[m+j];for(j+=G,P=H&(1<<-Z)-1,H>>=-Z,Z+=$;Z>0;P=256*P+d[m+j],j+=G,Z-=8);for(F=P&(1<<-Z)-1,P>>=-Z,Z+=w;Z>0;F=256*F+d[m+j],j+=G,Z-=8);if(P===0)P=1-U;else{if(P===D)return F?NaN:1/0*(H?-1:1);F+=Math.pow(2,w),P-=U}return(H?-1:1)*F*Math.pow(2,P-w)},write:function(d,m,g,w,I,P){var F,$,D,U=8*P-I-1,Z=(1<<U)-1,j=Z>>1,G=I===23?Math.pow(2,-24)-Math.pow(2,-77):0,H=w?0:P-1,W=w?1:-1,Q=m<0||m===0&&1/m<0?1:0;for(m=Math.abs(m),isNaN(m)||m===1/0?($=isNaN(m)?1:0,F=Z):(F=Math.floor(Math.log(m)/Math.LN2),m*(D=Math.pow(2,-F))<1&&(F--,D*=2),(m+=F+j>=1?G/D:G*Math.pow(2,1-j))*D>=2&&(F++,D/=2),F+j>=Z?($=0,F=Z):F+j>=1?($=(m*D-1)*Math.pow(2,I),F+=j):($=m*Math.pow(2,j-1)*Math.pow(2,I),F=0));I>=8;d[g+H]=255&$,H+=W,$/=256,I-=8);for(F=F<<I|$,U+=I;U>0;d[g+H]=255&F,H+=W,F/=256,U-=8);d[g+H-W]|=128*Q}};(function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.AnsiStringType=d.StringType=d.BufferType=d.Uint8ArrayType=d.IgnoreType=d.Float80_LE=d.Float80_BE=d.Float64_LE=d.Float64_BE=d.Float32_LE=d.Float32_BE=d.Float16_LE=d.Float16_BE=d.INT64_BE=d.UINT64_BE=d.INT64_LE=d.UINT64_LE=d.INT32_LE=d.INT32_BE=d.INT24_BE=d.INT24_LE=d.INT16_LE=d.INT16_BE=d.INT8=d.UINT32_BE=d.UINT32_LE=d.UINT24_BE=d.UINT24_LE=d.UINT16_BE=d.UINT16_LE=d.UINT8=void 0;const m=ieee754;function g(I){return new DataView(I.buffer,I.byteOffset)}d.UINT8={len:1,get:(I,P)=>g(I).getUint8(P),put:(I,P,F)=>(g(I).setUint8(P,F),P+1)},d.UINT16_LE={len:2,get:(I,P)=>g(I).getUint16(P,!0),put:(I,P,F)=>(g(I).setUint16(P,F,!0),P+2)},d.UINT16_BE={len:2,get:(I,P)=>g(I).getUint16(P),put:(I,P,F)=>(g(I).setUint16(P,F),P+2)},d.UINT24_LE={len:3,get(I,P){const F=g(I);return F.getUint8(P)+(F.getUint16(P+1,!0)<<8)},put(I,P,F){const $=g(I);return $.setUint8(P,255&F),$.setUint16(P+1,F>>8,!0),P+3}},d.UINT24_BE={len:3,get(I,P){const F=g(I);return(F.getUint16(P)<<8)+F.getUint8(P+2)},put(I,P,F){const $=g(I);return $.setUint16(P,F>>8),$.setUint8(P+2,255&F),P+3}},d.UINT32_LE={len:4,get:(I,P)=>g(I).getUint32(P,!0),put:(I,P,F)=>(g(I).setUint32(P,F,!0),P+4)},d.UINT32_BE={len:4,get:(I,P)=>g(I).getUint32(P),put:(I,P,F)=>(g(I).setUint32(P,F),P+4)},d.INT8={len:1,get:(I,P)=>g(I).getInt8(P),put:(I,P,F)=>(g(I).setInt8(P,F),P+1)},d.INT16_BE={len:2,get:(I,P)=>g(I).getInt16(P),put:(I,P,F)=>(g(I).setInt16(P,F),P+2)},d.INT16_LE={len:2,get:(I,P)=>g(I).getInt16(P,!0),put:(I,P,F)=>(g(I).setInt16(P,F,!0),P+2)},d.INT24_LE={len:3,get(I,P){const F=d.UINT24_LE.get(I,P);return F>8388607?F-16777216:F},put(I,P,F){const $=g(I);return $.setUint8(P,255&F),$.setUint16(P+1,F>>8,!0),P+3}},d.INT24_BE={len:3,get(I,P){const F=d.UINT24_BE.get(I,P);return F>8388607?F-16777216:F},put(I,P,F){const $=g(I);return $.setUint16(P,F>>8),$.setUint8(P+2,255&F),P+3}},d.INT32_BE={len:4,get:(I,P)=>g(I).getInt32(P),put:(I,P,F)=>(g(I).setInt32(P,F),P+4)},d.INT32_LE={len:4,get:(I,P)=>g(I).getInt32(P,!0),put:(I,P,F)=>(g(I).setInt32(P,F,!0),P+4)},d.UINT64_LE={len:8,get:(I,P)=>g(I).getBigUint64(P,!0),put:(I,P,F)=>(g(I).setBigUint64(P,F,!0),P+8)},d.INT64_LE={len:8,get:(I,P)=>g(I).getBigInt64(P,!0),put:(I,P,F)=>(g(I).setBigInt64(P,F,!0),P+8)},d.UINT64_BE={len:8,get:(I,P)=>g(I).getBigUint64(P),put:(I,P,F)=>(g(I).setBigUint64(P,F),P+8)},d.INT64_BE={len:8,get:(I,P)=>g(I).getBigInt64(P),put:(I,P,F)=>(g(I).setBigInt64(P,F),P+8)},d.Float16_BE={len:2,get(I,P){return m.read(I,P,!1,10,this.len)},put(I,P,F){return m.write(I,F,P,!1,10,this.len),P+this.len}},d.Float16_LE={len:2,get(I,P){return m.read(I,P,!0,10,this.len)},put(I,P,F){return m.write(I,F,P,!0,10,this.len),P+this.len}},d.Float32_BE={len:4,get:(I,P)=>g(I).getFloat32(P),put:(I,P,F)=>(g(I).setFloat32(P,F),P+4)},d.Float32_LE={len:4,get:(I,P)=>g(I).getFloat32(P,!0),put:(I,P,F)=>(g(I).setFloat32(P,F,!0),P+4)},d.Float64_BE={len:8,get:(I,P)=>g(I).getFloat64(P),put:(I,P,F)=>(g(I).setFloat64(P,F),P+8)},d.Float64_LE={len:8,get:(I,P)=>g(I).getFloat64(P,!0),put:(I,P,F)=>(g(I).setFloat64(P,F,!0),P+8)},d.Float80_BE={len:10,get(I,P){return m.read(I,P,!1,63,this.len)},put(I,P,F){return m.write(I,F,P,!1,63,this.len),P+this.len}},d.Float80_LE={len:10,get(I,P){return m.read(I,P,!0,63,this.len)},put(I,P,F){return m.write(I,F,P,!0,63,this.len),P+this.len}},d.IgnoreType=class{constructor(I){this.len=I}get(I,P){}},d.Uint8ArrayType=class{constructor(I){this.len=I}get(I,P){return I.subarray(P,P+this.len)}},d.BufferType=class{constructor(I){this.len=I}get(I,P){return Buffer.from(I.subarray(P,P+this.len))}},d.StringType=class{constructor(I,P){this.len=I,this.encoding=P}get(I,P){return Buffer.from(I).toString(this.encoding,P,P+this.len)}};class w{constructor(P){this.len=P}static decode(P,F,$){let D="";for(let U=F;U<$;++U)D+=w.codePointToString(w.singleByteDecoder(P[U]));return D}static inRange(P,F,$){return F<=P&&P<=$}static codePointToString(P){return P<=65535?String.fromCharCode(P):(P-=65536,String.fromCharCode(55296+(P>>10),56320+(1023&P)))}static singleByteDecoder(P){if(w.inRange(P,0,127))return P;const F=w.windows1252[P-128];if(F===null)throw Error("invaliding encoding");return F}get(P,F=0){return w.decode(P,F,F+this.len)}}d.AnsiStringType=w,w.windows1252=[8364,129,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,141,381,143,144,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,157,382,376,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255]})(lib$1);var core$1={},ReadStreamTokenizer$1={},AbstractTokenizer$1={},lib={},EndOfFileStream={};(function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.EndOfStreamError=d.defaultMessages=void 0,d.defaultMessages="End-Of-Stream";class m extends Error{constructor(){super(d.defaultMessages)}}d.EndOfStreamError=m})(EndOfFileStream);var StreamReader={},Deferred$1={};Object.defineProperty(Deferred$1,"__esModule",{value:!0}),Deferred$1.Deferred=void 0;class Deferred{constructor(){this.resolve=()=>null,this.reject=()=>null,this.promise=new Promise((m,g)=>{this.reject=g,this.resolve=m})}}Deferred$1.Deferred=Deferred,function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.StreamReader=d.EndOfStreamError=void 0;const m=EndOfFileStream,g=Deferred$1;var w=EndOfFileStream;Object.defineProperty(d,"EndOfStreamError",{enumerable:!0,get:function(){return w.EndOfStreamError}}),d.StreamReader=class{constructor(I){if(this.s=I,this.deferred=null,this.endOfStream=!1,this.peekQueue=[],!I.read||!I.once)throw new Error("Expected an instance of stream.Readable");this.s.once("end",()=>this.reject(new m.EndOfStreamError)),this.s.once("error",P=>this.reject(P)),this.s.once("close",()=>this.reject(new Error("Stream closed")))}async peek(I,P,F){const $=await this.read(I,P,F);return this.peekQueue.push(I.subarray(P,P+$)),$}async read(I,P,F){if(F===0)return 0;if(this.peekQueue.length===0&&this.endOfStream)throw new m.EndOfStreamError;let $=F,D=0;for(;this.peekQueue.length>0&&$>0;){const U=this.peekQueue.pop();if(!U)throw new Error("peekData should be defined");const Z=Math.min(U.length,$);I.set(U.subarray(0,Z),P+D),D+=Z,$-=Z,Z<U.length&&this.peekQueue.push(U.subarray(Z))}for(;$>0&&!this.endOfStream;){const U=Math.min($,1048576),Z=await this.readFromStream(I,P+D,U);if(D+=Z,Z<U)break;$-=Z}return D}async readFromStream(I,P,F){const $=this.s.read(F);if($)return I.set($,P),$.length;{const D={buffer:I,offset:P,length:F,deferred:new g.Deferred};return this.deferred=D.deferred,this.s.once("readable",()=>{this.readDeferred(D)}),D.deferred.promise}}readDeferred(I){const P=this.s.read(I.length);P?(I.buffer.set(P,I.offset),I.deferred.resolve(P.length),this.deferred=null):this.s.once("readable",()=>{this.readDeferred(I)})}reject(I){this.endOfStream=!0,this.deferred&&(this.deferred.reject(I),this.deferred=null)}}}(StreamReader),function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.StreamReader=d.EndOfStreamError=void 0;var m=EndOfFileStream;Object.defineProperty(d,"EndOfStreamError",{enumerable:!0,get:function(){return m.EndOfStreamError}});var g=StreamReader;Object.defineProperty(d,"StreamReader",{enumerable:!0,get:function(){return g.StreamReader}})}(lib),Object.defineProperty(AbstractTokenizer$1,"__esModule",{value:!0}),AbstractTokenizer$1.AbstractTokenizer=void 0;const peek_readable_1$2=lib;class AbstractTokenizer{constructor(m){this.position=0,this.numBuffer=new Uint8Array(8),this.fileInfo=m||{}}async readToken(m,g=this.position){const w=Buffer.alloc(m.len);if(await this.readBuffer(w,{position:g})<m.len)throw new peek_readable_1$2.EndOfStreamError;return m.get(w,0)}async peekToken(m,g=this.position){const w=Buffer.alloc(m.len);if(await this.peekBuffer(w,{position:g})<m.len)throw new peek_readable_1$2.EndOfStreamError;return m.get(w,0)}async readNumber(m){if(await this.readBuffer(this.numBuffer,{length:m.len})<m.len)throw new peek_readable_1$2.EndOfStreamError;return m.get(this.numBuffer,0)}async peekNumber(m){if(await this.peekBuffer(this.numBuffer,{length:m.len})<m.len)throw new peek_readable_1$2.EndOfStreamError;return m.get(this.numBuffer,0)}async ignore(m){if(this.fileInfo.size!==void 0){const g=this.fileInfo.size-this.position;if(m>g)return this.position+=g,g}return this.position+=m,m}async close(){}normalizeOptions(m,g){if(g&&g.position!==void 0&&g.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");return g?{mayBeLess:g.mayBeLess===!0,offset:g.offset?g.offset:0,length:g.length?g.length:m.length-(g.offset?g.offset:0),position:g.position?g.position:this.position}:{mayBeLess:!1,offset:0,length:m.length,position:this.position}}}AbstractTokenizer$1.AbstractTokenizer=AbstractTokenizer,Object.defineProperty(ReadStreamTokenizer$1,"__esModule",{value:!0}),ReadStreamTokenizer$1.ReadStreamTokenizer=void 0;const AbstractTokenizer_1$1=AbstractTokenizer$1,peek_readable_1$1=lib,maxBufferSize=256e3;class ReadStreamTokenizer extends AbstractTokenizer_1$1.AbstractTokenizer{constructor(m,g){super(g),this.streamReader=new peek_readable_1$1.StreamReader(m)}async getFileInfo(){return this.fileInfo}async readBuffer(m,g){const w=this.normalizeOptions(m,g),I=w.position-this.position;if(I>0)return await this.ignore(I),this.readBuffer(m,g);if(I<0)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");if(w.length===0)return 0;const P=await this.streamReader.read(m,w.offset,w.length);if(this.position+=P,(!g||!g.mayBeLess)&&P<w.length)throw new peek_readable_1$1.EndOfStreamError;return P}async peekBuffer(m,g){const w=this.normalizeOptions(m,g);let I=0;if(w.position){const P=w.position-this.position;if(P>0){const F=new Uint8Array(w.length+P);return I=await this.peekBuffer(F,{mayBeLess:w.mayBeLess}),m.set(F.subarray(P),w.offset),I-P}if(P<0)throw new Error("Cannot peek from a negative offset in a stream")}if(w.length>0){try{I=await this.streamReader.peek(m,w.offset,w.length)}catch(P){if(g&&g.mayBeLess&&P instanceof peek_readable_1$1.EndOfStreamError)return 0;throw P}if(!w.mayBeLess&&I<w.length)throw new peek_readable_1$1.EndOfStreamError}return I}async ignore(m){const g=Math.min(maxBufferSize,m),w=new Uint8Array(g);let I=0;for(;I<m;){const P=m-I,F=await this.readBuffer(w,{length:Math.min(g,P)});if(F<0)return F;I+=F}return I}}ReadStreamTokenizer$1.ReadStreamTokenizer=ReadStreamTokenizer;var BufferTokenizer$1={};Object.defineProperty(BufferTokenizer$1,"__esModule",{value:!0}),BufferTokenizer$1.BufferTokenizer=void 0;const peek_readable_1=lib,AbstractTokenizer_1=AbstractTokenizer$1;class BufferTokenizer extends AbstractTokenizer_1.AbstractTokenizer{constructor(m,g){super(g),this.uint8Array=m,this.fileInfo.size=this.fileInfo.size?this.fileInfo.size:m.length}async readBuffer(m,g){if(g&&g.position){if(g.position<this.position)throw new Error("`options.position` must be equal or greater than `tokenizer.position`");this.position=g.position}const w=await this.peekBuffer(m,g);return this.position+=w,w}async peekBuffer(m,g){const w=this.normalizeOptions(m,g),I=Math.min(this.uint8Array.length-w.position,w.length);if(!w.mayBeLess&&I<w.length)throw new peek_readable_1.EndOfStreamError;return m.set(this.uint8Array.subarray(w.position,w.position+I),w.offset),I}async close(){}}BufferTokenizer$1.BufferTokenizer=BufferTokenizer,function(d){Object.defineProperty(d,"__esModule",{value:!0}),d.fromBuffer=d.fromStream=d.EndOfStreamError=void 0;const m=ReadStreamTokenizer$1,g=BufferTokenizer$1;var w=lib;Object.defineProperty(d,"EndOfStreamError",{enumerable:!0,get:function(){return w.EndOfStreamError}}),d.fromStream=function(I,P){return P=P||{},new m.ReadStreamTokenizer(I,P)},d.fromBuffer=function(I,P){return new g.BufferTokenizer(I,P)}}(core$1);var util={stringToBytes:d=>[...d].map(m=>m.charCodeAt(0)),tarHeaderChecksumMatches:(d,m=0)=>{const g=parseInt(d.toString("utf8",148,154).replace(/\0.*$/,"").trim(),8);if(isNaN(g))return!1;let w=256;for(let I=m;I<m+148;I++)w+=d[I];for(let I=m+156;I<m+512;I++)w+=d[I];return g===w},uint32SyncSafeToken:{get:(d,m)=>127&d[m+3]|d[m+2]<<7|d[m+1]<<14|d[m]<<21,len:4}},supported$1={extensions:["jpg","png","apng","gif","webp","flif","xcf","cr2","cr3","orf","arw","dng","nef","rw2","raf","tif","bmp","icns","jxr","psd","indd","zip","tar","rar","gz","bz2","7z","dmg","mp4","mid","mkv","webm","mov","avi","mpg","mp2","mp3","m4a","oga","ogg","ogv","opus","flac","wav","spx","amr","pdf","epub","exe","swf","rtf","wasm","woff","woff2","eot","ttf","otf","ico","flv","ps","xz","sqlite","nes","crx","xpi","cab","deb","ar","rpm","Z","lz","cfb","mxf","mts","blend","bpg","docx","pptx","xlsx","3gp","3g2","jp2","jpm","jpx","mj2","aif","qcp","odt","ods","odp","xml","mobi","heic","cur","ktx","ape","wv","dcm","ics","glb","pcap","dsf","lnk","alias","voc","ac3","m4v","m4p","m4b","f4v","f4p","f4b","f4a","mie","asf","ogm","ogx","mpc","arrow","shp","aac","mp1","it","s3m","xm","ai","skp","avif","eps","lzh","pgp","asar","stl","chm","3mf","zst","jxl","vcf"],mimeTypes:["image/jpeg","image/png","image/gif","image/webp","image/flif","image/x-xcf","image/x-canon-cr2","image/x-canon-cr3","image/tiff","image/bmp","image/vnd.ms-photo","image/vnd.adobe.photoshop","application/x-indesign","application/epub+zip","application/x-xpinstall","application/vnd.oasis.opendocument.text","application/vnd.oasis.opendocument.spreadsheet","application/vnd.oasis.opendocument.presentation","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/zip","application/x-tar","application/x-rar-compressed","application/gzip","application/x-bzip2","application/x-7z-compressed","application/x-apple-diskimage","application/x-apache-arrow","video/mp4","audio/midi","video/x-matroska","video/webm","video/quicktime","video/vnd.avi","audio/vnd.wave","audio/qcelp","audio/x-ms-asf","video/x-ms-asf","application/vnd.ms-asf","video/mpeg","video/3gpp","audio/mpeg","audio/mp4","audio/opus","video/ogg","audio/ogg","application/ogg","audio/x-flac","audio/ape","audio/wavpack","audio/amr","application/pdf","application/x-msdownload","application/x-shockwave-flash","application/rtf","application/wasm","font/woff","font/woff2","application/vnd.ms-fontobject","font/ttf","font/otf","image/x-icon","video/x-flv","application/postscript","application/eps","application/x-xz","application/x-sqlite3","application/x-nintendo-nes-rom","application/x-google-chrome-extension","application/vnd.ms-cab-compressed","application/x-deb","application/x-unix-archive","application/x-rpm","application/x-compress","application/x-lzip","application/x-cfb","application/x-mie","application/mxf","video/mp2t","application/x-blender","image/bpg","image/jp2","image/jpx","image/jpm","image/mj2","audio/aiff","application/xml","application/x-mobipocket-ebook","image/heif","image/heif-sequence","image/heic","image/heic-sequence","image/icns","image/ktx","application/dicom","audio/x-musepack","text/calendar","text/vcard","model/gltf-binary","application/vnd.tcpdump.pcap","audio/x-dsf","application/x.ms.shortcut","application/x.apple.alias","audio/x-voc","audio/vnd.dolby.dd-raw","audio/x-m4a","image/apng","image/x-olympus-orf","image/x-sony-arw","image/x-adobe-dng","image/x-nikon-nef","image/x-panasonic-rw2","image/x-fujifilm-raf","video/x-m4v","video/3gpp2","application/x-esri-shape","audio/aac","audio/x-it","audio/x-s3m","audio/x-xm","video/MP1S","video/MP2P","application/vnd.sketchup.skp","image/avif","application/x-lzh-compressed","application/pgp-encrypted","application/x-asar","model/stl","application/vnd.ms-htmlhelp","model/3mf","image/jxl","application/zstd"]};const Token=lib$1,strtok3=core$1,{stringToBytes,tarHeaderChecksumMatches,uint32SyncSafeToken}=util,supported=supported$1,minimumBytes=4100;async function fromStream(d){const m=await strtok3.fromStream(d);try{return await fromTokenizer(m)}finally{await m.close()}}async function fromBuffer(d){if(!(d instanceof Uint8Array||d instanceof ArrayBuffer||Buffer.isBuffer(d)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof d}\``);const m=d instanceof Buffer?d:Buffer.from(d);if(m&&m.length>1)return fromTokenizer(strtok3.fromBuffer(m))}function _check(d,m,g){g={offset:0,...g};for(const[w,I]of m.entries())if(g.mask){if(I!==(g.mask[w]&d[w+g.offset]))return!1}else if(I!==d[w+g.offset])return!1;return!0}async function fromTokenizer(d){try{return _fromTokenizer(d)}catch(m){if(!(m instanceof strtok3.EndOfStreamError))throw m}}async function _fromTokenizer(d){let m=Buffer.alloc(minimumBytes);const g=(I,P)=>_check(m,I,P),w=(I,P)=>g(stringToBytes(I),P);if(d.fileInfo.size||(d.fileInfo.size=Number.MAX_SAFE_INTEGER),await d.peekBuffer(m,{length:12,mayBeLess:!0}),g([66,77]))return{ext:"bmp",mime:"image/bmp"};if(g([11,119]))return{ext:"ac3",mime:"audio/vnd.dolby.dd-raw"};if(g([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(g([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if(g([37,33]))return await d.peekBuffer(m,{length:24,mayBeLess:!0}),w("PS-Adobe-",{offset:2})&&w(" EPSF-",{offset:14})?{ext:"eps",mime:"application/eps"}:{ext:"ps",mime:"application/postscript"};if(g([31,160])||g([31,157]))return{ext:"Z",mime:"application/x-compress"};if(g([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(g([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(g([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(g([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(w("ID3")){await d.ignore(6);const I=await d.readToken(uint32SyncSafeToken);return d.position+I>d.fileInfo.size?{ext:"mp3",mime:"audio/mpeg"}:(await d.ignore(I),fromTokenizer(d))}if(w("MP+"))return{ext:"mpc",mime:"audio/x-musepack"};if((m[0]===67||m[0]===70)&&g([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(g([71,73,70]))return{ext:"gif",mime:"image/gif"};if(w("FLIF"))return{ext:"flif",mime:"image/flif"};if(w("8BPS"))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(w("WEBP",{offset:8}))return{ext:"webp",mime:"image/webp"};if(w("MPCK"))return{ext:"mpc",mime:"audio/x-musepack"};if(w("FORM"))return{ext:"aif",mime:"audio/aiff"};if(w("icns",{offset:0}))return{ext:"icns",mime:"image/icns"};if(g([80,75,3,4])){try{for(;d.position+30<d.fileInfo.size;){await d.readBuffer(m,{length:30});const I={compressedSize:m.readUInt32LE(18),uncompressedSize:m.readUInt32LE(22),filenameLength:m.readUInt16LE(26),extraFieldLength:m.readUInt16LE(28)};if(I.filename=await d.readToken(new Token.StringType(I.filenameLength,"utf-8")),await d.ignore(I.extraFieldLength),I.filename==="META-INF/mozilla.rsa")return{ext:"xpi",mime:"application/x-xpinstall"};if(I.filename.endsWith(".rels")||I.filename.endsWith(".xml"))switch(I.filename.split("/")[0]){case"_rels":default:break;case"word":return{ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"};case"ppt":return{ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"};case"xl":return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}if(I.filename.startsWith("xl/"))return{ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};if(I.filename.startsWith("3D/")&&I.filename.endsWith(".model"))return{ext:"3mf",mime:"model/3mf"};if(I.filename==="mimetype"&&I.compressedSize===I.uncompressedSize)switch(await d.readToken(new Token.StringType(I.compressedSize,"utf-8"))){case"application/epub+zip":return{ext:"epub",mime:"application/epub+zip"};case"application/vnd.oasis.opendocument.text":return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};case"application/vnd.oasis.opendocument.spreadsheet":return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};case"application/vnd.oasis.opendocument.presentation":return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"}}if(I.compressedSize===0){let P=-1;for(;P<0&&d.position<d.fileInfo.size;)await d.peekBuffer(m,{mayBeLess:!0}),P=m.indexOf("504B0304",0,"hex"),await d.ignore(P>=0?P:m.length)}else await d.ignore(I.compressedSize)}}catch(I){if(!(I instanceof strtok3.EndOfStreamError))throw I}return{ext:"zip",mime:"application/zip"}}if(w("OggS")){await d.ignore(28);const I=Buffer.alloc(8);return await d.readBuffer(I),_check(I,[79,112,117,115,72,101,97,100])?{ext:"opus",mime:"audio/opus"}:_check(I,[128,116,104,101,111,114,97])?{ext:"ogv",mime:"video/ogg"}:_check(I,[1,118,105,100,101,111,0])?{ext:"ogm",mime:"video/ogg"}:_check(I,[127,70,76,65,67])?{ext:"oga",mime:"audio/ogg"}:_check(I,[83,112,101,101,120,32,32])?{ext:"spx",mime:"audio/ogg"}:_check(I,[1,118,111,114,98,105,115])?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"}}if(g([80,75])&&(m[2]===3||m[2]===5||m[2]===7)&&(m[3]===4||m[3]===6||m[3]===8))return{ext:"zip",mime:"application/zip"};if(w("ftyp",{offset:4})&&96&m[8]){const I=m.toString("binary",8,12).replace("\0"," ").trim();switch(I){case"avif":return{ext:"avif",mime:"image/avif"};case"mif1":return{ext:"heic",mime:"image/heif"};case"msf1":return{ext:"heic",mime:"image/heif-sequence"};case"heic":case"heix":return{ext:"heic",mime:"image/heic"};case"hevc":case"hevx":return{ext:"heic",mime:"image/heic-sequence"};case"qt":return{ext:"mov",mime:"video/quicktime"};case"M4V":case"M4VH":case"M4VP":return{ext:"m4v",mime:"video/x-m4v"};case"M4P":return{ext:"m4p",mime:"video/mp4"};case"M4B":return{ext:"m4b",mime:"audio/mp4"};case"M4A":return{ext:"m4a",mime:"audio/x-m4a"};case"F4V":return{ext:"f4v",mime:"video/mp4"};case"F4P":return{ext:"f4p",mime:"video/mp4"};case"F4A":return{ext:"f4a",mime:"audio/mp4"};case"F4B":return{ext:"f4b",mime:"audio/mp4"};case"crx":return{ext:"cr3",mime:"image/x-canon-cr3"};default:return I.startsWith("3g")?I.startsWith("3g2")?{ext:"3g2",mime:"video/3gpp2"}:{ext:"3gp",mime:"video/3gpp"}:{ext:"mp4",mime:"video/mp4"}}}if(w("MThd"))return{ext:"mid",mime:"audio/midi"};if(w("wOFF")&&(g([0,1,0,0],{offset:4})||w("OTTO",{offset:4})))return{ext:"woff",mime:"font/woff"};if(w("wOF2")&&(g([0,1,0,0],{offset:4})||w("OTTO",{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(g([212,195,178,161])||g([161,178,195,212]))return{ext:"pcap",mime:"application/vnd.tcpdump.pcap"};if(w("DSD "))return{ext:"dsf",mime:"audio/x-dsf"};if(w("LZIP"))return{ext:"lz",mime:"application/x-lzip"};if(w("fLaC"))return{ext:"flac",mime:"audio/x-flac"};if(g([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(w("wvpk"))return{ext:"wv",mime:"audio/wavpack"};if(w("%PDF")){await d.ignore(1350);const I=10485760,P=Buffer.alloc(Math.min(I,d.fileInfo.size));return await d.readBuffer(P,{mayBeLess:!0}),P.includes(Buffer.from("AIPrivateData"))?{ext:"ai",mime:"application/postscript"}:{ext:"pdf",mime:"application/pdf"}}if(g([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(g([73,73,42,0]))return w("CR",{offset:8})?{ext:"cr2",mime:"image/x-canon-cr2"}:g([28,0,254,0],{offset:8})||g([31,0,11,0],{offset:8})?{ext:"nef",mime:"image/x-nikon-nef"}:g([8,0,0,0],{offset:4})&&(g([45,0,254,0],{offset:8})||g([39,0,254,0],{offset:8}))?{ext:"dng",mime:"image/x-adobe-dng"}:(m=Buffer.alloc(24),await d.peekBuffer(m),(g([16,251,134,1],{offset:4})||g([8,0,0,0],{offset:4}))&&g([0,254,0,4,0,1,0,0,0,1,0,0,0,3,1],{offset:9})?{ext:"arw",mime:"image/x-sony-arw"}:{ext:"tif",mime:"image/tiff"});if(g([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(w("MAC "))return{ext:"ape",mime:"audio/ape"};if(g([26,69,223,163])){async function I(){const D=await d.peekNumber(Token.UINT8);let U=128,Z=0;for(;!(D&U)&&U!==0;)++Z,U>>=1;const j=Buffer.alloc(Z+1);return await d.readBuffer(j),j}async function P(){const D=await I(),U=await I();U[0]^=128>>U.length-1;const Z=Math.min(6,U.length);return{id:D.readUIntBE(0,D.length),len:U.readUIntBE(U.length-Z,Z)}}async function F(D,U){for(;U>0;){const Z=await P();if(Z.id===17026)return d.readToken(new Token.StringType(Z.len,"utf-8"));await d.ignore(Z.len),--U}}const $=await P();switch(await F(0,$.len)){case"webm":return{ext:"webm",mime:"video/webm"};case"matroska":return{ext:"mkv",mime:"video/x-matroska"};default:return}}if(g([82,73,70,70])){if(g([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(g([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(g([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(w("SQLi"))return{ext:"sqlite",mime:"application/x-sqlite3"};if(g([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(w("Cr24"))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(w("MSCF")||w("ISc("))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(g([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(g([197,208,211,198]))return{ext:"eps",mime:"application/eps"};if(g([40,181,47,253]))return{ext:"zst",mime:"application/zstd"};if(g([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(w("#!AMR"))return{ext:"amr",mime:"audio/amr"};if(w("{\\rtf"))return{ext:"rtf",mime:"application/rtf"};if(g([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(w("IMPM"))return{ext:"it",mime:"audio/x-it"};if(w("-lh0-",{offset:2})||w("-lh1-",{offset:2})||w("-lh2-",{offset:2})||w("-lh3-",{offset:2})||w("-lh4-",{offset:2})||w("-lh5-",{offset:2})||w("-lh6-",{offset:2})||w("-lh7-",{offset:2})||w("-lzs-",{offset:2})||w("-lz4-",{offset:2})||w("-lz5-",{offset:2})||w("-lhd-",{offset:2}))return{ext:"lzh",mime:"application/x-lzh-compressed"};if(g([0,0,1,186])){if(g([33],{offset:4,mask:[241]}))return{ext:"mpg",mime:"video/MP1S"};if(g([68],{offset:4,mask:[196]}))return{ext:"mpg",mime:"video/MP2P"}}if(w("ITSF"))return{ext:"chm",mime:"application/vnd.ms-htmlhelp"};if(g([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(w("<?xml "))return{ext:"xml",mime:"application/xml"};if(g([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(g([82,97,114,33,26,7])&&(m[6]===0||m[6]===1))return{ext:"rar",mime:"application/x-rar-compressed"};if(w("solid "))return{ext:"stl",mime:"model/stl"};if(w("BLENDER"))return{ext:"blend",mime:"application/x-blender"};if(w("!<arch>"))return await d.ignore(8),await d.readToken(new Token.StringType(13,"ascii"))==="debian-binary"?{ext:"deb",mime:"application/x-deb"}:{ext:"ar",mime:"application/x-unix-archive"};if(g([137,80,78,71,13,10,26,10])){async function I(){return{length:await d.readToken(Token.INT32_BE),type:await d.readToken(new Token.StringType(4,"binary"))}}await d.ignore(8);do{const P=await I();if(P.length<0)return;switch(P.type){case"IDAT":return{ext:"png",mime:"image/png"};case"acTL":return{ext:"apng",mime:"image/apng"};default:await d.ignore(P.length+4)}}while(d.position+8<d.fileInfo.size);return{ext:"png",mime:"image/png"}}if(g([65,82,82,79,87,49,0,0]))return{ext:"arrow",mime:"application/x-apache-arrow"};if(g([103,108,84,70,2,0,0,0]))return{ext:"glb",mime:"model/gltf-binary"};if(g([102,114,101,101],{offset:4})||g([109,100,97,116],{offset:4})||g([109,111,111,118],{offset:4})||g([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(g([73,73,82,79,8,0,0,0,24]))return{ext:"orf",mime:"image/x-olympus-orf"};if(w("gimp xcf "))return{ext:"xcf",mime:"image/x-xcf"};if(g([73,73,85,0,24,0,0,0,136,231,116,216]))return{ext:"rw2",mime:"image/x-panasonic-rw2"};if(g([48,38,178,117,142,102,207,17,166,217])){async function I(){const P=Buffer.alloc(16);return await d.readBuffer(P),{id:P,size:Number(await d.readToken(Token.UINT64_LE))}}for(await d.ignore(30);d.position+24<d.fileInfo.size;){const P=await I();let F=P.size-24;if(_check(P.id,[145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101])){const $=Buffer.alloc(16);if(F-=await d.readBuffer($),_check($,[64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"audio/x-ms-asf"};if(_check($,[192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43]))return{ext:"asf",mime:"video/x-ms-asf"};break}await d.ignore(F)}return{ext:"asf",mime:"application/vnd.ms-asf"}}if(g([171,75,84,88,32,49,49,187,13,10,26,10]))return{ext:"ktx",mime:"image/ktx"};if((g([126,16,4])||g([126,24,4]))&&g([48,77,73,69],{offset:4}))return{ext:"mie",mime:"application/x-mie"};if(g([39,10,0,0,0,0,0,0,0,0,0,0],{offset:2}))return{ext:"shp",mime:"application/x-esri-shape"};if(g([0,0,0,12,106,80,32,32,13,10,135,10]))switch(await d.ignore(20),await d.readToken(new Token.StringType(4,"ascii"))){case"jp2 ":return{ext:"jp2",mime:"image/jp2"};case"jpx ":return{ext:"jpx",mime:"image/jpx"};case"jpm ":return{ext:"jpm",mime:"image/jpm"};case"mjp2":return{ext:"mj2",mime:"image/mj2"};default:return}if(g([255,10])||g([0,0,0,12,74,88,76,32,13,10,135,10]))return{ext:"jxl",mime:"image/jxl"};if(g([0,0,1,186])||g([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(g([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(g([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(g([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(g([208,207,17,224,161,177,26,225]))return{ext:"cfb",mime:"application/x-cfb"};if(await d.peekBuffer(m,{length:Math.min(256,d.fileInfo.size),mayBeLess:!0}),w("BEGIN:")){if(w("VCARD",{offset:6}))return{ext:"vcf",mime:"text/vcard"};if(w("VCALENDAR",{offset:6}))return{ext:"ics",mime:"text/calendar"}}if(w("FUJIFILMCCD-RAW"))return{ext:"raf",mime:"image/x-fujifilm-raf"};if(w("Extended Module:"))return{ext:"xm",mime:"audio/x-xm"};if(w("Creative Voice File"))return{ext:"voc",mime:"audio/x-voc"};if(g([4,0,0,0])&&m.length>=16){const I=m.readUInt32LE(12);if(I>12&&m.length>=I+16)try{const P=m.slice(16,I+16).toString();if(JSON.parse(P).files)return{ext:"asar",mime:"application/x-asar"}}catch{}}if(g([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(w("SCRM",{offset:44}))return{ext:"s3m",mime:"audio/x-s3m"};if(g([71],{offset:4})&&(g([71],{offset:192})||g([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(g([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(g([68,73,67,77],{offset:128}))return{ext:"dcm",mime:"application/dicom"};if(g([76,0,0,0,1,20,2,0,0,0,0,0,192,0,0,0,0,0,0,70]))return{ext:"lnk",mime:"application/x.ms.shortcut"};if(g([98,111,111,107,0,0,0,0,109,97,114,107,0,0,0,0]))return{ext:"alias",mime:"application/x.apple.alias"};if(g([76,80],{offset:34})&&(g([0,0,1],{offset:8})||g([1,0,2],{offset:8})||g([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(g([6,6,237,245,216,29,70,229,189,49,239,231,254,116,183,29]))return{ext:"indd",mime:"application/x-indesign"};if(await d.peekBuffer(m,{length:Math.min(512,d.fileInfo.size),mayBeLess:!0}),tarHeaderChecksumMatches(m))return{ext:"tar",mime:"application/x-tar"};if(g([255,254,255,14,83,0,107,0,101,0,116,0,99,0,104,0,85,0,112,0,32,0,77,0,111,0,100,0,101,0,108,0]))return{ext:"skp",mime:"application/vnd.sketchup.skp"};if(w("-----BEGIN PGP MESSAGE-----"))return{ext:"pgp",mime:"application/pgp-encrypted"};if(m.length>=2&&g([255,224],{offset:0,mask:[255,224]})){if(g([16],{offset:1,mask:[22]}))return g([8],{offset:1,mask:[8]}),{ext:"aac",mime:"audio/aac"};if(g([2],{offset:1,mask:[6]}))return{ext:"mp3",mime:"audio/mpeg"};if(g([4],{offset:1,mask:[6]}))return{ext:"mp2",mime:"audio/mpeg"};if(g([6],{offset:1,mask:[6]}))return{ext:"mp1",mime:"audio/mpeg"}}}const stream=readableStream=>new Promise((resolve,reject)=>{const stream=eval("require")("stream");readableStream.on("error",reject),readableStream.once("readable",async()=>{const d=new stream.PassThrough;let m;m=stream.pipeline?stream.pipeline(readableStream,d,()=>{}):readableStream.pipe(d);const g=readableStream.read(minimumBytes)||readableStream.read()||Buffer.alloc(0);try{const w=await fromBuffer(g);d.fileType=w}catch(w){reject(w)}resolve(m)})}),fileType={fromStream,fromTokenizer,fromBuffer,stream};Object.defineProperty(fileType,"extensions",{get:()=>new Set(supported.extensions)}),Object.defineProperty(fileType,"mimeTypes",{get:()=>new Set(supported.mimeTypes)});var core=fileType,fileType$1=getDefaultExportFromCjs(core);function to(d,m){return d.then(function(g){return[null,g]}).catch(function(g){return[g,void 0]})}const writeFile=async()=>{throw new Error("Not supported")};function Mime$1(){this._types=Object.create(null),this._extensions=Object.create(null);for(let d=0;d<arguments.length;d++)this.define(arguments[d]);this.define=this.define.bind(this),this.getType=this.getType.bind(this),this.getExtension=this.getExtension.bind(this)}Mime$1.prototype.define=function(d,m){for(let g in d){let w=d[g].map(function(I){return I.toLowerCase()});g=g.toLowerCase();for(let I=0;I<w.length;I++){const P=w[I];if(P[0]!=="*"){if(!m&&P in this._types)throw new Error('Attempt to change mapping for "'+P+'" extension from "'+this._types[P]+'" to "'+g+'". Pass `force=true` to allow this, otherwise remove "'+P+'" from the list of extensions for "'+g+'".');this._types[P]=g}}if(m||!this._extensions[g]){const I=w[0];this._extensions[g]=I[0]!=="*"?I:I.substr(1)}}},Mime$1.prototype.getType=function(d){let m=(d=String(d)).replace(/^.*[/\\]/,"").toLowerCase(),g=m.replace(/^.*\./,"").toLowerCase(),w=m.length<d.length;return(g.length<m.length-1||!w)&&this._types[g]||null},Mime$1.prototype.getExtension=function(d){return(d=/^\s*([^;\s]*)/.test(d)&&RegExp.$1)&&this._extensions[d.toLowerCase()]||null};var Mime_1=Mime$1,standard={"application/andrew-inset":["ez"],"application/applixware":["aw"],"application/atom+xml":["atom"],"application/atomcat+xml":["atomcat"],"application/atomdeleted+xml":["atomdeleted"],"application/atomsvc+xml":["atomsvc"],"application/atsc-dwd+xml":["dwd"],"application/atsc-held+xml":["held"],"application/atsc-rsat+xml":["rsat"],"application/bdoc":["bdoc"],"application/calendar+xml":["xcs"],"application/ccxml+xml":["ccxml"],"application/cdfx+xml":["cdfx"],"application/cdmi-capability":["cdmia"],"application/cdmi-container":["cdmic"],"application/cdmi-domain":["cdmid"],"application/cdmi-object":["cdmio"],"application/cdmi-queue":["cdmiq"],"application/cu-seeme":["cu"],"application/dash+xml":["mpd"],"application/davmount+xml":["davmount"],"application/docbook+xml":["dbk"],"application/dssc+der":["dssc"],"application/dssc+xml":["xdssc"],"application/ecmascript":["es","ecma"],"application/emma+xml":["emma"],"application/emotionml+xml":["emotionml"],"application/epub+zip":["epub"],"application/exi":["exi"],"application/express":["exp"],"application/fdt+xml":["fdt"],"application/font-tdpfr":["pfr"],"application/geo+json":["geojson"],"application/gml+xml":["gml"],"application/gpx+xml":["gpx"],"application/gxf":["gxf"],"application/gzip":["gz"],"application/hjson":["hjson"],"application/hyperstudio":["stk"],"application/inkml+xml":["ink","inkml"],"application/ipfix":["ipfix"],"application/its+xml":["its"],"application/java-archive":["jar","war","ear"],"application/java-serialized-object":["ser"],"application/java-vm":["class"],"application/javascript":["js","mjs"],"application/json":["json","map"],"application/json5":["json5"],"application/jsonml+json":["jsonml"],"application/ld+json":["jsonld"],"application/lgr+xml":["lgr"],"application/lost+xml":["lostxml"],"application/mac-binhex40":["hqx"],"application/mac-compactpro":["cpt"],"application/mads+xml":["mads"],"application/manifest+json":["webmanifest"],"application/marc":["mrc"],"application/marcxml+xml":["mrcx"],"application/mathematica":["ma","nb","mb"],"application/mathml+xml":["mathml"],"application/mbox":["mbox"],"application/mediaservercontrol+xml":["mscml"],"application/metalink+xml":["metalink"],"application/metalink4+xml":["meta4"],"application/mets+xml":["mets"],"application/mmt-aei+xml":["maei"],"application/mmt-usd+xml":["musd"],"application/mods+xml":["mods"],"application/mp21":["m21","mp21"],"application/mp4":["mp4s","m4p"],"application/msword":["doc","dot"],"application/mxf":["mxf"],"application/n-quads":["nq"],"application/n-triples":["nt"],"application/node":["cjs"],"application/octet-stream":["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"],"application/oda":["oda"],"application/oebps-package+xml":["opf"],"application/ogg":["ogx"],"application/omdoc+xml":["omdoc"],"application/onenote":["onetoc","onetoc2","onetmp","onepkg"],"application/oxps":["oxps"],"application/p2p-overlay+xml":["relo"],"application/patch-ops-error+xml":["xer"],"application/pdf":["pdf"],"application/pgp-encrypted":["pgp"],"application/pgp-signature":["asc","sig"],"application/pics-rules":["prf"],"application/pkcs10":["p10"],"application/pkcs7-mime":["p7m","p7c"],"application/pkcs7-signature":["p7s"],"application/pkcs8":["p8"],"application/pkix-attr-cert":["ac"],"application/pkix-cert":["cer"],"application/pkix-crl":["crl"],"application/pkix-pkipath":["pkipath"],"application/pkixcmp":["pki"],"application/pls+xml":["pls"],"application/postscript":["ai","eps","ps"],"application/provenance+xml":["provx"],"application/pskc+xml":["pskcxml"],"application/raml+yaml":["raml"],"application/rdf+xml":["rdf","owl"],"application/reginfo+xml":["rif"],"application/relax-ng-compact-syntax":["rnc"],"application/resource-lists+xml":["rl"],"application/resource-lists-diff+xml":["rld"],"application/rls-services+xml":["rs"],"application/route-apd+xml":["rapd"],"application/route-s-tsid+xml":["sls"],"application/route-usd+xml":["rusd"],"application/rpki-ghostbusters":["gbr"],"application/rpki-manifest":["mft"],"application/rpki-roa":["roa"],"application/rsd+xml":["rsd"],"application/rss+xml":["rss"],"application/rtf":["rtf"],"application/sbml+xml":["sbml"],"application/scvp-cv-request":["scq"],"application/scvp-cv-response":["scs"],"application/scvp-vp-request":["spq"],"application/scvp-vp-response":["spp"],"application/sdp":["sdp"],"application/senml+xml":["senmlx"],"application/sensml+xml":["sensmlx"],"application/set-payment-initiation":["setpay"],"application/set-registration-initiation":["setreg"],"application/shf+xml":["shf"],"application/sieve":["siv","sieve"],"application/smil+xml":["smi","smil"],"application/sparql-query":["rq"],"application/sparql-results+xml":["srx"],"application/srgs":["gram"],"application/srgs+xml":["grxml"],"application/sru+xml":["sru"],"application/ssdl+xml":["ssdl"],"application/ssml+xml":["ssml"],"application/swid+xml":["swidtag"],"application/tei+xml":["tei","teicorpus"],"application/thraud+xml":["tfi"],"application/timestamped-data":["tsd"],"application/toml":["toml"],"application/trig":["trig"],"application/ttml+xml":["ttml"],"application/ubjson":["ubj"],"application/urc-ressheet+xml":["rsheet"],"application/urc-targetdesc+xml":["td"],"application/voicexml+xml":["vxml"],"application/wasm":["wasm"],"application/widget":["wgt"],"application/winhlp":["hlp"],"application/wsdl+xml":["wsdl"],"application/wspolicy+xml":["wspolicy"],"application/xaml+xml":["xaml"],"application/xcap-att+xml":["xav"],"application/xcap-caps+xml":["xca"],"application/xcap-diff+xml":["xdf"],"application/xcap-el+xml":["xel"],"application/xcap-ns+xml":["xns"],"application/xenc+xml":["xenc"],"application/xhtml+xml":["xhtml","xht"],"application/xliff+xml":["xlf"],"application/xml":["xml","xsl","xsd","rng"],"application/xml-dtd":["dtd"],"application/xop+xml":["xop"],"application/xproc+xml":["xpl"],"application/xslt+xml":["*xsl","xslt"],"application/xspf+xml":["xspf"],"application/xv+xml":["mxml","xhvml","xvml","xvm"],"application/yang":["yang"],"application/yin+xml":["yin"],"application/zip":["zip"],"audio/3gpp":["*3gpp"],"audio/adpcm":["adp"],"audio/amr":["amr"],"audio/basic":["au","snd"],"audio/midi":["mid","midi","kar","rmi"],"audio/mobile-xmf":["mxmf"],"audio/mp3":["*mp3"],"audio/mp4":["m4a","mp4a"],"audio/mpeg":["mpga","mp2","mp2a","mp3","m2a","m3a"],"audio/ogg":["oga","ogg","spx","opus"],"audio/s3m":["s3m"],"audio/silk":["sil"],"audio/wav":["wav"],"audio/wave":["*wav"],"audio/webm":["weba"],"audio/xm":["xm"],"font/collection":["ttc"],"font/otf":["otf"],"font/ttf":["ttf"],"font/woff":["woff"],"font/woff2":["woff2"],"image/aces":["exr"],"image/apng":["apng"],"image/avif":["avif"],"image/bmp":["bmp"],"image/cgm":["cgm"],"image/dicom-rle":["drle"],"image/emf":["emf"],"image/fits":["fits"],"image/g3fax":["g3"],"image/gif":["gif"],"image/heic":["heic"],"image/heic-sequence":["heics"],"image/heif":["heif"],"image/heif-sequence":["heifs"],"image/hej2k":["hej2"],"image/hsj2":["hsj2"],"image/ief":["ief"],"image/jls":["jls"],"image/jp2":["jp2","jpg2"],"image/jpeg":["jpeg","jpg","jpe"],"image/jph":["jph"],"image/jphc":["jhc"],"image/jpm":["jpm"],"image/jpx":["jpx","jpf"],"image/jxr":["jxr"],"image/jxra":["jxra"],"image/jxrs":["jxrs"],"image/jxs":["jxs"],"image/jxsc":["jxsc"],"image/jxsi":["jxsi"],"image/jxss":["jxss"],"image/ktx":["ktx"],"image/ktx2":["ktx2"],"image/png":["png"],"image/sgi":["sgi"],"image/svg+xml":["svg","svgz"],"image/t38":["t38"],"image/tiff":["tif","tiff"],"image/tiff-fx":["tfx"],"image/webp":["webp"],"image/wmf":["wmf"],"message/disposition-notification":["disposition-notification"],"message/global":["u8msg"],"message/global-delivery-status":["u8dsn"],"message/global-disposition-notification":["u8mdn"],"message/global-headers":["u8hdr"],"message/rfc822":["eml","mime"],"model/3mf":["3mf"],"model/gltf+json":["gltf"],"model/gltf-binary":["glb"],"model/iges":["igs","iges"],"model/mesh":["msh","mesh","silo"],"model/mtl":["mtl"],"model/obj":["obj"],"model/step+xml":["stpx"],"model/step+zip":["stpz"],"model/step-xml+zip":["stpxz"],"model/stl":["stl"],"model/vrml":["wrl","vrml"],"model/x3d+binary":["*x3db","x3dbz"],"model/x3d+fastinfoset":["x3db"],"model/x3d+vrml":["*x3dv","x3dvz"],"model/x3d+xml":["x3d","x3dz"],"model/x3d-vrml":["x3dv"],"text/cache-manifest":["appcache","manifest"],"text/calendar":["ics","ifb"],"text/coffeescript":["coffee","litcoffee"],"text/css":["css"],"text/csv":["csv"],"text/html":["html","htm","shtml"],"text/jade":["jade"],"text/jsx":["jsx"],"text/less":["less"],"text/markdown":["markdown","md"],"text/mathml":["mml"],"text/mdx":["mdx"],"text/n3":["n3"],"text/plain":["txt","text","conf","def","list","log","in","ini"],"text/richtext":["rtx"],"text/rtf":["*rtf"],"text/sgml":["sgml","sgm"],"text/shex":["shex"],"text/slim":["slim","slm"],"text/spdx":["spdx"],"text/stylus":["stylus","styl"],"text/tab-separated-values":["tsv"],"text/troff":["t","tr","roff","man","me","ms"],"text/turtle":["ttl"],"text/uri-list":["uri","uris","urls"],"text/vcard":["vcard"],"text/vtt":["vtt"],"text/xml":["*xml"],"text/yaml":["yaml","yml"],"video/3gpp":["3gp","3gpp"],"video/3gpp2":["3g2"],"video/h261":["h261"],"video/h263":["h263"],"video/h264":["h264"],"video/iso.segment":["m4s"],"video/jpeg":["jpgv"],"video/jpm":["*jpm","jpgm"],"video/mj2":["mj2","mjp2"],"video/mp2t":["ts"],"video/mp4":["mp4","mp4v","mpg4"],"video/mpeg":["mpeg","mpg","mpe","m1v","m2v"],"video/ogg":["ogv"],"video/quicktime":["qt","mov"],"video/webm":["webm"]};let Mime=Mime_1;var lite=new Mime(standard),mime=getDefaultExportFromCjs(lite),HorizontalAlign,HorizontalAlign2,VerticalAlign,VerticalAlign2,BlendMode,BlendMode2;function srcOver(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a;return{r:(d.r*d.a+m.r*m.a*(1-d.a))/w,g:(d.g*d.a+m.g*m.a*(1-d.a))/w,b:(d.b*d.a+m.b*m.a*(1-d.a))/w,a:w}}function dstOver(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a;return{r:(m.r*m.a+d.r*d.a*(1-m.a))/w,g:(m.g*m.a+d.g*d.a*(1-m.a))/w,b:(m.b*m.a+d.b*d.a*(1-m.a))/w,a:w}}function multiply(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,$=m.r*m.a,D=m.g*m.a,U=m.b*m.a;return{r:(I*$+I*(1-m.a)+$*(1-d.a))/w,g:(P*D+P*(1-m.a)+D*(1-d.a))/w,b:(F*U+F*(1-m.a)+U*(1-d.a))/w,a:w}}function add(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a;return{r:(I+m.r*m.a)/w,g:(P+m.g*m.a)/w,b:(F+m.b*m.a)/w,a:w}}function screen(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,$=m.r*m.a,D=m.g*m.a,U=m.b*m.a;return{r:(I*m.a+$*d.a-I*$+I*(1-m.a)+$*(1-d.a))/w,g:(P*m.a+D*d.a-P*D+P*(1-m.a)+D*(1-d.a))/w,b:(F*m.a+U*d.a-F*U+F*(1-m.a)+U*(1-d.a))/w,a:w}}function overlay(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,$=m.r*m.a,D=m.g*m.a,U=m.b*m.a;return{r:(2*$<=m.a?2*I*$+I*(1-m.a)+$*(1-d.a):I*(1+m.a)+$*(1+d.a)-2*$*I-m.a*d.a)/w,g:(2*D<=m.a?2*P*D+P*(1-m.a)+D*(1-d.a):P*(1+m.a)+D*(1+d.a)-2*D*P-m.a*d.a)/w,b:(2*U<=m.a?2*F*U+F*(1-m.a)+U*(1-d.a):F*(1+m.a)+U*(1+d.a)-2*U*F-m.a*d.a)/w,a:w}}function darken(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,$=m.r*m.a,D=m.g*m.a,U=m.b*m.a;return{r:(Math.min(I*m.a,$*d.a)+I*(1-m.a)+$*(1-d.a))/w,g:(Math.min(P*m.a,D*d.a)+P*(1-m.a)+D*(1-d.a))/w,b:(Math.min(F*m.a,U*d.a)+F*(1-m.a)+U*(1-d.a))/w,a:w}}function lighten(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,$=m.r*m.a,D=m.g*m.a,U=m.b*m.a;return{r:(Math.max(I*m.a,$*d.a)+I*(1-m.a)+$*(1-d.a))/w,g:(Math.max(P*m.a,D*d.a)+P*(1-m.a)+D*(1-d.a))/w,b:(Math.max(F*m.a,U*d.a)+F*(1-m.a)+U*(1-d.a))/w,a:w}}function hardLight(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,$=m.r*m.a,D=m.g*m.a,U=m.b*m.a;return{r:(2*I<=d.a?2*I*$+I*(1-m.a)+$*(1-d.a):I*(1+m.a)+$*(1+d.a)-2*$*I-m.a*d.a)/w,g:(2*P<=d.a?2*P*D+P*(1-m.a)+D*(1-d.a):P*(1+m.a)+D*(1+d.a)-2*D*P-m.a*d.a)/w,b:(2*F<=d.a?2*F*U+F*(1-m.a)+U*(1-d.a):F*(1+m.a)+U*(1+d.a)-2*U*F-m.a*d.a)/w,a:w}}function difference(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,$=m.r*m.a,D=m.g*m.a,U=m.b*m.a;return{r:(I+$-2*Math.min(I*m.a,$*d.a))/w,g:(P+D-2*Math.min(P*m.a,D*d.a))/w,b:(F+U-2*Math.min(F*m.a,U*d.a))/w,a:w}}function exclusion(d,m,g=1){d.a*=g;const w=m.a+d.a-m.a*d.a,I=d.r*d.a,P=d.g*d.a,F=d.b*d.a,$=m.r*m.a,D=m.g*m.a,U=m.b*m.a;return{r:(I*m.a+$*d.a-2*I*$+I*(1-m.a)+$*(1-d.a))/w,g:(P*m.a+D*d.a-2*P*D+P*(1-m.a)+D*(1-d.a))/w,b:(F*m.a+U*d.a-2*F*U+F*(1-m.a)+U*(1-d.a))/w,a:w}}HorizontalAlign2=HorizontalAlign||(HorizontalAlign={}),HorizontalAlign2[HorizontalAlign2.LEFT=1]="LEFT",HorizontalAlign2[HorizontalAlign2.CENTER=2]="CENTER",HorizontalAlign2[HorizontalAlign2.RIGHT=4]="RIGHT",VerticalAlign2=VerticalAlign||(VerticalAlign={}),VerticalAlign2[VerticalAlign2.TOP=8]="TOP",VerticalAlign2[VerticalAlign2.MIDDLE=16]="MIDDLE",VerticalAlign2[VerticalAlign2.BOTTOM=32]="BOTTOM",BlendMode2=BlendMode||(BlendMode={}),BlendMode2.SRC_OVER="srcOver",BlendMode2.DST_OVER="dstOver",BlendMode2.MULTIPLY="multiply",BlendMode2.ADD="add",BlendMode2.SCREEN="screen",BlendMode2.OVERLAY="overlay",BlendMode2.DARKEN="darken",BlendMode2.LIGHTEN="lighten",BlendMode2.HARD_LIGHT="hardLight",BlendMode2.DIFFERENCE="difference",BlendMode2.EXCLUSION="exclusion";const names=[srcOver,dstOver,multiply,add,screen,overlay,darken,lighten,hardLight,difference,exclusion];var compositeModes=Object.freeze({__proto__:null,add,darken,difference,dstOver,exclusion,hardLight,lighten,multiply,names,overlay,screen,srcOver});function composite(d,m,g=0,w=0,I={}){if(!(m instanceof d.constructor))throw new Error("The source must be a Jimp image");if(typeof g!="number"||typeof w!="number")throw new Error("x and y must be numbers");const{mode:P=BlendMode.SRC_OVER}=I;let{opacitySource:F=1,opacityDest:$=1}=I;(typeof F!="number"||F<0||F>1)&&(F=1),(typeof $!="number"||$<0||$>1)&&($=1);const D=compositeModes[P];return g=Math.round(g),w=Math.round(w),$!==1&&d.scan((U,Z,j)=>{const G=d.bitmap.data[j+3]*$;d.bitmap.data[j+3]=G}),m.scan((U,Z,j)=>{const G=d.getPixelIndex(g+U,w+Z,Edge.CROP);if(G===-1)return;const H=D({r:m.bitmap.data[j+0]/255,g:m.bitmap.data[j+1]/255,b:m.bitmap.data[j+2]/255,a:m.bitmap.data[j+3]/255},{r:d.bitmap.data[G+0]/255,g:d.bitmap.data[G+1]/255,b:d.bitmap.data[G+2]/255,a:d.bitmap.data[G+3]/255},F);d.bitmap.data[G+0]=limit255(255*H.r),d.bitmap.data[G+1]=limit255(255*H.g),d.bitmap.data[G+2]=limit255(255*H.b),d.bitmap.data[G+3]=limit255(255*H.a)}),d}var jpeg$1={parseSections:function(d,m){var g,w;for(d.setBigEndian(!0);d.remainingLength()>0&&w!==218;){if(d.nextUInt8()!==255)throw new Error("Invalid JPEG section offset");g=(w=d.nextUInt8())>=208&&w<=217||w===218?0:d.nextUInt16()-2,m(w,d.branch(0,g)),d.skip(g)}},getSizeFromSOFSection:function(d){return d.skip(1),{height:d.nextUInt16(),width:d.nextUInt16()}},getSectionName:function(d){var m,g;switch(d){case 216:m="SOI";break;case 196:m="DHT";break;case 219:m="DQT";break;case 221:m="DRI";break;case 218:m="SOS";break;case 254:m="COM";break;case 217:m="EOI";break;default:d>=224&&d<=239?(m="APP",g=d-224):d>=192&&d<=207&&d!==196&&d!==200&&d!==204?(m="SOF",g=d-192):d>=208&&d<=215&&(m="RST",g=d-208)}var w={name:m};return typeof g=="number"&&(w.index=g),w}};function readExifValue(d,m){switch(d){case 1:return m.nextUInt8();case 3:case 8:return m.nextUInt16();case 4:case 9:return m.nextUInt32();case 5:return[m.nextUInt32(),m.nextUInt32()];case 6:return m.nextInt8();case 10:return[m.nextInt32(),m.nextInt32()];case 11:return m.nextFloat();case 12:return m.nextDouble();default:throw new Error("Invalid format while decoding: "+d)}}function getBytesPerComponent(d){switch(d){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}}function readExifTag(d,m){var g,w,I=m.nextUInt16(),P=m.nextUInt16(),F=getBytesPerComponent(P),$=m.nextUInt32(),D=F*$;if(D>4&&(m=d.openWithOffset(m.nextUInt32())),P===2){var U=(g=m.nextString($)).indexOf("\0");U!==-1&&(g=g.substr(0,U))}else if(P===7)g=m.nextBuffer($);else if(P!==0)for(g=[],w=0;w<$;++w)g.push(readExifValue(P,m));return D<4&&m.skip(4-D),[I,g,P]}function readIFDSection(d,m,g){var w,I,P=m.nextUInt16();for(I=0;I<P;++I)g((w=readExifTag(d,m))[0],w[1],w[2])}function readHeader(d){if(d.nextString(6)!=="Exif\0\0")throw new Error("Invalid EXIF header");var m=d.mark(),g=d.nextUInt16();if(g===18761)d.setBigEndian(!1);else{if(g!==19789)throw new Error("Invalid TIFF header");d.setBigEndian(!0)}if(d.nextUInt16()!==42)throw new Error("Invalid TIFF data");return m}var exif$2={IFD0:1,IFD1:2,GPSIFD:3,SubIFD:4,InteropIFD:5,parseTags:function(d,m){var g,w,I,P;try{g=readHeader(d)}catch{return!1}var F=g.openWithOffset(d.nextUInt32()),$=this.IFD0;readIFDSection(g,F,function(W,Q,q){switch(W){case 34853:I=Q[0];break;case 34665:w=Q[0];break;default:m($,W,Q,q)}});var D=F.nextUInt32();if(D!==0){var U=g.openWithOffset(D);readIFDSection(g,U,m.bind(null,this.IFD1))}if(I){var Z=g.openWithOffset(I);readIFDSection(g,Z,m.bind(null,this.GPSIFD))}if(w){var j=g.openWithOffset(w),G=this.InteropIFD;readIFDSection(g,j,function(W,Q,q){W===40965?P=Q[0]:m(G,W,Q,q)})}if(P){var H=g.openWithOffset(P);readIFDSection(g,H,m.bind(null,this.InteropIFD))}return!0}};function parseNumber(d){return parseInt(d,10)}var hours=3600,minutes=60;function parseDateTimeParts(d,m){d=d.map(parseNumber),m=m.map(parseNumber);var g=d[0],w=d[1]-1,I=d[2],P=m[0],F=m[1],$=m[2];return Date.UTC(g,w,I,P,F,$,0)/1e3}function parseDateWithTimezoneFormat(d){var m=d.substr(0,10).split("-"),g=d.substr(11,8).split(":"),w=d.substr(19,6).split(":").map(parseNumber),I=w[0]*hours+w[1]*minutes,P=parseDateTimeParts(m,g);if(typeof(P-=I)=="number"&&!isNaN(P))return P}function parseDateWithSpecFormat(d){var m=d.split(" "),g=parseDateTimeParts(m[0].split(":"),m[1].split(":"));if(typeof g=="number"&&!isNaN(g))return g}function parseExifDate(d){var m=d.length===19&&d.charAt(4)===":";return d.length===25&&d.charAt(10)==="T"?parseDateWithTimezoneFormat(d):m?parseDateWithSpecFormat(d):void 0}var date$1={parseDateWithSpecFormat,parseDateWithTimezoneFormat,parseExifDate},exif$1=exif$2,date=date$1,degreeTags=[{section:exif$1.GPSIFD,type:2,name:"GPSLatitude",refType:1,refName:"GPSLatitudeRef",posVal:"N"},{section:exif$1.GPSIFD,type:4,name:"GPSLongitude",refType:3,refName:"GPSLongitudeRef",posVal:"E"}],dateTags=[{section:exif$1.SubIFD,type:306,name:"ModifyDate"},{section:exif$1.SubIFD,type:36867,name:"DateTimeOriginal"},{section:exif$1.SubIFD,type:36868,name:"CreateDate"},{section:exif$1.SubIFD,type:306,name:"ModifyDate"}],simplify$1={castDegreeValues:function(d,m){degreeTags.forEach(function(g){var w=d(g);if(w){var I=d({section:g.section,type:g.refType,name:g.refName})===g.posVal?1:-1,P=(w[0]+w[1]/60+w[2]/3600)*I;m(g,P)}})},castDateValues:function(d,m){dateTags.forEach(function(g){var w=d(g);if(w){var I=date.parseExifDate(w);I!==void 0&&m(g,I)}})},simplifyValue:function(d,m){return Array.isArray(d)&&(d=d.map(function(g){return m===10||m===5?g[0]/g[1]:g})).length===1&&(d=d[0]),d}},exifTags,hasRequiredExifTags;function requireExifTags(){return hasRequiredExifTags?exifTags:(hasRequiredExifTags=1,exifTags={exif:{1:"InteropIndex",2:"InteropVersion",11:"ProcessingSoftware",254:"SubfileType",255:"OldSubfileType",256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Thresholding",264:"CellWidth",265:"CellLength",266:"FillOrder",269:"DocumentName",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",285:"PageName",286:"XPosition",287:"YPosition",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",292:"T4Options",293:"T6Options",296:"ResolutionUnit",297:"PageNumber",300:"ColorResponseUnit",301:"TransferFunction",305:"Software",306:"ModifyDate",315:"Artist",316:"HostComputer",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",320:"ColorMap",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFD",332:"InkSet",333:"InkNames",334:"NumberofInks",336:"DotRange",337:"TargetPrinter",338:"ExtraSamples",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",435:"T82Options",437:"JPEGTables",512:"JPEGProc",513:"ThumbnailOffset",514:"ThumbnailLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"ApplicationNotes",999:"USPTOMiscellaneous",4096:"RelatedImageFileFormat",4097:"RelatedImageWidth",4098:"RelatedImageHeight",18246:"Rating",18247:"XP_DIP_XML",18248:"StitchInfo",18249:"RatingPercent",32781:"ImageID",32931:"WangTag1",32932:"WangAnnotation",32933:"WangTag3",32934:"WangTag4",32995:"Matteing",32996:"DataType",32997:"ImageDepth",32998:"TileDepth",33405:"Model2",33421:"CFARepeatPatternDim",33422:"CFAPattern2",33423:"BatteryLevel",33424:"KodakIFD",33432:"Copyright",33434:"ExposureTime",33437:"FNumber",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"PixelScale",33589:"AdventScale",33590:"AdventRevision",33628:"UIC1Tag",33629:"UIC2Tag",33630:"UIC3Tag",33631:"UIC4Tag",33723:"IPTC-NAA",33918:"IntergraphPacketData",33919:"IntergraphFlagRegisters",33920:"IntergraphMatrix",33921:"INGRReserved",33922:"ModelTiePoint",34016:"Site",34017:"ColorSequence",34018:"IT8Header",34019:"RasterPadding",34020:"BitsPerRunLength",34021:"BitsPerExtendedRunLength",34022:"ColorTable",34023:"ImageColorIndicator",34024:"BackgroundColorIndicator",34025:"ImageColorValue",34026:"BackgroundColorValue",34027:"PixelIntensityRange",34028:"TransparencyIndicator",34029:"ColorCharacterization",34030:"HCUsage",34031:"TrapIndicator",34032:"CMYKEquivalent",34118:"SEMInfo",34152:"AFCP_IPTC",34232:"PixelMagicJBIGOptions",34264:"ModelTransform",34306:"WB_GRGBLevels",34310:"LeafData",34377:"PhotoshopSettings",34665:"ExifOffset",34675:"ICC_Profile",34687:"TIFF_FXExtensions",34688:"MultiProfiles",34689:"SharedData",34690:"T88Options",34732:"ImageLayer",34735:"GeoTiffDirectory",34736:"GeoTiffDoubleParams",34737:"GeoTiffAsciiParams",34850:"ExposureProgram",34852:"SpectralSensitivity",34853:"GPSInfo",34855:"ISO",34856:"Opto-ElectricConvFactor",34857:"Interlace",34858:"TimeZoneOffset",34859:"SelfTimerMode",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",34908:"FaxRecvParams",34909:"FaxSubAddress",34910:"FaxRecvTime",34954:"LeafSubIFD",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"CreateDate",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureCompensation",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37387:"FlashEnergy",37388:"SpatialFrequencyResponse",37389:"Noise",37390:"FocalPlaneXResolution",37391:"FocalPlaneYResolution",37392:"FocalPlaneResolutionUnit",37393:"ImageNumber",37394:"SecurityClassification",37395:"ImageHistory",37396:"SubjectArea",37397:"ExposureIndex",37398:"TIFF-EPStandardID",37399:"SensingMethod",37434:"CIP3DataFile",37435:"CIP3Sheet",37436:"CIP3Side",37439:"StoNits",37500:"MakerNote",37510:"UserComment",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",37679:"MSDocumentText",37680:"MSPropertySetStorage",37681:"MSDocumentTextPosition",37724:"ImageSourceData",40091:"XPTitle",40092:"XPComment",40093:"XPAuthor",40094:"XPKeywords",40095:"XPSubject",40960:"FlashpixVersion",40961:"ColorSpace",40962:"ExifImageWidth",40963:"ExifImageHeight",40964:"RelatedSoundFile",40965:"InteropOffset",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41485:"Noise",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41489:"ImageNumber",41490:"SecurityClassification",41491:"ImageHistory",41492:"SubjectLocation",41493:"ExposureIndex",41494:"TIFF-EPStandardID",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFormat",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"OwnerName",42033:"SerialNumber",42034:"LensInfo",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42112:"GDALMetadata",42113:"GDALNoData",42240:"Gamma",44992:"ExpandSoftware",44993:"ExpandLens",44994:"ExpandFilm",44995:"ExpandFilterLens",44996:"ExpandScanner",44997:"ExpandFlashLamp",48129:"PixelFormat",48130:"Transformation",48131:"Uncompressed",48132:"ImageType",48256:"ImageWidth",48257:"ImageHeight",48258:"WidthResolution",48259:"HeightResolution",48320:"ImageOffset",48321:"ImageByteCount",48322:"AlphaOffset",48323:"AlphaByteCount",48324:"ImageDataDiscard",48325:"AlphaDataDiscard",50215:"OceScanjobDesc",50216:"OceApplicationSelector",50217:"OceIDNumber",50218:"OceImageLogic",50255:"Annotations",50341:"PrintIM",50560:"USPTOOriginalContentType",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"DNGLensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50739:"ShadowScale",50740:"DNGPrivateData",50741:"MakerNoteSafety",50752:"RawImageSegmentation",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50781:"RawDataUniqueID",50784:"AliasLayerMetadata",50827:"OriginalRawFileName",50828:"OriginalRawFileData",50829:"ActiveArea",50830:"MaskedAreas",50831:"AsShotICCProfile",50832:"AsShotPreProfileMatrix",50833:"CurrentICCProfile",50834:"CurrentPreProfileMatrix",50879:"ColorimetricReference",50898:"PanasonicTitle",50899:"PanasonicTitle2",50931:"CameraCalibrationSig",50932:"ProfileCalibrationSig",50933:"ProfileIFD",50934:"AsShotProfileName",50935:"NoiseReductionApplied",50936:"ProfileName",50937:"ProfileHueSatMapDims",50938:"ProfileHueSatMapData1",50939:"ProfileHueSatMapData2",50940:"ProfileToneCurve",50941:"ProfileEmbedPolicy",50942:"ProfileCopyright",50964:"ForwardMatrix1",50965:"ForwardMatrix2",50966:"PreviewApplicationName",50967:"PreviewApplicationVersion",50968:"PreviewSettingsName",50969:"PreviewSettingsDigest",50970:"PreviewColorSpace",50971:"PreviewDateTime",50972:"RawImageDigest",50973:"OriginalRawFileDigest",50974:"SubTileBlockSize",50975:"RowInterleaveFactor",50981:"ProfileLookTableDims",50982:"ProfileLookTableData",51008:"OpcodeList1",51009:"OpcodeList2",51022:"OpcodeList3",51041:"NoiseProfile",51043:"TimeCodes",51044:"FrameRate",51058:"TStop",51081:"ReelName",51089:"OriginalDefaultFinalSize",51090:"OriginalBestQualitySize",51091:"OriginalDefaultCropSize",51105:"CameraLabel",51107:"ProfileHueSatMapEncoding",51108:"ProfileLookTableEncoding",51109:"BaselineExposureOffset",51110:"DefaultBlackRender",51111:"NewRawImageDigest",51112:"RawToPreviewGain",51125:"DefaultUserCrop",59932:"Padding",59933:"OffsetSchema",65e3:"OwnerName",65001:"SerialNumber",65002:"Lens",65024:"KDC_IFD",65100:"RawFile",65101:"Converter",65102:"WhiteBalance",65105:"Exposure",65106:"Shadows",65107:"Brightness",65108:"Contrast",65109:"Saturation",65110:"Sharpness",65111:"Smoothness",65112:"MoireFilter"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"}})}var jpeg=jpeg$1,exif=exif$2,simplify=simplify$1;function ExifResult(d,m,g,w,I,P,F){this.startMarker=d,this.tags=m,this.imageSize=g,this.thumbnailOffset=w,this.thumbnailLength=I,this.thumbnailType=P,this.app1Offset=F}function Parser$1(d){this.stream=d,this.flags={readBinaryTags:!1,resolveTagNames:!0,simplifyValues:!0,imageSize:!0,hidePointers:!0,returnTags:!0}}ExifResult.prototype={hasThumbnail:function(d){return!(!this.thumbnailOffset||!this.thumbnailLength)&&(typeof d!="string"||(d.toLowerCase().trim()==="image/jpeg"?this.thumbnailType===6:d.toLowerCase().trim()==="image/tiff"&&this.thumbnailType===1))},getThumbnailOffset:function(){return this.app1Offset+6+this.thumbnailOffset},getThumbnailLength:function(){return this.thumbnailLength},getThumbnailBuffer:function(){return this._getThumbnailStream().nextBuffer(this.thumbnailLength)},_getThumbnailStream:function(){return this.startMarker.openWithOffset(this.getThumbnailOffset())},getImageSize:function(){return this.imageSize},getThumbnailSize:function(){var d,m=this._getThumbnailStream();return jpeg.parseSections(m,function(g,w){jpeg.getSectionName(g).name==="SOF"&&(d=jpeg.getSizeFromSOFSection(w))}),d}},Parser$1.prototype={enableBinaryFields:function(d){return this.flags.readBinaryTags=!!d,this},enablePointers:function(d){return this.flags.hidePointers=!d,this},enableTagNames:function(d){return this.flags.resolveTagNames=!!d,this},enableImageSize:function(d){return this.flags.imageSize=!!d,this},enableReturnTags:function(d){return this.flags.returnTags=!!d,this},enableSimpleValues:function(d){return this.flags.simplifyValues=!!d,this},parse:function(){var d,m,g,w,I,P,F,$,D,U=this.stream.mark(),Z=U.openWithOffset(0),j=this.flags;return j.resolveTagNames&&(F=requireExifTags()),j.resolveTagNames?(d={},$=function(G){return d[G.name]},D=function(G,H){d[G.name]=H}):(d=[],$=function(G){var H;for(H=0;H<d.length;++H)if(d[H].type===G.type&&d[H].section===G.section)return d.value},D=function(G,H){var W;for(W=0;W<d.length;++W)if(d[W].type===G.type&&d[W].section===G.section)return void(d.value=H)}),jpeg.parseSections(Z,function(G,H){var W=H.offsetFrom(U);G===225?exif.parseTags(H,function(Q,q,rt,it){if(j.readBinaryTags||it!==7){if(q===513){if(g=rt[0],j.hidePointers)return}else if(q===514){if(w=rt[0],j.hidePointers)return}else if(q===259&&(I=rt[0],j.hidePointers))return;if(j.returnTags)if(j.simplifyValues&&(rt=simplify.simplifyValue(rt,it)),j.resolveTagNames){var X=(Q===exif.GPSIFD?F.gps:F.exif)[q];X||(X=F.exif[q]),d.hasOwnProperty(X)||(d[X]=rt)}else d.push({section:Q,type:q,value:rt})}})&&(P=W):j.imageSize&&jpeg.getSectionName(G).name==="SOF"&&(m=jpeg.getSizeFromSOFSection(H))}),j.simplifyValues&&(simplify.castDegreeValues($,D),simplify.castDateValues($,D)),new ExifResult(U,d,m,g,w,I,P)}};var parser=Parser$1,domBufferstream,hasRequiredDomBufferstream,bufferstream,hasRequiredBufferstream;function requireDomBufferstream(){if(hasRequiredDomBufferstream)return domBufferstream;function d(m,g,w,I,P,F){this.global=P,g=g||0,w=w||m.byteLength-g,this.arrayBuffer=m.slice(g,g+w),this.view=new P.DataView(this.arrayBuffer,0,this.arrayBuffer.byteLength),this.setBigEndian(I),this.offset=0,this.parentOffset=(F||0)+g}return hasRequiredDomBufferstream=1,d.prototype={setBigEndian:function(m){this.littleEndian=!m},nextUInt8:function(){var m=this.view.getUint8(this.offset);return this.offset+=1,m},nextInt8:function(){var m=this.view.getInt8(this.offset);return this.offset+=1,m},nextUInt16:function(){var m=this.view.getUint16(this.offset,this.littleEndian);return this.offset+=2,m},nextUInt32:function(){var m=this.view.getUint32(this.offset,this.littleEndian);return this.offset+=4,m},nextInt16:function(){var m=this.view.getInt16(this.offset,this.littleEndian);return this.offset+=2,m},nextInt32:function(){var m=this.view.getInt32(this.offset,this.littleEndian);return this.offset+=4,m},nextFloat:function(){var m=this.view.getFloat32(this.offset,this.littleEndian);return this.offset+=4,m},nextDouble:function(){var m=this.view.getFloat64(this.offset,this.littleEndian);return this.offset+=8,m},nextBuffer:function(m){var g=this.arrayBuffer.slice(this.offset,this.offset+m);return this.offset+=m,g},remainingLength:function(){return this.arrayBuffer.byteLength-this.offset},nextString:function(m){var g=this.arrayBuffer.slice(this.offset,this.offset+m);return g=String.fromCharCode.apply(null,new this.global.Uint8Array(g)),this.offset+=m,g},mark:function(){var m=this;return{openWithOffset:function(g){return g=(g||0)+this.offset,new d(m.arrayBuffer,g,m.arrayBuffer.byteLength-g,!m.littleEndian,m.global,m.parentOffset)},offset:this.offset,getParentOffset:function(){return m.parentOffset}}},offsetFrom:function(m){return this.parentOffset+this.offset-(m.offset+m.getParentOffset())},skip:function(m){this.offset+=m},branch:function(m,g){return g=typeof g=="number"?g:this.arrayBuffer.byteLength-(this.offset+m),new d(this.arrayBuffer,this.offset+m,g,!this.littleEndian,this.global,this.parentOffset)}},domBufferstream=d}function requireBufferstream(){if(hasRequiredBufferstream)return bufferstream;function d(m,g,w,I){this.buffer=m,this.offset=g||0,w=typeof w=="number"?w:m.length,this.endPosition=this.offset+w,this.setBigEndian(I)}return hasRequiredBufferstream=1,d.prototype={setBigEndian:function(m){this.bigEndian=!!m},nextUInt8:function(){var m=this.buffer.readUInt8(this.offset);return this.offset+=1,m},nextInt8:function(){var m=this.buffer.readInt8(this.offset);return this.offset+=1,m},nextUInt16:function(){var m=this.bigEndian?this.buffer.readUInt16BE(this.offset):this.buffer.readUInt16LE(this.offset);return this.offset+=2,m},nextUInt32:function(){var m=this.bigEndian?this.buffer.readUInt32BE(this.offset):this.buffer.readUInt32LE(this.offset);return this.offset+=4,m},nextInt16:function(){var m=this.bigEndian?this.buffer.readInt16BE(this.offset):this.buffer.readInt16LE(this.offset);return this.offset+=2,m},nextInt32:function(){var m=this.bigEndian?this.buffer.readInt32BE(this.offset):this.buffer.readInt32LE(this.offset);return this.offset+=4,m},nextFloat:function(){var m=this.bigEndian?this.buffer.readFloatBE(this.offset):this.buffer.readFloatLE(this.offset);return this.offset+=4,m},nextDouble:function(){var m=this.bigEndian?this.buffer.readDoubleBE(this.offset):this.buffer.readDoubleLE(this.offset);return this.offset+=8,m},nextBuffer:function(m){var g=this.buffer.slice(this.offset,this.offset+m);return this.offset+=m,g},remainingLength:function(){return this.endPosition-this.offset},nextString:function(m){var g=this.buffer.toString("utf8",this.offset,this.offset+m);return this.offset+=m,g},mark:function(){var m=this;return{openWithOffset:function(g){return g=(g||0)+this.offset,new d(m.buffer,g,m.endPosition-g,m.bigEndian)},offset:this.offset}},offsetFrom:function(m){return this.offset-m.offset},skip:function(m){this.offset+=m},branch:function(m,g){return g=typeof g=="number"?g:this.endPosition-(this.offset+m),new d(this.buffer,this.offset+m,g,this.bigEndian)}},bufferstream=d}var Parser=parser;function getGlobal(){return(0,eval)("this")}var exifParser={create:function(d,m){if(d instanceof(m=m||getGlobal()).ArrayBuffer){var g=requireDomBufferstream();return new Parser(new g(d,0,d.byteLength,!0,m))}var w=requireBufferstream();return new Parser(new w(d,0,d.length,!0))}},EXIFParser=getDefaultExportFromCjs(exifParser);function getExifOrientation(d){const m=d._exif;return m&&m.tags&&m.tags.Orientation||1}function getExifOrientationTransformation(d){const m=d.bitmap.width,g=d.bitmap.height;switch(getExifOrientation(d)){case 1:default:return null;case 2:return function(w,I){return[m-w-1,I]};case 3:return function(w,I){return[m-w-1,g-I-1]};case 4:return function(w,I){return[w,g-I-1]};case 5:return function(w,I){return[I,w]};case 6:return function(w,I){return[I,g-w-1]};case 7:return function(w,I){return[m-I-1,g-w-1]};case 8:return function(w,I){return[m-I-1,w]}}}function transformBitmap(d,m,g,w){const I=d.bitmap.data,P=d.bitmap.width,F=Buffer.alloc(I.length);for(let $=0;$<m;$++)for(let D=0;D<g;D++){const[U,Z]=w($,D),j=m*D+$<<2,G=P*Z+U<<2,H=I.readUInt32BE(G);F.writeUInt32BE(H,j)}d.bitmap.data=F,d.bitmap.width=m,d.bitmap.height=g,d._exif.tags.Orientation=1}function exifRotate(d){if(getExifOrientation(d)<2)return;const m=getExifOrientationTransformation(d),g=getExifOrientation(d)>4,w=g?d.bitmap.height:d.bitmap.width,I=g?d.bitmap.width:d.bitmap.height;m&&transformBitmap(d,w,I,m)}async function attemptExifRotate(d,m){try{d._exif=EXIFParser.create(m).parse(),exifRotate(d)}catch{}}var __defProp$2=Object.defineProperty,__defNormalProp$2=(d,m,g)=>m in d?__defProp$2(d,m,{enumerable:!0,configurable:!0,writable:!0,value:g}):d[m]=g,__publicField$2=(d,m,g)=>__defNormalProp$2(d,typeof m!="symbol"?m+"":m,g);const emptyBitmap={data:Buffer.alloc(0),width:0,height:0};function bufferFromArrayBuffer(d){const m=Buffer.alloc(d.byteLength),g=new Uint8Array(d);for(let w=0;w<m.length;++w)m[w]=g[w];return m}function createJimp({plugins:d,formats:m}={}){const g=d||[],w=(m||[]).map(P=>P()),I=class{constructor(P=emptyBitmap){if(__publicField$2(this,"bitmap",emptyBitmap),__publicField$2(this,"background",0),__publicField$2(this,"formats",[]),__publicField$2(this,"mime"),this.formats=w,"data"in P)this.bitmap=P;else if(this.bitmap={data:Buffer.alloc(P.width*P.height*4),width:P.width,height:P.height},P.color){this.background=typeof P.color=="string"?cssColorToHex(P.color):P.color;for(let F=0;F<this.bitmap.data.length;F+=4)this.bitmap.data.writeUInt32BE(this.background,F)}for(const F of g)for(const $ in F)this[$]=(...D)=>{var Z;const U=(Z=F[$])==null?void 0:Z.call(F,this,...D);return typeof U=="object"&&"bitmap"in U?(this.bitmap=U.bitmap,this):U}}static async read(P,F){if(Buffer.isBuffer(P)||P instanceof ArrayBuffer)return this.fromBuffer(P);const[$,D]=await to(fetch(P));if($)throw new Error(`Could not load Buffer from URL: ${P}`);if(!D.ok)throw new Error(`HTTP Status ${D.status} for url ${P}`);const[U,Z]=await to(D.arrayBuffer());if(U)throw new Error(`Could not load Buffer from ${P}`);const j=bufferFromArrayBuffer(Z);return this.fromBuffer(j,F)}static fromBitmap(P){let F;if(P.data instanceof Buffer&&(F=Buffer.from(P.data)),(P.data instanceof Uint8Array||P.data instanceof Uint8ClampedArray)&&(F=Buffer.from(P.data.buffer)),Array.isArray(P.data)&&(F=Buffer.concat(P.data.map($=>Buffer.from($.toString(16).padStart(8,"0"),"hex")))),!F)throw new Error("data must be a Buffer");if(typeof P.height!="number"||typeof P.width!="number")throw new Error("bitmap must have width and height");return new I({height:P.height,width:P.width,data:F})}static async fromBuffer(P,F){const $=P instanceof ArrayBuffer?bufferFromArrayBuffer(P):P,D=await fileType$1.fromBuffer($);if(!D||!D.mime)throw new Error("Could not find MIME for Buffer");const U=w.find(j=>j.mime===D.mime);if(!U||!U.decode)throw new Error(`Mime type ${D.mime} does not support decoding`);const Z=new I(await U.decode($,F==null?void 0:F[U.mime]));return Z.mime=D.mime,attemptExifRotate(Z,$),Z}inspect(){return"<Jimp "+(this.bitmap===emptyBitmap?"pending...":this.bitmap.width+"x"+this.bitmap.height)+">"}toString(){return"[object Jimp]"}get width(){return this.bitmap.width}get height(){return this.bitmap.height}async getBuffer(P,F){const $=this.formats.find(U=>U.mime===P);if(!$||!$.encode)throw new Error(`Unsupported MIME type: ${P}`);let D;return $.hasAlpha?D=this:(D=new I({width:this.bitmap.width,height:this.bitmap.height,color:this.background}),composite(D,this)),$.encode(D.bitmap,F)}async getBase64(P,F){return"data:"+P+";base64,"+(await this.getBuffer(P,F)).toString("base64")}async write(P,F){const $=mime.getType(P);await writeFile(P,await this.getBuffer($,F))}clone(){return new I({...this.bitmap,data:Buffer.from(this.bitmap.data)})}getPixelIndex(P,F,$){let D,U;if($||($=Edge.EXTEND),typeof P!="number"||typeof F!="number")throw new Error("x and y must be numbers");D=P=Math.round(P),U=F=Math.round(F),$===Edge.EXTEND&&(P<0&&(D=0),P>=this.bitmap.width&&(D=this.bitmap.width-1),F<0&&(U=0),F>=this.bitmap.height&&(U=this.bitmap.height-1)),$===Edge.WRAP&&(P<0&&(D=this.bitmap.width+P),P>=this.bitmap.width&&(D=P%this.bitmap.width),F<0&&(U=this.bitmap.height+F),F>=this.bitmap.height&&(U=F%this.bitmap.height));let Z=this.bitmap.width*U+D<<2;return(D<0||D>=this.bitmap.width)&&(Z=-1),(U<0||U>=this.bitmap.height)&&(Z=-1),Z}getPixelColor(P,F){if(typeof P!="number"||typeof F!="number")throw new Error("x and y must be numbers");const $=this.getPixelIndex(P,F);return this.bitmap.data.readUInt32BE($)}setPixelColor(P,F,$){if(typeof P!="number"||typeof F!="number"||typeof $!="number")throw new Error("hex, x and y must be numbers");const D=this.getPixelIndex(F,$);return this.bitmap.data.writeUInt32BE(P,D),this}hasAlpha(){const{width:P,height:F,data:$}=this.bitmap,D=P*F<<2;for(let U=3;U<D;U+=4)if($[U]!==255)return!0;return!1}composite(P,F=0,$=0,D={}){return composite(this,P,F,$,D)}scan(P,F,$,D,U){return scan(this,P,F,$,D,U)}scanIterator(P=0,F=0,$=this.bitmap.width,D=this.bitmap.height){if(typeof P!="number"||typeof F!="number")throw new Error("x and y must be numbers");if(typeof $!="number"||typeof D!="number")throw new Error("w and h must be numbers");return scanIterator(this,P,F,$,D)}};return I}var ResizeStrategy,ResizeStrategy2;function Resize(d,m,g,w,I,P,F){this.widthOriginal=Math.abs(Math.floor(d)||0),this.heightOriginal=Math.abs(Math.floor(m)||0),this.targetWidth=Math.abs(Math.floor(g)||0),this.targetHeight=Math.abs(Math.floor(w)||0),this.colorChannels=I?4:3,this.interpolationPass=!!P,this.resizeCallback=typeof F=="function"?F:function(){},this.targetWidthMultipliedByChannels=this.targetWidth*this.colorChannels,this.originalWidthMultipliedByChannels=this.widthOriginal*this.colorChannels,this.originalHeightMultipliedByChannels=this.heightOriginal*this.colorChannels,this.widthPassResultSize=this.targetWidthMultipliedByChannels*this.heightOriginal,this.finalResultSize=this.targetWidthMultipliedByChannels*this.targetHeight,this.initialize()}ResizeStrategy2=ResizeStrategy||(ResizeStrategy={}),ResizeStrategy2.NEAREST_NEIGHBOR="nearestNeighbor",ResizeStrategy2.BILINEAR="bilinearInterpolation",ResizeStrategy2.BICUBIC="bicubicInterpolation",ResizeStrategy2.HERMITE="hermiteInterpolation",ResizeStrategy2.BEZIER="bezierInterpolation",Resize.prototype.initialize=function(){if(!(this.widthOriginal>0&&this.heightOriginal>0&&this.targetWidth>0&&this.targetHeight>0))throw console.log(this),new Error("Invalid settings specified for the resizer.");this.configurePasses()},Resize.prototype.configurePasses=function(){this.widthOriginal===this.targetWidth?this.resizeWidth=this.bypassResizer:(this.ratioWeightWidthPass=this.widthOriginal/this.targetWidth,this.ratioWeightWidthPass<1&&this.interpolationPass?(this.initializeFirstPassBuffers(!0),this.resizeWidth=this.colorChannels===4?this.resizeWidthInterpolatedRGBA:this.resizeWidthInterpolatedRGB):(this.initializeFirstPassBuffers(!1),this.resizeWidth=this.colorChannels===4?this.resizeWidthRGBA:this.resizeWidthRGB)),this.heightOriginal===this.targetHeight?this.resizeHeight=this.bypassResizer:(this.ratioWeightHeightPass=this.heightOriginal/this.targetHeight,this.ratioWeightHeightPass<1&&this.interpolationPass?(this.initializeSecondPassBuffers(!0),this.resizeHeight=this.resizeHeightInterpolated):(this.initializeSecondPassBuffers(!1),this.resizeHeight=this.colorChannels===4?this.resizeHeightRGBA:this.resizeHeightRGB))},Resize.prototype._resizeWidthInterpolatedRGBChannels=function(d,m){const g=m?4:3,w=this.ratioWeightWidthPass,I=this.widthBuffer;let P,F,$=0,D=0,U=0,Z=0,j=0;for(P=0;$<1/3;P+=g,$+=w)for(D=P,U=0;D<this.widthPassResultSize;U+=this.originalWidthMultipliedByChannels,D+=this.targetWidthMultipliedByChannels)I[D]=d[U],I[D+1]=d[U+1],I[D+2]=d[U+2],m&&(I[D+3]=d[U+3]);for($-=1/3,F=this.widthOriginal-1;$<F;P+=g,$+=w)for(j=$%1,Z=1-j,D=P,U=Math.floor($)*g;D<this.widthPassResultSize;U+=this.originalWidthMultipliedByChannels,D+=this.targetWidthMultipliedByChannels)I[D+0]=d[U+0]*Z+d[U+g+0]*j,I[D+1]=d[U+1]*Z+d[U+g+1]*j,I[D+2]=d[U+2]*Z+d[U+g+2]*j,m&&(I[D+3]=d[U+3]*Z+d[U+g+3]*j);for(F=this.originalWidthMultipliedByChannels-g;P<this.targetWidthMultipliedByChannels;P+=g)for(D=P,U=F;D<this.widthPassResultSize;U+=this.originalWidthMultipliedByChannels,D+=this.targetWidthMultipliedByChannels)I[D]=d[U],I[D+1]=d[U+1],I[D+2]=d[U+2],m&&(I[D+3]=d[U+3]);return I},Resize.prototype._resizeWidthRGBChannels=function(d,m){const g=m?4:3,w=this.ratioWeightWidthPass,I=1/w,P=this.originalWidthMultipliedByChannels-g+1,F=this.targetWidthMultipliedByChannels-g+1,$=this.outputWidthWorkBench,D=this.widthBuffer,U=this.outputWidthWorkBenchOpaquePixelsCount;let Z=0,j=0,G=0,H=0,W=0,Q=0,q=0,rt=1,it=0,X=0,J=0,tt=0;do{for(W=0;W<this.originalHeightMultipliedByChannels;)$[W++]=0,$[W++]=0,$[W++]=0,m&&($[W++]=0,U[W/g-1]=0);Z=w;do{for(j=1+G-H,rt=Math.min(Z,j),W=0,Q=G;W<this.originalHeightMultipliedByChannels;Q+=P)it=d[Q],X=d[++Q],J=d[++Q],tt=m?d[++Q]:255,$[W++]+=(tt?it:0)*rt,$[W++]+=(tt?X:0)*rt,$[W++]+=(tt?J:0)*rt,m&&($[W++]+=tt*rt,U[W/g-1]+=tt?rt:0);if(!(Z>=j)){H+=Z;break}G+=g,H=G,Z-=j}while(Z>0&&G<this.originalWidthMultipliedByChannels);for(W=0,Q=q;W<this.originalHeightMultipliedByChannels;Q+=F)Z=m?U[W/g]:1,rt=m?Z?1/Z:0:I,D[Q]=$[W++]*rt,D[++Q]=$[W++]*rt,D[++Q]=$[W++]*rt,m&&(D[++Q]=$[W++]*I);q+=g}while(q<this.targetWidthMultipliedByChannels);return D},Resize.prototype._resizeHeightRGBChannels=function(d,m){const g=this.ratioWeightHeightPass,w=1/g,I=this.outputHeightWorkBench,P=this.heightBuffer,F=this.outputHeightWorkBenchOpaquePixelsCount;let $=0,D=0,U=0,Z=0,j=0,G=0,H=0,W=1,Q=0,q=0,rt=0,it=0;do{for(j=0;j<this.targetWidthMultipliedByChannels;)I[j++]=0,I[j++]=0,I[j++]=0,m&&(I[j++]=0,F[j/4-1]=0);$=g;do{for(D=1+U-Z,W=Math.min($,D),H=U,j=0;j<this.targetWidthMultipliedByChannels;)Q=d[H++],q=d[H++],rt=d[H++],it=m?d[H++]:255,I[j++]+=(it?Q:0)*W,I[j++]+=(it?q:0)*W,I[j++]+=(it?rt:0)*W,m&&(I[j++]+=it*W,F[j/4-1]+=it?W:0);if(!($>=D)){Z+=$;break}U=H,Z=U,$-=D}while($>0&&U<this.widthPassResultSize);for(j=0;j<this.targetWidthMultipliedByChannels;)$=m?F[j/4]:1,W=m?$?1/$:0:w,P[G++]=Math.round(I[j++]*W),P[G++]=Math.round(I[j++]*W),P[G++]=Math.round(I[j++]*W),m&&(P[G++]=Math.round(I[j++]*w))}while(G<this.finalResultSize);return P},Resize.prototype.resizeWidthInterpolatedRGB=function(d){return this._resizeWidthInterpolatedRGBChannels(d,!1)},Resize.prototype.resizeWidthInterpolatedRGBA=function(d){return this._resizeWidthInterpolatedRGBChannels(d,!0)},Resize.prototype.resizeWidthRGB=function(d){return this._resizeWidthRGBChannels(d,!1)},Resize.prototype.resizeWidthRGBA=function(d){return this._resizeWidthRGBChannels(d,!0)},Resize.prototype.resizeHeightInterpolated=function(d){const m=this.ratioWeightHeightPass,g=this.heightBuffer;let w,I=0,P=0,F=0,$=0,D=0,U=0,Z=0;for(;I<1/3;I+=m)for(F=0;F<this.targetWidthMultipliedByChannels;)g[P++]=Math.round(d[F++]);for(I-=1/3,w=this.heightOriginal-1;I<w;I+=m)for(Z=I%1,U=1-Z,$=Math.floor(I)*this.targetWidthMultipliedByChannels,D=$+this.targetWidthMultipliedByChannels,F=0;F<this.targetWidthMultipliedByChannels;++F)g[P++]=Math.round(d[$++]*U+d[D++]*Z);for(;P<this.finalResultSize;)for(F=0,$=w*this.targetWidthMultipliedByChannels;F<this.targetWidthMultipliedByChannels;++F)g[P++]=Math.round(d[$++]);return g},Resize.prototype.resizeHeightRGB=function(d){return this._resizeHeightRGBChannels(d,!1)},Resize.prototype.resizeHeightRGBA=function(d){return this._resizeHeightRGBChannels(d,!0)},Resize.prototype.resize=function(d){this.resizeCallback(this.resizeHeight(this.resizeWidth(d)))},Resize.prototype.bypassResizer=function(d){return d},Resize.prototype.initializeFirstPassBuffers=function(d){this.widthBuffer=this.generateFloatBuffer(this.widthPassResultSize),d||(this.outputWidthWorkBench=this.generateFloatBuffer(this.originalHeightMultipliedByChannels),this.colorChannels>3&&(this.outputWidthWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.heightOriginal)))},Resize.prototype.initializeSecondPassBuffers=function(d){this.heightBuffer=this.generateUint8Buffer(this.finalResultSize),d||(this.outputHeightWorkBench=this.generateFloatBuffer(this.targetWidthMultipliedByChannels),this.colorChannels>3&&(this.outputHeightWorkBenchOpaquePixelsCount=this.generateFloat64Buffer(this.targetWidth)))},Resize.prototype.generateFloatBuffer=function(d){try{return new Float32Array(d)}catch(m){return console.error(m),[]}},Resize.prototype.generateFloat64Buffer=function(d){try{return new Float64Array(d)}catch(m){return console.error(m),[]}},Resize.prototype.generateUint8Buffer=function(d){try{return new Uint8Array(d)}catch(m){return console.error(m),[]}};const operations={nearestNeighbor(d,m){const g=d.width,w=d.height,I=m.width,P=m.height,F=d.data,$=m.data;for(let D=0;D<P;D++)for(let U=0;U<I;U++){let Z=4*(D*I+U),j=4*(Math.floor(D*w/P)*g+Math.floor(U*g/I));$[Z++]=F[j++],$[Z++]=F[j++],$[Z++]=F[j++],$[Z++]=F[j++]}},bilinearInterpolation(d,m){const g=d.width,w=d.height,I=m.width,P=m.height,F=d.data,$=m.data,D=function(Z,j,G,H,W){return j===H?G:Math.round((Z-j)*W+(H-Z)*G)},U=function(Z,j,G,H,W,Q,q,rt){let it=4*(q*g+H)+j,X=4*(q*g+W)+j;const J=D(G,H,F[it],W,F[X]);if(rt===q)$[Z+j]=J;else{it=4*(rt*g+H)+j,X=4*(rt*g+W)+j;const tt=D(G,H,F[it],W,F[X]);$[Z+j]=D(Q,q,J,rt,tt)}};for(let Z=0;Z<P;Z++)for(let j=0;j<I;j++){const G=4*(Z*I+j),H=j*g/I,W=Math.floor(H),Q=Math.min(Math.ceil(H),g-1),q=Z*w/P,rt=Math.floor(q),it=Math.min(Math.ceil(q),w-1);U(G,0,H,W,Q,q,rt,it),U(G,1,H,W,Q,q,rt,it),U(G,2,H,W,Q,q,rt,it),U(G,3,H,W,Q,q,rt,it)}},_interpolate2D(d,m,g,w){const I=d.data,P=m.data,F=d.width,$=d.height,D=m.width,U=m.height,Z=Math.max(1,Math.floor(F/D)),j=D*Z,G=Math.max(1,Math.floor($/U)),H=U*G,W=Buffer.alloc(j*$*4);for(let rt=0;rt<$;rt++)for(let it=0;it<j;it++){const X=it*(F-1)/j,J=Math.floor(X),tt=X-J,ot=4*(rt*F+J),nt=4*(rt*j+it);for(let lt=0;lt<4;lt++){const at=ot+lt,ut=J>0?I[at-4]:2*I[at]-I[at+4],V=I[at],ht=I[at+4],vt=J<F-2?I[at+8]:2*I[at+4]-I[at];W[nt+lt]=w(ut,V,ht,vt,tt)}}const Q=Buffer.alloc(j*H*4);for(let rt=0;rt<H;rt++)for(let it=0;it<j;it++){const X=rt*($-1)/H,J=Math.floor(X),tt=X-J,ot=4*(J*j+it),nt=4*(rt*j+it);for(let lt=0;lt<4;lt++){const at=ot+lt,ut=J>0?W[at-4*j]:2*W[at]-W[at+4*j],V=W[at],ht=W[at+4*j],vt=J<$-2?W[at+8*j]:2*W[at+4*j]-W[at];Q[nt+lt]=w(ut,V,ht,vt,tt)}}const q=Z*G;if(q>1)for(let rt=0;rt<U;rt++)for(let it=0;it<D;it++){let X=0,J=0,tt=0,ot=0,nt=0;for(let at=0;at<G;at++){const ut=rt*G+at;for(let V=0;V<Z;V++){const ht=4*(ut*j+(it*Z+V)),vt=Q[ht+3];vt&&(X+=Q[ht],J+=Q[ht+1],tt+=Q[ht+2],nt++),ot+=vt}}const lt=4*(rt*D+it);P[lt]=nt?Math.round(X/nt):0,P[lt+1]=nt?Math.round(J/nt):0,P[lt+2]=nt?Math.round(tt/nt):0,P[lt+3]=Math.round(ot/q)}else m.data=Q},bicubicInterpolation(d,m,g){return this._interpolate2D(d,m,g,function(w,I,P,F,$){const D=F-P-w+I,U=w-I-D,Z=P-w,j=I;return Math.max(0,Math.min(255,D*($*$*$)+U*($*$)+Z*$+j))})},hermiteInterpolation(d,m,g){return this._interpolate2D(d,m,g,function(w,I,P,F,$){const D=I,U=.5*(P-w),Z=w-2.5*I+2*P-.5*F,j=.5*(F-w)+1.5*(I-P);return Math.max(0,Math.min(255,Math.round(((j*$+Z)*$+U)*$+D)))})},bezierInterpolation(d,m,g){return this._interpolate2D(d,m,g,function(w,I,P,F,$){const D=1-$,U=I*D*D*D,Z=3*(I+(P-w)/4)*D*D*$,j=3*(P-(F-I)/4)*D*$*$,G=P*$*$*$;return Math.max(0,Math.min(255,Math.round(U+Z+j+G)))})}},ResizeOptionsSchema=z.union([z.object({w:z.number().min(0),h:z.number().min(0).optional(),mode:z.nativeEnum(ResizeStrategy).optional()}),z.object({w:z.number().min(0).optional(),h:z.number().min(0),mode:z.nativeEnum(ResizeStrategy).optional()})]),ScaleToFitOptionsSchema=z.object({w:z.number().min(0),h:z.number().min(0),mode:z.nativeEnum(ResizeStrategy).optional()}),ScaleComplexOptionsSchema=z.object({f:z.number().min(0),mode:z.nativeEnum(ResizeStrategy).optional()}),methods$d={resize(d,m){const{mode:g}=ResizeOptionsSchema.parse(m);let w,I;if(typeof m.w=="number")w=m.w,I=m.h??d.bitmap.height*(w/d.bitmap.width);else{if(typeof m.h!="number")throw new Error("w must be a number");I=m.h,w=m.w??d.bitmap.width*(I/d.bitmap.height)}if(w=Math.round(w)||1,I=Math.round(I)||1,g&&typeof operations[g]=="function"){const P={data:Buffer.alloc(w*I*4),width:w,height:I};operations[g](d.bitmap,P),d.bitmap=P}else new Resize(d.bitmap.width,d.bitmap.height,w,I,!0,!0,P=>{d.bitmap.data=Buffer.from(P),d.bitmap.width=w,d.bitmap.height=I}).resize(d.bitmap.data);return d},scale(d,m){const{f:g,mode:w}=typeof m=="number"?{f:m}:ScaleComplexOptionsSchema.parse(m),I=d.bitmap.width*g,P=d.bitmap.height*g;return this.resize(d,{w:I,h:P,mode:w})},scaleToFit(d,m){const{h:g,w,mode:I}=ScaleToFitOptionsSchema.parse(m),P=w/g>d.bitmap.width/d.bitmap.height?g/d.bitmap.height:w/d.bitmap.width;return this.scale(d,{f:P,mode:I})}},ContainOptionsSchema=z.object({w:z.number(),h:z.number(),align:z.number().optional(),mode:z.nativeEnum(ResizeStrategy).optional()}),methods$c={contain(d,m){const{w:g,h:w,align:I=HorizontalAlign.CENTER|VerticalAlign.MIDDLE,mode:P}=ContainOptionsSchema.parse(m),F=7&I,$=I>>3;if((F===0||F&F-1)&&($===0||$&$-1))throw new Error("only use one flag per alignment direction");const D=F>>1,U=$>>1,Z=g/w>d.bitmap.width/d.bitmap.height?w/d.bitmap.height:g/d.bitmap.width,j=methods$d.scale(clone(d),{f:Z,mode:P});return(d=methods$d.resize(d,{w:g,h:w,mode:P})).scan((G,H,W)=>{d.bitmap.data.writeUInt32BE(d.background,W)}),d=methods$h.blit(d,{src:j,x:(d.bitmap.width-j.bitmap.width)/2*D,y:(d.bitmap.height-j.bitmap.height)/2*U})}},CropOptionsSchema=z.object({x:z.number(),y:z.number(),w:z.number(),h:z.number()}),AutocropComplexOptionsSchema=z.object({tolerance:z.number().min(0).max(1).optional(),cropOnlyFrames:z.boolean().optional(),cropSymmetric:z.boolean().optional(),leaveBorder:z.number().optional(),ignoreSides:z.object({north:z.boolean().optional(),south:z.boolean().optional(),east:z.boolean().optional(),west:z.boolean().optional()}).optional()}),methods$b={crop(d,m){let{x:g,y:w,w:I,h:P}=CropOptionsSchema.parse(m);if(g=Math.round(g),w=Math.round(w),I=Math.round(I),P=Math.round(P),g===0&&I===d.bitmap.width){const F=I*w+g<<2,$=F+(P*I<<2);d.bitmap.data=d.bitmap.data.slice(F,$)}else{const F=Buffer.allocUnsafe(I*P*4);let $=0;scan(d,g,w,I,P,function(D,U,Z){const j=d.bitmap.data.readUInt32BE(Z);F.writeUInt32BE(j,$),$+=4}),d.bitmap.data=F}return d.bitmap.width=I,d.bitmap.height=P,d},autocrop(d,m={}){const{tolerance:g=2e-4,cropOnlyFrames:w=!0,cropSymmetric:I=!1,leaveBorder:P=0,ignoreSides:F}=typeof m=="number"?{tolerance:m}:AutocropComplexOptionsSchema.parse(m),$=d.bitmap.width,D=d.bitmap.height,U={north:!1,south:!1,east:!1,west:!1,...F};let Z=d.getPixelColor(0,0);const j=intToRGBA$1(Z);let G=0,H=0,W=0,Q=0;if(Z=d.getPixelColor(0,0),!U.north)t:for(let X=0;X<D-1;X++){for(let J=0;J<$;J++)if(colorDiff(j,intToRGBA$1(d.getPixelColor(J,X)))>g)break t;G++}if(Z=d.getPixelColor($,0),!U.west)t:for(let X=0;X<$-1;X++){for(let J=0+G;J<D;J++)if(colorDiff(j,intToRGBA$1(d.getPixelColor(X,J)))>g)break t;Q++}if(Z=d.getPixelColor(0,D),!U.south)t:for(let X=D-1;X>=G+1;X--){for(let J=$-H-1;J>=0;J--)if(colorDiff(j,intToRGBA$1(d.getPixelColor(J,X)))>g)break t;W++}if(Z=d.getPixelColor($,D),!U.east)t:for(let X=$-1;X>=0+Q+1;X--){for(let J=D-1;J>=0+G;J--)if(colorDiff(j,intToRGBA$1(d.getPixelColor(X,J)))>g)break t;H++}let q=!1;if(Q-=P,H-=P,G-=P,W-=P,I){const X=Math.min(H,Q),J=Math.min(G,W);Q=X,H=X,G=J,W=J}Q=Q>=0?Q:0,H=H>=0?H:0,G=G>=0?G:0,W=W>=0?W:0;const rt=$-(Q+H),it=D-(W+G);return q=w?H!==0&&G!==0&&Q!==0&&W!==0:H!==0||G!==0||Q!==0||W!==0,q&&this.crop(d,{x:Q,y:G,w:rt,h:it}),d}},CoverOptionsSchema=z.object({w:z.number(),h:z.number(),align:z.number().optional(),mode:z.nativeEnum(ResizeStrategy).optional()}),methods$a={cover(d,m){const{w:g,h:w,align:I=HorizontalAlign.CENTER|VerticalAlign.MIDDLE,mode:P}=CoverOptionsSchema.parse(m),F=7&I,$=I>>3;if((F===0||F&F-1)&&($===0||$&$-1))throw new Error("only use one flag per alignment direction");const D=F>>1,U=$>>1,Z=g/w>d.bitmap.width/d.bitmap.height?g/d.bitmap.width:w/d.bitmap.height;return d=methods$d.scale(d,{f:Z,mode:P}),d=methods$b.crop(d,{x:(d.bitmap.width-g)/2*D,y:(d.bitmap.height-w)/2*U,w:g,h:w})}},DisplaceOptionsSchema=z.object({map:JimpClassSchema,offset:z.number()}),methods$9={displace(d,m){const{map:g,offset:w}=DisplaceOptionsSchema.parse(m),I=clone(d);return d.scan((P,F,$)=>{let D=g.bitmap.data[$]/256*w;D=Math.round(D);const U=d.getPixelIndex(P+D,F);d.bitmap.data[U]=I.bitmap.data[$],d.bitmap.data[U+1]=I.bitmap.data[$+1],d.bitmap.data[U+2]=I.bitmap.data[$+2]}),d}},methods$8={dither(d){const m=[1,9,3,11,13,5,15,7,4,12,2,10,16,8,14,6];return d.scan((g,w,I)=>{const P=m[((3&w)<<2)+g%4];d.bitmap.data[I]=Math.min(d.bitmap.data[I]+P,255),d.bitmap.data[I+1]=Math.min(d.bitmap.data[I+1]+P,255),d.bitmap.data[I+2]=Math.min(d.bitmap.data[I+2]+P,255)}),d}},FisheyeOptionsSchema=z.object({radius:z.number().min(0).optional()}),methods$7={fisheye(d,m={}){const{radius:g=2.5}=FisheyeOptionsSchema.parse(m),w=clone(d),{width:I,height:P}=w.bitmap;return w.scan((F,$)=>{const D=F/I,U=$/P,Z=Math.sqrt(Math.pow(D-.5,2)+Math.pow(U-.5,2)),j=2*Math.pow(Z,g),G=(D-.5)/Z,H=(U-.5)/Z,W=Math.round((j*G+.5)*I),Q=Math.round((j*H+.5)*P),q=w.getPixelColor(W,Q);d.setPixelColor(q,F,$)}),d.setPixelColor(w.getPixelColor(I/2,P/2),I/2,P/2),d}},FlipOptionsSchema=z.object({horizontal:z.boolean().optional(),vertical:z.boolean().optional()}),methods$6={flip(d,m){const{horizontal:g,vertical:w}=FlipOptionsSchema.parse(m),I=Buffer.alloc(d.bitmap.data.length);return d.scan((P,F,$)=>{const D=g?d.bitmap.width-1-P:P,U=w?d.bitmap.height-1-F:F,Z=d.bitmap.width*U+D<<2,j=d.bitmap.data.readUInt32BE($);I.writeUInt32BE(j,Z)}),d.bitmap.data=Buffer.from(I),d}};function Converter$1(d,m){if(!(d&&m&&d.length&&m.length))throw new Error("Bad alphabet");this.srcAlphabet=d,this.dstAlphabet=m}Converter$1.prototype.convert=function(d){var m,g,w,I={},P=this.srcAlphabet.length,F=this.dstAlphabet.length,$=d.length,D=typeof d=="string"?"":[];if(!this.isValid(d))throw new Error('Number "'+d+'" contains of non-alphabetic digits ('+this.srcAlphabet+")");if(this.srcAlphabet===this.dstAlphabet)return d;for(m=0;m<$;m++)I[m]=this.srcAlphabet.indexOf(d[m]);do{for(g=0,w=0,m=0;m<$;m++)(g=g*P+I[m])>=F?(I[w++]=parseInt(g/F,10),g%=F):w>0&&(I[w++]=0);$=w,D=this.dstAlphabet.slice(g,g+1).concat(D)}while(w!==0);return D},Converter$1.prototype.isValid=function(d){for(var m=0;m<d.length;++m)if(this.srcAlphabet.indexOf(d[m])===-1)return!1;return!0};var converter=Converter$1,Converter=converter;function anyBase(d,m){var g=new Converter(d,m);return function(w){return g.convert(w)}}anyBase.BIN="01",anyBase.OCT="01234567",anyBase.DEC="0123456789",anyBase.HEX="0123456789abcdef";var anyBase_1=anyBase,anyBase$1=getDefaultExportFromCjs(anyBase_1),__defProp$1=Object.defineProperty,__defNormalProp$1=(d,m,g)=>m in d?__defProp$1(d,m,{enumerable:!0,configurable:!0,writable:!0,value:g}):d[m]=g,__publicField$1=(d,m,g)=>__defNormalProp$1(d,typeof m!="symbol"?m+"":m,g);class ImagePHash{constructor(m,g){__publicField$1(this,"size"),__publicField$1(this,"smallerSize"),this.size=m||32,this.smallerSize=g||8,initCoefficients(this.size)}distance(m,g){let w=0;for(let I=0;I<m.length;I++)m[I]!==g[I]&&w++;return w/m.length}getHash(m){m=methods$d.resize(clone(m),{w:this.size,h:this.size}),m=methods$e.greyscale(m);const g=[];for(let $=0;$<m.bitmap.width;$++){const D=[];for(let U=0;U<m.bitmap.height;U++)D[U]=intToRGBA(m.getPixelColor($,U)).b;g[$]=D}const w=applyDCT(g,this.size);let I=0;for(let $=0;$<this.smallerSize;$++)for(let D=0;D<this.smallerSize;D++)I+=w[$][D];const P=I/(this.smallerSize*this.smallerSize);let F="";for(let $=0;$<this.smallerSize;$++)for(let D=0;D<this.smallerSize;D++)F+=w[$][D]>P?"1":"0";return F}}function intToRGBA(d){const m=255&d,g=255&(d>>>=8),w=255&(d>>>=8);return{r:255&(d>>>=8),g:w,b:g,a:m}}const c$1=[];function initCoefficients(d){for(let m=1;m<d;m++)c$1[m]=1;c$1[0]=1/Math.sqrt(2)}function applyDCT(d,m){const g=m,w=[];for(let I=0;I<g;I++){const P=[];for(let F=0;F<g;F++){let $=0;for(let D=0;D<g;D++)for(let U=0;U<g;U++)$+=Math.cos((2*D+1)/(2*g)*I*Math.PI)*Math.cos((2*U+1)/(2*g)*F*Math.PI)*d[D][U];$*=c$1[I]*c$1[F]/4,P[F]=$,w[I]=P}}return w}const alphabet="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",maxHashLength=[NaN,NaN];for(let d=2;d<65;d++){const m=anyBase$1(anyBase$1.BIN,alphabet.slice(0,d))(new Array(65).join("1"));maxHashLength.push(m.length)}const methods$5={pHash:d=>new ImagePHash().getHash(d),hash(d,m=64){if(m<2||m>64)throw new Error("base must be a number between 2 and 64");const g=alphabet.slice(0,m),w=this.pHash(d),I=maxHashLength[m];return anyBase$1(anyBase$1.BIN,g)(w).padStart(I,"0")},distanceFromHash(d,m){const g=new ImagePHash,w=g.getHash(d);return g.distance(w,m)}},MaskOptionsObjectSchema=z.object({src:JimpClassSchema,x:z.number().optional(),y:z.number().optional()}),MaskOptionsSchema=z.union([JimpClassSchema,MaskOptionsObjectSchema]),methods$4={mask(d,m){let g,w,I;MaskOptionsSchema.parse(m),"bitmap"in m?(g=m,w=0,I=0):(g=m.src,w=m.x??0,I=m.y??0),w=Math.round(w),I=Math.round(I);const P=d.bitmap.width,F=d.bitmap.height;return g.scan(function($,D,U){const Z=w+$,j=I+D;if(Z>=0&&j>=0&&Z<P&&j<F){const G=d.getPixelIndex(Z,j),{data:H}=g.bitmap,W=(H[U+0]+H[U+1]+H[U+2])/3;d.bitmap.data[G+3]*=W/255}}),d}};function measureText(d,m){let g=0;for(let w=0;w<m.length;w++){const I=m[w],P=d.chars[I];if(P){const F=d.kernings[I],$=m[w+1],D=F&&$&&F[$]&&F[$]||0;g+=(P.xadvance||0)+D}}return g}function splitLines(d,m,g){const w=m.replace(/[\r\n]+/g,` 
`).split(" "),I=[];let P=[],F=0;return w.forEach($=>{if(measureText(d,$+(w.length>1?" ":""))>g){const Z=$[Symbol.iterator]();let j="";for(const G of Z){const H=[...P,j+G].join(" "),W=measureText(d,H);W<g?j+=G:W>g?(I.push([...P,j]),P=[],j=G):(I.push([...P,j+G]),P=[],j="")}return}const D=[...P,$].join(" "),U=measureText(d,D);U<=g&&!$.includes(`
`)?(U>F&&(F=U),P.push($)):(I.push(P),P=[$.replace(`
`,"")])}),I.push(P),{lines:I,longestLine:F}}function measureTextHeight(d,m,g){const{lines:w}=splitLines(d,m,g);return w.length*d.common.lineHeight}const PrintOptionsSchema=z.object({x:z.number(),y:z.number(),text:z.union([z.union([z.string(),z.number()]),z.object({text:z.union([z.string(),z.number()]),alignmentX:z.nativeEnum(HorizontalAlign).optional(),alignmentY:z.nativeEnum(VerticalAlign).optional()})]),maxWidth:z.number().optional(),maxHeight:z.number().optional(),cb:z.function(z.tuple([z.object({x:z.number(),y:z.number()})])).optional()});function xOffsetBasedOnAlignment(d,m,g,w){return w===HorizontalAlign.LEFT?0:w===HorizontalAlign.CENTER?(g-measureText(d,m))/2:g-measureText(d,m)}function drawCharacter(d,m,g,w,I){if(I.width>0&&I.height>0){const P=m.pages[I.page];P&&(d=methods$h.blit(d,{src:P,x:g+I.xoffset,y:w+I.yoffset,srcX:I.x,srcY:I.y,srcW:I.width,srcH:I.height}))}return d}function printText(d,m,g,w,I,P){for(let F=0;F<I.length;F++){const $=I[F];let D;D=m.chars[$]?$:/\s/.test($)?"":"?";const U=m.chars[D]||{xadvance:void 0},Z=m.kernings[D];U&&drawCharacter(d,m,g,w,U);const j=I[F+1];g+=(Z&&j&&Z[j]&&Z[j]||0)+(U.xadvance||P)}}const methods$3={print(d,{font:m,...g}){var W;let w,I,{x:P,y:F,text:$,maxWidth:D=1/0,maxHeight:U=1/0,cb:Z=()=>{}}=PrintOptionsSchema.parse(g);typeof $=="object"&&$.text!==null&&$.text!==void 0?(w=$.alignmentX||HorizontalAlign.LEFT,I=$.alignmentY||VerticalAlign.TOP,{text:$}=$):(w=HorizontalAlign.LEFT,I=VerticalAlign.TOP,$=$.toString()),typeof $=="number"&&($=$.toString()),U!==1/0&&I===VerticalAlign.BOTTOM?F+=U-measureTextHeight(m,$,D):U!==1/0&&I===VerticalAlign.MIDDLE&&(F+=U/2-measureTextHeight(m,$,D)/2);const j=(W=Object.entries(m.chars).find(Q=>Q[1].xadvance))==null?void 0:W[1].xadvance;if(typeof j!="number")throw new Error("Could not find default character width");const{lines:G,longestLine:H}=splitLines(m,$,D);return G.forEach(Q=>{const q=Q.join(" "),rt=xOffsetBasedOnAlignment(m,q,D,w);printText(d,m,P+rt,F,q,j),F+=m.common.lineHeight}),Z.bind(d)({x:P+H,y:F}),d}},RotateOptionsSchema=z.union([z.number(),z.object({deg:z.number(),mode:z.union([z.boolean(),z.nativeEnum(ResizeStrategy)]).optional()})]);function createIdxTranslationFunction(d){return function(m,g){return g*d+m<<2}}function matrixRotate(d,m){if(Math.abs(m)%90!=0)throw new Error("Unsupported matrix rotation degree");const g=d.bitmap.width,w=d.bitmap.height;let I;switch(m){case 90:case-270:I=90;break;case 180:case-180:I=180;break;case 270:case-90:I=-90;break;default:throw new Error("Unsupported matrix rotation degree")}const P=I===180?g:w,F=I===180?w:g,$=Buffer.alloc(d.bitmap.data.length),D=createIdxTranslationFunction(g),U=createIdxTranslationFunction(P);for(let Z=0;Z<g;Z++)for(let j=0;j<w;j++){const G=D(Z,j),H=d.bitmap.data.readUInt32BE(G);let W;switch(I){case 90:W=U(j,g-Z-1);break;case-90:W=U(w-j-1,Z);break;case 180:W=U(g-Z-1,w-j-1);break;default:throw new Error("Unsupported matrix rotation angle")}$.writeUInt32BE(H,W)}d.bitmap.data=$,d.bitmap.width=P,d.bitmap.height=F}function createTranslationFunction(d,m){return function(g,w){return{x:g+d,y:w+m}}}function advancedRotate(d,m,g){const w=m*Math.PI/180,I=Math.cos(w),P=Math.sin(w);let F=d.bitmap.width,$=d.bitmap.height;if(g===!0||typeof g=="string"){F=Math.ceil(Math.abs(d.bitmap.width*I)+Math.abs(d.bitmap.height*P))+1,$=Math.ceil(Math.abs(d.bitmap.width*P)+Math.abs(d.bitmap.height*I))+1,F%2!=0&&F++,$%2!=0&&$++;const H=clone(d);d.scan((Q,q,rt)=>{d.bitmap.data.writeUInt32BE(d.background,rt)});const W=Math.max(F,$,d.bitmap.width,d.bitmap.height);d=composite(d=methods$d.resize(d,{h:W,w:W,mode:g===!0?void 0:g}),H,d.bitmap.width/2-H.bitmap.width/2,d.bitmap.height/2-H.bitmap.height/2)}const D=d.bitmap.width,U=d.bitmap.height,Z=Buffer.alloc(d.bitmap.data.length),j=createTranslationFunction(-D/2,-U/2),G=createTranslationFunction(D/2+.5,U/2+.5);for(let H=1;H<=U;H++)for(let W=1;W<=D;W++){const Q=j(W,H),q=G(I*Q.x-P*Q.y,I*Q.y+P*Q.x),rt=D*(H-1)+W-1<<2;if(q.x>=0&&q.x<D&&q.y>=0&&q.y<U){const it=D*(0|q.y)+q.x<<2,X=d.bitmap.data.readUInt32BE(it);Z.writeUInt32BE(X,rt)}else Z.writeUInt32BE(d.background,rt)}if(d.bitmap.data=Z,g===!0||typeof g=="string"){const H=Math.max(D/2-F/2,0),W=Math.max(U/2-$/2,0);d=methods$b.crop(d,{x:H,y:W,w:F,h:$})}}const methods$2={rotate(d,m){const g=RotateOptionsSchema.parse(m),w=typeof g=="number"?{deg:g}:g,{mode:I=!0}=w;let{deg:P}=w;return P%=360,P%360==0||(P%90==0&&(I||d.bitmap.width===d.bitmap.height||P%180==0)?matrixRotate(d,P):advancedRotate(d,P,I)),d}},ThresholdOptionsSchema=z.object({max:z.number().min(0).max(255),replace:z.number().min(0).max(255).optional(),autoGreyscale:z.boolean().optional()}),methods$1={threshold(d,m){let{max:g,replace:w=255,autoGreyscale:I=!0}=ThresholdOptionsSchema.parse(m);return g=limit255(g),w=limit255(w),I&&methods$e.greyscale(d),d.scan((P,F,$)=>{const D=d.bitmap.data[$]<g?d.bitmap.data[$]:w;d.bitmap.data[$]=D,d.bitmap.data[$+1]=D,d.bitmap.data[$+2]=D}),d}};var __defProp=Object.defineProperty,__defNormalProp=(d,m,g)=>m in d?__defProp(d,m,{enumerable:!0,configurable:!0,writable:!0,value:g}):d[m]=g,__export=(d,m)=>{for(var g in m)__defProp(d,g,{get:m[g],enumerable:!0})},__publicField=(d,m,g)=>(__defNormalProp(d,typeof m!="symbol"?m+"":m,g),g),constants_exports={};__export(constants_exports,{bt709:()=>bt709_exports});var bt709_exports={};__export(bt709_exports,{Y:()=>Y,x:()=>x$1,y:()=>y$1});var Y=(d=>(d[d.RED=.2126]="RED",d[d.GREEN=.7152]="GREEN",d[d.BLUE=.0722]="BLUE",d[d.WHITE=1]="WHITE",d))(Y||{}),x$1=(d=>(d[d.RED=.64]="RED",d[d.GREEN=.3]="GREEN",d[d.BLUE=.15]="BLUE",d[d.WHITE=.3127]="WHITE",d))(x$1||{}),y$1=(d=>(d[d.RED=.33]="RED",d[d.GREEN=.6]="GREEN",d[d.BLUE=.06]="BLUE",d[d.WHITE=.329]="WHITE",d))(y$1||{}),conversion_exports={};function correctGamma(d){return d>.04045?((d+.055)/1.055)**2.4:d/12.92}function rgb2xyz(d,m,g){return{x:.4124*(d=correctGamma(d/255))+.3576*(m=correctGamma(m/255))+.1805*(g=correctGamma(g/255)),y:.2126*d+.7152*m+.0722*g,z:.0193*d+.1192*m+.9505*g}}__export(conversion_exports,{lab2rgb:()=>lab2rgb,lab2xyz:()=>lab2xyz,rgb2hsl:()=>rgb2hsl,rgb2lab:()=>rgb2lab,rgb2xyz:()=>rgb2xyz,xyz2lab:()=>xyz2lab,xyz2rgb:()=>xyz2rgb});var arithmetic_exports={};function degrees2radians(d){return d*(Math.PI/180)}function max3(d,m,g){let w=d;return w<m&&(w=m),w<g&&(w=g),w}function min3(d,m,g){let w=d;return w>m&&(w=m),w>g&&(w=g),w}function intInRange(d,m,g){return d>g&&(d=g),d<m&&(d=m),0|d}function inRange0to255Rounded(d){return(d=Math.round(d))>255?d=255:d<0&&(d=0),d}function inRange0to255(d){return d>255?d=255:d<0&&(d=0),d}function stableSort(d,m){const g=typeof d[0];let w;if(g==="number"||g==="string"){const I=Object.create(null);for(let P=0,F=d.length;P<F;P++){const $=d[P];I[$]||I[$]===0||(I[$]=P)}w=d.sort((P,F)=>m(P,F)||I[P]-I[F])}else{const I=d.slice(0);w=d.sort((P,F)=>m(P,F)||I.indexOf(P)-I.indexOf(F))}return w}function rgb2hsl(d,m,g){const w=min3(d,m,g),I=max3(d,m,g),P=I-w,F=(w+I)/510;let $=0;F>0&&F<1&&($=P/(F<.5?I+w:510-I-w));let D=0;return P>0&&(D=I===d?(m-g)/P:I===m?2+(g-d)/P:4+(d-m)/P,D*=60,D<0&&(D+=360)),{h:D,s:$,l:F}}__export(arithmetic_exports,{degrees2radians:()=>degrees2radians,inRange0to255:()=>inRange0to255,inRange0to255Rounded:()=>inRange0to255Rounded,intInRange:()=>intInRange,max3:()=>max3,min3:()=>min3,stableSort:()=>stableSort});var refX=.95047,refY=1,refZ=1.08883;function pivot(d){return d>.008856?d**(1/3):7.787*d+16/116}function xyz2lab(d,m,g){if(d=pivot(d/refX),m=pivot(m/refY),g=pivot(g/refZ),116*m-16<0)throw new Error("xxx");return{L:Math.max(0,116*m-16),a:500*(d-m),b:200*(m-g)}}function rgb2lab(d,m,g){const w=rgb2xyz(d,m,g);return xyz2lab(w.x,w.y,w.z)}var refX2=.95047,refY2=1,refZ2=1.08883;function pivot2(d){return d>.206893034?d**3:(d-16/116)/7.787}function lab2xyz(d,m,g){const w=(d+16)/116,I=w-g/200;return{x:refX2*pivot2(m/500+w),y:refY2*pivot2(w),z:refZ2*pivot2(I)}}function correctGamma2(d){return d>.0031308?1.055*d**(1/2.4)-.055:12.92*d}function xyz2rgb(d,m,g){const w=correctGamma2(3.2406*d+-1.5372*m+-.4986*g),I=correctGamma2(-.9689*d+1.8758*m+.0415*g),P=correctGamma2(.0557*d+-.204*m+1.057*g);return{r:inRange0to255Rounded(255*w),g:inRange0to255Rounded(255*I),b:inRange0to255Rounded(255*P)}}function lab2rgb(d,m,g){const w=lab2xyz(d,m,g);return xyz2rgb(w.x,w.y,w.z)}var distance_exports={};__export(distance_exports,{AbstractDistanceCalculator:()=>AbstractDistanceCalculator,AbstractEuclidean:()=>AbstractEuclidean,AbstractManhattan:()=>AbstractManhattan,CIE94GraphicArts:()=>CIE94GraphicArts,CIE94Textiles:()=>CIE94Textiles,CIEDE2000:()=>CIEDE2000,CMetric:()=>CMetric,Euclidean:()=>Euclidean,EuclideanBT709:()=>EuclideanBT709,EuclideanBT709NoAlpha:()=>EuclideanBT709NoAlpha,Manhattan:()=>Manhattan,ManhattanBT709:()=>ManhattanBT709,ManhattanNommyde:()=>ManhattanNommyde,PNGQuant:()=>PNGQuant});var AbstractDistanceCalculator=class{constructor(){__publicField(this,"_maxDistance"),__publicField(this,"_whitePoint"),this._setDefaults(),this.setWhitePoint(255,255,255,255)}setWhitePoint(d,m,g,w){this._whitePoint={r:d>0?255/d:0,g:m>0?255/m:0,b:g>0?255/g:0,a:w>0?255/w:0},this._maxDistance=this.calculateRaw(d,m,g,w,0,0,0,0)}calculateNormalized(d,m){return this.calculateRaw(d.r,d.g,d.b,d.a,m.r,m.g,m.b,m.a)/this._maxDistance}},AbstractCIE94=class extends AbstractDistanceCalculator{calculateRaw(d,m,g,w,I,P,F,$){const D=rgb2lab(inRange0to255(d*this._whitePoint.r),inRange0to255(m*this._whitePoint.g),inRange0to255(g*this._whitePoint.b)),U=rgb2lab(inRange0to255(I*this._whitePoint.r),inRange0to255(P*this._whitePoint.g),inRange0to255(F*this._whitePoint.b)),Z=D.L-U.L,j=D.a-U.a,G=D.b-U.b,H=Math.sqrt(D.a*D.a+D.b*D.b),W=H-Math.sqrt(U.a*U.a+U.b*U.b);let Q=j*j+G*G-W*W;Q=Q<0?0:Math.sqrt(Q);const q=($-w)*this._whitePoint.a*this._kA;return Math.sqrt((Z/this._Kl)**2+(W/(1+this._K1*H))**2+(Q/(1+this._K2*H))**2+q**2)}},CIE94Textiles=class extends AbstractCIE94{_setDefaults(){this._Kl=2,this._K1=.048,this._K2=.014,this._kA=12.5/255}},CIE94GraphicArts=class extends AbstractCIE94{_setDefaults(){this._Kl=1,this._K1=.045,this._K2=.015,this._kA=25/255}},_CIEDE2000=class extends AbstractDistanceCalculator{_setDefaults(){}static _calculatehp(d,m){const g=Math.atan2(d,m);return g>=0?g:g+_CIEDE2000._deg360InRad}static _calculateRT(d,m){const g=m**7,w=2*Math.sqrt(g/(g+_CIEDE2000._pow25to7)),I=_CIEDE2000._deg30InRad*Math.exp(-(((d-_CIEDE2000._deg275InRad)/_CIEDE2000._deg25InRad)**2));return-Math.sin(2*I)*w}static _calculateT(d){return 1-.17*Math.cos(d-_CIEDE2000._deg30InRad)+.24*Math.cos(2*d)+.32*Math.cos(3*d+_CIEDE2000._deg6InRad)-.2*Math.cos(4*d-_CIEDE2000._deg63InRad)}static _calculate_ahp(d,m,g,w){const I=g+w;return d===0?I:m<=_CIEDE2000._deg180InRad?I/2:I<_CIEDE2000._deg360InRad?(I+_CIEDE2000._deg360InRad)/2:(I-_CIEDE2000._deg360InRad)/2}static _calculate_dHp(d,m,g,w){let I;return I=d===0?0:m<=_CIEDE2000._deg180InRad?g-w:g<=w?g-w+_CIEDE2000._deg360InRad:g-w-_CIEDE2000._deg360InRad,2*Math.sqrt(d)*Math.sin(I/2)}calculateRaw(d,m,g,w,I,P,F,$){const D=rgb2lab(inRange0to255(d*this._whitePoint.r),inRange0to255(m*this._whitePoint.g),inRange0to255(g*this._whitePoint.b)),U=rgb2lab(inRange0to255(I*this._whitePoint.r),inRange0to255(P*this._whitePoint.g),inRange0to255(F*this._whitePoint.b)),Z=($-w)*this._whitePoint.a*_CIEDE2000._kA,j=this.calculateRawInLab(D,U);return Math.sqrt(j+Z*Z)}calculateRawInLab(d,m){const g=d.L,w=d.a,I=d.b,P=m.L,F=m.a,$=m.b,D=((Math.sqrt(w*w+I*I)+Math.sqrt(F*F+$*$))/2)**7,U=.5*(1-Math.sqrt(D/(D+_CIEDE2000._pow25to7))),Z=(1+U)*w,j=(1+U)*F,G=Math.sqrt(Z*Z+I*I),H=Math.sqrt(j*j+$*$),W=G*H,Q=_CIEDE2000._calculatehp(I,Z),q=_CIEDE2000._calculatehp($,j),rt=Math.abs(Q-q),it=P-g,X=H-G,J=_CIEDE2000._calculate_dHp(W,rt,q,Q),tt=_CIEDE2000._calculate_ahp(W,rt,Q,q),ot=(G+H)/2,nt=((g+P)/2-50)**2,lt=X/(1+.045*ot),at=J/(1+.015*_CIEDE2000._calculateT(tt)*ot);return(it/(1+.015*nt/Math.sqrt(20+nt)))**2+lt**2+at**2+_CIEDE2000._calculateRT(tt,ot)*lt*at}},CIEDE2000=_CIEDE2000;__publicField(CIEDE2000,"_kA",25/255),__publicField(CIEDE2000,"_pow25to7",25**7),__publicField(CIEDE2000,"_deg360InRad",degrees2radians(360)),__publicField(CIEDE2000,"_deg180InRad",degrees2radians(180)),__publicField(CIEDE2000,"_deg30InRad",degrees2radians(30)),__publicField(CIEDE2000,"_deg6InRad",degrees2radians(6)),__publicField(CIEDE2000,"_deg63InRad",degrees2radians(63)),__publicField(CIEDE2000,"_deg275InRad",degrees2radians(275)),__publicField(CIEDE2000,"_deg25InRad",degrees2radians(25));var CMetric=class extends AbstractDistanceCalculator{calculateRaw(d,m,g,w,I,P,F,$){const D=(d+I)/2*this._whitePoint.r,U=(d-I)*this._whitePoint.r,Z=(m-P)*this._whitePoint.g,j=(g-F)*this._whitePoint.b,G=((512+D)*U*U>>8)+4*Z*Z+((767-D)*j*j>>8),H=($-w)*this._whitePoint.a;return Math.sqrt(G+H*H)}_setDefaults(){}},AbstractEuclidean=class extends AbstractDistanceCalculator{calculateRaw(d,m,g,w,I,P,F,$){const D=I-d,U=P-m,Z=F-g,j=$-w;return Math.sqrt(this._kR*D*D+this._kG*U*U+this._kB*Z*Z+this._kA*j*j)}},Euclidean=class extends AbstractEuclidean{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},EuclideanBT709=class extends AbstractEuclidean{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},EuclideanBT709NoAlpha=class extends AbstractEuclidean{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=0}},AbstractManhattan=class extends AbstractDistanceCalculator{calculateRaw(d,m,g,w,I,P,F,$){let D=I-d,U=P-m,Z=F-g,j=$-w;return D<0&&(D=0-D),U<0&&(U=0-U),Z<0&&(Z=0-Z),j<0&&(j=0-j),this._kR*D+this._kG*U+this._kB*Z+this._kA*j}},Manhattan=class extends AbstractManhattan{_setDefaults(){this._kR=1,this._kG=1,this._kB=1,this._kA=1}},ManhattanNommyde=class extends AbstractManhattan{_setDefaults(){this._kR=.4984,this._kG=.8625,this._kB=.2979,this._kA=1}},ManhattanBT709=class extends AbstractManhattan{_setDefaults(){this._kR=.2126,this._kG=.7152,this._kB=.0722,this._kA=1}},PNGQuant=class extends AbstractDistanceCalculator{calculateRaw(d,m,g,w,I,P,F,$){const D=($-w)*this._whitePoint.a;return this._colordifferenceCh(d*this._whitePoint.r,I*this._whitePoint.r,D)+this._colordifferenceCh(m*this._whitePoint.g,P*this._whitePoint.g,D)+this._colordifferenceCh(g*this._whitePoint.b,F*this._whitePoint.b,D)}_colordifferenceCh(d,m,g){const w=d-m,I=w+g;return w*w+I*I}_setDefaults(){}},palette_exports={};__export(palette_exports,{AbstractPaletteQuantizer:()=>AbstractPaletteQuantizer,ColorHistogram:()=>ColorHistogram,NeuQuant:()=>NeuQuant,NeuQuantFloat:()=>NeuQuantFloat,RGBQuant:()=>RGBQuant,WuColorCube:()=>WuColorCube,WuQuant:()=>WuQuant});var AbstractPaletteQuantizer=class{quantizeSync(){for(const d of this.quantize())if(d.palette)return d.palette;throw new Error("unreachable")}},Point=class{constructor(){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),__publicField(this,"uint32"),__publicField(this,"rgba"),this.uint32=-1>>>0,this.r=this.g=this.b=this.a=0,this.rgba=new Array(4),this.rgba[0]=0,this.rgba[1]=0,this.rgba[2]=0,this.rgba[3]=0}static createByQuadruplet(d){const m=new Point;return m.r=0|d[0],m.g=0|d[1],m.b=0|d[2],m.a=0|d[3],m._loadUINT32(),m._loadQuadruplet(),m}static createByRGBA(d,m,g,w){const I=new Point;return I.r=0|d,I.g=0|m,I.b=0|g,I.a=0|w,I._loadUINT32(),I._loadQuadruplet(),I}static createByUint32(d){const m=new Point;return m.uint32=d>>>0,m._loadRGBA(),m._loadQuadruplet(),m}from(d){this.r=d.r,this.g=d.g,this.b=d.b,this.a=d.a,this.uint32=d.uint32,this.rgba[0]=d.r,this.rgba[1]=d.g,this.rgba[2]=d.b,this.rgba[3]=d.a}getLuminosity(d){let m=this.r,g=this.g,w=this.b;return d&&(m=Math.min(255,255-this.a+this.a*m/255),g=Math.min(255,255-this.a+this.a*g/255),w=Math.min(255,255-this.a+this.a*w/255)),.2126*m+.7152*g+.0722*w}_loadUINT32(){this.uint32=(this.a<<24|this.b<<16|this.g<<8|this.r)>>>0}_loadRGBA(){this.r=255&this.uint32,this.g=this.uint32>>>8&255,this.b=this.uint32>>>16&255,this.a=this.uint32>>>24&255}_loadQuadruplet(){this.rgba[0]=this.r,this.rgba[1]=this.g,this.rgba[2]=this.b,this.rgba[3]=this.a}},PointContainer=class{constructor(){__publicField(this,"_pointArray"),__publicField(this,"_width"),__publicField(this,"_height"),this._width=0,this._height=0,this._pointArray=[]}getWidth(){return this._width}getHeight(){return this._height}setWidth(d){this._width=d}setHeight(d){this._height=d}getPointArray(){return this._pointArray}clone(){const d=new PointContainer;d._width=this._width,d._height=this._height;for(let m=0,g=this._pointArray.length;m<g;m++)d._pointArray[m]=Point.createByUint32(0|this._pointArray[m].uint32);return d}toUint32Array(){const d=this._pointArray.length,m=new Uint32Array(d);for(let g=0;g<d;g++)m[g]=this._pointArray[g].uint32;return m}toUint8Array(){return new Uint8Array(this.toUint32Array().buffer)}static fromHTMLImageElement(d){const m=d.naturalWidth,g=d.naturalHeight,w=document.createElement("canvas");return w.width=m,w.height=g,w.getContext("2d").drawImage(d,0,0,m,g,0,0,m,g),PointContainer.fromHTMLCanvasElement(w)}static fromHTMLCanvasElement(d){const m=d.width,g=d.height,w=d.getContext("2d").getImageData(0,0,m,g);return PointContainer.fromImageData(w)}static fromImageData(d){const m=d.width,g=d.height;return PointContainer.fromUint8Array(d.data,m,g)}static fromUint8Array(d,m,g){switch(Object.prototype.toString.call(d)){case"[object Uint8ClampedArray]":case"[object Uint8Array]":break;default:d=new Uint8Array(d)}const w=new Uint32Array(d.buffer);return PointContainer.fromUint32Array(w,m,g)}static fromUint32Array(d,m,g){const w=new PointContainer;w._width=m,w._height=g;for(let I=0,P=d.length;I<P;I++)w._pointArray[I]=Point.createByUint32(0|d[I]);return w}static fromBuffer(d,m,g){const w=new Uint32Array(d.buffer,d.byteOffset,d.byteLength/Uint32Array.BYTES_PER_ELEMENT);return PointContainer.fromUint32Array(w,m,g)}},hueGroups=10;function hueGroup(d,m){const g=360/m;for(let w=1,I=g-g/2;w<m;w++,I+=g)if(d>=I&&d<I+g)return w;return 0}var Palette=class{constructor(){__publicField(this,"_pointContainer"),__publicField(this,"_pointArray",[]),__publicField(this,"_i32idx",{}),this._pointContainer=new PointContainer,this._pointContainer.setHeight(1),this._pointArray=this._pointContainer.getPointArray()}add(d){this._pointArray.push(d),this._pointContainer.setWidth(this._pointArray.length)}has(d){for(let m=this._pointArray.length-1;m>=0;m--)if(d.uint32===this._pointArray[m].uint32)return!0;return!1}getNearestColor(d,m){return this._pointArray[0|this._getNearestIndex(d,m)]}getPointContainer(){return this._pointContainer}_nearestPointFromCache(d){return typeof this._i32idx[d]=="number"?this._i32idx[d]:-1}_getNearestIndex(d,m){let g=this._nearestPointFromCache(""+m.uint32);if(g>=0)return g;let w=Number.MAX_VALUE;g=0;for(let I=0,P=this._pointArray.length;I<P;I++){const F=this._pointArray[I],$=d.calculateRaw(m.r,m.g,m.b,m.a,F.r,F.g,F.b,F.a);$<w&&(w=$,g=I)}return this._i32idx[m.uint32]=g,g}sort(){this._i32idx={},this._pointArray.sort((d,m)=>{const g=rgb2hsl(d.r,d.g,d.b),w=rgb2hsl(m.r,m.g,m.b),I=d.r===d.g&&d.g===d.b?0:1+hueGroup(g.h,hueGroups),P=(m.r===m.g&&m.g===m.b?0:1+hueGroup(w.h,hueGroups))-I;if(P)return-P;const F=d.getLuminosity(!0),$=m.getLuminosity(!0);if($-F!=0)return $-F;const D=(100*w.s|0)-(100*g.s|0);return D?-D:0})}},utils_exports={};__export(utils_exports,{HueStatistics:()=>HueStatistics,Palette:()=>Palette,Point:()=>Point,PointContainer:()=>PointContainer,ProgressTracker:()=>ProgressTracker,arithmetic:()=>arithmetic_exports});var HueGroup=class{constructor(){__publicField(this,"num",0),__publicField(this,"cols",[])}},HueStatistics=class{constructor(d,m){__publicField(this,"_numGroups"),__publicField(this,"_minCols"),__publicField(this,"_stats"),__publicField(this,"_groupsFull"),this._numGroups=d,this._minCols=m,this._stats=[];for(let g=0;g<=d;g++)this._stats[g]=new HueGroup;this._groupsFull=0}check(d){this._groupsFull===this._numGroups+1&&(this.check=()=>{});const m=255&d,g=d>>>8&255,w=d>>>16&255,I=m===g&&g===w?0:1+hueGroup(rgb2hsl(m,g,w).h,this._numGroups),P=this._stats[I],F=this._minCols;P.num++,P.num>F||(P.num===F&&this._groupsFull++,P.num<=F&&this._stats[I].cols.push(d))}injectIntoDictionary(d){for(let m=0;m<=this._numGroups;m++)this._stats[m].num<=this._minCols&&this._stats[m].cols.forEach(g=>{d[g]?d[g]++:d[g]=1})}injectIntoArray(d){for(let m=0;m<=this._numGroups;m++)this._stats[m].num<=this._minCols&&this._stats[m].cols.forEach(g=>{d.indexOf(g)===-1&&d.push(g)})}},_ProgressTracker=class{constructor(d,m){__publicField(this,"progress"),__publicField(this,"_step"),__publicField(this,"_range"),__publicField(this,"_last"),__publicField(this,"_progressRange"),this._range=d,this._progressRange=m,this._step=Math.max(1,this._range/(_ProgressTracker.steps+1)|0),this._last=-this._step,this.progress=0}shouldNotify(d){return d-this._last>=this._step&&(this._last=d,this.progress=Math.min(this._progressRange*this._last/this._range,this._progressRange),!0)}},ProgressTracker=_ProgressTracker;__publicField(ProgressTracker,"steps",100);var networkBiasShift=3,Neuron=class{constructor(d){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),this.r=this.g=this.b=this.a=d}toPoint(){return Point.createByRGBA(this.r>>networkBiasShift,this.g>>networkBiasShift,this.b>>networkBiasShift,this.a>>networkBiasShift)}subtract(d,m,g,w){this.r-=0|d,this.g-=0|m,this.b-=0|g,this.a-=0|w}},_NeuQuant=class extends AbstractPaletteQuantizer{constructor(d,m=256){super(),__publicField(this,"_pointArray"),__publicField(this,"_networkSize"),__publicField(this,"_network"),__publicField(this,"_sampleFactor"),__publicField(this,"_radPower"),__publicField(this,"_freq"),__publicField(this,"_bias"),__publicField(this,"_distance"),this._distance=d,this._pointArray=[],this._sampleFactor=1,this._networkSize=m,this._distance.setWhitePoint(255<<networkBiasShift,255<<networkBiasShift,255<<networkBiasShift,255<<networkBiasShift)}sample(d){this._pointArray=this._pointArray.concat(d.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let d=0;d<this._networkSize;d++)this._network[d]=new Neuron((d<<networkBiasShift+8)/this._networkSize|0),this._freq[d]=_NeuQuant._initialBias/this._networkSize|0,this._bias[d]=0}*_learn(){let d=this._sampleFactor;const m=this._pointArray.length;m<_NeuQuant._minpicturebytes&&(d=1);const g=30+(d-1)/3|0,w=m/d|0;let I,P=w/_NeuQuant._nCycles|0,F=_NeuQuant._initAlpha,$=(this._networkSize>>3)*_NeuQuant._radiusBias,D=$>>_NeuQuant._radiusBiasShift;D<=1&&(D=0);for(let Z=0;Z<D;Z++)this._radPower[Z]=F*((D*D-Z*Z)*_NeuQuant._radBias/(D*D))>>>0;I=m<_NeuQuant._minpicturebytes?1:m%_NeuQuant._prime1!=0?_NeuQuant._prime1:m%_NeuQuant._prime2!=0?_NeuQuant._prime2:m%_NeuQuant._prime3!=0?_NeuQuant._prime3:_NeuQuant._prime4;const U=new ProgressTracker(w,99);for(let Z=0,j=0;Z<w;){U.shouldNotify(Z)&&(yield{progress:U.progress});const G=this._pointArray[j],H=G.b<<networkBiasShift,W=G.g<<networkBiasShift,Q=G.r<<networkBiasShift,q=G.a<<networkBiasShift,rt=this._contest(H,W,Q,q);if(this._alterSingle(F,rt,H,W,Q,q),D!==0&&this._alterNeighbour(D,rt,H,W,Q,q),j+=I,j>=m&&(j-=m),Z++,P===0&&(P=1),Z%P==0){F-=F/g|0,$-=$/_NeuQuant._radiusDecrease|0,D=$>>_NeuQuant._radiusBiasShift,D<=1&&(D=0);for(let it=0;it<D;it++)this._radPower[it]=F*((D*D-it*it)*_NeuQuant._radBias/(D*D))>>>0}}}_buildPalette(){const d=new Palette;return this._network.forEach(m=>{d.add(m.toPoint())}),d.sort(),d}_alterNeighbour(d,m,g,w,I,P){let F=m-d;F<-1&&(F=-1);let $=m+d;$>this._networkSize&&($=this._networkSize);let D=m+1,U=m-1,Z=1;for(;D<$||U>F;){const j=this._radPower[Z++]/_NeuQuant._alphaRadBias;if(D<$){const G=this._network[D++];G.subtract(j*(G.r-I),j*(G.g-w),j*(G.b-g),j*(G.a-P))}if(U>F){const G=this._network[U--];G.subtract(j*(G.r-I),j*(G.g-w),j*(G.b-g),j*(G.a-P))}}}_alterSingle(d,m,g,w,I,P){d/=_NeuQuant._initAlpha;const F=this._network[m];F.subtract(d*(F.r-I),d*(F.g-w),d*(F.b-g),d*(F.a-P))}_contest(d,m,g,w){const I=1020<<networkBiasShift;let P=2147483647,F=P,$=-1,D=$;for(let U=0;U<this._networkSize;U++){const Z=this._network[U],j=this._distance.calculateNormalized(Z,{r:g,g:m,b:d,a:w})*I|0;j<P&&(P=j,$=U);const G=j-(this._bias[U]>>_NeuQuant._initialBiasShift-networkBiasShift);G<F&&(F=G,D=U);const H=this._freq[U]>>_NeuQuant._betaShift;this._freq[U]-=H,this._bias[U]+=H<<_NeuQuant._gammaShift}return this._freq[$]+=_NeuQuant._beta,this._bias[$]-=_NeuQuant._betaGamma,D}},NeuQuant=_NeuQuant;__publicField(NeuQuant,"_prime1",499),__publicField(NeuQuant,"_prime2",491),__publicField(NeuQuant,"_prime3",487),__publicField(NeuQuant,"_prime4",503),__publicField(NeuQuant,"_minpicturebytes",_NeuQuant._prime4),__publicField(NeuQuant,"_nCycles",100),__publicField(NeuQuant,"_initialBiasShift",16),__publicField(NeuQuant,"_initialBias",1<<_NeuQuant._initialBiasShift),__publicField(NeuQuant,"_gammaShift",10),__publicField(NeuQuant,"_betaShift",10),__publicField(NeuQuant,"_beta",_NeuQuant._initialBias>>_NeuQuant._betaShift),__publicField(NeuQuant,"_betaGamma",_NeuQuant._initialBias<<_NeuQuant._gammaShift-_NeuQuant._betaShift),__publicField(NeuQuant,"_radiusBiasShift",6),__publicField(NeuQuant,"_radiusBias",1<<_NeuQuant._radiusBiasShift),__publicField(NeuQuant,"_radiusDecrease",30),__publicField(NeuQuant,"_alphaBiasShift",10),__publicField(NeuQuant,"_initAlpha",1<<_NeuQuant._alphaBiasShift),__publicField(NeuQuant,"_radBiasShift",8),__publicField(NeuQuant,"_radBias",1<<_NeuQuant._radBiasShift),__publicField(NeuQuant,"_alphaRadBiasShift",_NeuQuant._alphaBiasShift+_NeuQuant._radBiasShift),__publicField(NeuQuant,"_alphaRadBias",1<<_NeuQuant._alphaRadBiasShift);var networkBiasShift2=3,NeuronFloat=class{constructor(d){__publicField(this,"r"),__publicField(this,"g"),__publicField(this,"b"),__publicField(this,"a"),this.r=this.g=this.b=this.a=d}toPoint(){return Point.createByRGBA(this.r>>networkBiasShift2,this.g>>networkBiasShift2,this.b>>networkBiasShift2,this.a>>networkBiasShift2)}subtract(d,m,g,w){this.r-=d,this.g-=m,this.b-=g,this.a-=w}},_NeuQuantFloat=class extends AbstractPaletteQuantizer{constructor(d,m=256){super(),__publicField(this,"_pointArray"),__publicField(this,"_networkSize"),__publicField(this,"_network"),__publicField(this,"_sampleFactor"),__publicField(this,"_radPower"),__publicField(this,"_freq"),__publicField(this,"_bias"),__publicField(this,"_distance"),this._distance=d,this._pointArray=[],this._sampleFactor=1,this._networkSize=m,this._distance.setWhitePoint(255<<networkBiasShift2,255<<networkBiasShift2,255<<networkBiasShift2,255<<networkBiasShift2)}sample(d){this._pointArray=this._pointArray.concat(d.getPointArray())}*quantize(){this._init(),yield*this._learn(),yield{palette:this._buildPalette(),progress:100}}_init(){this._freq=[],this._bias=[],this._radPower=[],this._network=[];for(let d=0;d<this._networkSize;d++)this._network[d]=new NeuronFloat((d<<networkBiasShift2+8)/this._networkSize),this._freq[d]=_NeuQuantFloat._initialBias/this._networkSize,this._bias[d]=0}*_learn(){let d=this._sampleFactor;const m=this._pointArray.length;m<_NeuQuantFloat._minpicturebytes&&(d=1);const g=30+(d-1)/3,w=m/d;let I,P=w/_NeuQuantFloat._nCycles|0,F=_NeuQuantFloat._initAlpha,$=(this._networkSize>>3)*_NeuQuantFloat._radiusBias,D=$>>_NeuQuantFloat._radiusBiasShift;D<=1&&(D=0);for(let Z=0;Z<D;Z++)this._radPower[Z]=F*((D*D-Z*Z)*_NeuQuantFloat._radBias/(D*D));I=m<_NeuQuantFloat._minpicturebytes?1:m%_NeuQuantFloat._prime1!=0?_NeuQuantFloat._prime1:m%_NeuQuantFloat._prime2!=0?_NeuQuantFloat._prime2:m%_NeuQuantFloat._prime3!=0?_NeuQuantFloat._prime3:_NeuQuantFloat._prime4;const U=new ProgressTracker(w,99);for(let Z=0,j=0;Z<w;){U.shouldNotify(Z)&&(yield{progress:U.progress});const G=this._pointArray[j],H=G.b<<networkBiasShift2,W=G.g<<networkBiasShift2,Q=G.r<<networkBiasShift2,q=G.a<<networkBiasShift2,rt=this._contest(H,W,Q,q);if(this._alterSingle(F,rt,H,W,Q,q),D!==0&&this._alterNeighbour(D,rt,H,W,Q,q),j+=I,j>=m&&(j-=m),Z++,P===0&&(P=1),Z%P==0){F-=F/g,$-=$/_NeuQuantFloat._radiusDecrease,D=$>>_NeuQuantFloat._radiusBiasShift,D<=1&&(D=0);for(let it=0;it<D;it++)this._radPower[it]=F*((D*D-it*it)*_NeuQuantFloat._radBias/(D*D))}}}_buildPalette(){const d=new Palette;return this._network.forEach(m=>{d.add(m.toPoint())}),d.sort(),d}_alterNeighbour(d,m,g,w,I,P){let F=m-d;F<-1&&(F=-1);let $=m+d;$>this._networkSize&&($=this._networkSize);let D=m+1,U=m-1,Z=1;for(;D<$||U>F;){const j=this._radPower[Z++]/_NeuQuantFloat._alphaRadBias;if(D<$){const G=this._network[D++];G.subtract(j*(G.r-I),j*(G.g-w),j*(G.b-g),j*(G.a-P))}if(U>F){const G=this._network[U--];G.subtract(j*(G.r-I),j*(G.g-w),j*(G.b-g),j*(G.a-P))}}}_alterSingle(d,m,g,w,I,P){d/=_NeuQuantFloat._initAlpha;const F=this._network[m];F.subtract(d*(F.r-I),d*(F.g-w),d*(F.b-g),d*(F.a-P))}_contest(d,m,g,w){const I=1020<<networkBiasShift2;let P=2147483647,F=P,$=-1,D=$;for(let U=0;U<this._networkSize;U++){const Z=this._network[U],j=this._distance.calculateNormalized(Z,{r:g,g:m,b:d,a:w})*I;j<P&&(P=j,$=U);const G=j-(this._bias[U]>>_NeuQuantFloat._initialBiasShift-networkBiasShift2);G<F&&(F=G,D=U);const H=this._freq[U]>>_NeuQuantFloat._betaShift;this._freq[U]-=H,this._bias[U]+=H<<_NeuQuantFloat._gammaShift}return this._freq[$]+=_NeuQuantFloat._beta,this._bias[$]-=_NeuQuantFloat._betaGamma,D}},NeuQuantFloat=_NeuQuantFloat;__publicField(NeuQuantFloat,"_prime1",499),__publicField(NeuQuantFloat,"_prime2",491),__publicField(NeuQuantFloat,"_prime3",487),__publicField(NeuQuantFloat,"_prime4",503),__publicField(NeuQuantFloat,"_minpicturebytes",_NeuQuantFloat._prime4),__publicField(NeuQuantFloat,"_nCycles",100),__publicField(NeuQuantFloat,"_initialBiasShift",16),__publicField(NeuQuantFloat,"_initialBias",1<<_NeuQuantFloat._initialBiasShift),__publicField(NeuQuantFloat,"_gammaShift",10),__publicField(NeuQuantFloat,"_betaShift",10),__publicField(NeuQuantFloat,"_beta",_NeuQuantFloat._initialBias>>_NeuQuantFloat._betaShift),__publicField(NeuQuantFloat,"_betaGamma",_NeuQuantFloat._initialBias<<_NeuQuantFloat._gammaShift-_NeuQuantFloat._betaShift),__publicField(NeuQuantFloat,"_radiusBiasShift",6),__publicField(NeuQuantFloat,"_radiusBias",1<<_NeuQuantFloat._radiusBiasShift),__publicField(NeuQuantFloat,"_radiusDecrease",30),__publicField(NeuQuantFloat,"_alphaBiasShift",10),__publicField(NeuQuantFloat,"_initAlpha",1<<_NeuQuantFloat._alphaBiasShift),__publicField(NeuQuantFloat,"_radBiasShift",8),__publicField(NeuQuantFloat,"_radBias",1<<_NeuQuantFloat._radBiasShift),__publicField(NeuQuantFloat,"_alphaRadBiasShift",_NeuQuantFloat._alphaBiasShift+_NeuQuantFloat._radBiasShift),__publicField(NeuQuantFloat,"_alphaRadBias",1<<_NeuQuantFloat._alphaRadBiasShift);var _ColorHistogram=class{constructor(d,m){__publicField(this,"_method"),__publicField(this,"_hueStats"),__publicField(this,"_histogram"),__publicField(this,"_initColors"),__publicField(this,"_minHueCols"),this._method=d,this._minHueCols=m<<2,this._initColors=m<<2,this._hueStats=new HueStatistics(_ColorHistogram._hueGroups,this._minHueCols),this._histogram=Object.create(null)}sample(d){switch(this._method){case 1:this._colorStats1D(d);break;case 2:this._colorStats2D(d)}}getImportanceSortedColorsIDXI32(){const d=stableSort(Object.keys(this._histogram),(g,w)=>this._histogram[w]-this._histogram[g]);if(d.length===0)return[];let m;switch(this._method){case 1:const g=Math.min(d.length,this._initColors),w=d[g-1],I=this._histogram[w];m=d.slice(0,g);let P=g;const F=d.length;for(;P<F&&this._histogram[d[P]]===I;)m.push(d[P++]);this._hueStats.injectIntoArray(m);break;case 2:m=d;break;default:throw new Error("Incorrect method")}return m.map(g=>+g)}_colorStats1D(d){const m=this._histogram,g=d.getPointArray(),w=g.length;for(let I=0;I<w;I++){const P=g[I].uint32;this._hueStats.check(P),P in m?m[P]++:m[P]=1}}_colorStats2D(d){const m=d.getWidth(),g=d.getHeight(),w=d.getPointArray(),I=_ColorHistogram._boxSize[0],P=_ColorHistogram._boxSize[1],F=I*P,$=this._makeBoxes(m,g,I,P),D=this._histogram;$.forEach(U=>{let Z=Math.round(U.w*U.h/F)*_ColorHistogram._boxPixels;Z<2&&(Z=2);const j={};this._iterateBox(U,m,G=>{const H=w[G].uint32;this._hueStats.check(H),H in D?D[H]++:H in j?++j[H]>=Z&&(D[H]=j[H]):j[H]=1})}),this._hueStats.injectIntoDictionary(D)}_iterateBox(d,m,g){const w=d,I=w.y*m+w.x,P=(w.y+w.h-1)*m+(w.x+w.w-1),F=m-w.w+1;let $=0,D=I;do g.call(this,D),D+=++$%w.w==0?F:1;while(D<=P)}_makeBoxes(d,m,g,w){const I=d%g,P=m%w,F=d-I,$=m-P,D=[];for(let U=0;U<m;U+=w)for(let Z=0;Z<d;Z+=g)D.push({x:Z,y:U,w:Z===F?I:g,h:U===$?P:w});return D}},ColorHistogram=_ColorHistogram;__publicField(ColorHistogram,"_boxSize",[64,64]),__publicField(ColorHistogram,"_boxPixels",2),__publicField(ColorHistogram,"_hueGroups",10);var RemovedColor=class{constructor(d,m,g){__publicField(this,"index"),__publicField(this,"color"),__publicField(this,"distance"),this.index=d,this.color=m,this.distance=g}},RGBQuant=class extends AbstractPaletteQuantizer{constructor(d,m=256,g=2){super(),__publicField(this,"_colors"),__publicField(this,"_initialDistance"),__publicField(this,"_distanceIncrement"),__publicField(this,"_histogram"),__publicField(this,"_distance"),this._distance=d,this._colors=m,this._histogram=new ColorHistogram(g,m),this._initialDistance=.01,this._distanceIncrement=.005}sample(d){this._histogram.sample(d)}*quantize(){const d=this._histogram.getImportanceSortedColorsIDXI32();if(d.length===0)throw new Error("No colors in image");yield*this._buildPalette(d)}*_buildPalette(d){const m=new Palette,g=m.getPointContainer().getPointArray(),w=new Array(d.length);for(let Z=0;Z<d.length;Z++)g.push(Point.createByUint32(d[Z])),w[Z]=1;const I=g.length,P=[];let F=I,$=this._initialDistance;const D=new ProgressTracker(F-this._colors,99);for(;F>this._colors;){P.length=0;for(let Z=0;Z<I;Z++){if(D.shouldNotify(I-F)&&(yield{progress:D.progress}),w[Z]===0)continue;const j=g[Z];for(let G=Z+1;G<I;G++){if(w[G]===0)continue;const H=g[G],W=this._distance.calculateNormalized(j,H);W<$&&(P.push(new RemovedColor(G,H,W)),w[G]=0,F--)}}$+=F>3*this._colors?this._initialDistance:this._distanceIncrement}if(F<this._colors){stableSort(P,(j,G)=>G.distance-j.distance);let Z=0;for(;F<this._colors&&Z<P.length;)w[P[Z].index]=1,F++,Z++}let U=g.length;for(let Z=U-1;Z>=0;Z--)w[Z]===0&&(Z!==U-1&&(g[Z]=g[U-1]),--U);g.length=U,m.sort(),yield{palette:m,progress:100}}};function createArray1D(d){const m=[];for(let g=0;g<d;g++)m[g]=0;return m}function createArray4D(d,m,g,w){const I=new Array(d);for(let P=0;P<d;P++){I[P]=new Array(m);for(let F=0;F<m;F++){I[P][F]=new Array(g);for(let $=0;$<g;$++){I[P][F][$]=new Array(w);for(let D=0;D<w;D++)I[P][F][$][D]=0}}}return I}function createArray3D(d,m,g){const w=new Array(d);for(let I=0;I<d;I++){w[I]=new Array(m);for(let P=0;P<m;P++){w[I][P]=new Array(g);for(let F=0;F<g;F++)w[I][P][F]=0}}return w}function fillArray3D(d,m,g,w,I){for(let P=0;P<m;P++){d[P]=[];for(let F=0;F<g;F++){d[P][F]=[];for(let $=0;$<w;$++)d[P][F][$]=I}}}function fillArray1D(d,m,g){for(let w=0;w<m;w++)d[w]=g}var WuColorCube=class{constructor(){__publicField(this,"redMinimum"),__publicField(this,"redMaximum"),__publicField(this,"greenMinimum"),__publicField(this,"greenMaximum"),__publicField(this,"blueMinimum"),__publicField(this,"blueMaximum"),__publicField(this,"volume"),__publicField(this,"alphaMinimum"),__publicField(this,"alphaMaximum")}},_WuQuant=class extends AbstractPaletteQuantizer{constructor(d,m=256,g=5){super(),__publicField(this,"_reds"),__publicField(this,"_greens"),__publicField(this,"_blues"),__publicField(this,"_alphas"),__publicField(this,"_sums"),__publicField(this,"_weights"),__publicField(this,"_momentsRed"),__publicField(this,"_momentsGreen"),__publicField(this,"_momentsBlue"),__publicField(this,"_momentsAlpha"),__publicField(this,"_moments"),__publicField(this,"_table"),__publicField(this,"_pixels"),__publicField(this,"_cubes"),__publicField(this,"_colors"),__publicField(this,"_significantBitsPerChannel"),__publicField(this,"_maxSideIndex"),__publicField(this,"_alphaMaxSideIndex"),__publicField(this,"_sideSize"),__publicField(this,"_alphaSideSize"),__publicField(this,"_distance"),this._distance=d,this._setQuality(g),this._initialize(m)}sample(d){const m=d.getPointArray();for(let g=0,w=m.length;g<w;g++)this._addColor(m[g]);this._pixels=this._pixels.concat(m)}*quantize(){yield*this._preparePalette();const d=new Palette;for(let m=0;m<this._colors;m++)if(this._sums[m]>0){const g=this._sums[m],w=this._reds[m]/g,I=this._greens[m]/g,P=this._blues[m]/g,F=this._alphas[m]/g,$=Point.createByRGBA(0|w,0|I,0|P,0|F);d.add($)}d.sort(),yield{palette:d,progress:100}}*_preparePalette(){yield*this._calculateMoments();let d=0;const m=createArray1D(this._colors);for(let F=1;F<this._colors;++F){this._cut(this._cubes[d],this._cubes[F])?(m[d]=this._cubes[d].volume>1?this._calculateVariance(this._cubes[d]):0,m[F]=this._cubes[F].volume>1?this._calculateVariance(this._cubes[F]):0):(m[d]=0,F--),d=0;let $=m[0];for(let D=1;D<=F;++D)m[D]>$&&($=m[D],d=D);if($<=0){this._colors=F+1;break}}const g=[],w=[],I=[],P=[];for(let F=0;F<this._colors;++F){const $=_WuQuant._volume(this._cubes[F],this._weights);$>0?(g[F]=_WuQuant._volume(this._cubes[F],this._momentsRed)/$|0,w[F]=_WuQuant._volume(this._cubes[F],this._momentsGreen)/$|0,I[F]=_WuQuant._volume(this._cubes[F],this._momentsBlue)/$|0,P[F]=_WuQuant._volume(this._cubes[F],this._momentsAlpha)/$|0):(g[F]=0,w[F]=0,I[F]=0,P[F]=0)}this._reds=createArray1D(this._colors+1),this._greens=createArray1D(this._colors+1),this._blues=createArray1D(this._colors+1),this._alphas=createArray1D(this._colors+1),this._sums=createArray1D(this._colors+1);for(let F=0,$=this._pixels.length;F<$;F++){const D=this._pixels[F];let U=-1,Z=Number.MAX_VALUE;for(let j=0;j<this._colors;j++){const G=g[j],H=w[j],W=I[j],Q=P[j],q=this._distance.calculateRaw(G,H,W,Q,D.r,D.g,D.b,D.a);q<Z&&(Z=q,U=j)}this._reds[U]+=D.r,this._greens[U]+=D.g,this._blues[U]+=D.b,this._alphas[U]+=D.a,this._sums[U]++}}_addColor(d){const m=8-this._significantBitsPerChannel,g=1+(d.r>>m),w=1+(d.g>>m),I=1+(d.b>>m),P=1+(d.a>>m);this._weights[P][g][w][I]++,this._momentsRed[P][g][w][I]+=d.r,this._momentsGreen[P][g][w][I]+=d.g,this._momentsBlue[P][g][w][I]+=d.b,this._momentsAlpha[P][g][w][I]+=d.a,this._moments[P][g][w][I]+=this._table[d.r]+this._table[d.g]+this._table[d.b]+this._table[d.a]}*_calculateMoments(){const d=[],m=[],g=[],w=[],I=[],P=[],F=createArray3D(this._sideSize,this._sideSize,this._sideSize),$=createArray3D(this._sideSize,this._sideSize,this._sideSize),D=createArray3D(this._sideSize,this._sideSize,this._sideSize),U=createArray3D(this._sideSize,this._sideSize,this._sideSize),Z=createArray3D(this._sideSize,this._sideSize,this._sideSize),j=createArray3D(this._sideSize,this._sideSize,this._sideSize);let G=0;const H=new ProgressTracker(this._alphaMaxSideIndex*this._maxSideIndex,99);for(let W=1;W<=this._alphaMaxSideIndex;++W){fillArray3D(F,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D($,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(D,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(U,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(Z,this._sideSize,this._sideSize,this._sideSize,0),fillArray3D(j,this._sideSize,this._sideSize,this._sideSize,0);for(let Q=1;Q<=this._maxSideIndex;++Q,++G){H.shouldNotify(G)&&(yield{progress:H.progress}),fillArray1D(d,this._sideSize,0),fillArray1D(m,this._sideSize,0),fillArray1D(g,this._sideSize,0),fillArray1D(w,this._sideSize,0),fillArray1D(I,this._sideSize,0),fillArray1D(P,this._sideSize,0);for(let q=1;q<=this._maxSideIndex;++q){let rt=0,it=0,X=0,J=0,tt=0,ot=0;for(let nt=1;nt<=this._maxSideIndex;++nt)rt+=this._weights[W][Q][q][nt],it+=this._momentsRed[W][Q][q][nt],X+=this._momentsGreen[W][Q][q][nt],J+=this._momentsBlue[W][Q][q][nt],tt+=this._momentsAlpha[W][Q][q][nt],ot+=this._moments[W][Q][q][nt],d[nt]+=rt,m[nt]+=it,g[nt]+=X,w[nt]+=J,I[nt]+=tt,P[nt]+=ot,F[Q][q][nt]=F[Q-1][q][nt]+d[nt],$[Q][q][nt]=$[Q-1][q][nt]+m[nt],D[Q][q][nt]=D[Q-1][q][nt]+g[nt],U[Q][q][nt]=U[Q-1][q][nt]+w[nt],Z[Q][q][nt]=Z[Q-1][q][nt]+I[nt],j[Q][q][nt]=j[Q-1][q][nt]+P[nt],this._weights[W][Q][q][nt]=this._weights[W-1][Q][q][nt]+F[Q][q][nt],this._momentsRed[W][Q][q][nt]=this._momentsRed[W-1][Q][q][nt]+$[Q][q][nt],this._momentsGreen[W][Q][q][nt]=this._momentsGreen[W-1][Q][q][nt]+D[Q][q][nt],this._momentsBlue[W][Q][q][nt]=this._momentsBlue[W-1][Q][q][nt]+U[Q][q][nt],this._momentsAlpha[W][Q][q][nt]=this._momentsAlpha[W-1][Q][q][nt]+Z[Q][q][nt],this._moments[W][Q][q][nt]=this._moments[W-1][Q][q][nt]+j[Q][q][nt]}}}}static _volumeFloat(d,m){return m[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMaximum]-m[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMaximum]-m[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMaximum]+m[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]-m[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMaximum]+m[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]+m[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-m[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(m[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMinimum]-m[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]-m[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+m[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]-m[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]+m[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]+m[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]-m[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum])}static _volume(d,m){return 0|_WuQuant._volumeFloat(d,m)}static _top(d,m,g,w){let I;switch(m){case _WuQuant._alpha:I=w[g][d.redMaximum][d.greenMaximum][d.blueMaximum]-w[g][d.redMaximum][d.greenMinimum][d.blueMaximum]-w[g][d.redMinimum][d.greenMaximum][d.blueMaximum]+w[g][d.redMinimum][d.greenMinimum][d.blueMaximum]-(w[g][d.redMaximum][d.greenMaximum][d.blueMinimum]-w[g][d.redMaximum][d.greenMinimum][d.blueMinimum]-w[g][d.redMinimum][d.greenMaximum][d.blueMinimum]+w[g][d.redMinimum][d.greenMinimum][d.blueMinimum]);break;case _WuQuant._red:I=w[d.alphaMaximum][g][d.greenMaximum][d.blueMaximum]-w[d.alphaMaximum][g][d.greenMinimum][d.blueMaximum]-w[d.alphaMinimum][g][d.greenMaximum][d.blueMaximum]+w[d.alphaMinimum][g][d.greenMinimum][d.blueMaximum]-(w[d.alphaMaximum][g][d.greenMaximum][d.blueMinimum]-w[d.alphaMaximum][g][d.greenMinimum][d.blueMinimum]-w[d.alphaMinimum][g][d.greenMaximum][d.blueMinimum]+w[d.alphaMinimum][g][d.greenMinimum][d.blueMinimum]);break;case _WuQuant._green:I=w[d.alphaMaximum][d.redMaximum][g][d.blueMaximum]-w[d.alphaMaximum][d.redMinimum][g][d.blueMaximum]-w[d.alphaMinimum][d.redMaximum][g][d.blueMaximum]+w[d.alphaMinimum][d.redMinimum][g][d.blueMaximum]-(w[d.alphaMaximum][d.redMaximum][g][d.blueMinimum]-w[d.alphaMaximum][d.redMinimum][g][d.blueMinimum]-w[d.alphaMinimum][d.redMaximum][g][d.blueMinimum]+w[d.alphaMinimum][d.redMinimum][g][d.blueMinimum]);break;case _WuQuant._blue:I=w[d.alphaMaximum][d.redMaximum][d.greenMaximum][g]-w[d.alphaMaximum][d.redMaximum][d.greenMinimum][g]-w[d.alphaMaximum][d.redMinimum][d.greenMaximum][g]+w[d.alphaMaximum][d.redMinimum][d.greenMinimum][g]-(w[d.alphaMinimum][d.redMaximum][d.greenMaximum][g]-w[d.alphaMinimum][d.redMaximum][d.greenMinimum][g]-w[d.alphaMinimum][d.redMinimum][d.greenMaximum][g]+w[d.alphaMinimum][d.redMinimum][d.greenMinimum][g]);break;default:throw new Error("impossible")}return 0|I}static _bottom(d,m,g){switch(m){case _WuQuant._alpha:return-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMaximum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant._red:return-g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMaximum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant._green:return-g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMaximum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMaximum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMaximum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMaximum]-(-g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);case _WuQuant._blue:return-g[d.alphaMaximum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMaximum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMaximum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMaximum][d.redMinimum][d.greenMinimum][d.blueMinimum]-(-g[d.alphaMinimum][d.redMaximum][d.greenMaximum][d.blueMinimum]+g[d.alphaMinimum][d.redMaximum][d.greenMinimum][d.blueMinimum]+g[d.alphaMinimum][d.redMinimum][d.greenMaximum][d.blueMinimum]-g[d.alphaMinimum][d.redMinimum][d.greenMinimum][d.blueMinimum]);default:return 0}}_calculateVariance(d){const m=_WuQuant._volume(d,this._momentsRed),g=_WuQuant._volume(d,this._momentsGreen),w=_WuQuant._volume(d,this._momentsBlue),I=_WuQuant._volume(d,this._momentsAlpha);return _WuQuant._volumeFloat(d,this._moments)-(m*m+g*g+w*w+I*I)/_WuQuant._volume(d,this._weights)}_maximize(d,m,g,w,I,P,F,$,D){const U=0|_WuQuant._bottom(d,m,this._momentsRed),Z=0|_WuQuant._bottom(d,m,this._momentsGreen),j=0|_WuQuant._bottom(d,m,this._momentsBlue),G=0|_WuQuant._bottom(d,m,this._momentsAlpha),H=0|_WuQuant._bottom(d,m,this._weights);let W=0,Q=-1;for(let q=g;q<w;++q){let rt=U+_WuQuant._top(d,m,q,this._momentsRed),it=Z+_WuQuant._top(d,m,q,this._momentsGreen),X=j+_WuQuant._top(d,m,q,this._momentsBlue),J=G+_WuQuant._top(d,m,q,this._momentsAlpha),tt=H+_WuQuant._top(d,m,q,this._weights);if(tt!==0){let ot=rt*rt+it*it+X*X+J*J,nt=ot/tt;rt=I-rt,it=P-it,X=F-X,J=$-J,tt=D-tt,tt!==0&&(ot=rt*rt+it*it+X*X+J*J,nt+=ot/tt,nt>W&&(W=nt,Q=q))}}return{max:W,position:Q}}_cut(d,m){let g;const w=_WuQuant._volume(d,this._momentsRed),I=_WuQuant._volume(d,this._momentsGreen),P=_WuQuant._volume(d,this._momentsBlue),F=_WuQuant._volume(d,this._momentsAlpha),$=_WuQuant._volume(d,this._weights),D=this._maximize(d,_WuQuant._red,d.redMinimum+1,d.redMaximum,w,I,P,F,$),U=this._maximize(d,_WuQuant._green,d.greenMinimum+1,d.greenMaximum,w,I,P,F,$),Z=this._maximize(d,_WuQuant._blue,d.blueMinimum+1,d.blueMaximum,w,I,P,F,$),j=this._maximize(d,_WuQuant._alpha,d.alphaMinimum+1,d.alphaMaximum,w,I,P,F,$);if(j.max>=D.max&&j.max>=U.max&&j.max>=Z.max){if(g=_WuQuant._alpha,j.position<0)return!1}else g=D.max>=j.max&&D.max>=U.max&&D.max>=Z.max?_WuQuant._red:U.max>=j.max&&U.max>=D.max&&U.max>=Z.max?_WuQuant._green:_WuQuant._blue;switch(m.redMaximum=d.redMaximum,m.greenMaximum=d.greenMaximum,m.blueMaximum=d.blueMaximum,m.alphaMaximum=d.alphaMaximum,g){case _WuQuant._red:m.redMinimum=d.redMaximum=D.position,m.greenMinimum=d.greenMinimum,m.blueMinimum=d.blueMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant._green:m.greenMinimum=d.greenMaximum=U.position,m.redMinimum=d.redMinimum,m.blueMinimum=d.blueMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant._blue:m.blueMinimum=d.blueMaximum=Z.position,m.redMinimum=d.redMinimum,m.greenMinimum=d.greenMinimum,m.alphaMinimum=d.alphaMinimum;break;case _WuQuant._alpha:m.alphaMinimum=d.alphaMaximum=j.position,m.blueMinimum=d.blueMinimum,m.redMinimum=d.redMinimum,m.greenMinimum=d.greenMinimum}return d.volume=(d.redMaximum-d.redMinimum)*(d.greenMaximum-d.greenMinimum)*(d.blueMaximum-d.blueMinimum)*(d.alphaMaximum-d.alphaMinimum),m.volume=(m.redMaximum-m.redMinimum)*(m.greenMaximum-m.greenMinimum)*(m.blueMaximum-m.blueMinimum)*(m.alphaMaximum-m.alphaMinimum),!0}_initialize(d){this._colors=d,this._cubes=[];for(let m=0;m<d;m++)this._cubes[m]=new WuColorCube;this._cubes[0].redMinimum=0,this._cubes[0].greenMinimum=0,this._cubes[0].blueMinimum=0,this._cubes[0].alphaMinimum=0,this._cubes[0].redMaximum=this._maxSideIndex,this._cubes[0].greenMaximum=this._maxSideIndex,this._cubes[0].blueMaximum=this._maxSideIndex,this._cubes[0].alphaMaximum=this._alphaMaxSideIndex,this._weights=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsRed=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsGreen=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsBlue=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._momentsAlpha=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._moments=createArray4D(this._alphaSideSize,this._sideSize,this._sideSize,this._sideSize),this._table=[];for(let m=0;m<256;++m)this._table[m]=m*m;this._pixels=[]}_setQuality(d=5){this._significantBitsPerChannel=d,this._maxSideIndex=1<<this._significantBitsPerChannel,this._alphaMaxSideIndex=this._maxSideIndex,this._sideSize=this._maxSideIndex+1,this._alphaSideSize=this._alphaMaxSideIndex+1}},WuQuant=_WuQuant;__publicField(WuQuant,"_alpha",3),__publicField(WuQuant,"_red",2),__publicField(WuQuant,"_green",1),__publicField(WuQuant,"_blue",0);var image_exports={};__export(image_exports,{AbstractImageQuantizer:()=>AbstractImageQuantizer,ErrorDiffusionArray:()=>ErrorDiffusionArray,ErrorDiffusionArrayKernel:()=>ErrorDiffusionArrayKernel,ErrorDiffusionRiemersma:()=>ErrorDiffusionRiemersma,NearestColor:()=>NearestColor});var AbstractImageQuantizer=class{quantizeSync(d,m){for(const g of this.quantize(d,m))if(g.pointContainer)return g.pointContainer;throw new Error("unreachable")}},NearestColor=class extends AbstractImageQuantizer{constructor(d){super(),__publicField(this,"_distance"),this._distance=d}*quantize(d,m){const g=d.getPointArray(),w=d.getWidth(),I=d.getHeight(),P=new ProgressTracker(I,99);for(let F=0;F<I;F++){P.shouldNotify(F)&&(yield{progress:P.progress});for(let $=0,D=F*w;$<w;$++,D++){const U=g[D];U.from(m.getNearestColor(this._distance,U))}}yield{pointContainer:d,progress:100}}},ErrorDiffusionArrayKernel=(d=>(d[d.FloydSteinberg=0]="FloydSteinberg",d[d.FalseFloydSteinberg=1]="FalseFloydSteinberg",d[d.Stucki=2]="Stucki",d[d.Atkinson=3]="Atkinson",d[d.Jarvis=4]="Jarvis",d[d.Burkes=5]="Burkes",d[d.Sierra=6]="Sierra",d[d.TwoSierra=7]="TwoSierra",d[d.SierraLite=8]="SierraLite",d))(ErrorDiffusionArrayKernel||{}),ErrorDiffusionArray=class extends AbstractImageQuantizer{constructor(d,m,g=!0,w=0,I=!1){super(),__publicField(this,"_minColorDistance"),__publicField(this,"_serpentine"),__publicField(this,"_kernel"),__publicField(this,"_calculateErrorLikeGIMP"),__publicField(this,"_distance"),this._setKernel(m),this._distance=d,this._minColorDistance=w,this._serpentine=g,this._calculateErrorLikeGIMP=I}*quantize(d,m){const g=d.getPointArray(),w=new Point,I=d.getWidth(),P=d.getHeight(),F=[];let $=1,D=1;for(const Z of this._kernel){const j=Z[2]+1;D<j&&(D=j)}for(let Z=0;Z<D;Z++)this._fillErrorLine(F[Z]=[],I);const U=new ProgressTracker(P,99);for(let Z=0;Z<P;Z++){U.shouldNotify(Z)&&(yield{progress:U.progress}),this._serpentine&&($*=-1);const j=Z*I,G=$===1?0:I-1,H=$===1?I:-1;this._fillErrorLine(F[0],I),F.push(F.shift());const W=F[0];for(let Q=G,q=j+G;Q!==H;Q+=$,q+=$){const rt=g[q],it=W[Q];w.from(rt);const X=Point.createByRGBA(inRange0to255Rounded(rt.r+it[0]),inRange0to255Rounded(rt.g+it[1]),inRange0to255Rounded(rt.b+it[2]),inRange0to255Rounded(rt.a+it[3])),J=m.getNearestColor(this._distance,X);if(rt.from(J),this._minColorDistance&&this._distance.calculateNormalized(w,J)<this._minColorDistance)continue;let tt,ot,nt,lt;this._calculateErrorLikeGIMP?(tt=X.r-J.r,ot=X.g-J.g,nt=X.b-J.b,lt=X.a-J.a):(tt=w.r-J.r,ot=w.g-J.g,nt=w.b-J.b,lt=w.a-J.a);const at=$===1?0:this._kernel.length-1,ut=$===1?this._kernel.length:-1;for(let V=at;V!==ut;V+=$){const ht=this._kernel[V][1]*$,vt=this._kernel[V][2];if(ht+Q>=0&&ht+Q<I&&vt+Z>=0&&vt+Z<P){const pt=this._kernel[V][0],st=F[vt][ht+Q];st[0]+=tt*pt,st[1]+=ot*pt,st[2]+=nt*pt,st[3]+=lt*pt}}}}yield{pointContainer:d,progress:100}}_fillErrorLine(d,m){d.length>m&&(d.length=m);const g=d.length;for(let w=0;w<g;w++){const I=d[w];I[0]=I[1]=I[2]=I[3]=0}for(let w=g;w<m;w++)d[w]=[0,0,0,0]}_setKernel(d){switch(d){case 0:this._kernel=[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]];break;case 1:this._kernel=[[3/8,1,0],[3/8,0,1],[2/8,1,1]];break;case 2:this._kernel=[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]];break;case 3:this._kernel=[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]];break;case 4:this._kernel=[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]];break;case 5:this._kernel=[[.25,1,0],[4/32,2,0],[2/32,-2,1],[4/32,-1,1],[.25,0,1],[4/32,1,1],[2/32,2,1]];break;case 6:this._kernel=[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[4/32,-1,1],[5/32,0,1],[4/32,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]];break;case 7:this._kernel=[[.25,1,0],[3/16,2,0],[1/16,-2,1],[2/16,-1,1],[3/16,0,1],[2/16,1,1],[1/16,2,1]];break;case 8:this._kernel=[[.5,1,0],[1/4,-1,1],[1/4,0,1]];break;default:throw new Error(`ErrorDiffusionArray: unknown kernel = ${d}`)}}};function*hilbertCurve(d,m,g){const w=Math.max(d,m),I={width:d,height:m,level:Math.floor(Math.log(w)/Math.log(2)+1),callback:g,tracker:new ProgressTracker(d*m,99),index:0,x:0,y:0};yield*walkHilbert(I,1),visit(I,0)}function*walkHilbert(d,m){if(!(d.level<1)){switch(d.tracker.shouldNotify(d.index)&&(yield{progress:d.tracker.progress}),d.level--,m){case 2:yield*walkHilbert(d,1),visit(d,3),yield*walkHilbert(d,2),visit(d,4),yield*walkHilbert(d,2),visit(d,2),yield*walkHilbert(d,4);break;case 3:yield*walkHilbert(d,4),visit(d,2),yield*walkHilbert(d,3),visit(d,1),yield*walkHilbert(d,3),visit(d,3),yield*walkHilbert(d,1);break;case 1:yield*walkHilbert(d,2),visit(d,4),yield*walkHilbert(d,1),visit(d,3),yield*walkHilbert(d,1),visit(d,1),yield*walkHilbert(d,3);break;case 4:yield*walkHilbert(d,3),visit(d,1),yield*walkHilbert(d,4),visit(d,2),yield*walkHilbert(d,4),visit(d,4),yield*walkHilbert(d,2)}d.level++}}function visit(d,m){switch(d.x>=0&&d.x<d.width&&d.y>=0&&d.y<d.height&&(d.callback(d.x,d.y),d.index++),m){case 2:d.x--;break;case 3:d.x++;break;case 1:d.y--;break;case 4:d.y++}}var ErrorDiffusionRiemersma=class extends AbstractImageQuantizer{constructor(d,m=16,g=1){super(),__publicField(this,"_distance"),__publicField(this,"_weights"),__publicField(this,"_errorQueueSize"),this._distance=d,this._errorQueueSize=m,this._weights=ErrorDiffusionRiemersma._createWeights(g,m)}*quantize(d,m){const g=d.getPointArray(),w=d.getWidth(),I=d.getHeight(),P=[];let F=0;for(let $=0;$<this._errorQueueSize;$++)P[$]={r:0,g:0,b:0,a:0};yield*hilbertCurve(w,I,($,D)=>{const U=g[$+D*w];let{r:Z,g:j,b:G,a:H}=U;for(let rt=0;rt<this._errorQueueSize;rt++){const it=this._weights[rt],X=P[(rt+F)%this._errorQueueSize];Z+=X.r*it,j+=X.g*it,G+=X.b*it,H+=X.a*it}const W=Point.createByRGBA(inRange0to255Rounded(Z),inRange0to255Rounded(j),inRange0to255Rounded(G),inRange0to255Rounded(H)),Q=m.getNearestColor(this._distance,W);F=(F+1)%this._errorQueueSize;const q=(F+this._errorQueueSize-1)%this._errorQueueSize;P[q].r=U.r-Q.r,P[q].g=U.g-Q.g,P[q].b=U.b-Q.b,P[q].a=U.a-Q.a,U.from(Q)}),yield{pointContainer:d,progress:100}}static _createWeights(d,m){const g=[],w=Math.exp(Math.log(m)/(m-1));for(let I=0,P=1;I<m;I++)g[I]=(P+.5|0)/m*d,P*=w;return g}},quality_exports={};__export(quality_exports,{ssim:()=>ssim});var K1=.01,K2=.03;function ssim(d,m){if(d.getHeight()!==m.getHeight()||d.getWidth()!==m.getWidth())throw new Error("Images have different sizes!");const g=(255*K1)**2,w=(255*K2)**2;let I=0,P=0;return iterate(d,m,(F,$,D,U)=>{let Z=0,j=0,G=0;for(let W=0;W<F.length;W++)j+=(F[W]-D)**2,G+=($[W]-U)**2,Z+=(F[W]-D)*($[W]-U);const H=F.length-1;j/=H,G/=H,Z/=H,P+=(2*D*U+g)*(2*Z+w)/((D**2+U**2+g)*(j+G+w)),I++}),P/I}function iterate(d,m,g){const w=d.getWidth(),I=d.getHeight();for(let P=0;P<I;P+=8)for(let F=0;F<w;F+=8){const $=Math.min(8,w-F),D=Math.min(8,I-P),U=calculateLumaValuesForWindow(d,F,P,$,D),Z=calculateLumaValuesForWindow(m,F,P,$,D);g(U,Z,calculateAverageLuma(U),calculateAverageLuma(Z))}}function calculateLumaValuesForWindow(d,m,g,w,I){const P=d.getPointArray(),F=[];let $=0;for(let D=g;D<g+I;D++){const U=D*d.getWidth();for(let Z=m;Z<m+w;Z++){const j=P[U+Z];F[$]=.2126*j.r+.7152*j.g+.0722*j.b,$++}}return F}function calculateAverageLuma(d){let m=0;for(const g of d)m+=g;return m/d.length}function buildPaletteSync(d,{colorDistanceFormula:m,paletteQuantization:g,colors:w}={}){const I=paletteQuantizationToPaletteQuantizer(colorDistanceFormulaToColorDistance(m),g,w);return d.forEach(P=>I.sample(P)),I.quantizeSync()}function applyPaletteSync(d,m,{colorDistanceFormula:g,imageQuantization:w}={}){return imageQuantizationToImageQuantizer(colorDistanceFormulaToColorDistance(g),w).quantizeSync(d,m)}function colorDistanceFormulaToColorDistance(d="euclidean-bt709"){switch(d){case"cie94-graphic-arts":return new CIE94GraphicArts;case"cie94-textiles":return new CIE94Textiles;case"ciede2000":return new CIEDE2000;case"color-metric":return new CMetric;case"euclidean":return new Euclidean;case"euclidean-bt709":return new EuclideanBT709;case"euclidean-bt709-noalpha":return new EuclideanBT709NoAlpha;case"manhattan":return new Manhattan;case"manhattan-bt709":return new ManhattanBT709;case"manhattan-nommyde":return new ManhattanNommyde;case"pngquant":return new PNGQuant;default:throw new Error(`Unknown colorDistanceFormula ${d}`)}}function imageQuantizationToImageQuantizer(d,m="floyd-steinberg"){switch(m){case"nearest":return new NearestColor(d);case"riemersma":return new ErrorDiffusionRiemersma(d);case"floyd-steinberg":return new ErrorDiffusionArray(d,0);case"false-floyd-steinberg":return new ErrorDiffusionArray(d,1);case"stucki":return new ErrorDiffusionArray(d,2);case"atkinson":return new ErrorDiffusionArray(d,3);case"jarvis":return new ErrorDiffusionArray(d,4);case"burkes":return new ErrorDiffusionArray(d,5);case"sierra":return new ErrorDiffusionArray(d,6);case"two-sierra":return new ErrorDiffusionArray(d,7);case"sierra-lite":return new ErrorDiffusionArray(d,8);default:throw new Error(`Unknown imageQuantization ${m}`)}}function paletteQuantizationToPaletteQuantizer(d,m="wuquant",g=256){switch(m){case"neuquant":return new NeuQuant(d,g);case"rgbquant":return new RGBQuant(d,g);case"wuquant":return new WuQuant(d,g);case"neuquant-float":return new NeuQuantFloat(d,g);default:throw new Error(`Unknown paletteQuantization ${m}`)}}/**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * cie94.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * ciede2000.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * cmetric.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * common.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * constants.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * ditherErrorDiffusionArray.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * euclidean.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * helper.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * hueStatistics.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * iq.ts - Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * lab2rgb.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * lab2xyz.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * manhattanNeuQuant.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * nearestColor.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * palette.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * pngQuant.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * point.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * pointContainer.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgb2hsl.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgb2lab.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgb2xyz.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * ssim.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * wuQuant.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * xyz2lab.ts - part of Image Quantization Library
 *//**
 * @preserve
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * xyz2rgb.ts - part of Image Quantization Library
 *//**
 * @preserve
 * MIT License
 *
 * Copyright 2015-2018 Igor Bezkrovnyi
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
 * THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * riemersma.ts - part of Image Quantization Library
 *//**
 * @preserve TypeScript port:
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * colorHistogram.ts - part of Image Quantization Library
 *//**
 * @preserve TypeScript port:
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * neuquant.ts - part of Image Quantization Library
 *//**
 * @preserve TypeScript port:
 * Copyright 2015-2018 Igor Bezkrovnyi
 * All rights reserved. (MIT Licensed)
 *
 * rgbquant.ts - part of Image Quantization Library
 */typeof setImmediate=="function"?setImmediate:typeof process<"u"&&(process==null||process.nextTick);const QuantizeOptionsSchema=z.object({colors:z.number().optional(),colorDistanceFormula:z.union([z.literal("cie94-textiles"),z.literal("cie94-graphic-arts"),z.literal("ciede2000"),z.literal("color-metric"),z.literal("euclidean"),z.literal("euclidean-bt709-noalpha"),z.literal("euclidean-bt709"),z.literal("manhattan"),z.literal("manhattan-bt709"),z.literal("manhattan-nommyde"),z.literal("pngquant")]).optional(),paletteQuantization:z.union([z.literal("neuquant"),z.literal("neuquant-float"),z.literal("rgbquant"),z.literal("wuquant")]).optional(),imageQuantization:z.union([z.literal("nearest"),z.literal("riemersma"),z.literal("floyd-steinberg"),z.literal("false-floyd-steinberg"),z.literal("stucki"),z.literal("atkinson"),z.literal("jarvis"),z.literal("burkes"),z.literal("sierra"),z.literal("two-sierra"),z.literal("sierra-lite")]).optional()}),methods={quantize(d,m){const{colors:g,colorDistanceFormula:w,paletteQuantization:I,imageQuantization:P}=QuantizeOptionsSchema.parse(m),F=utils_exports.PointContainer.fromUint8Array(d.bitmap.data,d.bitmap.width,d.bitmap.height),$=applyPaletteSync(F,buildPaletteSync([F],{colors:g,colorDistanceFormula:w,paletteQuantization:I}),{colorDistanceFormula:w,imageQuantization:P});return d.bitmap.data=Buffer.from($.toUint8Array()),d}};var parseBmfontAscii=function(d){if(!d)throw new Error("no data provided");var m={pages:[],chars:[],kernings:[]},g=(d=d.toString().trim()).split(/\r\n?|\n/g);if(g.length===0)throw new Error("no data in BMFont file");for(var w=0;w<g.length;w++){var I=splitLine(g[w],w);if(I)if(I.key==="page"){if(typeof I.data.id!="number")throw new Error("malformed file at line "+w+" -- needs page id=N");if(typeof I.data.file!="string")throw new Error("malformed file at line "+w+' -- needs page file="path"');m.pages[I.data.id]=I.data.file}else I.key==="chars"||I.key==="kernings"||(I.key==="char"?m.chars.push(I.data):I.key==="kerning"?m.kernings.push(I.data):m[I.key]=I.data)}return m};function splitLine(d,m){if(!(d=d.replace(/\t+/g," ").trim()))return null;var g=d.indexOf(" ");if(g===-1)throw new Error("no named row at line "+m);var w=d.substring(0,g);d=(d=(d=(d=d.substring(g+1)).replace(/letter=[\'\"]\S+[\'\"]/gi,"")).split("=")).map(function(D){return D.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var I=[],P=0;P<d.length;P++){var F=d[P];P===0?I.push({key:F[0],data:""}):P===d.length-1?I[I.length-1].data=parseData(F[0]):(I[I.length-1].data=parseData(F[0]),I.push({key:F[1],data:""}))}var $={key:w,data:{}};return I.forEach(function(D){$.data[D.key]=D.data}),$}function parseData(d){return d&&d.length!==0?d.indexOf('"')===0||d.indexOf("'")===0?d.substring(1,d.length-1):d.indexOf(",")!==-1?parseIntList$1(d):parseInt(d,10):""}function parseIntList$1(d){return d.split(",").map(function(m){return parseInt(m,10)})}getDefaultExportFromCjs(parseBmfontAscii);var GLYPH_DESIGNER_ERROR="chasrset",parseAttribs=function(d){for(var m in d=Object.assign({},d),GLYPH_DESIGNER_ERROR in d&&(d.charset=d[GLYPH_DESIGNER_ERROR],delete d[GLYPH_DESIGNER_ERROR]),d)m!=="face"&&m!=="charset"&&(d[m]=m==="padding"||m==="spacing"?parseIntList(d[m]):parseInt(d[m],10));return d};function parseIntList(d){return d.split(",").map(function(m){return parseInt(m,10)})}var xmlParseFromString=self.DOMParser!==void 0?function(d){return new self.DOMParser().parseFromString(d,"application/xml")}:self.ActiveXObject!==void 0&&new self.ActiveXObject("Microsoft.XMLDOM")?function(d){var m=new self.ActiveXObject("Microsoft.XMLDOM");return m.async="false",m.loadXML(d),m}:function(d){var m=document.createElement("div");return m.innerHTML=d,m},parseAttributes=parseAttribs,parseFromString=xmlParseFromString,NAME_MAP={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"},browser=function(d){d=d.toString();var m=parseFromString(d),g={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(U){var Z=m.getElementsByTagName(U)[0];Z&&(g[U]=parseAttributes(getAttribs(Z)))});var w=m.getElementsByTagName("pages")[0];if(!w)throw new Error("malformed file -- no <pages> element");for(var I=w.getElementsByTagName("page"),P=0;P<I.length;P++){var F=I[P],$=parseInt(F.getAttribute("id"),10),D=F.getAttribute("file");if(isNaN($))throw new Error('malformed file -- page "id" attribute is NaN');if(!D)throw new Error('malformed file -- needs page "file" attribute');g.pages[parseInt($,10)]=D}return["chars","kernings"].forEach(function(U){var Z=m.getElementsByTagName(U)[0];if(Z)for(var j=U.substring(0,U.length-1),G=Z.getElementsByTagName(j),H=0;H<G.length;H++){var W=G[H];g[U].push(parseAttributes(getAttribs(W)))}}),g};function getAttribs(d){return getAttribList(d).reduce(function(m,g){return m[mapName(g.nodeName)]=g.nodeValue,m},{})}function getAttribList(d){for(var m=[],g=0;g<d.attributes.length;g++)m.push(d.attributes[g]);return m}function mapName(d){return NAME_MAP[d.toLowerCase()]||d}getDefaultExportFromCjs(browser);var HEADER$1=[66,77,70],parseBmfontBinary=function(d){if(d.length<6)throw new Error("invalid buffer length for BMFont");var m=HEADER$1.every(function(P,F){return d.readUInt8(F)===P});if(!m)throw new Error("BMFont missing BMF byte header");var g=3;if(d.readUInt8(g++)>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var w={kernings:[],chars:[]},I=0;I<5;I++)g+=readBlock(w,d,g);return w};function readBlock(d,m,g){if(g>m.length-1)return 0;var w=m.readUInt8(g++),I=m.readInt32LE(g);switch(g+=4,w){case 1:d.info=readInfo(m,g);break;case 2:d.common=readCommon(m,g);break;case 3:d.pages=readPages(m,g,I);break;case 4:d.chars=readChars(m,g,I);break;case 5:d.kernings=readKernings(m,g,I)}return 5+I}function readInfo(d,m){var g={};g.size=d.readInt16LE(m);var w=d.readUInt8(m+2);return g.smooth=w>>7&1,g.unicode=w>>6&1,g.italic=w>>5&1,g.bold=w>>4&1,w>>3&1&&(g.fixedHeight=1),g.charset=d.readUInt8(m+3)||"",g.stretchH=d.readUInt16LE(m+4),g.aa=d.readUInt8(m+6),g.padding=[d.readInt8(m+7),d.readInt8(m+8),d.readInt8(m+9),d.readInt8(m+10)],g.spacing=[d.readInt8(m+11),d.readInt8(m+12)],g.outline=d.readUInt8(m+13),g.face=readStringNT(d,m+14),g}function readCommon(d,m){var g={};return g.lineHeight=d.readUInt16LE(m),g.base=d.readUInt16LE(m+2),g.scaleW=d.readUInt16LE(m+4),g.scaleH=d.readUInt16LE(m+6),g.pages=d.readUInt16LE(m+8),d.readUInt8(m+10),g.packed=0,g.alphaChnl=d.readUInt8(m+11),g.redChnl=d.readUInt8(m+12),g.greenChnl=d.readUInt8(m+13),g.blueChnl=d.readUInt8(m+14),g}function readPages(d,m,g){for(var w=[],I=readNameNT(d,m),P=I.length+1,F=g/P,$=0;$<F;$++)w[$]=d.slice(m,m+I.length).toString("utf8"),m+=P;return w}function readChars(d,m,g){for(var w=[],I=g/20,P=0;P<I;P++){var F={},$=20*P;F.id=d.readUInt32LE(m+0+$),F.x=d.readUInt16LE(m+4+$),F.y=d.readUInt16LE(m+6+$),F.width=d.readUInt16LE(m+8+$),F.height=d.readUInt16LE(m+10+$),F.xoffset=d.readInt16LE(m+12+$),F.yoffset=d.readInt16LE(m+14+$),F.xadvance=d.readInt16LE(m+16+$),F.page=d.readUInt8(m+18+$),F.chnl=d.readUInt8(m+19+$),w[P]=F}return w}function readKernings(d,m,g){for(var w=[],I=g/10,P=0;P<I;P++){var F={},$=10*P;F.first=d.readUInt32LE(m+0+$),F.second=d.readUInt32LE(m+4+$),F.amount=d.readInt16LE(m+8+$),w[P]=F}return w}function readNameNT(d,m){for(var g=m;g<d.length&&d[g]!==0;g++);return d.slice(m,g)}function readStringNT(d,m){return readNameNT(d,m).toString("utf8")}getDefaultExportFromCjs(parseBmfontBinary);function e(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}const t=d=>{if(!d)return null;const m={};switch(d.type){case"ELEMENT":{let g={};const w=E(d.value.attributes),I=t(d.value.children);if(w&&(g=Object.assign(g,w)),I){const P=r(d.value.children);g=Object.assign(g,P)}m[d.value.type]=g;break}case"ATTRIBUTE":{const g=d.value;m[g.name]=g.value;break}case"CONTENT":return{content:d.value}}return m},r=d=>d&&Array.isArray(d)&&d.length!==0?n(d)?{content:d[0].value}:{children:d.map(t)}:null,n=d=>d&&Array.isArray(d)&&d.length===1&&d[0].type==="CONTENT",E=d=>d&&Array.isArray(d)?d.map(t).reduce((m,g)=>Object.assign(m,g),{}):null;var s={convert:d=>t(d.value.children[0])},a={Token:(d,m)=>({type:d,value:m}),TOKEN_TYPE:{OPEN_BRACKET:"OPEN_BRACKET",ELEMENT_TYPE:"ELEMENT_TYPE",CLOSE_ELEMENT:"CLOSE_ELEMENT",ATTRIB_NAME:"ATTRIB_NAME",ATTRIB_VALUE:"ATTRIB_VALUE",ASSIGN:"ASSIGN",CLOSE_BRACKET:"CLOSE_BRACKET",CONTENT:"CONTENT",EOF:"EOF"}};const{Token:T,TOKEN_TYPE:u}=a,c=T("EOF"),l=d=>d===" "||d===`
`||d==="\r"||d==="	",o=d=>d.replace(/'/g,'"');var N={createLexer:function(d){let m=null,g=(j=>{let G=0;for(;G<j.length&&l(j[G]);)G++;return((H,W)=>{if(H.startsWith("<?xml",W)){const Q=H.length;for(;W<Q;)if(H[W]!=="?")W++;else{if(H[W+1]===">")return W+2;W++}}return W})(j,G)})(d),w=[];const I=()=>d[g],P=()=>m!==c&&g<d.length,F=j=>j==='"'||j==="'",$=()=>{for(;P()&&l(d[g]);)g++},D=j=>{if(P()){if(d[g]==="<"){let G="<";return g++,P()&&d[g]==="/"?(g++,G="</"):P()&&d[g]==="!"&&d[g+1]==="-"&&d[g+2]==="-"&&(g++,g++,g++,G="<!--"),G}if(I()==="/"){let G="/";return g++,P()&&I()===">"&&(g++,G="/>"),G}if(d[g]==="="||d[g]===">"){const G=d[g];return g++,G}}return U(!!j)},U=j=>{const G=j?/[^>=<]/u:/[a-zA-Z0-9_:-]/;let H=g;for(;P()&&d[g].match(G);)g++;return o(d.substring(H,g))},Z=()=>{const j=g;$();const G=g-j;if(P())if(m&&m.type===u.OPEN_BRACKET){$();const H=D(!1);m=T(u.ELEMENT_TYPE,H),w.push(H)}else if(m&&m.type===u.ASSIGN){P()&&F(I())&&g++;let H=g;for(;P()&&!F(I());)g++;const W=o(d.substring(H,g));g++,m=T(u.ATTRIB_VALUE,W)}else{$();let H=D(!0);switch(H){case"=":m=m.type===u.ATTRIB_NAME?T(u.ASSIGN):T(u.CONTENT,H);break;case"</":{const W=g;for(;d[g]!==">";)g++;m=T(u.CLOSE_ELEMENT,d.substring(W,g)),g++,w.pop();break}case"/>":{const W=w.pop();m=T(u.CLOSE_ELEMENT,W);break}case"<!--":{const W=["!","-","-"];for(;P()&&(W[2]!==">"||W[1]!=="-"||W[0]!=="-");)W.shift(),W.push(d[g]),g++;return Z()}case">":m=T(u.CLOSE_BRACKET);break;case"<":m=T(u.OPEN_BRACKET);break;default:if(H&&H.length>0){if(m.type===u.CLOSE_BRACKET){let W="";I()!=="<"&&(W=U(!0)),m=T(u.CONTENT,H+W)}else if(m.type!==u.ATTRIB_NAME&&m.type!==u.CONTENT)m.type===u.CLOSE_ELEMENT?(H=" ".repeat(G)+H,m=T(u.CONTENT,H)):m=T(u.ATTRIB_NAME,H);else{const W=" ".repeat(G)+H;m=T(u.CONTENT,W)}break}{const W='Unknown Syntax : "'+d[g]+'"';throw new Error(W)}}}else m=c;return m};return{peek:I,next:Z,hasNext:P}}};const{createLexer:i}=N,{Token:p,TOKEN_TYPE:O}=a,[A,f,C,h]=["ROOT","ELEMENT","ATTRIBUTE","CONTENT"],_=(d,m)=>({type:d,value:m}),L=d=>_(h,d),y=(d,m,g)=>_(f,{type:d,attributes:m,children:g}),v=(d,m)=>_(C,{name:d,value:m}),S=(d,m)=>{const g=[];for(;d.hasNext();){const w=d.next();switch(w.type){case O.OPEN_BRACKET:{const I=d.next(),[P,F]=R(d);let $=[];F.type!==O.CLOSE_ELEMENT&&($=S(d,I)),$&&$.length>0&&$[0].type===O.CONTENT&&($=b($)),g.push(y(I.value,P,$));break}case O.CLOSE_ELEMENT:if(w.value===m.value)return g;break;case O.CONTENT:g.push(L(w.value));break;case O.EOF:return g;default:throw new Error(`Unknown Lexem type: ${w.type} "${w.value}, scoping element: ${m.value}"`)}}return g},R=d=>{const m=[];let g=d.peek();if(!d.hasNext()||g&&g.type===O.CLOSE_BRACKET||g&&g.type===O.CLOSE_ELEMENT)return[m,g];for(g=d.next();d.hasNext()&&g&&g.type!==O.CLOSE_BRACKET&&g.type!==O.CLOSE_ELEMENT;){const w=g;d.next();const I=d.next(),P=v(w.value,I.value);m.push(P),g=d.next()}return[m,g]};function b(d){let m=[],g="";return d.forEach(w=>{w.type===O.CONTENT?g+=w.value:(g.length&&(m.push(L(g)),g=""),m.push(w))}),g.length&&m.push(L(g)),m}var B={transpile:function(d,m){const g=(w=>_(A,{children:S(w,p(A,"ROOT"))}))(i(d));return m?m.convert(g):g}};const M=s,{transpile:x}=B;var k=e({convertXML:function(d,m){return x(d,m||M)},createAST:function(d){return x(d)}}),simpleXmlToJson_min=k,xmlPackage=getDefaultExportFromCjs(simpleXmlToJson_min);const{convertXML}=xmlPackage;createJimp({formats:[png]});Buffer.from([66,77,70,3]);var pixelmatch_1=pixelmatch;const defaultOptions={threshold:.1,includeAA:!1,alpha:.1,aaColor:[255,255,0],diffColor:[255,0,0],diffColorAlt:null,diffMask:!1};function pixelmatch(d,m,g,w,I,P){if(!isPixelData(d)||!isPixelData(m)||g&&!isPixelData(g))throw new Error("Image data: Uint8Array, Uint8ClampedArray or Buffer expected.");if(d.length!==m.length||g&&g.length!==d.length)throw new Error("Image sizes do not match.");if(d.length!==w*I*4)throw new Error("Image data size does not match width/height.");P=Object.assign({},defaultOptions,P);const F=w*I,$=new Uint32Array(d.buffer,d.byteOffset,F),D=new Uint32Array(m.buffer,m.byteOffset,F);let U=!0;for(let G=0;G<F;G++)if($[G]!==D[G]){U=!1;break}if(U){if(g&&!P.diffMask)for(let G=0;G<F;G++)drawGrayPixel(d,4*G,P.alpha,g);return 0}const Z=35215*P.threshold*P.threshold;let j=0;for(let G=0;G<I;G++)for(let H=0;H<w;H++){const W=4*(G*w+H),Q=colorDelta(d,m,W,W);Math.abs(Q)>Z?P.includeAA||!antialiased(d,H,G,w,I,m)&&!antialiased(m,H,G,w,I,d)?(g&&drawPixel(g,W,...Q<0&&P.diffColorAlt||P.diffColor),j++):g&&!P.diffMask&&drawPixel(g,W,...P.aaColor):g&&(P.diffMask||drawGrayPixel(d,W,P.alpha,g))}return j}function isPixelData(d){return ArrayBuffer.isView(d)&&d.constructor.BYTES_PER_ELEMENT===1}function antialiased(d,m,g,w,I,P){const F=Math.max(m-1,0),$=Math.max(g-1,0),D=Math.min(m+1,w-1),U=Math.min(g+1,I-1),Z=4*(g*w+m);let j,G,H,W,Q=m===F||m===D||g===$||g===U?1:0,q=0,rt=0;for(let it=F;it<=D;it++)for(let X=$;X<=U;X++){if(it===m&&X===g)continue;const J=colorDelta(d,d,Z,4*(X*w+it),!0);if(J===0){if(Q++,Q>2)return!1}else J<q?(q=J,j=it,G=X):J>rt&&(rt=J,H=it,W=X)}return q!==0&&rt!==0&&(hasManySiblings(d,j,G,w,I)&&hasManySiblings(P,j,G,w,I)||hasManySiblings(d,H,W,w,I)&&hasManySiblings(P,H,W,w,I))}function hasManySiblings(d,m,g,w,I){const P=Math.max(m-1,0),F=Math.max(g-1,0),$=Math.min(m+1,w-1),D=Math.min(g+1,I-1),U=4*(g*w+m);let Z=m===P||m===$||g===F||g===D?1:0;for(let j=P;j<=$;j++)for(let G=F;G<=D;G++){if(j===m&&G===g)continue;const H=4*(G*w+j);if(d[U]===d[H]&&d[U+1]===d[H+1]&&d[U+2]===d[H+2]&&d[U+3]===d[H+3]&&Z++,Z>2)return!0}return!1}function colorDelta(d,m,g,w,I){let P=d[g+0],F=d[g+1],$=d[g+2],D=d[g+3],U=m[w+0],Z=m[w+1],j=m[w+2],G=m[w+3];if(D===G&&P===U&&F===Z&&$===j)return 0;D<255&&(D/=255,P=blend(P,D),F=blend(F,D),$=blend($,D)),G<255&&(G/=255,U=blend(U,G),Z=blend(Z,G),j=blend(j,G));const H=rgb2y(P,F,$),W=rgb2y(U,Z,j),Q=H-W;if(I)return Q;const q=rgb2i(P,F,$)-rgb2i(U,Z,j),rt=rgb2q(P,F,$)-rgb2q(U,Z,j),it=.5053*Q*Q+.299*q*q+.1957*rt*rt;return H>W?-it:it}function rgb2y(d,m,g){return .29889531*d+.58662247*m+.11448223*g}function rgb2i(d,m,g){return .59597799*d-.2741761*m-.32180189*g}function rgb2q(d,m,g){return .21147017*d-.52261711*m+.31114694*g}function blend(d,m){return 255+(d-255)*m}function drawPixel(d,m,g,w,I){d[m+0]=g,d[m+1]=w,d[m+2]=I,d[m+3]=255}function drawGrayPixel(d,m,g,w){const I=blend(rgb2y(d[m+0],d[m+1],d[m+2]),g*d[m+3]/255);drawPixel(w,m,I,I,I)}getDefaultExportFromCjs(pixelmatch_1);const defaultPlugins=[methods$h,methods$g,methods$f,methods$e,methods$c,methods$a,methods$b,methods$9,methods$8,methods$7,methods$6,methods$5,methods$4,methods$3,methods$d,methods$2,methods$1,methods],defaultFormats=[bmp,msBmp,gif,jpeg$2,png,tiff];bmp().mime,gif().mime,jpeg$2().mime,png().mime,tiff().mime;const Jimp=createJimp({formats:defaultFormats,plugins:defaultPlugins}),_hoisted_1={key:1,class:"user-profile"},_hoisted_2={class:"container main-content"},_hoisted_3={class:"profile-header"},_hoisted_4=["src"],_hoisted_5={class:"profile-info"},_hoisted_6={class:"username"},_hoisted_7={class:"uuid"},_hoisted_8={class:"stats-grid"},_hoisted_9={class:"stat-icon"},_hoisted_10={class:"stat-content"},_hoisted_11={class:"stat-value"},_hoisted_12={class:"stat-title"},_sfc_main={__name:"Userpage",setup(d){dayjs.extend(relativeTime),dayjs.locale("zh-cn");const m=useRoute(),g=ref(m.params.username),w=ref(""),I=ref("xxxxxxxx-xxxx-xxxxxxxxxxxx"),P=ref(dayjs().valueOf()),F=ref(dayjs().valueOf()),$=ref(0),D=ref(0);ref(0);const U=ref(""),Z=ref("#000000"),j=ref(""),G=ref(!0);axios.get(_sfc_main$1.backendurl+"/api/userdata",{params:{username:g.value}}).then(W=>{W.data.status==200?(w.value="",I.value=W.data.uuid,P.value=W.data.lastlogin,F.value=W.data.regtime,$.value=W.data.balance,D.value=dayjs(W.data.playtime).get("hour"),W.data.rank=="vip"?(U.value="[VIP] ",Z.value="#ffdd19"):W.data.rank=="mvp"?(U.value="[MVP] ",Z.value="#ff3311"):W.data.rank=="admin"?(U.value="[Admin] ",Z.value="#dd0033"):W.data.rank=="builder"&&(U.value="[Builder] ",Z.value="#00ff00")):(console.warn("Error code received when retrieving data: "+W.data.status),G.value=!1)}),axios.get(_sfc_main$1.backendurl+"/api/avatar",{params:{username:g.value}}).then(W=>{console.log(W.data),Jimp.read(W.data.textures.SKIN.url).then(Q=>{Q.crop({x:8,y:8,h:8,w:8}).resize({w:120,h:120,mode:"nearestNeighbor"}).getBase64("image/png").then(q=>{console.log(q),j.value=q})})});const H=computed(()=>[{title:"上次登录",value:dayjs(P.value).fromNow(),icon:render$1,hue:200},{title:"注册时间",value:dayjs(F.value).format("YYYY-MM-DD"),icon:render$2,hue:220},{title:"金币数量",value:$.value.toLocaleString(),icon:render,hue:50},{title:"活跃时长",value:`${D.value} 小时`,icon:render$1,hue:180}]);return(W,Q)=>(openBlock(),createElementBlock(Fragment,null,[G.value?createCommentVNode("",!0):(openBlock(),createBlock(_sfc_main$2,{key:0})),G.value?(openBlock(),createElementBlock("div",_hoisted_1,[createVNode(Navbar,{class:"navbar-container"}),createBaseVNode("main",_hoisted_2,[createBaseVNode("div",_hoisted_3,[createBaseVNode("img",{src:j.value,alt:"用户头像",class:"avatar"},null,8,_hoisted_4),createBaseVNode("div",_hoisted_5,[createBaseVNode("h1",_hoisted_6,[createBaseVNode("span",{style:normalizeStyle("color: "+Z.value),class:"userrank"},toDisplayString(U.value),5),createTextVNode(toDisplayString(g.value),1)]),createBaseVNode("div",_hoisted_7,"UUID: "+toDisplayString(I.value),1),createBaseVNode("div",{class:normalizeClass(["bio",{"empty-bio":!w.value}])},toDisplayString(w.value||"该用户很懒，什么也没有写!"),3)])]),createBaseVNode("div",_hoisted_8,[(openBlock(!0),createElementBlock(Fragment,null,renderList(H.value,q=>(openBlock(),createElementBlock("div",{key:q.title,class:"stat-card",style:normalizeStyle({"--hue":q.hue})},[createBaseVNode("div",_hoisted_9,[(openBlock(),createBlock(resolveDynamicComponent(q.icon)))]),createBaseVNode("div",_hoisted_10,[createBaseVNode("div",_hoisted_11,toDisplayString(q.value),1),createBaseVNode("div",_hoisted_12,toDisplayString(q.title),1)])],4))),128))])])])):createCommentVNode("",!0)],64))}};export{_sfc_main as default};
