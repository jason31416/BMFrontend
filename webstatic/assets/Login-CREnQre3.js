import{r as l,c as u,f as s,z as b,g as y,t as k,l as p,v as d,A as _,b as c,k as w}from"./index-TIiU0LZt.js";import{a as m,_ as v}from"./const-ClyfiBNT.js";import{J as x}from"./JSEncrypt-BF8AmNNu.js";const V={class:"container"},h={class:"login-card"},B={key:0,class:"error-message"},E={class:"input-group"},S={class:"input-group"},N={__name:"Login",setup(D){const r=l(""),n=l(""),t=l(null),f=_();function g(){t.value=null,m.get(v.backendurl+"/api/publickey").then(i=>{var e=new x;e.setPublicKey(i.data);var o=e.encrypt(n.value);m.post(v.backendurl+"/api/login",{username:r.value,password:o}).then(a=>{a.data.success==!0?(w.set("bmsessiontoken",a.data.token,"7d"),f.push("/")):t.value=a.data.message}).catch(a=>{t.value="登录失败，也许是服务器关了？过会再试吧！",console.error("Login error:",a)})})}return(i,e)=>(c(),u("div",V,[s("div",h,[e[5]||(e[5]=s("h1",{class:"title"},"欢迎回来",-1)),s("form",{onSubmit:b(g,["prevent"]),class:"form"},[t.value?(c(),u("div",B,k(t.value),1)):y("",!0),s("div",E,[e[2]||(e[2]=s("label",{for:"username"},"用户名",-1)),p(s("input",{id:"username",type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>r.value=o),class:"input",placeholder:"请输入您的游戏内用户名"},null,512),[[d,r.value]])]),s("div",S,[e[3]||(e[3]=s("label",{for:"password"},"密码",-1)),p(s("input",{id:"password",type:"password","onUpdate:modelValue":e[1]||(e[1]=o=>n.value=o),class:"input",placeholder:"••••••••"},null,512),[[d,n.value]])]),e[4]||(e[4]=s("button",{type:"submit",class:"button"},"登录",-1))],32)])]))}};export{N as default};
